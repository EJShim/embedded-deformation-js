(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Oe=1e-6,at=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function rg(){var t=new at(9);return at!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Do(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function oy(t){var e=new at(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function fy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function uy(t,e,r,n,a,i,s,f,o){var u=new at(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=i,u[6]=s,u[7]=f,u[8]=o,u}function cy(t,e,r,n,a,i,s,f,o,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=f,t[7]=o,t[8]=u,t}function Qr(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ng(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function mo(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=g*s-f*u,l=-g*i+f*o,h=u*i-s*o,y=r*c+n*l+a*h;return y?(y=1/y,t[0]=c*y,t[1]=(-g*n+a*u)*y,t[2]=(f*n-a*s)*y,t[3]=l*y,t[4]=(g*r-a*o)*y,t[5]=(-f*r+a*i)*y,t[6]=h*y,t[7]=(-u*r+n*o)*y,t[8]=(s*r-n*i)*y,t):null}function gy(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8];return t[0]=s*g-f*u,t[1]=a*u-n*g,t[2]=n*f-a*s,t[3]=f*o-i*g,t[4]=r*g-a*o,t[5]=a*i-r*f,t[6]=i*u-s*o,t[7]=n*o-r*u,t[8]=r*s-n*i,t}function vy(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],f=t[6],o=t[7],u=t[8];return e*(u*i-s*o)+r*(-u*a+s*f)+n*(o*a-i*f)}function Ro(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=r[0],h=r[1],y=r[2],S=r[3],T=r[4],E=r[5],x=r[6],w=r[7],C=r[8];return t[0]=l*n+h*s+y*u,t[1]=l*a+h*f+y*g,t[2]=l*i+h*o+y*c,t[3]=S*n+T*s+E*u,t[4]=S*a+T*f+E*g,t[5]=S*i+T*o+E*c,t[6]=x*n+w*s+C*u,t[7]=x*a+w*f+C*g,t[8]=x*i+w*o+C*c,t}function ly(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=r[0],h=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=s,t[4]=f,t[5]=o,t[6]=l*n+h*s+u,t[7]=l*a+h*f+g,t[8]=l*i+h*o+c,t}function py(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=Math.sin(r),h=Math.cos(r);return t[0]=h*n+l*s,t[1]=h*a+l*f,t[2]=h*i+l*o,t[3]=h*s-l*n,t[4]=h*f-l*a,t[5]=h*o-l*i,t[6]=u,t[7]=g,t[8]=c,t}function hy(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function yy(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function dy(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ty(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Sy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Cy(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,f=n+n,o=a+a,u=r*s,g=n*s,c=n*f,l=a*s,h=a*f,y=a*o,S=i*s,T=i*f,E=i*o;return t[0]=1-c-y,t[3]=g-E,t[6]=l+T,t[1]=g+E,t[4]=1-u-y,t[7]=h-S,t[2]=l-T,t[5]=h+S,t[8]=1-u-c,t}function Ey(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=e[9],l=e[10],h=e[11],y=e[12],S=e[13],T=e[14],E=e[15],x=r*f-n*s,w=r*o-a*s,C=r*u-i*s,m=n*o-a*f,D=n*u-i*f,b=a*u-i*o,F=g*S-c*y,U=g*T-l*y,O=g*E-h*y,A=c*T-l*S,W=c*E-h*S,j=l*E-h*T,N=x*j-w*W+C*A+m*O-D*U+b*F;return N?(N=1/N,t[0]=(f*j-o*W+u*A)*N,t[1]=(o*O-s*j-u*U)*N,t[2]=(s*W-f*O+u*F)*N,t[3]=(a*W-n*j-i*A)*N,t[4]=(r*j-a*O+i*U)*N,t[5]=(n*O-r*W-i*F)*N,t[6]=(S*b-T*D+E*m)*N,t[7]=(T*C-y*b-E*w)*N,t[8]=(y*D-S*C+E*x)*N,t):null}function wy(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function xy(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Oy(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function My(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function ag(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Dy(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function my(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Ry(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Ly(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],f=t[5],o=t[6],u=t[7],g=t[8],c=e[0],l=e[1],h=e[2],y=e[3],S=e[4],T=e[5],E=e[6],x=e[7],w=e[8];return Math.abs(r-c)<=Oe*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=Oe*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-h)<=Oe*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-y)<=Oe*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-S)<=Oe*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(f-T)<=Oe*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(o-E)<=Oe*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(u-x)<=Oe*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(g-w)<=Oe*Math.max(1,Math.abs(g),Math.abs(w))}var Vy=Ro,_y=ag;const by=Object.freeze(Object.defineProperty({__proto__:null,create:rg,fromMat4:Do,clone:oy,copy:fy,fromValues:uy,set:cy,identity:Qr,transpose:ng,invert:mo,adjoint:gy,determinant:vy,multiply:Ro,translate:ly,rotate:py,scale:hy,fromTranslation:yy,fromRotation:dy,fromScaling:Ty,fromMat2d:Sy,fromQuat:Cy,normalFromMat4:Ey,projection:wy,str:xy,frob:Oy,add:My,subtract:ag,multiplyScalar:Dy,multiplyScalarAndAdd:my,exactEquals:Ry,equals:Ly,mul:Vy,sub:_y},Symbol.toStringTag,{value:"Module"}));function Lo(){var t=new at(16);return at!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function ky(t){var e=new at(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ut(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Fy(t,e,r,n,a,i,s,f,o,u,g,c,l,h,y,S){var T=new at(16);return T[0]=t,T[1]=e,T[2]=r,T[3]=n,T[4]=a,T[5]=i,T[6]=s,T[7]=f,T[8]=o,T[9]=u,T[10]=g,T[11]=c,T[12]=l,T[13]=h,T[14]=y,T[15]=S,T}function By(t,e,r,n,a,i,s,f,o,u,g,c,l,h,y,S,T){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=f,t[7]=o,t[8]=u,t[9]=g,t[10]=c,t[11]=l,t[12]=h,t[13]=y,t[14]=S,t[15]=T,t}function De(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ze(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],s=e[7],f=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=s,t[14]=f}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function xt(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=e[9],l=e[10],h=e[11],y=e[12],S=e[13],T=e[14],E=e[15],x=r*f-n*s,w=r*o-a*s,C=r*u-i*s,m=n*o-a*f,D=n*u-i*f,b=a*u-i*o,F=g*S-c*y,U=g*T-l*y,O=g*E-h*y,A=c*T-l*S,W=c*E-h*S,j=l*E-h*T,N=x*j-w*W+C*A+m*O-D*U+b*F;return N?(N=1/N,t[0]=(f*j-o*W+u*A)*N,t[1]=(a*W-n*j-i*A)*N,t[2]=(S*b-T*D+E*m)*N,t[3]=(l*D-c*b-h*m)*N,t[4]=(o*O-s*j-u*U)*N,t[5]=(r*j-a*O+i*U)*N,t[6]=(T*C-y*b-E*w)*N,t[7]=(g*b-l*C+h*w)*N,t[8]=(s*W-f*O+u*F)*N,t[9]=(n*O-r*W-i*F)*N,t[10]=(y*D-S*C+E*x)*N,t[11]=(c*C-g*D-h*x)*N,t[12]=(f*U-s*A-o*F)*N,t[13]=(r*A-n*U+a*F)*N,t[14]=(S*w-y*m-T*x)*N,t[15]=(g*m-c*w+l*x)*N,t):null}function Ny(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=e[9],l=e[10],h=e[11],y=e[12],S=e[13],T=e[14],E=e[15];return t[0]=f*(l*E-h*T)-c*(o*E-u*T)+S*(o*h-u*l),t[1]=-(n*(l*E-h*T)-c*(a*E-i*T)+S*(a*h-i*l)),t[2]=n*(o*E-u*T)-f*(a*E-i*T)+S*(a*u-i*o),t[3]=-(n*(o*h-u*l)-f*(a*h-i*l)+c*(a*u-i*o)),t[4]=-(s*(l*E-h*T)-g*(o*E-u*T)+y*(o*h-u*l)),t[5]=r*(l*E-h*T)-g*(a*E-i*T)+y*(a*h-i*l),t[6]=-(r*(o*E-u*T)-s*(a*E-i*T)+y*(a*u-i*o)),t[7]=r*(o*h-u*l)-s*(a*h-i*l)+g*(a*u-i*o),t[8]=s*(c*E-h*S)-g*(f*E-u*S)+y*(f*h-u*c),t[9]=-(r*(c*E-h*S)-g*(n*E-i*S)+y*(n*h-i*c)),t[10]=r*(f*E-u*S)-s*(n*E-i*S)+y*(n*u-i*f),t[11]=-(r*(f*h-u*c)-s*(n*h-i*c)+g*(n*u-i*f)),t[12]=-(s*(c*T-l*S)-g*(f*T-o*S)+y*(f*l-o*c)),t[13]=r*(c*T-l*S)-g*(n*T-a*S)+y*(n*l-a*c),t[14]=-(r*(f*T-o*S)-s*(n*T-a*S)+y*(n*o-a*f)),t[15]=r*(f*l-o*c)-s*(n*l-a*c)+g*(n*o-a*f),t}function Uy(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],f=t[6],o=t[7],u=t[8],g=t[9],c=t[10],l=t[11],h=t[12],y=t[13],S=t[14],T=t[15],E=e*s-r*i,x=e*f-n*i,w=e*o-a*i,C=r*f-n*s,m=r*o-a*s,D=n*o-a*f,b=u*y-g*h,F=u*S-c*h,U=u*T-l*h,O=g*S-c*y,A=g*T-l*y,W=c*T-l*S;return E*W-x*A+w*O+C*U-m*F+D*b}function St(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=e[9],h=e[10],y=e[11],S=e[12],T=e[13],E=e[14],x=e[15],w=r[0],C=r[1],m=r[2],D=r[3];return t[0]=w*n+C*f+m*c+D*S,t[1]=w*a+C*o+m*l+D*T,t[2]=w*i+C*u+m*h+D*E,t[3]=w*s+C*g+m*y+D*x,w=r[4],C=r[5],m=r[6],D=r[7],t[4]=w*n+C*f+m*c+D*S,t[5]=w*a+C*o+m*l+D*T,t[6]=w*i+C*u+m*h+D*E,t[7]=w*s+C*g+m*y+D*x,w=r[8],C=r[9],m=r[10],D=r[11],t[8]=w*n+C*f+m*c+D*S,t[9]=w*a+C*o+m*l+D*T,t[10]=w*i+C*u+m*h+D*E,t[11]=w*s+C*g+m*y+D*x,w=r[12],C=r[13],m=r[14],D=r[15],t[12]=w*n+C*f+m*c+D*S,t[13]=w*a+C*o+m*l+D*T,t[14]=w*i+C*u+m*h+D*E,t[15]=w*s+C*g+m*y+D*x,t}function et(t,e,r){var n=r[0],a=r[1],i=r[2],s,f,o,u,g,c,l,h,y,S,T,E;return e===t?(t[12]=e[0]*n+e[4]*a+e[8]*i+e[12],t[13]=e[1]*n+e[5]*a+e[9]*i+e[13],t[14]=e[2]*n+e[6]*a+e[10]*i+e[14],t[15]=e[3]*n+e[7]*a+e[11]*i+e[15]):(s=e[0],f=e[1],o=e[2],u=e[3],g=e[4],c=e[5],l=e[6],h=e[7],y=e[8],S=e[9],T=e[10],E=e[11],t[0]=s,t[1]=f,t[2]=o,t[3]=u,t[4]=g,t[5]=c,t[6]=l,t[7]=h,t[8]=y,t[9]=S,t[10]=T,t[11]=E,t[12]=s*n+g*a+y*i+e[12],t[13]=f*n+c*a+S*i+e[13],t[14]=o*n+l*a+T*i+e[14],t[15]=u*n+h*a+E*i+e[15]),t}function sa(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Xt(t,e,r,n){var a=n[0],i=n[1],s=n[2],f=Math.hypot(a,i,s),o,u,g,c,l,h,y,S,T,E,x,w,C,m,D,b,F,U,O,A,W,j,N,I;return f<Oe?null:(f=1/f,a*=f,i*=f,s*=f,o=Math.sin(r),u=Math.cos(r),g=1-u,c=e[0],l=e[1],h=e[2],y=e[3],S=e[4],T=e[5],E=e[6],x=e[7],w=e[8],C=e[9],m=e[10],D=e[11],b=a*a*g+u,F=i*a*g+s*o,U=s*a*g-i*o,O=a*i*g-s*o,A=i*i*g+u,W=s*i*g+a*o,j=a*s*g+i*o,N=i*s*g-a*o,I=s*s*g+u,t[0]=c*b+S*F+w*U,t[1]=l*b+T*F+C*U,t[2]=h*b+E*F+m*U,t[3]=y*b+x*F+D*U,t[4]=c*O+S*A+w*W,t[5]=l*O+T*A+C*W,t[6]=h*O+E*A+m*W,t[7]=y*O+x*A+D*W,t[8]=c*j+S*N+w*I,t[9]=l*j+T*N+C*I,t[10]=h*j+E*N+m*I,t[11]=y*j+x*N+D*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ig(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],s=e[5],f=e[6],o=e[7],u=e[8],g=e[9],c=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+u*n,t[5]=s*a+g*n,t[6]=f*a+c*n,t[7]=o*a+l*n,t[8]=u*a-i*n,t[9]=g*a-s*n,t[10]=c*a-f*n,t[11]=l*a-o*n,t}function sg(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],f=e[2],o=e[3],u=e[8],g=e[9],c=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-u*n,t[1]=s*a-g*n,t[2]=f*a-c*n,t[3]=o*a-l*n,t[8]=i*n+u*a,t[9]=s*n+g*a,t[10]=f*n+c*a,t[11]=o*n+l*a,t}function og(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],f=e[2],o=e[3],u=e[4],g=e[5],c=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+u*n,t[1]=s*a+g*n,t[2]=f*a+c*n,t[3]=o*a+l*n,t[4]=u*a-i*n,t[5]=g*a-s*n,t[6]=c*a-f*n,t[7]=l*a-o*n,t}function fg(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ug(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gy(t,e,r){var n=r[0],a=r[1],i=r[2],s=Math.hypot(n,a,i),f,o,u;return s<Oe?null:(s=1/s,n*=s,a*=s,i*=s,f=Math.sin(e),o=Math.cos(e),u=1-o,t[0]=n*n*u+o,t[1]=a*n*u+i*f,t[2]=i*n*u-a*f,t[3]=0,t[4]=n*a*u-i*f,t[5]=a*a*u+o,t[6]=i*a*u+n*f,t[7]=0,t[8]=n*i*u+a*f,t[9]=a*i*u-n*f,t[10]=i*i*u+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Ay(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Py(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zy(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cg(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=n+n,o=a+a,u=i+i,g=n*f,c=n*o,l=n*u,h=a*o,y=a*u,S=i*u,T=s*f,E=s*o,x=s*u;return t[0]=1-(h+S),t[1]=c+x,t[2]=l-E,t[3]=0,t[4]=c-x,t[5]=1-(g+S),t[6]=y+T,t[7]=0,t[8]=l+E,t[9]=y-T,t[10]=1-(g+h),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Wy(t,e){var r=new at(3),n=-e[0],a=-e[1],i=-e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=n*n+a*a+i*i+s*s;return c>0?(r[0]=(f*s+g*n+o*i-u*a)*2/c,r[1]=(o*s+g*a+u*n-f*i)*2/c,r[2]=(u*s+g*i+f*a-o*n)*2/c):(r[0]=(f*s+g*n+o*i-u*a)*2,r[1]=(o*s+g*a+u*n-f*i)*2,r[2]=(u*s+g*i+f*a-o*n)*2),cg(t,e,r),t}function jy(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function gg(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],s=e[5],f=e[6],o=e[8],u=e[9],g=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(i,s,f),t[2]=Math.hypot(o,u,g),t}function vg(t,e){var r=new at(3);gg(r,e);var n=1/r[0],a=1/r[1],i=1/r[2],s=e[0]*n,f=e[1]*a,o=e[2]*i,u=e[4]*n,g=e[5]*a,c=e[6]*i,l=e[8]*n,h=e[9]*a,y=e[10]*i,S=s+g+y,T=0;return S>0?(T=Math.sqrt(S+1)*2,t[3]=.25*T,t[0]=(c-h)/T,t[1]=(l-o)/T,t[2]=(f-u)/T):s>g&&s>y?(T=Math.sqrt(1+s-g-y)*2,t[3]=(c-h)/T,t[0]=.25*T,t[1]=(f+u)/T,t[2]=(l+o)/T):g>y?(T=Math.sqrt(1+g-s-y)*2,t[3]=(l-o)/T,t[0]=(f+u)/T,t[1]=.25*T,t[2]=(c+h)/T):(T=Math.sqrt(1+y-s-g)*2,t[3]=(f-u)/T,t[0]=(l+o)/T,t[1]=(c+h)/T,t[2]=.25*T),t}function lg(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=e[3],o=a+a,u=i+i,g=s+s,c=a*o,l=a*u,h=a*g,y=i*u,S=i*g,T=s*g,E=f*o,x=f*u,w=f*g,C=n[0],m=n[1],D=n[2];return t[0]=(1-(y+T))*C,t[1]=(l+w)*C,t[2]=(h-x)*C,t[3]=0,t[4]=(l-w)*m,t[5]=(1-(c+T))*m,t[6]=(S+E)*m,t[7]=0,t[8]=(h+x)*D,t[9]=(S-E)*D,t[10]=(1-(c+y))*D,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function $y(t,e,r,n,a){var i=e[0],s=e[1],f=e[2],o=e[3],u=i+i,g=s+s,c=f+f,l=i*u,h=i*g,y=i*c,S=s*g,T=s*c,E=f*c,x=o*u,w=o*g,C=o*c,m=n[0],D=n[1],b=n[2],F=a[0],U=a[1],O=a[2],A=(1-(S+E))*m,W=(h+C)*m,j=(y-w)*m,N=(h-C)*D,I=(1-(l+E))*D,X=(T+x)*D,J=(y+w)*b,P=(T-x)*b,G=(1-(l+S))*b;return t[0]=A,t[1]=W,t[2]=j,t[3]=0,t[4]=N,t[5]=I,t[6]=X,t[7]=0,t[8]=J,t[9]=P,t[10]=G,t[11]=0,t[12]=r[0]+F-(A*F+N*U+J*O),t[13]=r[1]+U-(W*F+I*U+P*O),t[14]=r[2]+O-(j*F+X*U+G*O),t[15]=1,t}function Vo(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,f=n+n,o=a+a,u=r*s,g=n*s,c=n*f,l=a*s,h=a*f,y=a*o,S=i*s,T=i*f,E=i*o;return t[0]=1-c-y,t[1]=g+E,t[2]=l-T,t[3]=0,t[4]=g-E,t[5]=1-u-y,t[6]=h+S,t[7]=0,t[8]=l+T,t[9]=h-S,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hy(t,e,r,n,a,i,s){var f=1/(r-e),o=1/(a-n),u=1/(i-s);return t[0]=i*2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*o,t[6]=0,t[7]=0,t[8]=(r+e)*f,t[9]=(a+n)*o,t[10]=(s+i)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i*2*u,t[15]=0,t}function pg(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=(a+n)*s,t[14]=2*a*n*s):(t[10]=-1,t[14]=-2*n),t}var Ky=pg;function Xy(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=a*s,t[14]=a*n*s):(t[10]=-1,t[14]=-n),t}function Yy(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),f=Math.tan(e.rightDegrees*Math.PI/180),o=2/(s+f),u=2/(a+i);return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((s-f)*o*.5),t[9]=(a-i)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function hg(t,e,r,n,a,i,s){var f=1/(e-r),o=1/(n-a),u=1/(i-s);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*f,t[13]=(a+n)*o,t[14]=(s+i)*u,t[15]=1,t}var yg=hg;function Iy(t,e,r,n,a,i,s){var f=1/(e-r),o=1/(n-a),u=1/(i-s);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*f,t[13]=(a+n)*o,t[14]=i*u,t[15]=1,t}function dg(t,e,r,n){var a,i,s,f,o,u,g,c,l,h,y=e[0],S=e[1],T=e[2],E=n[0],x=n[1],w=n[2],C=r[0],m=r[1],D=r[2];return Math.abs(y-C)<Oe&&Math.abs(S-m)<Oe&&Math.abs(T-D)<Oe?De(t):(g=y-C,c=S-m,l=T-D,h=1/Math.hypot(g,c,l),g*=h,c*=h,l*=h,a=x*l-w*c,i=w*g-E*l,s=E*c-x*g,h=Math.hypot(a,i,s),h?(h=1/h,a*=h,i*=h,s*=h):(a=0,i=0,s=0),f=c*s-l*i,o=l*a-g*s,u=g*i-c*a,h=Math.hypot(f,o,u),h?(h=1/h,f*=h,o*=h,u*=h):(f=0,o=0,u=0),t[0]=a,t[1]=f,t[2]=g,t[3]=0,t[4]=i,t[5]=o,t[6]=c,t[7]=0,t[8]=s,t[9]=u,t[10]=l,t[11]=0,t[12]=-(a*y+i*S+s*T),t[13]=-(f*y+o*S+u*T),t[14]=-(g*y+c*S+l*T),t[15]=1,t)}function qy(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=n[0],o=n[1],u=n[2],g=a-r[0],c=i-r[1],l=s-r[2],h=g*g+c*c+l*l;h>0&&(h=1/Math.sqrt(h),g*=h,c*=h,l*=h);var y=o*l-u*c,S=u*g-f*l,T=f*c-o*g;return h=y*y+S*S+T*T,h>0&&(h=1/Math.sqrt(h),y*=h,S*=h,T*=h),t[0]=y,t[1]=S,t[2]=T,t[3]=0,t[4]=c*T-l*S,t[5]=l*y-g*T,t[6]=g*S-c*y,t[7]=0,t[8]=g,t[9]=c,t[10]=l,t[11]=0,t[12]=a,t[13]=i,t[14]=s,t[15]=1,t}function Zy(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Qy(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Jy(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Tg(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function ed(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function td(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function rd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function nd(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],f=t[5],o=t[6],u=t[7],g=t[8],c=t[9],l=t[10],h=t[11],y=t[12],S=t[13],T=t[14],E=t[15],x=e[0],w=e[1],C=e[2],m=e[3],D=e[4],b=e[5],F=e[6],U=e[7],O=e[8],A=e[9],W=e[10],j=e[11],N=e[12],I=e[13],X=e[14],J=e[15];return Math.abs(r-x)<=Oe*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(n-w)<=Oe*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(a-C)<=Oe*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(i-m)<=Oe*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-D)<=Oe*Math.max(1,Math.abs(s),Math.abs(D))&&Math.abs(f-b)<=Oe*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(o-F)<=Oe*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(u-U)<=Oe*Math.max(1,Math.abs(u),Math.abs(U))&&Math.abs(g-O)<=Oe*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(c-A)<=Oe*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(l-W)<=Oe*Math.max(1,Math.abs(l),Math.abs(W))&&Math.abs(h-j)<=Oe*Math.max(1,Math.abs(h),Math.abs(j))&&Math.abs(y-N)<=Oe*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(S-I)<=Oe*Math.max(1,Math.abs(S),Math.abs(I))&&Math.abs(T-X)<=Oe*Math.max(1,Math.abs(T),Math.abs(X))&&Math.abs(E-J)<=Oe*Math.max(1,Math.abs(E),Math.abs(J))}var Xs=St,ad=Tg;const Ys=Object.freeze(Object.defineProperty({__proto__:null,create:Lo,clone:ky,copy:ut,fromValues:Fy,set:By,identity:De,transpose:ze,invert:xt,adjoint:Ny,determinant:Uy,multiply:St,translate:et,scale:sa,rotate:Xt,rotateX:ig,rotateY:sg,rotateZ:og,fromTranslation:fg,fromScaling:ug,fromRotation:Gy,fromXRotation:Ay,fromYRotation:Py,fromZRotation:zy,fromRotationTranslation:cg,fromQuat2:Wy,getTranslation:jy,getScaling:gg,getRotation:vg,fromRotationTranslationScale:lg,fromRotationTranslationScaleOrigin:$y,fromQuat:Vo,frustum:Hy,perspectiveNO:pg,perspective:Ky,perspectiveZO:Xy,perspectiveFromFieldOfView:Yy,orthoNO:hg,ortho:yg,orthoZO:Iy,lookAt:dg,targetTo:qy,str:Zy,frob:Qy,add:Jy,subtract:Tg,multiplyScalar:ed,multiplyScalarAndAdd:td,exactEquals:rd,equals:nd,mul:Xs,sub:ad},Symbol.toStringTag,{value:"Module"}));function Sg(){var t=new at(3);return at!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function id(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function zf(t,e,r){var n=new at(3);return n[0]=t,n[1]=e,n[2]=r,n}function yi(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Kn(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Er(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function hr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function sd(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function oa(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Cg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ps(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[0],f=r[1],o=r[2];return t[0]=a*o-i*f,t[1]=i*s-n*o,t[2]=n*f-a*s,t}function me(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[3]*n+r[7]*a+r[11]*i+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/s,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/s,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/s,t}function Wf(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function jf(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],s=e[1],f=e[2];return Math.abs(r-i)<=Oe*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=Oe*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-f)<=Oe*Math.max(1,Math.abs(a),Math.abs(f))}var Is=Er,Eg=id;(function(){var t=Sg();return function(e,r,n,a,i,s){var f,o;for(r||(r=3),n||(n=0),a?o=Math.min(a*r+n,e.length):o=e.length,f=n;f<o;f+=r)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],i(t,t,s),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2];return e}})();function od(){var t=new at(4);return at!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function fd(t,e,r,n){var a=new at(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function ud(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r*r+n*n+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=i*s,t}function yn(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*s,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*s,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*s,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*s,t}(function(){var t=od();return function(e,r,n,a,i,s){var f,o;for(r||(r=4),n||(n=0),a?o=Math.min(a*r+n,e.length):o=e.length,f=n;f<o;f+=r)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],t[3]=e[f+3],i(t,t,s),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2],e[f+3]=t[3];return e}})();function Ir(){var t=new at(4);return at!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function _o(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function cd(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>Oe?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function $f(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=r[0],o=r[1],u=r[2],g=r[3];return t[0]=n*g+s*f+a*u-i*o,t[1]=a*g+s*o+i*f-n*u,t[2]=i*g+s*u+n*o-a*f,t[3]=s*g-n*f-a*o-i*u,t}function hs(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=e[3],o=r[0],u=r[1],g=r[2],c=r[3],l,h,y,S,T;return h=a*o+i*u+s*g+f*c,h<0&&(h=-h,o=-o,u=-u,g=-g,c=-c),1-h>Oe?(l=Math.acos(h),y=Math.sin(l),S=Math.sin((1-n)*l)/y,T=Math.sin(n*l)/y):(S=1-n,T=n),t[0]=S*a+T*o,t[1]=S*i+T*u,t[2]=S*s+T*g,t[3]=S*f+T*c,t}function gd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function vd(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var i=(a+1)%3,s=(a+2)%3;n=Math.sqrt(e[a*3+a]-e[i*3+i]-e[s*3+s]+1),t[a]=.5*n,n=.5/n,t[3]=(e[i*3+s]-e[s*3+i])*n,t[i]=(e[i*3+a]+e[a*3+i])*n,t[s]=(e[s*3+a]+e[a*3+s])*n}return t}var Hf=fd,wg=ud;(function(){var t=Sg(),e=zf(1,0,0),r=zf(0,1,0);return function(n,a,i){var s=Cg(a,i);return s<-.999999?(ps(t,e,a),Eg(t)<1e-6&&ps(t,r,a),oa(t,t),_o(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ps(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,wg(n,n))}})();(function(){var t=Ir(),e=Ir();return function(r,n,a,i,s,f){return hs(t,n,s,f),hs(e,a,i,f),hs(r,t,e,2*f*(1-f)),r}})();(function(){var t=rg();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],wg(e,vd(e,t))}})();function ld(t){if(Array.isArray(t))return t}function pd(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,f;try{for(r=r.call(t);!(a=(s=r.next()).done)&&(n.push(s.value),!(e&&n.length===e));a=!0);}catch(o){i=!0,f=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw f}}return n}}function qs(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xg(t,e){if(!!t){if(typeof t=="string")return qs(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qs(t,e)}}function hd(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ct(t,e){return ld(t)||pd(t,e)||xg(t,e)||hd()}function qr(t){return qr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qr(t)}function de(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yd(t){if(Array.isArray(t))return qs(t)}function dd(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Td(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ce(t){return yd(t)||dd(t)||xg(t)||Td()}function fa(t,e){return fa=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},fa(t,e)}function Sd(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jn(t,e,r){return Sd()?Jn=Reflect.construct:Jn=function(a,i,s){var f=[null];f.push.apply(f,i);var o=Function.bind.apply(a,f),u=new o;return s&&fa(u,s.prototype),u},Jn.apply(null,arguments)}var Vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cd(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ed(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}),r}var Kf=Object.prototype.toString,Og=function(e){var r=Kf.call(e),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Kf.call(e.callee)==="[object Function]"),n},ys,Xf;function wd(){if(Xf)return ys;Xf=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=Og,a=Object.prototype.propertyIsEnumerable,i=!a.call({toString:null},"toString"),s=a.call(function(){},"prototype"),f=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=function(l){var h=l.constructor;return h&&h.prototype===l},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if(typeof window>"u")return!1;for(var l in window)try{if(!u["$"+l]&&e.call(window,l)&&window[l]!==null&&typeof window[l]=="object")try{o(window[l])}catch{return!0}}catch{return!0}return!1}(),c=function(l){if(typeof window>"u"||!g)return o(l);try{return o(l)}catch{return!1}};t=function(h){var y=h!==null&&typeof h=="object",S=r.call(h)==="[object Function]",T=n(h),E=y&&r.call(h)==="[object String]",x=[];if(!y&&!S&&!T)throw new TypeError("Object.keys called on a non-object");var w=s&&S;if(E&&h.length>0&&!e.call(h,0))for(var C=0;C<h.length;++C)x.push(String(C));if(T&&h.length>0)for(var m=0;m<h.length;++m)x.push(String(m));else for(var D in h)!(w&&D==="prototype")&&e.call(h,D)&&x.push(String(D));if(i)for(var b=c(h),F=0;F<f.length;++F)!(b&&f[F]==="constructor")&&e.call(h,f[F])&&x.push(f[F]);return x}}return ys=t,ys}var xd=Array.prototype.slice,Od=Og,Yf=Object.keys,fi=Yf?function(e){return Yf(e)}:wd(),If=Object.keys;fi.shim=function(){if(Object.keys){var e=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);e||(Object.keys=function(n){return Od(n)?If(xd.call(n)):If(n)})}else Object.keys=fi;return Object.keys||fi};var Md=fi,Dd=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[r]=a;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==a||s.enumerable!==!0)return!1}return!0},qf=typeof Symbol<"u"&&Symbol,md=Dd,Rd=function(){return typeof qf!="function"||typeof Symbol!="function"||typeof qf("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:md()},Ld="Function.prototype.bind called on incompatible ",ds=Array.prototype.slice,Vd=Object.prototype.toString,_d="[object Function]",bd=function(e){var r=this;if(typeof r!="function"||Vd.call(r)!==_d)throw new TypeError(Ld+r);for(var n=ds.call(arguments,1),a,i=function(){if(this instanceof a){var g=r.apply(this,n.concat(ds.call(arguments)));return Object(g)===g?g:this}else return r.apply(e,n.concat(ds.call(arguments)))},s=Math.max(0,r.length-n.length),f=[],o=0;o<s;o++)f.push("$"+o);if(a=Function("binder","return function ("+f.join(",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var u=function(){};u.prototype=r.prototype,a.prototype=new u,u.prototype=null}return a},kd=bd,Mg=Function.prototype.bind||kd,Fd=Mg,Bd=Fd.call(Function.call,Object.prototype.hasOwnProperty),Me,xn=SyntaxError,Dg=Function,Sn=TypeError,Ts=function(t){try{return Dg('"use strict"; return ('+t+").constructor;")()}catch{}},Xr=Object.getOwnPropertyDescriptor;if(Xr)try{Xr({},"")}catch{Xr=null}var Ss=function(){throw new Sn},Nd=Xr?function(){try{return arguments.callee,Ss}catch{try{return Xr(arguments,"callee").get}catch{return Ss}}}():Ss,sn=Rd(),Tr=Object.getPrototypeOf||function(t){return t.__proto__},pn={},Ud=typeof Uint8Array>"u"?Me:Tr(Uint8Array),Cn={"%AggregateError%":typeof AggregateError>"u"?Me:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Me:ArrayBuffer,"%ArrayIteratorPrototype%":sn?Tr([][Symbol.iterator]()):Me,"%AsyncFromSyncIteratorPrototype%":Me,"%AsyncFunction%":pn,"%AsyncGenerator%":pn,"%AsyncGeneratorFunction%":pn,"%AsyncIteratorPrototype%":pn,"%Atomics%":typeof Atomics>"u"?Me:Atomics,"%BigInt%":typeof BigInt>"u"?Me:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Me:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Me:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Me:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Me:FinalizationRegistry,"%Function%":Dg,"%GeneratorFunction%":pn,"%Int8Array%":typeof Int8Array>"u"?Me:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Me:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Me:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":sn?Tr(Tr([][Symbol.iterator]())):Me,"%JSON%":typeof JSON=="object"?JSON:Me,"%Map%":typeof Map>"u"?Me:Map,"%MapIteratorPrototype%":typeof Map>"u"||!sn?Me:Tr(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Me:Promise,"%Proxy%":typeof Proxy>"u"?Me:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Me:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Me:Set,"%SetIteratorPrototype%":typeof Set>"u"||!sn?Me:Tr(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Me:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":sn?Tr(""[Symbol.iterator]()):Me,"%Symbol%":sn?Symbol:Me,"%SyntaxError%":xn,"%ThrowTypeError%":Nd,"%TypedArray%":Ud,"%TypeError%":Sn,"%Uint8Array%":typeof Uint8Array>"u"?Me:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Me:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Me:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Me:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Me:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Me:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Me:WeakSet},Gd=function t(e){var r;if(e==="%AsyncFunction%")r=Ts("async function () {}");else if(e==="%GeneratorFunction%")r=Ts("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Ts("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=t("%AsyncGenerator%");a&&(r=Tr(a.prototype))}return Cn[e]=r,r},Zf={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ha=Mg,di=Bd,Ad=ha.call(Function.call,Array.prototype.concat),Pd=ha.call(Function.apply,Array.prototype.splice),Qf=ha.call(Function.call,String.prototype.replace),Ti=ha.call(Function.call,String.prototype.slice),zd=ha.call(Function.call,RegExp.prototype.exec),Wd=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,jd=/\\(\\)?/g,$d=function(e){var r=Ti(e,0,1),n=Ti(e,-1);if(r==="%"&&n!=="%")throw new xn("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new xn("invalid intrinsic syntax, expected opening `%`");var a=[];return Qf(e,Wd,function(i,s,f,o){a[a.length]=f?Qf(o,jd,"$1"):s||i}),a},Hd=function(e,r){var n=e,a;if(di(Zf,n)&&(a=Zf[n],n="%"+a[0]+"%"),di(Cn,n)){var i=Cn[n];if(i===pn&&(i=Gd(n)),typeof i>"u"&&!r)throw new Sn("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:i}}throw new xn("intrinsic "+e+" does not exist!")},Kd=function(e,r){if(typeof e!="string"||e.length===0)throw new Sn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Sn('"allowMissing" argument must be a boolean');if(zd(/^%?[^%]*%?$/,e)===null)throw new xn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=$d(e),a=n.length>0?n[0]:"",i=Hd("%"+a+"%",r),s=i.name,f=i.value,o=!1,u=i.alias;u&&(a=u[0],Pd(n,Ad([0,1],u)));for(var g=1,c=!0;g<n.length;g+=1){var l=n[g],h=Ti(l,0,1),y=Ti(l,-1);if((h==='"'||h==="'"||h==="`"||y==='"'||y==="'"||y==="`")&&h!==y)throw new xn("property names with quotes must have matching quotes");if((l==="constructor"||!c)&&(o=!0),a+="."+l,s="%"+a+"%",di(Cn,s))f=Cn[s];else if(f!=null){if(!(l in f)){if(!r)throw new Sn("base intrinsic for "+e+" exists, but the property is not available.");return}if(Xr&&g+1>=n.length){var S=Xr(f,l);c=!!S,c&&"get"in S&&!("originalValue"in S.get)?f=S.get:f=f[l]}else c=di(f,l),f=f[l];c&&!o&&(Cn[s]=f)}}return f},Xd=Kd,Zs=Xd("%Object.defineProperty%",!0),Qs=function(){if(Zs)try{return Zs({},"a",{value:1}),!0}catch{return!1}return!1};Qs.hasArrayLengthDefineBug=function(){if(!Qs())return null;try{return Zs([],"length",{value:1}).length!==1}catch{return!0}};var Yd=Qs,Id=Md,qd=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Zd=Object.prototype.toString,Qd=Array.prototype.concat,mg=Object.defineProperty,Jd=function(t){return typeof t=="function"&&Zd.call(t)==="[object Function]"},e1=Yd(),Rg=mg&&e1,t1=function(t,e,r,n){e in t&&(!Jd(n)||!n())||(Rg?mg(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},Lg=function(t,e){var r=arguments.length>2?arguments[2]:{},n=Id(e);qd&&(n=Qd.call(n,Object.getOwnPropertySymbols(e)));for(var a=0;a<n.length;a+=1)t1(t,n[a],e[n[a]],r[n[a]])};Lg.supportsDescriptors=!!Rg;var Vg=Lg,ea={exports:{}};typeof self<"u"?ea.exports=self:typeof window<"u"?ea.exports=window:ea.exports=Function("return this")();var r1=ea.exports,_g=function(){return typeof Vt!="object"||!Vt||Vt.Math!==Math||Vt.Array!==Array?r1:Vt},n1=Vg,a1=_g,i1=function(){var e=a1();if(n1.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(e,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==e))&&Object.defineProperty(e,"globalThis",{configurable:!0,enumerable:!1,value:e,writable:!0})}else(typeof globalThis!="object"||globalThis!==e)&&(e.globalThis=e);return e},s1=Vg,o1=ea.exports,bg=_g,f1=i1,u1=bg(),kg=function(){return u1};s1(kg,{getPolyfill:bg,implementation:o1,shim:f1});var c1=kg;function Jf(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function g1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jf(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jf(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var At=c1(),Fg={vtkObject:function(){return null}};function Wt(t){if(t==null||t.isA)return t;if(!t.vtkClass)return At.console&&At.console.error&&At.console.error("Invalid VTK object"),null;var e=Fg[t.vtkClass];if(!e)return At.console&&At.console.error&&At.console.error("No vtk class found for Object of type ".concat(t.vtkClass)),null;var r=g1({},t);Object.keys(r).forEach(function(a){r[a]&&qr(r[a])==="object"&&r[a].vtkClass&&(r[a]=Wt(r[a]))});var n=e(r);return n&&n.modified&&n.modified(),n}function v1(t,e){Fg[t]=e}Wt.register=v1;function bo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ko(t,e,r){return e&&eu(t.prototype,e),r&&eu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zr(t){return Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Zr(t)}function l1(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Zr(t),t!==null););return t}function ui(){return typeof Reflect<"u"&&Reflect.get?ui=Reflect.get:ui=function(e,r,n){var a=l1(e,r);if(!!a){var i=Object.getOwnPropertyDescriptor(a,r);return i.get?i.get.call(arguments.length<3?e:n):i.value}},ui.apply(this,arguments)}function p1(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fa(t,e)}function h1(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y1(t,e){if(e&&(qr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h1(t)}function d1(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Js(t){var e=typeof Map=="function"?new Map:void 0;return Js=function(n){if(n===null||!d1(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,a)}function a(){return Jn(n,arguments,Zr(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),fa(a,n)},Js(t)}function T1(t){var e=S1();return function(){var n=Zr(t),a;if(e){var i=Zr(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return y1(this,a)}}function S1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Cs=function(t){p1(r,t);var e=T1(r);function r(){return bo(this,r),e.apply(this,arguments)}return ko(r,[{key:"push",value:function(){for(var a=this,i,s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];var u=f.filter(function(g){return!a.includes(g)});return(i=ui(Zr(r.prototype),"push",this)).call.apply(i,[this].concat(Ce(u)))}}]),r}(Js(Array));function tu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function eo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var to=0,C1=Symbol("void");function E1(){return to}var Bg={};function jr(){}var w1=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];w1.forEach(function(t){Bg[t]=jr});At.console=console.hasOwnProperty("log")?console:Bg;var Ot={debug:jr,error:At.console.error||jr,info:At.console.info||jr,log:At.console.log||jr,warn:At.console.warn||jr};function x1(t,e){Ot[t]&&(Ot[t]=e||jr)}function O1(){Ot.log.apply(Ot,arguments)}function M1(){Ot.info.apply(Ot,arguments)}function Or(){Ot.debug.apply(Ot,arguments)}function ge(){Ot.error.apply(Ot,arguments)}function Fi(){Ot.warn.apply(Ot,arguments)}var ru={};function D1(t){ru[t]||(Ot.error(t),ru[t]=!0)}var bt=Object.create(null);bt.Float32Array=Float32Array;bt.Float64Array=Float64Array;bt.Uint8Array=Uint8Array;bt.Int8Array=Int8Array;bt.Uint16Array=Uint16Array;bt.Int16Array=Int16Array;bt.Uint32Array=Uint32Array;bt.Int32Array=Int32Array;bt.Uint8ClampedArray=Uint8ClampedArray;function ya(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Jn(bt[t]||Float64Array,r)}function Ng(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(e=bt[t]||Float64Array).from.apply(e,n)}function Fo(t){return t.charAt(0).toUpperCase()+t.slice(1)}function ct(t){return Fo(t[0]==="_"?t.slice(1):t)}function m1(t){return t.charAt(0).toLowerCase()+t.slice(1)}function R1(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,n=["TB","GB","MB","KB"],a=Number(t),i="B";a>r;)a/=r,i=n.pop();return"".concat(a.toFixed(e)," ").concat(i)}function L1(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ",r=[],n=t;n>1e3;)r.push("000".concat(n%1e3).slice(-3)),n=Math.floor(n/1e3);return n>0&&r.push(n),r.reverse(),r.join(e)}function Ug(t){Object.keys(t).forEach(function(e){Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function V1(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}function _1(t,e){return Object.keys(t).find(function(r){return t[r]===e})}function Gg(t){return t&&t.isA?t.getState():t}function Ag(t){setTimeout(t,0)}function b1(t,e){var r=performance.now();t.finally(function(){var n=performance.now()-r;e(n)})}function yt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ug(e);var r=[];Number.isInteger(e.mtime)||(e.mtime=++to),"classHierarchy"in e?e.classHierarchy instanceof Cs||(e.classHierarchy=Cs.from(e.classHierarchy)):e.classHierarchy=new Cs("vtkObject");function n(i){r[i]=null}function a(i){function s(){n(i)}return Object.freeze({unsubscribe:s})}return t.isDeleted=function(){return!!e.deleted},t.modified=function(i){if(e.deleted){ge("instance deleted - cannot call any method");return}i&&i<t.getMTime()||(e.mtime=++to,r.forEach(function(s){return s&&s(t)}))},t.onModified=function(i){if(e.deleted)return ge("instance deleted - cannot call any method"),null;var s=r.length;return r.push(i),a(s)},t.getMTime=function(){return e.mtime},t.isA=function(i){for(var s=e.classHierarchy.length;s--;)if(e.classHierarchy[s]===i)return!0;return!1},t.getClassName=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-i]},t.set=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1;return Object.keys(i).forEach(function(u){var g=f?null:t["set".concat(Fo(u))];g&&Array.isArray(i[u])&&g.length>1?o=g.apply(void 0,Ce(i[u]))||o:g?o=g(i[u])||o:(["mtime"].indexOf(u)===-1&&!s&&Fi("Warning: Set value to model directly ".concat(u,", ").concat(i[u])),o=e[u]!==i[u]||o,e[u]=i[u])}),o},t.get=function(){for(var i=arguments.length,s=new Array(i),f=0;f<i;f++)s[f]=arguments[f];if(!s.length)return e;var o={};return s.forEach(function(u){o[u]=e[u]}),o},t.getReferenceByName=function(i){return e[i]},t.delete=function(){Object.keys(e).forEach(function(i){return delete e[i]}),r.forEach(function(i,s){return n(s)}),e.deleted=!0},t.getState=function(){if(e.deleted)return null;var i=eo(eo({},e),{},{vtkClass:t.getClassName()});Object.keys(i).forEach(function(f){i[f]===null||i[f]===void 0||f[0]==="_"?delete i[f]:i[f].isA?i[f]=i[f].getState():Array.isArray(i[f])&&(i[f]=i[f].map(Gg))});var s={};return Object.keys(i).sort().forEach(function(f){s[f]=i[f]}),s.mtime&&delete s.mtime,s},t.shallowCopy=function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i.getClassName()!==t.getClassName())throw new Error("Cannot ShallowCopy ".concat(i.getClassName()," into ").concat(t.getClassName()));var f=i.get(),o=Object.keys(e).sort(),u=Object.keys(f).sort();u.forEach(function(g){var c=o.indexOf(g);c===-1?s&&Or("add ".concat(g," in shallowCopy")):o.splice(c,1),e[g]=f[g]}),o.length&&s&&Or("Untouched keys: ".concat(o.join(", "))),t.modified()},t.toJSON=function(){return t.getState()},t}function kt(t,e,r){r.forEach(function(n){qr(n)==="object"?t["get".concat(ct(n.name))]=function(){return e[n.name]}:t["get".concat(ct(n))]=function(){return e[n]}})}var k1={enum:function(e,r,n){return function(a){if(typeof a=="string"){if(n.enum[a]!==void 0)return r[n.name]!==n.enum[a]?(r[n.name]=n.enum[a],e.modified(),!0):!1;throw ge("Set Enum with invalid argument ".concat(n,", ").concat(a)),new RangeError("Set Enum with invalid string argument")}if(typeof a=="number"){if(r[n.name]!==a){if(Object.keys(n.enum).map(function(i){return n.enum[i]}).indexOf(a)!==-1)return r[n.name]=a,e.modified(),!0;throw ge("Set Enum outside numeric range ".concat(n,", ").concat(a)),new RangeError("Set Enum outside numeric range")}return!1}throw ge("Set Enum with invalid argument (String/Number) ".concat(n,", ").concat(a)),new TypeError("Set Enum with invalid argument (String/Number)")}}};function nu(t){if(qr(t)==="object"){var e=k1[t.type];if(e)return function(r,n){return e(r,n,t)};throw ge("No setter for field ".concat(t)),new TypeError("No setter for field")}return function(n,a){return function(s){return a.deleted?(ge("instance deleted - cannot call any method"),!1):a[t]!==s?(a[t]=s,n.modified(),!0):!1}}}function Bi(t,e,r){r.forEach(function(n){qr(n)==="object"?t["set".concat(ct(n.name))]=nu(n)(t,e):t["set".concat(ct(n))]=nu(n)(t,e)})}function gt(t,e,r){kt(t,e,r),Bi(t,e,r)}function da(t,e,r){r.forEach(function(n){t["get".concat(ct(n))]=function(){return e[n]?[].concat(e[n]):e[n]},t["get".concat(ct(n),"ByReference")]=function(){return e[n]}})}function Pg(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;r.forEach(function(i){if(e[i]&&n&&e[i].length!==n)throw new RangeError("Invalid initial number of values for array (".concat(i,")"));t["set".concat(ct(i))]=function(){if(e.deleted)return ge("instance deleted - cannot call any method"),!1;for(var s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];var u=f,g,c=!1;if(u.length===1&&(u[0]==null||u[0].length>=0)&&(u=u[0],c=!0),u==null)g=e[i]!==u;else{if(n&&u.length!==n)if(u.length<n&&a!==void 0)for(u=Array.from(u),c=!1;u.length<n;)u.push(a);else throw new RangeError("Invalid number of values for array setter (".concat(i,")"));g=e[i]==null||e[i].some(function(l,h){return l!==u[h]})||e[i].length!==u.length,g&&c&&(u=Array.from(u))}return g&&(e[i]=u,t.modified()),g},t["set".concat(ct(i),"From")]=function(s){var f=e[i];s.forEach(function(o,u){f[u]=o})}})}function zg(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;da(t,e,r),Pg(t,e,r,n,a)}function Bo(t,e,r){for(var n=0;n<r.length;n++){var a=r[n];e[a]!==void 0&&(e["_".concat(a)]=e[a],delete e[a])}}function F1(t,e,r,n){e.inputData?e.inputData=e.inputData.map(Wt):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(Wt):e.inputConnection=[],e.output?e.output=e.output.map(Wt):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(Wt):e.inputArrayToProcess=[],e.numberOfInputs=r;function a(y){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ge("instance deleted - cannot call any method");return}if(S>=e.numberOfInputs){ge("algorithm ".concat(t.getClassName()," only has ").concat(e.numberOfInputs," input ports. To add more input ports, use addInputData()"));return}(e.inputData[S]!==y||e.inputConnection[S])&&(e.inputData[S]=y,e.inputConnection[S]=null,t.modified&&t.modified())}function i(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[y]&&(e.inputData[y]=e.inputConnection[y]()),e.inputData[y]}function s(y){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ge("instance deleted - cannot call any method");return}if(S>=e.numberOfInputs){var T="algorithm ".concat(t.getClassName()," only has ");T+="".concat(e.numberOfInputs),T+=" input ports. To add more input ports, use addInputConnection()",ge(T);return}e.inputData[S]=null,e.inputConnection[S]=y}function f(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[y]}function o(){for(var y=e.numberOfInputs;y&&!e.inputData[y-1]&&!e.inputConnection[y-1];)y--;return y===e.numberOfInputs&&e.numberOfInputs++,y}function u(y){if(e.deleted){ge("instance deleted - cannot call any method");return}s(y,o())}function g(y){if(e.deleted){ge("instance deleted - cannot call any method");return}a(y,o())}function c(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(ge("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[y])}t.shouldUpdate=function(){for(var y=t.getMTime(),S=1/0,T=n;T--;){if(!e.output[T]||e.output[T].isDeleted())return!0;var E=e.output[T].getMTime();if(E<y)return!0;E<S&&(S=E)}for(T=e.numberOfInputs;T--;){var x,w;if((x=e.inputConnection[T])!==null&&x!==void 0&&x.filter.shouldUpdate()||((w=t.getInputData(T))===null||w===void 0?void 0:w.getMTime())>S)return!0}return!1};function l(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=function(){return c(y)};return S.filter=t,S}if(e.numberOfInputs){for(var h=e.numberOfInputs;h--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=a,t.setInputConnection=s,t.addInputData=g,t.addInputConnection=u,t.getInputData=i,t.getInputConnection=f}n&&(t.getOutputData=c,t.getOutputPort=l),t.update=function(){var y=[];if(e.numberOfInputs)for(var S=0;S<e.numberOfInputs;)y[S]=t.getInputData(S),S++;t.shouldUpdate()&&t.requestData&&t.requestData(y,e.output)},t.getNumberOfInputPorts=function(){return e.numberOfInputs},t.getNumberOfOutputPorts=function(){return n||e.output.length},t.getInputArrayToProcess=function(y){var S=e.inputArrayToProcess[y],T=e.inputData[y];return S&&T?T["get".concat(S.fieldAssociation)]().getArray(S.arrayName):null},t.setInputArrayToProcess=function(y,S,T){for(var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";e.inputArrayToProcess.length<y;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[y]={arrayName:S,fieldAssociation:T,attributeType:E}}}var Wg=Symbol("Event abort");function B1(t,e,r){var n=[],a=t.delete,i=1;function s(u){for(var g=0;g<n.length;++g){var c=Ct(n[g],1),l=c[0];if(l===u){n.splice(g,1);return}}}function f(u){function g(){s(u)}return Object.freeze({unsubscribe:g})}function o(){var u=arguments;if(e.deleted){ge("instance deleted - cannot call any method");return}for(var g=n.slice(),c=function(S){var T=Ct(g[S],3),E=T[1],x=T[2];if(!E)return"continue";if(x<0)setTimeout(function(){return E.apply(t,u)},1-x);else{var w=E.apply(t,u);if(w===Wg)return"break"}},l=0;l<g.length;++l){var h=c(l);if(h!=="continue"&&h==="break")break}}t["invoke".concat(ct(r))]=o,t["on".concat(ct(r))]=function(u){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error("Invalid callback for event ".concat(r)),null;if(e.deleted)return ge("instance deleted - cannot call any method"),null;var c=i++;return n.push([c,u,g]),n.sort(function(l,h){return h[2]-l[2]}),f(c)},t.delete=function(){a(),n.forEach(function(u){var g=Ct(u,1),c=g[0];return s(c)})}}function Ue(t,e){var r=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={},s={};return t(s,i,a),Object.freeze(s)};return e&&Wt.register(e,r),r}function N1(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e.filter(function(s){return!!s}).map(function(s){return s.apply(void 0,a)})}}function jg(t){return t&&t.isA&&t.isA("vtkObject")}function ro(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(jg(t)){if(n.indexOf(t)>=0)return r;n.push(t);var a=e(t);a!==void 0&&r.push(a);var i=t.get();Object.keys(i).forEach(function(s){var f=i[s];Array.isArray(f)?f.forEach(function(o){ro(o,e,r,n)}):ro(f,e,r,n)})}return r}function U1(t,e,r){var n=this,a,i=function(){for(var f=arguments.length,o=new Array(f),u=0;u<f;u++)o[u]=arguments[u];var g=n,c=function(){a=null,r||t.apply(g,o)},l=r&&!a;clearTimeout(a),a=setTimeout(c,e),l&&t.apply(g,o)};return i.cancel=function(){return clearTimeout(a)},i}function G1(t,e){var r=!1,n=null;function a(){r=!1,n!==null&&(i.apply(void 0,Ce(n)),n=null)}function i(){for(var s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];if(r){n=f;return}r=!0,t.apply(void 0,f),setTimeout(a,e)}return i}function $g(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},r),t.setKey=function(n,a){e.keystore[n]=a},t.getKey=function(n){return e.keystore[n]},t.getAllKeys=function(){return Object.keys(e.keystore)},t.deleteKey=function(n){return delete e.keystore[n]},t.clearKeystore=function(){return t.getAllKeys().forEach(function(n){return delete e.keystore[n]})}}var A1=1,Fa="__root__";function P1(t,e){$g(t,e);var r=t.delete;e.proxyId="".concat(A1++),e.ui=JSON.parse(JSON.stringify(e.ui||[])),kt(t,e,["proxyId","proxyGroup","proxyName"]),gt(t,e,["proxyManager"]);var n={},a={};function i(u,g){a[g]||(a[g]=[]);for(var c=a[g],l=0;l<u.length;l++)c.push(u[l].name),n[u[l].name]=u[l],u[l].children&&u[l].children.length&&i(u[l].children,u[l].name)}i(e.ui,Fa),t.updateUI=function(u){e.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(n).forEach(function(g){return delete n[g]}),Object.keys(a).forEach(function(g){return delete a[g]}),i(e.ui,Fa),t.modified()};function s(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fa;return a[u]}t.updateProxyProperty=function(u,g){var c=n[u];c?Object.assign(c,g):n[u]=eo({},g)},t.activate=function(){if(e.proxyManager){var u="setActive".concat(ct(t.getProxyGroup().slice(0,-1)));e.proxyManager[u]&&e.proxyManager[u](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=function(u,g){g in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[g]=[]),e.propertyLinkSubscribers[g].push(u)},t.gcPropertyLinks=function(u){for(var g=e.propertyLinkSubscribers[u]||[];g.length;)g.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(u){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[u])return e.propertyLinkMap[u];var c=null,l=[],h=0,y=!1;function S(C){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(y)return null;var D=[],b=null;for(h=l.length;h--;){var F=l[h];F.instance===C?b=F:D.push(F)}if(!b)return null;var U=b.instance["get".concat(ct(b.propertyName))]();if(!V1(U,c)||m){for(c=U,y=!0;D.length;){var O=D.pop();O.instance.set(de({},O.propertyName,c))}y=!1}return e.propertyLinkMap[u].persistent&&(e.propertyLinkMap[u].value=U),U}function T(C,m){var D=[];for(h=l.length;h--;){var b=l[h];b.instance===C&&(b.propertyName===m||m===void 0)&&(b.subscription.unsubscribe(),D.push(h))}for(;D.length;)l.splice(D.pop(),1)}function E(C,m){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,b=C.onModified(S),F=l[0];return l.push({instance:C,propertyName:m,subscription:b}),D&&(e.propertyLinkMap[u].persistent&&e.propertyLinkMap[u].value!==void 0?C.set(de({},m,e.propertyLinkMap[u].value)):F&&S(F.instance,!0)),{unsubscribe:function(){return T(C,m)}}}function x(){for(;l.length;)l.pop().subscription.unsubscribe()}var w={bind:E,unbind:T,unsubscribe:x,persistent:g};return e.propertyLinkMap[u]=w,w};function f(){for(var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fa,g=[],c=e.proxyId,l=s(u)||[],h=0;h<l.length;h++){var y=l[h],S=t["get".concat(ct(y))],T=S?S():void 0,E={id:c,name:y,value:T},x=f(y);x.length&&(E.children=x),g.push(E)}return g}t.listPropertyNames=function(){return f().map(function(u){return u.name})},t.getPropertyByName=function(u){return f().find(function(g){return g.name===u})},t.getPropertyDomainByName=function(u){return(n[u]||{}).domain},t.getProxySection=function(){return{id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:f()}},t.delete=function(){for(var u=Object.keys(e.propertyLinkMap),g=u.length;g--;)e.propertyLinkMap[u[g]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),r()},t.getState=function(){return null};function o(){if(e.links)for(var u=0;u<e.links.length;u++){var g=e.links[u],c=g.link,l=g.property,h=g.persistent,y=g.updateOnBind,S=g.type;if(S==="application"){var T=e.proxyManager.getPropertyLink(c,h);t.registerPropertyLinkForGC(T,"application"),T.bind(t,l,y)}}}Ag(o)}function z1(t,e,r){for(var n=t.delete,a=[],i=Object.keys(r),s=i.length;s--;){var f=i[s],o=r[f],u=o.modelKey,g=o.property,c=o.modified,l=c===void 0?!0:c,h=ct(g),y=ct(f);t["get".concat(y)]=e[u]["get".concat(h)],t["set".concat(y)]=e[u]["set".concat(h)],l&&a.push(e[u].onModified(t.modified))}t.delete=function(){for(;a.length;)a.pop().unsubscribe();n()}}function W1(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function a(o){for(var u=Object.keys(o),g=u.length;g--;){var c=u[g];e[c].set(o[c])}}for(var i=Object.keys(n),s=i.length,f=function(){var u=i[s];e[u]=n[u];var g=r[u];t["set".concat(ct(u))]=function(c){if(c!==e[u]){e[u]=c;var l=g[c];a(l),t.modified()}}};s--;)f();i.length&&kt(t,e,i)}var au=10,iu=40,su=800;function j1(t){var e=0,r=0,n=0,a=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*au,a=r*au,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||a)&&t.deltaMode&&(t.deltaMode===1?(n*=iu,a*=iu):(n*=su,a*=su)),n&&!e&&(e=n<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:a}}var L={algo:F1,capitalize:Fo,chain:N1,debounce:U1,enumToString:_1,event:B1,EVENT_ABORT:Wg,formatBytesToProperUnit:R1,formatNumbersWithThousandSeparator:L1,get:kt,getArray:da,getCurrentGlobalMTime:E1,getStateArrayMapFunc:Gg,isVtkObject:jg,keystore:$g,measurePromiseExecution:b1,moveToProtected:Bo,newInstance:Ue,newTypedArray:ya,newTypedArrayFrom:Ng,normalizeWheel:j1,obj:yt,proxy:P1,proxyPropertyMapping:z1,proxyPropertyState:W1,safeArrays:Ug,set:Bi,setArray:Pg,setGet:gt,setGetArray:zg,setImmediate:Ag,setLoggerFunction:x1,throttle:G1,traverseInstanceTree:ro,TYPED_ARRAYS:bt,uncapitalize:m1,VOID:C1,vtkDebugMacro:Or,vtkErrorMacro:ge,vtkInfoMacro:M1,vtkLogMacro:O1,vtkOnceErrorMacro:D1,vtkWarningMacro:Fi},$1=L.vtkErrorMacro,H1=["Build","Render"];function K1(t,e){e.classHierarchy.push("vtkViewNode"),t.build=function(r){},t.render=function(r){},t.traverse=function(r){var n=r.getTraverseOperation(),a=t[n];if(a){a(r);return}t.apply(r,!0);for(var i=0;i<e.children.length;i++)e.children[i].traverse(r);t.apply(r,!1)},t.apply=function(r,n){var a=t[r.getOperation()];a&&a(n,r)},t.getViewNodeFor=function(r){if(e.renderable===r)return t;for(var n=0;n<e.children.length;++n){var a=e.children[n],i=a.getViewNodeFor(r);if(i)return i}},t.getFirstAncestorOfType=function(r){return e._parent?e._parent.isA(r)?e._parent:e._parent.getFirstAncestorOfType(r):null},t.addMissingNode=function(r){if(!!r){var n=e._renderableChildMap.get(r);if(n!==void 0)n.setVisited(!0);else{var a=t.createViewNode(r);a&&(a.setParent(t),a.setVisited(!0),e._renderableChildMap.set(r,a),e.children.push(a))}}},t.addMissingNodes=function(r){if(!(!r||!r.length))for(var n=0;n<r.length;++n){var a=r[n],i=e._renderableChildMap.get(a);if(i!==void 0)i.setVisited(!0);else{var s=t.createViewNode(a);s&&(s.setParent(t),s.setVisited(!0),e._renderableChildMap.set(a,s),e.children.push(s))}}},t.addMissingChildren=function(r){if(!(!r||!r.length))for(var n=0;n<r.length;++n){var a=r[n],i=e.children.indexOf(a);i===-1&&(a.setParent(t),e.children.push(a)),a.setVisited(!0)}},t.prepareNodes=function(){for(var r=0;r<e.children.length;++r)e.children[r].setVisited(!1)},t.setVisited=function(r){e.visited=r},t.removeUnusedNodes=function(){for(var r=null,n=0;n<e.children.length;++n){var a=e.children[n],i=a.getVisited();if(i)a.setVisited(!1);else{var s=a.getRenderable();s&&e._renderableChildMap.delete(s),r||(r=[]),r.push(a)}}r&&(e.children=e.children.filter(function(f){return!r.includes(f)}))},t.createViewNode=function(r){if(!e.myFactory)return $1("Cannot create view nodes without my own factory"),null;var n=e.myFactory.createNode(r);return n&&n.setRenderable(r),n}}var X1={renderable:null,myFactory:null,children:[],visited:!1};function Hg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,X1,r),L.obj(t,e),L.event(t,e,"event"),e._renderableChildMap=new Map,L.get(t,e,["visited"]),L.setGet(t,e,["_parent","renderable","myFactory"]),L.getArray(t,e,["children"]),L.moveToProtected(t,e,["parent"]),K1(t,e)}var Y1=L.newInstance(Hg,"vtkViewNode"),Ie={newInstance:Y1,extend:Hg,PASS_TYPES:H1};function I1(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=function(r){if(r.isDeleted())return null;for(var n=0,a=r.getClassName(n++),i=!1,s=Object.keys(e.overrides);a&&!i;)s.indexOf(a)!==-1?i=!0:a=r.getClassName(n++);if(!i)return null;var f=e.overrides[a]();return f.setMyFactory(t),f},t.registerOverride=function(r,n){e.overrides[r]=n}}var q1={};function Kg(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,q1,r),L.obj(t,e),I1(t,e)}var Z1=L.newInstance(Kg,"vtkViewNodeFactory"),Xg={newInstance:Z1,extend:Kg},Yg=Object.create(null);function Mt(t,e){Yg[t]=e}function Q1(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}var J1={};function Ig(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,J1,r),e.overrides=Yg,Xg.extend(t,e,r),Q1(t,e)}var eT=L.newInstance(Ig,"vtkOpenGLViewNodeFactory"),tT={newInstance:eT,extend:Ig};function rT(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=function(r){r&&(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=function(r){if(r){var n=e.openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize),e.context.scissor(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)}},t.translucentPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=function(r){if(r!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||r.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){ut(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Do(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),mo(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ze(e.keyMatrices.wcvc,e.keyMatrices.wcvc);var n=e.openGLRenderer.getAspectRatio();ut(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(n,-1,1)),ze(e.keyMatrices.vcpc,e.keyMatrices.vcpc),St(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=r}return e.keyMatrices}}var nT={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function aT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nT,r),Ie.extend(t,e,r),e.keyMatrixTime={},yt(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},gt(t,e,["context","keyMatrixTime"]),rT(t,e)}var iT=Ue(aT);Mt("vtkCamera",iT);var sT=Or;function oT(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(sT("No lights are on, creating one."),e.renderable.createLight()),r},t.opaqueZBufferPass=function(r){if(r){var n=0,a=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),n|=a.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(a.clearDepth(1),n|=a.DEPTH_BUFFER_BIT,e.context.depthMask(!0));var i=t.getTiledSizeAndOrigin();a.enable(a.SCISSOR_TEST),a.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.colorMask(!0,!0,!0,!0),n&&a.clear(n),a.enable(a.DEPTH_TEST)}},t.cameraPass=function(r){r&&t.clear()},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),f=Math.round(s[0]),o=Math.round(s[1]),u=r[2]-n[0],g=r[3]-n[1],c=e._parent.normalizedDisplayToDisplay(u,g),l=Math.round(c[0])-f,h=Math.round(c[1])-o;return l<0&&(l=0),h<0&&(h=0),{usize:l,vsize:h,lowerLeftU:f,lowerLeftV:o}},t.clear=function(){var r=0,n=e.context;if(!e.renderable.getTransparent()){var a=e.renderable.getBackgroundByReference();e.context.clearColor(a[0],a[1],a[2],a[3]),r|=n.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(n.clearDepth(1),r|=n.DEPTH_BUFFER_BIT,e.context.depthMask(!0)),n.colorMask(!0,!0,!0,!0);var i=t.getTiledSizeAndOrigin();n.enable(n.SCISSOR_TEST),n.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r&&n.clear(r),n.enable(n.DEPTH_TEST)},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var fT={context:null,selector:null};function uT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fT,r),Ie.extend(t,e,r),kt(t,e,["shaderCache"]),gt(t,e,["selector"]),Bo(t,e,["openGLRenderWindow"]),oT(t,e)}var cT=Ue(uT,"vtkOpenGLRenderer");Mt("vtkRenderer",cT);function gT(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=function(r){if(r){e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.traverseOpaqueZBufferPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(!!e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.opaqueZBufferPass=function(r,n){return t.opaquePass(r,n)},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.getKeyMatrices=function(){return e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),ut(e.keyMatrices.mcwc,e.renderable.getMatrix()),ze(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?Qr(e.keyMatrices.normalMatrix):(Do(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),mo(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ng(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices}}var vT={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function lT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vT,r),Ie.extend(t,e,r),e.keyMatrixTime={},yt(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Qr(new Float64Array(9)),mcwc:De(new Float64Array(16))},gt(t,e,["context"]),kt(t,e,["activeTextures"]),gT(t,e)}var pT=Ue(lT);Mt("vtkActor",pT);function hT(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=function(r){if(r){if(!e.renderable)return;e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOverlayActorCount()}},t.traverseOpaquePass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOverlayPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(!!e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.overlayPass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()}}var yT={context:null,activeTextures:null};function dT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yT,r),Ie.extend(t,e,r),gt(t,e,["context"]),kt(t,e,["activeTextures"]),hT(t,e)}var TT=Ue(dT);Mt("vtkActor2D",TT);function ci(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ST(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function qg(t){let e,r,n;t.length!==2?(e=ci,r=(f,o)=>ci(t(f),o),n=(f,o)=>t(f)-o):(e=t===ci||t===ST?t:CT,r=t,n=t);function a(f,o,u=0,g=f.length){if(u<g){if(e(o,o)!==0)return g;do{const c=u+g>>>1;r(f[c],o)<0?u=c+1:g=c}while(u<g)}return u}function i(f,o,u=0,g=f.length){if(u<g){if(e(o,o)!==0)return g;do{const c=u+g>>>1;r(f[c],o)<=0?u=c+1:g=c}while(u<g)}return u}function s(f,o,u=0,g=f.length){const c=a(f,o,u,g-1);return c>u&&n(f[c-1],o)>-n(f[c],o)?c-1:c}return{left:a,center:s,right:i}}function CT(){return 0}function ET(t){return t===null?NaN:+t}const wT=qg(ci),xT=wT.right;qg(ET).center;const OT=xT;var no=Math.sqrt(50),ao=Math.sqrt(10),io=Math.sqrt(2);function MT(t,e,r){var n,a=-1,i,s,f;if(e=+e,t=+t,r=+r,t===e&&r>0)return[t];if((n=e<t)&&(i=t,t=e,e=i),(f=Zg(t,e,r))===0||!isFinite(f))return[];if(f>0){let o=Math.round(t/f),u=Math.round(e/f);for(o*f<t&&++o,u*f>e&&--u,s=new Array(i=u-o+1);++a<i;)s[a]=(o+a)*f}else{f=-f;let o=Math.round(t*f),u=Math.round(e*f);for(o/f<t&&++o,u/f>e&&--u,s=new Array(i=u-o+1);++a<i;)s[a]=(o+a)/f}return n&&s.reverse(),s}function Zg(t,e,r){var n=(e-t)/Math.max(0,r),a=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,a);return a>=0?(i>=no?10:i>=ao?5:i>=io?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=no?10:i>=ao?5:i>=io?2:1)}function DT(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),a=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/a;return i>=no?a*=10:i>=ao?a*=5:i>=io&&(a*=2),e<t?-a:a}function mT(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function No(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function Qg(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Ta(){}var ua=.7,Si=1/ua,En="\\s*([+-]?\\d+)\\s*",ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",RT=/^#([0-9a-f]{3,8})$/,LT=new RegExp(`^rgb\\(${En},${En},${En}\\)$`),VT=new RegExp(`^rgb\\(${qt},${qt},${qt}\\)$`),_T=new RegExp(`^rgba\\(${En},${En},${En},${ca}\\)$`),bT=new RegExp(`^rgba\\(${qt},${qt},${qt},${ca}\\)$`),kT=new RegExp(`^hsl\\(${ca},${qt},${qt}\\)$`),FT=new RegExp(`^hsla\\(${ca},${qt},${qt},${ca}\\)$`),ou={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};No(Ta,ga,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fu,formatHex:fu,formatHex8:BT,formatHsl:NT,formatRgb:uu,toString:uu});function fu(){return this.rgb().formatHex()}function BT(){return this.rgb().formatHex8()}function NT(){return Jg(this).formatHsl()}function uu(){return this.rgb().formatRgb()}function ga(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=RT.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?cu(e):r===3?new Tt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Ba(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Ba(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=LT.exec(t))?new Tt(e[1],e[2],e[3],1):(e=VT.exec(t))?new Tt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=_T.exec(t))?Ba(e[1],e[2],e[3],e[4]):(e=bT.exec(t))?Ba(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kT.exec(t))?lu(e[1],e[2]/100,e[3]/100,1):(e=FT.exec(t))?lu(e[1],e[2]/100,e[3]/100,e[4]):ou.hasOwnProperty(t)?cu(ou[t]):t==="transparent"?new Tt(NaN,NaN,NaN,0):null}function cu(t){return new Tt(t>>16&255,t>>8&255,t&255,1)}function Ba(t,e,r,n){return n<=0&&(t=e=r=NaN),new Tt(t,e,r,n)}function UT(t){return t instanceof Ta||(t=ga(t)),t?(t=t.rgb(),new Tt(t.r,t.g,t.b,t.opacity)):new Tt}function so(t,e,r,n){return arguments.length===1?UT(t):new Tt(t,e,r,n==null?1:n)}function Tt(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}No(Tt,so,Qg(Ta,{brighter(t){return t=t==null?Si:Math.pow(Si,t),new Tt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ua:Math.pow(ua,t),new Tt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Tt(Yr(this.r),Yr(this.g),Yr(this.b),Ci(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gu,formatHex:gu,formatHex8:GT,formatRgb:vu,toString:vu}));function gu(){return`#${Kr(this.r)}${Kr(this.g)}${Kr(this.b)}`}function GT(){return`#${Kr(this.r)}${Kr(this.g)}${Kr(this.b)}${Kr((isNaN(this.opacity)?1:this.opacity)*255)}`}function vu(){const t=Ci(this.opacity);return`${t===1?"rgb(":"rgba("}${Yr(this.r)}, ${Yr(this.g)}, ${Yr(this.b)}${t===1?")":`, ${t})`}`}function Ci(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Yr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Kr(t){return t=Yr(t),(t<16?"0":"")+t.toString(16)}function lu(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new zt(t,e,r,n)}function Jg(t){if(t instanceof zt)return new zt(t.h,t.s,t.l,t.opacity);if(t instanceof Ta||(t=ga(t)),!t)return new zt;if(t instanceof zt)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,f=i-a,o=(i+a)/2;return f?(e===i?s=(r-n)/f+(r<n)*6:r===i?s=(n-e)/f+2:s=(e-r)/f+4,f/=o<.5?i+a:2-i-a,s*=60):f=o>0&&o<1?0:s,new zt(s,f,o,t.opacity)}function AT(t,e,r,n){return arguments.length===1?Jg(t):new zt(t,e,r,n==null?1:n)}function zt(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}No(zt,AT,Qg(Ta,{brighter(t){return t=t==null?Si:Math.pow(Si,t),new zt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ua:Math.pow(ua,t),new zt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new Tt(Es(t>=240?t-240:t+120,a,n),Es(t,a,n),Es(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new zt(pu(this.h),Na(this.s),Na(this.l),Ci(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ci(this.opacity);return`${t===1?"hsl(":"hsla("}${pu(this.h)}, ${Na(this.s)*100}%, ${Na(this.l)*100}%${t===1?")":`, ${t})`}`}}));function pu(t){return t=(t||0)%360,t<0?t+360:t}function Na(t){return Math.max(0,Math.min(1,t||0))}function Es(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Uo=t=>()=>t;function PT(t,e){return function(r){return t+r*e}}function zT(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function WT(t){return(t=+t)==1?ev:function(e,r){return r-e?zT(e,r,t):Uo(isNaN(e)?r:e)}}function ev(t,e){var r=e-t;return r?PT(t,r):Uo(isNaN(t)?e:t)}const hu=function t(e){var r=WT(e);function n(a,i){var s=r((a=so(a)).r,(i=so(i)).r),f=r(a.g,i.g),o=r(a.b,i.b),u=ev(a.opacity,i.opacity);return function(g){return a.r=s(g),a.g=f(g),a.b=o(g),a.opacity=u(g),a+""}}return n.gamma=t,n}(1);function jT(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function $T(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function HT(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Go(t[s],e[s]);for(;s<r;++s)i[s]=e[s];return function(f){for(s=0;s<n;++s)i[s]=a[s](f);return i}}function KT(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Ei(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function XT(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=Go(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var oo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ws=new RegExp(oo.source,"g");function YT(t){return function(){return t}}function IT(t){return function(e){return t(e)+""}}function qT(t,e){var r=oo.lastIndex=ws.lastIndex=0,n,a,i,s=-1,f=[],o=[];for(t=t+"",e=e+"";(n=oo.exec(t))&&(a=ws.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),f[s]?f[s]+=i:f[++s]=i),(n=n[0])===(a=a[0])?f[s]?f[s]+=a:f[++s]=a:(f[++s]=null,o.push({i:s,x:Ei(n,a)})),r=ws.lastIndex;return r<e.length&&(i=e.slice(r),f[s]?f[s]+=i:f[++s]=i),f.length<2?o[0]?IT(o[0].x):YT(e):(e=o.length,function(u){for(var g=0,c;g<e;++g)f[(c=o[g]).i]=c.x(u);return f.join("")})}function Go(t,e){var r=typeof e,n;return e==null||r==="boolean"?Uo(e):(r==="number"?Ei:r==="string"?(n=ga(e))?(e=n,hu):qT:e instanceof ga?hu:e instanceof Date?KT:$T(e)?jT:Array.isArray(e)?HT:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?XT:Ei)(t,e)}function ZT(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function QT(t){return function(){return t}}function JT(t){return+t}var yu=[0,1];function dn(t){return t}function fo(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:QT(isNaN(e)?NaN:.5)}function e2(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function t2(t,e,r){var n=t[0],a=t[1],i=e[0],s=e[1];return a<n?(n=fo(a,n),i=r(s,i)):(n=fo(n,a),i=r(i,s)),function(f){return i(n(f))}}function r2(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)a[s]=fo(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(f){var o=OT(t,f,1,n)-1;return i[o](a[o](f))}}function n2(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function a2(){var t=yu,e=yu,r=Go,n,a,i,s=dn,f,o,u;function g(){var l=Math.min(t.length,e.length);return s!==dn&&(s=e2(t[0],t[l-1])),f=l>2?r2:t2,o=u=null,c}function c(l){return l==null||isNaN(l=+l)?i:(o||(o=f(t.map(n),e,r)))(n(s(l)))}return c.invert=function(l){return s(a((u||(u=f(e,t.map(n),Ei)))(l)))},c.domain=function(l){return arguments.length?(t=Array.from(l,JT),g()):t.slice()},c.range=function(l){return arguments.length?(e=Array.from(l),g()):e.slice()},c.rangeRound=function(l){return e=Array.from(l),r=ZT,g()},c.clamp=function(l){return arguments.length?(s=l?!0:dn,g()):s!==dn},c.interpolate=function(l){return arguments.length?(r=l,g()):r},c.unknown=function(l){return arguments.length?(i=l,c):i},function(l,h){return n=l,a=h,g()}}function i2(){return a2()(dn,dn)}function s2(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function wi(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function On(t){return t=wi(Math.abs(t)),t?t[1]:NaN}function o2(t,e){return function(r,n){for(var a=r.length,i=[],s=0,f=t[0],o=0;a>0&&f>0&&(o+f+1>n&&(f=Math.max(1,n-o)),i.push(r.substring(a-=f,a+f)),!((o+=f+1)>n));)f=t[s=(s+1)%t.length];return i.reverse().join(e)}}function f2(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var u2=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xi(t){if(!(e=u2.exec(t)))throw new Error("invalid format: "+t);var e;return new Ao({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}xi.prototype=Ao.prototype;function Ao(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ao.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function c2(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var tv;function g2(t,e){var r=wi(t,e);if(!r)return t+"";var n=r[0],a=r[1],i=a-(tv=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+wi(t,Math.max(0,e+i-1))[0]}function du(t,e){var r=wi(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Tu={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:s2,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>du(t*100,e),r:du,s:g2,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Su(t){return t}var Cu=Array.prototype.map,Eu=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function v2(t){var e=t.grouping===void 0||t.thousands===void 0?Su:o2(Cu.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?Su:f2(Cu.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",f=t.minus===void 0?"\u2212":t.minus+"",o=t.nan===void 0?"NaN":t.nan+"";function u(c){c=xi(c);var l=c.fill,h=c.align,y=c.sign,S=c.symbol,T=c.zero,E=c.width,x=c.comma,w=c.precision,C=c.trim,m=c.type;m==="n"?(x=!0,m="g"):Tu[m]||(w===void 0&&(w=12),C=!0,m="g"),(T||l==="0"&&h==="=")&&(T=!0,l="0",h="=");var D=S==="$"?r:S==="#"&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",b=S==="$"?n:/[%p]/.test(m)?s:"",F=Tu[m],U=/[defgprs%]/.test(m);w=w===void 0?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function O(A){var W=D,j=b,N,I,X;if(m==="c")j=F(A)+j,A="";else{A=+A;var J=A<0||1/A<0;if(A=isNaN(A)?o:F(Math.abs(A),w),C&&(A=c2(A)),J&&+A==0&&y!=="+"&&(J=!1),W=(J?y==="("?y:f:y==="-"||y==="("?"":y)+W,j=(m==="s"?Eu[8+tv/3]:"")+j+(J&&y==="("?")":""),U){for(N=-1,I=A.length;++N<I;)if(X=A.charCodeAt(N),48>X||X>57){j=(X===46?a+A.slice(N+1):A.slice(N))+j,A=A.slice(0,N);break}}}x&&!T&&(A=e(A,1/0));var P=W.length+A.length+j.length,G=P<E?new Array(E-P+1).join(l):"";switch(x&&T&&(A=e(G+A,G.length?E-j.length:1/0),G=""),h){case"<":A=W+A+j+G;break;case"=":A=W+G+A+j;break;case"^":A=G.slice(0,P=G.length>>1)+W+A+j+G.slice(P);break;default:A=G+W+A+j;break}return i(A)}return O.toString=function(){return c+""},O}function g(c,l){var h=u((c=xi(c),c.type="f",c)),y=Math.max(-8,Math.min(8,Math.floor(On(l)/3)))*3,S=Math.pow(10,-y),T=Eu[8+y/3];return function(E){return h(S*E)+T}}return{format:u,formatPrefix:g}}var Ua,rv,nv;l2({thousands:",",grouping:[3],currency:["$",""]});function l2(t){return Ua=v2(t),rv=Ua.format,nv=Ua.formatPrefix,Ua}function p2(t){return Math.max(0,-On(Math.abs(t)))}function h2(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(On(e)/3)))*3-On(Math.abs(t)))}function y2(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,On(e)-On(t))+1}function d2(t,e,r,n){var a=DT(t,e,r),i;switch(n=xi(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=h2(a,s))&&(n.precision=i),nv(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=y2(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=p2(a))&&(n.precision=i-(n.type==="%")*2);break}}return rv(n)}function T2(t){var e=t.domain;return t.ticks=function(r){var n=e();return MT(n[0],n[n.length-1],r==null?10:r)},t.tickFormat=function(r,n){var a=e();return d2(a[0],a[a.length-1],r==null?10:r,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,s=n[a],f=n[i],o,u,g=10;for(f<s&&(u=s,s=f,f=u,u=a,a=i,i=u);g-- >0;){if(u=Zg(s,f,r),u===o)return n[a]=s,n[i]=f,e(n);if(u>0)s=Math.floor(s/u)*u,f=Math.ceil(f/u)*u;else if(u<0)s=Math.ceil(s*u)/u,f=Math.floor(f*u)/u;else break;o=u}return t},t}function Po(){var t=i2();return t.copy=function(){return n2(t,Po())},mT.apply(t,arguments),T2(t)}var av={exports:{}};(function(t){(function(e,r,n){function a(o){var u=this,g=f();u.next=function(){var c=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=c-(u.c=c|0)},u.c=1,u.s0=g(" "),u.s1=g(" "),u.s2=g(" "),u.s0-=g(o),u.s0<0&&(u.s0+=1),u.s1-=g(o),u.s1<0&&(u.s1+=1),u.s2-=g(o),u.s2<0&&(u.s2+=1),g=null}function i(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function s(o,u){var g=new a(o),c=u&&u.state,l=g.next;return l.int32=function(){return g.next()*4294967296|0},l.double=function(){return l()+(l()*2097152|0)*11102230246251565e-32},l.quick=l,c&&(typeof c=="object"&&i(c,g),l.state=function(){return i(g,{})}),l}function f(){var o=4022871197,u=function(g){g=String(g);for(var c=0;c<g.length;c++){o+=g.charCodeAt(c);var l=.02519603282416938*o;o=l>>>0,l-=o,l*=o,o=l>>>0,l-=o,o+=l*4294967296}return(o>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.alea=s})(Vt,t,!1)})(av);var iv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var c=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^c^c>>>8},f===(f|0)?o.x=f:u+=f;for(var g=0;g<u.length+64;g++)o.x^=u.charCodeAt(g)|0,o.next()}function i(f,o){return o.x=f.x,o.y=f.y,o.z=f.z,o.w=f.w,o}function s(f,o){var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(typeof g=="object"&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor128=s})(Vt,t,!1)})(iv);var sv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.next=function(){var c=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(c^c<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,f===(f|0)?o.x=f:u+=f;for(var g=0;g<u.length+64;g++)o.x^=u.charCodeAt(g)|0,g==u.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function i(f,o){return o.x=f.x,o.y=f.y,o.z=f.z,o.w=f.w,o.v=f.v,o.d=f.d,o}function s(f,o){var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(typeof g=="object"&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorwow=s})(Vt,t,!1)})(sv);var ov={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this;o.next=function(){var g=o.x,c=o.i,l,h;return l=g[c],l^=l>>>7,h=l^l<<24,l=g[c+1&7],h^=l^l>>>10,l=g[c+3&7],h^=l^l>>>3,l=g[c+4&7],h^=l^l<<7,l=g[c+7&7],l=l^l<<13,h^=l^l<<9,g[c]=h,o.i=c+1&7,h};function u(g,c){var l,h=[];if(c===(c|0))h[0]=c;else for(c=""+c,l=0;l<c.length;++l)h[l&7]=h[l&7]<<15^c.charCodeAt(l)+h[l+1&7]<<13;for(;h.length<8;)h.push(0);for(l=0;l<8&&h[l]===0;++l);for(l==8?h[7]=-1:h[l],g.x=h,g.i=0,l=256;l>0;--l)g.next()}u(o,f)}function i(f,o){return o.x=f.x.slice(),o.i=f.i,o}function s(f,o){f==null&&(f=+new Date);var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(g.x&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorshift7=s})(Vt,t,!1)})(ov);var fv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this;o.next=function(){var g=o.w,c=o.X,l=o.i,h,y;return o.w=g=g+1640531527|0,y=c[l+34&127],h=c[l=l+1&127],y^=y<<13,h^=h<<17,y^=y>>>15,h^=h>>>12,y=c[l]=y^h,o.i=l,y+(g^g>>>16)|0};function u(g,c){var l,h,y,S,T,E=[],x=128;for(c===(c|0)?(h=c,c=null):(c=c+"\0",h=0,x=Math.max(x,c.length)),y=0,S=-32;S<x;++S)c&&(h^=c.charCodeAt((S+32)%c.length)),S===0&&(T=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,S>=0&&(T=T+1640531527|0,l=E[S&127]^=h+T,y=l==0?y+1:0);for(y>=128&&(E[(c&&c.length||0)&127]=-1),y=127,S=4*128;S>0;--S)h=E[y+34&127],l=E[y=y+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,E[y]=h^l;g.w=T,g.X=E,g.i=y}u(o,f)}function i(f,o){return o.i=f.i,o.w=f.w,o.X=f.X.slice(),o}function s(f,o){f==null&&(f=+new Date);var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(g.X&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor4096=s})(Vt,t,!1)})(fv);var uv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.next=function(){var c=o.b,l=o.c,h=o.d,y=o.a;return c=c<<25^c>>>7^l,l=l-h|0,h=h<<24^h>>>8^y,y=y-c|0,o.b=c=c<<20^c>>>12^l,o.c=l=l-h|0,o.d=h<<16^l>>>16^y,o.a=y-c|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,f===Math.floor(f)?(o.a=f/4294967296|0,o.b=f|0):u+=f;for(var g=0;g<u.length+20;g++)o.b^=u.charCodeAt(g)|0,o.next()}function i(f,o){return o.a=f.a,o.b=f.b,o.c=f.c,o.d=f.d,o}function s(f,o){var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(typeof g=="object"&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.tychei=s})(Vt,t,!1)})(uv);var cv={exports:{}};const S2={},C2=Object.freeze(Object.defineProperty({__proto__:null,default:S2},Symbol.toStringTag,{value:"Module"})),E2=Ed(C2);(function(t){(function(e,r,n){var a=256,i=6,s=52,f="random",o=n.pow(a,i),u=n.pow(2,s),g=u*2,c=a-1,l;function h(C,m,D){var b=[];m=m==!0?{entropy:!0}:m||{};var F=E(T(m.entropy?[C,w(r)]:C==null?x():C,3),b),U=new y(b),O=function(){for(var A=U.g(i),W=o,j=0;A<u;)A=(A+j)*a,W*=a,j=U.g(1);for(;A>=g;)A/=2,W/=2,j>>>=1;return(A+j)/W};return O.int32=function(){return U.g(4)|0},O.quick=function(){return U.g(4)/4294967296},O.double=O,E(w(U.S),r),(m.pass||D||function(A,W,j,N){return N&&(N.S&&S(N,U),A.state=function(){return S(U,{})}),j?(n[f]=A,W):A})(O,F,"global"in m?m.global:this==n,m.state)}function y(C){var m,D=C.length,b=this,F=0,U=b.i=b.j=0,O=b.S=[];for(D||(C=[D++]);F<a;)O[F]=F++;for(F=0;F<a;F++)O[F]=O[U=c&U+C[F%D]+(m=O[F])],O[U]=m;(b.g=function(A){for(var W,j=0,N=b.i,I=b.j,X=b.S;A--;)W=X[N=c&N+1],j=j*a+X[c&(X[N]=X[I=c&I+W])+(X[I]=W)];return b.i=N,b.j=I,j})(a)}function S(C,m){return m.i=C.i,m.j=C.j,m.S=C.S.slice(),m}function T(C,m){var D=[],b=typeof C,F;if(m&&b=="object")for(F in C)try{D.push(T(C[F],m-1))}catch{}return D.length?D:b=="string"?C:C+"\0"}function E(C,m){for(var D=C+"",b,F=0;F<D.length;)m[c&F]=c&(b^=m[c&F]*19)+D.charCodeAt(F++);return w(m)}function x(){try{var C;return l&&(C=l.randomBytes)?C=C(a):(C=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(C)),w(C)}catch{var m=e.navigator,D=m&&m.plugins;return[+new Date,e,D,e.screen,w(r)]}}function w(C){return String.fromCharCode.apply(0,C)}if(E(n.random(),r),t.exports){t.exports=h;try{l=E2}catch{}}else n["seed"+f]=h})(typeof self<"u"?self:Vt,[],Math)})(cv);var w2=av.exports,x2=iv.exports,O2=sv.exports,M2=ov.exports,D2=fv.exports,m2=uv.exports,Rn=cv.exports;Rn.alea=w2;Rn.xor128=x2;Rn.xorwow=O2;Rn.xorshift7=M2;Rn.xor4096=D2;Rn.tychei=m2;var wu=L.vtkWarningMacro,R2=1e-12;function uo(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;return Array(t).fill(0)}function Ke(t){return t/180*Math.PI}function va(t){return t*180/Math.PI}var Ga=Math.round;function Pt(t){for(var e=1;e<t;)e*=2;return e}function Aa(t){return t===Pt(t)}function co(t,e,r){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function wr(t,e,r){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function xu(t,e,r,n){return n[0]=t[0]+e[0]*r,n[1]=t[1]+e[1]*r,n[2]=t[2]+e[2]*r,n}function Ee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function la(t,e,r){var n=t[1]*e[2]-t[2]*e[1],a=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return r[0]=n,r[1]=a,r[2]=i,r}function ta(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{for(var r=0,n=0;n<e;n++)r+=t[n]*t[n];return Math.sqrt(r)}}}function Mn(t){var e=ta(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function Gt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function L2(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function V2(t){var e=L2(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function gi(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function xs(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!"".concat(t).includes("e"))return+"".concat(Math.round("".concat(t,"e+").concat(e)),"e-").concat(e);var r="".concat(t).split("e"),n="";return+r[1]+e>0&&(n="+"),+"".concat(Math.round("".concat(+r[0],"e").concat(n).concat(+r[1]+e)),"e-").concat(e)}function Ou(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=xs(t[0],r),e[1]=xs(t[1],r),e[2]=xs(t[2],r),e}function _2(t,e,r){var n,a,i,s,f=0,o,u,g,c=uo(r);for(n=0;n<r;n++){for(s=0,a=0;a<r;a++)(g=Math.abs(t[n*r+a]))>s&&(s=g);if(s===0)return wu("Unable to factor linear system"),0;c[n]=1/s}for(a=0;a<r;a++){for(n=0;n<a;n++){for(o=t[n*r+a],i=0;i<n;i++)o-=t[n*r+i]*t[i*r+a];t[n*r+a]=o}for(s=0,n=a;n<r;n++){for(o=t[n*r+a],i=0;i<a;i++)o-=t[n*r+i]*t[i*r+a];t[n*r+a]=o,(u=c[n]*Math.abs(o))>=s&&(s=u,f=n)}if(a!==f){for(i=0;i<r;i++)u=t[f*r+i],t[f*r+i]=t[a*r+i],t[a*r+i]=u;c[f]=c[a]}if(e[a]=f,Math.abs(t[a*r+a])<=R2)return wu("Unable to factor linear system"),0;if(a!==r-1)for(u=1/t[a*r+a],n=a+1;n<r;n++)t[n*r+a]*=u}return 1}function b2(t,e,r,n){var a,i,s,f,o;for(s=-1,a=0;a<n;a++){if(f=e[a],o=r[f],r[f]=r[a],s>=0)for(i=s;i<=a-1;i++)o-=t[a*n+i]*r[i];else o!==0&&(s=a);r[a]=o}for(a=n-1;a>=0;a--){for(o=r[a],i=a+1;i<n;i++)o-=t[a*n+i]*r[i];r[a]=o/t[a*n+a]}}function k2(t,e,r){if(r===2){var n=uo(2),a=gi(t[0],t[1],t[2],t[3]);return a===0?0:(n[0]=(t[3]*e[0]-t[1]*e[1])/a,n[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=n[0],e[1]=n[1],1)}if(r===1)return t[0]===0?0:(e[0]/=t[0],1);var i=uo(r);return _2(t,i,r)===0?0:(b2(t,i,e,r),1)}function F2(t,e){var r=Ct(t,3),n=r[0],a=r[1],i=r[2],s=1/3,f=1/6,o=2/3,u=5/6,g,c,l;n>f&&n<=s?(c=1,g=(s-n)/f,l=0):n>s&&n<=.5?(c=1,l=(n-s)/f,g=0):n>.5&&n<=o?(l=1,c=(o-n)/f,g=0):n>o&&n<=u?(l=1,g=(n-o)/f,c=0):n>u&&n<=1?(g=1,l=(1-n)/f,c=0):(g=1,c=n/f,l=0),g=a*g+(1-a),c=a*c+(1-a),l=a*l+(1-a),g*=i,c*=i,l*=i,e[0]=g,e[1]=c,e[2]=l}function Ni(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function Os(t){return!(t[1]-t[0]<0)}function Mu(t,e,r){return r[0]=Math.min(t[0],e[0]),r[1]=Math.max(t[0],e[0]),r[2]=Math.min(t[1],e[1]),r[3]=Math.max(t[1],e[1]),r[4]=Math.min(t[2],e[2]),r[5]=Math.max(t[2],e[2]),r}function Ms(t,e,r){return t<e?e:t>r?r:t}function Du(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return n[0]=Ms(t[0],e[0],r[0]),n[1]=Ms(t[1],e[1],r[1]),n[2]=Ms(t[2],e[2],r[2]),n}var B2=Number.isNaN,gv=B2;function vv(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function mu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function N2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var go=1e-6,lv="coincide",pv="disjoint";function U2(t,e,r){return t[0]*(r[0]-e[0])+t[1]*(r[1]-e[1])+t[2]*(r[2]-e[2])}function hv(t,e,r){var n=r[0]*(t[0]-e[0])+r[1]*(t[1]-e[1])+r[2]*(t[2]-e[2]);return Math.abs(n)}function yv(t,e,r,n){var a=[];wr(t,e,a);var i=Ee(r,a);n[0]=t[0]-i*r[0],n[1]=t[1]-i*r[1],n[2]=t[2]-i*r[2]}function dv(t,e,r){var n=Ee(t,e),a=Ee(e,e);return a===0&&(a=1),r[0]=t[0]-n*e[0]/a,r[1]=t[1]-n*e[1]/a,r[2]=t[2]-n*e[2]/a,r}function Tv(t,e,r,n){var a=[];wr(t,e,a);var i=Ee(r,a),s=Ee(r,r);s!==0?(n[0]=t[0]-i*r[0]/s,n[1]=t[1]-i*r[1]/s,n[2]=t[2]-i*r[2]/s):(n[0]=t[0],n[1]=t[1],n[2]=t[2])}function Sv(t,e,r,n){var a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},i=[],s=[];wr(e,t,i),wr(r,t,s);var f=Ee(n,s),o=Ee(n,i),u,g;return o<0?u=-o:u=o,f<0?g=-f*go:g=f*go,u<=g||(a.t=f/o,a.x[0]=t[0]+a.t*i[0],a.x[1]=t[1]+a.t*i[1],a.x[2]=t[2]+a.t*i[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function Cv(t,e,r,n){var a={intersection:!1,l0:[],l1:[],error:null},i=[];la(e,n,i);var s=i.map(function(l){return Math.abs(l)});if(s[0]+s[1]+s[2]<go){var f=[];return wr(t,r,f),Ee(e,f)===0?a.error=lv:a.error=pv,a}var o;s[0]>s[1]&&s[0]>s[2]?o="x":s[1]>s[2]?o="y":o="z";var u=[],g=-Ee(e,t),c=-Ee(n,r);switch(o){case"x":u[0]=0,u[1]=(c*e[2]-g*n[2])/i[0],u[2]=(g*n[1]-c*e[1])/i[0];break;case"y":u[0]=(g*n[2]-c*e[2])/i[1],u[1]=0,u[2]=(c*e[0]-g*n[0])/i[1];break;case"z":u[0]=(c*e[1]-g*n[1])/i[2],u[1]=(g*n[0]-c*e[0])/i[2],u[2]=0;break}return a.l0=u,co(u,i,a.l1),a.intersection=!0,a}var G2={evaluate:U2,distanceToPlane:hv,projectPoint:yv,projectVector:dv,generalizedProjectPoint:Tv,intersectWithLine:Sv,intersectWithPlane:Cv,DISJOINT:pv,COINCIDE:lv};function A2(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=function(r){return hv(r,e.origin,e.normal)},t.projectPoint=function(r,n){yv(r,e.origin,e.normal,n)},t.projectVector=function(r,n){return dv(r,e.normal,n)},t.push=function(r){if(r!==0)for(var n=0;n<3;n++)e.origin[n]+=r*e.normal[n]},t.generalizedProjectPoint=function(r,n){Tv(r,e.origin,e.normal,n)},t.evaluateFunction=function(r,n,a){return Array.isArray(r)?e.normal[0]*(r[0]-e.origin[0])+e.normal[1]*(r[1]-e.origin[1])+e.normal[2]*(r[2]-e.origin[2]):e.normal[0]*(r-e.origin[0])+e.normal[1]*(n-e.origin[1])+e.normal[2]*(a-e.origin[2])},t.evaluateGradient=function(r){var n=[e.normal[0],e.normal[1],e.normal[2]];return n},t.intersectWithLine=function(r,n){return Sv(r,n,e.origin,e.normal)},t.intersectWithPlane=function(r,n){return Cv(r,n,e.origin,e.normal)}}var P2={normal:[0,0,1],origin:[0,0,0]};function Ev(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,P2,r),L.obj(t,e),L.setGetArray(t,e,["normal","origin"],3),A2(t,e)}var z2=L.newInstance(Ev,"vtkPlane"),Dn=N2({newInstance:z2,extend:Ev},G2);function Ru(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function W2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ru(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ru(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ui=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function wv(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function or(t){return t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function zo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function xv(t){return zo(t,Ui)}function Oi(t){var e=Ct(t,6),r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5];return t[0]=r<(arguments.length<=1?void 0:arguments[1])?r:arguments.length<=1?void 0:arguments[1],t[1]=n>(arguments.length<=1?void 0:arguments[1])?n:arguments.length<=1?void 0:arguments[1],t[2]=a<(arguments.length<=2?void 0:arguments[2])?a:arguments.length<=2?void 0:arguments[2],t[3]=i>(arguments.length<=2?void 0:arguments[2])?i:arguments.length<=2?void 0:arguments[2],t[4]=s<(arguments.length<=3?void 0:arguments[3])?s:arguments.length<=3?void 0:arguments[3],t[5]=f>(arguments.length<=3?void 0:arguments[3])?f:arguments.length<=3?void 0:arguments[3],t}function Ov(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(var r=0;r<e.length;++r)Oi(t,e[r]);else for(var n=0;n<e.length;n+=3)Oi(t,e.slice(n,n+3));return t}function Mv(t,e,r,n,a,i,s){var f=Ct(t,6),o=f[0],u=f[1],g=f[2],c=f[3],l=f[4],h=f[5];return s===void 0?(t[0]=Math.min(e[0],o),t[1]=Math.max(e[1],u),t[2]=Math.min(e[2],g),t[3]=Math.max(e[3],c),t[4]=Math.min(e[4],l),t[5]=Math.max(e[5],h)):(t[0]=Math.min(e,o),t[1]=Math.max(r,u),t[2]=Math.min(n,g),t[3]=Math.max(a,c),t[4]=Math.min(i,l),t[5]=Math.max(s,h)),t}function Dv(t,e,r,n){var a=Ct(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],g=a[5];return t[0]=e,t[1]=e>s?e:s,t[2]=r,t[3]=r>o?r:o,t[4]=n,t[5]=n>g?n:g,i!==e||f!==r||u!==n}function mv(t,e,r,n){var a=Ct(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],g=a[5];return t[0]=e<i?e:i,t[1]=e,t[2]=r<f?r:f,t[3]=r,t[4]=n<u?n:u,t[5]=n,s!==e||o!==r||g!==n}function Rv(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function Wo(t,e,r,n){return or(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),r>=0?(t[2]*=r,t[3]*=r):(t[2]=r*t[3],t[3]=r*t[2]),n>=0?(t[4]*=n,t[5]*=n):(t[4]=n*t[5],t[5]=n*t[4]),!0):!1}function jo(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function j2(t,e,r,n){if(!or(t))return!1;var a=jo(t);return t[0]-=a[0],t[1]-=a[0],t[2]-=a[1],t[3]-=a[1],t[4]-=a[2],t[5]-=a[2],Wo(t,e,r,n),t[0]+=a[0],t[1]+=a[0],t[2]+=a[1],t[3]+=a[1],t[4]+=a[2],t[5]+=a[2],!0}function ra(t,e){return t[e*2+1]-t[e*2]}function Gi(t){return[ra(t,0),ra(t,1),ra(t,2)]}function Lv(t){return t.slice(0,2)}function Vv(t){return t.slice(2,4)}function _v(t){return t.slice(4,6)}function bv(t){var e=Gi(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function kv(t){if(or(t)){var e=Gi(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function $o(t){return[t[0],t[2],t[4]]}function Ho(t){return[t[1],t[3],t[5]]}function Pa(t,e){return t<=0&&e>=0||t>=0&&e<=0}function Fv(t,e){for(var r=0,n=0;n<2;n++)for(var a=2;a<4;a++)for(var i=4;i<6;i++)e[r]=[t[n],t[a],t[i]],r++;return e}function Bv(t,e,r){return e[0]=t[0],e[1]=t[2],e[2]=t[4],r[0]=t[1],r[1]=t[3],r[2]=t[5],e}function Nv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function Uv(t,e,r,n){for(var a=[].concat(Ui),i=t.getData(),s=0;s<i.length;s+=3){var f=[i[s],i[s+1],i[s+2]],o=Ee(f,e);a[0]=Math.min(o,a[0]),a[1]=Math.max(o,a[1]);var u=Ee(f,r);a[2]=Math.min(u,a[2]),a[3]=Math.max(u,a[3]);var g=Ee(f,n);a[4]=Math.min(g,a[4]),a[5]=Math.max(g,a[5])}return a}function Gv(t,e,r,n,a){for(var i=!0,s=[],f=0,o=[],u=[0,0,0],g=0,c=1,l=2,h=0;h<3;h++)e[h]<t[2*h]?(s[h]=c,u[h]=t[2*h],i=!1):e[h]>t[2*h+1]?(s[h]=g,u[h]=t[2*h+1],i=!1):s[h]=l;if(i)return n[0]=e[0],n[1]=e[1],n[2]=e[2],a[0]=0,1;for(var y=0;y<3;y++)s[y]!==l&&r[y]!==0?o[y]=(u[y]-e[y])/r[y]:o[y]=-1;for(var S=0;S<3;S++)o[f]<o[S]&&(f=S);if(o[f]>1||o[f]<0)return 0;a[0]=o[f];for(var T=0;T<3;T++)if(f!==T){if(n[T]=e[T]+o[f]*r[T],n[T]<t[2*T]||n[T]>t[2*T+1])return 0}else n[T]=u[T];return 1}function Av(t,e,r){for(var n=[],a=0,i=1,s=1,f=4;f<=5;++f){n[2]=t[f];for(var o=2;o<=3;++o){n[1]=t[o];for(var u=0;u<=1;++u)if(n[0]=t[u],a=Dn.evaluate(r,e,n),s&&(i=a>=0?1:-1,s=0),a===0||i>0&&a<0||i<0&&a>0)return 1}}return 0}function Pv(t,e){if(!(or(t)&&or(e)))return!1;for(var r=[0,0,0,0,0,0],n,a=0;a<3;a++)if(n=!1,e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]?(n=!0,r[a*2]=e[a*2]):t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]&&(n=!0,r[a*2]=t[a*2]),e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]?(n=!0,r[a*2+1]=e[2*a+1]):t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]&&(n=!0,r[a*2+1]=t[a*2+1]),!n)return!1;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],!0}function Mi(t,e){if(!(or(t)&&or(e)))return!1;for(var r=0;r<3;r++)if(!(e[r*2]>=t[r*2]&&e[r*2]<=t[r*2+1])&&!(t[r*2]>=e[r*2]&&t[r*2]<=e[r*2+1])&&!(e[r*2+1]>=t[r*2]&&e[r*2+1]<=t[r*2+1])&&!(t[r*2+1]>=e[r*2]&&t[r*2+1]<=e[r*2+1]))return!1;return!0}function Di(t,e,r,n){return!(e<t[0]||e>t[1]||r<t[2]||r>t[3]||n<t[4]||n>t[5])}function $2(t,e){return!(!Mi(t,e)||!Di.apply(void 0,[t].concat(Ce($o(e))))||!Di.apply(void 0,[t].concat(Ce(Ho(e)))))}function zv(t,e,r){for(var n=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0],i=0,s=0;s<2;s++)for(var f=2;f<4;f++)for(var o=4;o<6;o++){var u=[t[s],t[f],t[o]];a[i++]=Dn.evaluate(r,e,u)}for(var g=2;g--&&!(Pa(a[n[g][0]],a[n[g][4]])&&Pa(a[n[g][1]],a[n[g][5]])&&Pa(a[n[g][2]],a[n[g][6]])&&Pa(a[n[g][3]],a[n[g][7]])););if(g<0)return!1;for(var c=Math.sign(r[g]),l=Math.abs((t[g*2+1]-t[g*2])*r[g]),h=c>0?1:0,y=0;y<4;y++)if(l!==0){var S=Math.abs(a[n[g][y]])/l;c>0&&S<h&&(h=S),c<0&&S>h&&(h=S)}var T=(1-h)*t[g*2]+h*t[g*2+1];return c>0?t[g*2]=T:t[g*2+1]=T,!0}var H2=function(){function t(e){bo(this,t),this.bounds=e,this.bounds||(this.bounds=new Float64Array(Ui))}return ko(t,[{key:"getBounds",value:function(){return this.bounds}},{key:"equals",value:function(r){return wv(this.bounds,r)}},{key:"isValid",value:function(){return or(this.bounds)}},{key:"setBounds",value:function(r){return zo(this.bounds,r)}},{key:"reset",value:function(){return xv(this.bounds)}},{key:"addPoint",value:function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return Oi(this.bounds,n)}},{key:"addPoints",value:function(r){return Ov(this.bounds,r)}},{key:"addBounds",value:function(r,n,a,i,s,f){return Mv(this.bounds,r,n,a,i,s,f)}},{key:"setMinPoint",value:function(r,n,a){return Dv(this.bounds,r,n,a)}},{key:"setMaxPoint",value:function(r,n,a){return mv(this.bounds,r,n,a)}},{key:"inflate",value:function(r){return Rv(this.bounds,r)}},{key:"scale",value:function(r,n,a){return Wo(this.bounds,r,n,a)}},{key:"getCenter",value:function(){return jo(this.bounds)}},{key:"getLength",value:function(r){return ra(this.bounds,r)}},{key:"getLengths",value:function(){return Gi(this.bounds)}},{key:"getMaxLength",value:function(){return bv(this.bounds)}},{key:"getDiagonalLength",value:function(){return kv(this.bounds)}},{key:"getMinPoint",value:function(){return $o(this.bounds)}},{key:"getMaxPoint",value:function(){return Ho(this.bounds)}},{key:"getXRange",value:function(){return Lv(this.bounds)}},{key:"getYRange",value:function(){return Vv(this.bounds)}},{key:"getZRange",value:function(){return _v(this.bounds)}},{key:"getCorners",value:function(r){return Fv(this.bounds,r)}},{key:"computeCornerPoints",value:function(r,n){return Bv(this.bounds,r,n)}},{key:"computeLocalBounds",value:function(r,n,a){return Uv(this.bounds,r,n,a)}},{key:"computeScale3",value:function(r){return Nv(this.bounds,r)}},{key:"cutWithPlane",value:function(r,n){return zv(this.bounds,r,n)}},{key:"intersectBox",value:function(r,n,a,i){return Gv(this.bounds,r,n,a,i)}},{key:"intersectPlane",value:function(r,n){return Av(this.bounds,r,n)}},{key:"intersect",value:function(r){return Pv(this.bounds,r)}},{key:"intersects",value:function(r){return Mi(this.bounds,r)}},{key:"containsPoint",value:function(r,n,a){return Di(this.bounds,r,n,a)}},{key:"contains",value:function(r){return Mi(this.bounds,r)}}]),t}();function K2(t){var e=t&&t.bounds;return new H2(e)}var X2={equals:wv,isValid:or,setBounds:zo,reset:xv,addPoint:Oi,addPoints:Ov,addBounds:Mv,setMinPoint:Dv,setMaxPoint:mv,inflate:Rv,scale:Wo,scaleAboutCenter:j2,getCenter:jo,getLength:ra,getLengths:Gi,getMaxLength:bv,getDiagonalLength:kv,getMinPoint:$o,getMaxPoint:Ho,getXRange:Lv,getYRange:Vv,getZRange:_v,getCorners:Fv,computeCornerPoints:Bv,computeLocalBounds:Uv,computeScale3:Nv,cutWithPlane:zv,intersectBox:Gv,intersectPlane:Av,intersect:Pv,intersects:Mi,containsPoint:Di,contains:$2,INIT_BOUNDS:Ui},je=W2({newInstance:K2},X2),Y2={DISPLAY:0,WORLD:1},Wv={CoordinateSystem:Y2};function Lu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function I2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var vo=Wv.CoordinateSystem;function Vu(t){return function(){return L.vtkErrorMacro("vtkProp::".concat(t," - NOT IMPLEMENTED"))}}function q2(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=function(){for(var r=e.mtime,n=0;n<e.textures.length;++n){var a=e.textures[n].getMTime();a>r&&(r=a)}return r},t.processSelectorPixelBuffers=function(r,n){},t.getNestedProps=function(){return null},t.getActors=function(){return[]},t.getActors2D=function(){return[]},t.getVolumes=function(){return[]},t.pick=Vu("pick"),t.hasKey=Vu("hasKey"),t.getNestedVisibility=function(){return e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility())},t.getNestedPickable=function(){return e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable())},t.getNestedDragable=function(){return e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable())},t.getRedrawMTime=function(){return e.mtime},t.setEstimatedRenderTime=function(r){e.estimatedRenderTime=r,e.savedEstimatedRenderTime=r},t.restoreEstimatedRenderTime=function(){e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=function(r){e.estimatedRenderTime+=r},t.setAllocatedRenderTime=function(r){e.allocatedRenderTime=r,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=function(){return!1},t.getTextures=function(){return e.textures},t.hasTexture=function(r){return e.textures.indexOf(r)!==-1},t.addTexture=function(r){r&&!t.hasTexture(r)&&(e.textures=e.textures.concat(r),t.modified())},t.removeTexture=function(r){var n=e.textures.filter(function(a){return a!==r});e.textures.length!==n.length&&(e.textures=n,t.modified())},t.removeAllTextures=function(){e.textures=[],t.modified()},t.setCoordinateSystemToWorld=function(){return t.setCoordinateSystem(vo.WORLD)},t.setCoordinateSystemToDisplay=function(){return t.setCoordinateSystem(vo.DISPLAY)}}var Z2={allocatedRenderTime:10,coordinateSystem:vo.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function jv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Z2,r),L.obj(t,e),L.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),L.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),L.moveToProtected(t,e,["parentProp"]),q2(t,e)}var Q2=L.newInstance(jv,"vtkProp"),Sa=I2({newInstance:Q2,extend:jv},Wv);function J2(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=function(n){e.position=e.position.map(function(a,i){return a+n[i]}),t.modified()},t.getOrientationWXYZ=function(){var n=Ir();vg(n,e.rotation);var a=new Float64Array(3),i=cd(a,n);return[va(i),a[0],a[1],a[2]]},t.rotateX=function(n){n!==0&&(ig(e.rotation,e.rotation,Ke(n)),t.modified())},t.rotateY=function(n){n!==0&&(sg(e.rotation,e.rotation,Ke(n)),t.modified())},t.rotateZ=function(n){n!==0&&(og(e.rotation,e.rotation,Ke(n)),t.modified())},t.rotateWXYZ=function(n,a,i,s){if(!(n===0||a===0&&i===0&&s===0)){var f=Ke(n),o=Ir();_o(o,[a,i,s],f);var u=new Float64Array(16);Vo(u,o),St(e.rotation,e.rotation,u),t.modified()}},t.setOrientation=function(n,a,i){return n===e.orientation[0]&&a===e.orientation[1]&&i===e.orientation[2]?!1:(e.orientation=[n,a,i],De(e.rotation),t.rotateZ(i),t.rotateX(n),t.rotateY(a),t.modified(),!0)},t.setUserMatrix=function(n){ut(e.userMatrix,n),t.modified()},t.getMatrix=function(){return t.computeMatrix(),e.matrix},t.computeMatrix=function(){if(t.getMTime()>e.matrixMTime.getMTime()){De(e.matrix),e.userMatrix&&St(e.matrix,e.matrix,e.userMatrix),et(e.matrix,e.matrix,e.origin),et(e.matrix,e.matrix,e.position),St(e.matrix,e.matrix,e.rotation),sa(e.matrix,e.matrix,e.scale),et(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),ze(e.matrix,e.matrix),e.isIdentity=!0;for(var n=0;n<4;++n)for(var a=0;a<4;++a)(n===a?1:0)!==e.matrix[n+a*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=function(){return je.getCenter(e.bounds)},t.getLength=function(){return je.getLength(e.bounds)},t.getXRange=function(){return je.getXRange(e.bounds)},t.getYRange=function(){return je.getYRange(e.bounds)},t.getZRange=function(){return je.getZRange(e.bounds)},t.getUserMatrix=function(){return e.userMatrix};function r(){t.computeMatrix()}t.onModified(r)}var eS={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function $v(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,eS,r),Sa.extend(t,e,r),e.matrixMTime={},L.obj(e.matrixMTime),L.get(t,e,["bounds","isIdentity"]),L.getArray(t,e,["orientation"]),L.setGetArray(t,e,["origin","position","scale"],3),e.matrix=De(new Float64Array(16)),e.rotation=De(new Float64Array(16)),e.userMatrix=De(new Float64Array(16)),e.transform=null,J2(t,e)}var tS=L.newInstance($v,"vtkProp3D"),rS={newInstance:tS,extend:$v},Hv={FLAT:0,GOURAUD:1,PHONG:2},_t={POINTS:0,WIREFRAME:1,SURFACE:2},nS=Hv,Ko={Shading:Hv,Representation:_t,Interpolation:nS};function _u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function aS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_u(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_u(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Xn=Ko.Representation,Yn=Ko.Interpolation;function bu(t){return function(){return L.vtkErrorMacro("vtkProperty::".concat(t," - NOT IMPLEMENTED"))}}function iS(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=function(r,n,a){Array.isArray(r)?(e.color[0]!==r[0]||e.color[1]!==r[1]||e.color[2]!==r[2])&&(e.color[0]=r[0],e.color[1]=r[1],e.color[2]=r[2],t.modified()):(e.color[0]!==r||e.color[1]!==n||e.color[2]!==a)&&(e.color[0]=r,e.color[1]=n,e.color[2]=a,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=bu("ComputeCompositeColor"),t.getColor=function(){var r=0;e.ambient+e.diffuse+e.specular>0&&(r=1/(e.ambient+e.diffuse+e.specular));for(var n=0;n<3;n++)e.color[n]=r*(e.ambient*e.ambientColor[n]+e.diffuse*e.diffuseColor[n]+e.specular*e.specularColor[n]);return[].concat(e.color)},t.setSpecularPower=function(r){var n=1/Math.max(1,r);(e.roughness!==n||e.specularPower!==r)&&(e.specularPower=r,e.roughness=n,t.modified())},t.addShaderVariable=bu("AddShaderVariable"),t.setInterpolationToFlat=function(){return t.setInterpolation(Yn.FLAT)},t.setInterpolationToGouraud=function(){return t.setInterpolation(Yn.GOURAUD)},t.setInterpolationToPhong=function(){return t.setInterpolation(Yn.PHONG)},t.getInterpolationAsString=function(){return L.enumToString(Yn,e.interpolation)},t.setRepresentationToWireframe=function(){return t.setRepresentation(Xn.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(Xn.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(Xn.POINTS)},t.getRepresentationAsString=function(){return L.enumToString(Xn,e.representation)}}var sS={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:Yn.GOURAUD,representation:Xn.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function Kv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sS,r),L.obj(t,e),L.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),L.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),iS(t,e)}var oS=L.newInstance(Kv,"vtkProperty"),Ln=aS({newInstance:oS,extend:Kv},Ko);function ku(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ku(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ku(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var uS=L.vtkDebugMacro;function cS(t,e){e.classHierarchy.push("vtkActor");var r=fS({},t);t.getActors=function(){return[t]},t.getIsOpaque=function(){if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();var n=e.property.getOpacity()>=1;return n=n&&(!e.texture||!e.texture.isTranslucent()),n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=function(){return e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque())},t.makeProperty=Ln.newInstance,t.getProperty=function(){return e.property===null&&(e.property=t.makeProperty()),e.property},t.getBounds=function(){if(e.mapper===null)return e.bounds;var n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;if(!e.mapperBounds||n[0]!==e.mapperBounds[0]||n[1]!==e.mapperBounds[1]||n[2]!==e.mapperBounds[2]||n[3]!==e.mapperBounds[3]||n[4]!==e.mapperBounds[4]||n[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){uS("Recomputing bounds..."),e.mapperBounds=n.concat();var a=[];je.getCorners(n,a),t.computeMatrix();var i=new Float64Array(16);ze(i,e.matrix),a.forEach(function(s){return me(s,s,i)}),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map(function(s,f){return f%2===0?a.reduce(function(o,u){return o>u[f/2]?u[f/2]:o},s):a.reduce(function(o,u){return o<u[(f-1)/2]?u[(f-1)/2]:o},s)}),e.boundsMTime.modified()}return e.bounds},t.getMTime=function(){var n=r.getMTime();if(e.property!==null){var a=e.property.getMTime();n=a>n?a:n}if(e.backfaceProperty!==null){var i=e.backfaceProperty.getMTime();n=i>n?i:n}return n},t.getRedrawMTime=function(){var n=e.mtime;if(e.mapper!==null){var a=e.mapper.getMTime();n=a>n?a:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),a=e.mapper.getInput().getMTime(),n=a>n?a:n)}return n},t.getSupportsSelection=function(){return e.mapper?e.mapper.getSupportsSelection():!1},t.processSelectorPixelBuffers=function(n,a){e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(n,a)}}var gS={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function Xv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gS,r),rS.extend(t,e,r),e.boundsMTime={},L.obj(e.boundsMTime),L.set(t,e,["property"]),L.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),cS(t,e)}var vS=L.newInstance(Xv,"vtkActor"),Mr={newInstance:vS,extend:Xv},Yv={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Dr={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},lS=Dr.FLOAT,Iv={DefaultDataType:lS,DataTypeByteSize:Yv,VtkDataTypes:Dr};function Fu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function mi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var pS=ge,hS=Iv.DefaultDataType;function lo(t,e,r){var n=t.length,a,i,s,f;if(n===0)return{min:Number.MAX_VALUE,max:-Number.MAX_VALUE};for(a=t[e],i=a,f=e;f<n;f+=r)s=t[f],s<a?a=s:s>i&&(i=s);return{min:a,max:i}}function yS(){var t=Number.MAX_VALUE,e=-Number.MAX_VALUE,r=0,n=0;return{add:function(i){t>i&&(t=i),e<i&&(e=i),r++,n+=i},get:function(){return{min:t,max:e,count:r,sum:n,mean:n/r}},getRange:function(){return{min:t,max:e}}}}function qv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&r>1){for(var n=t.length,a=n/r,i=new Float64Array(a),s=0,f=0;s<a;++s){for(var o,u=f+r;f<u;++f)i[s]+=t[f]*t[f];o=s,i[o]=Math.pow(i[o],.5)}return lo(i,0,1)}return lo(t,e<0?0:e,r)}function Bu(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t||[];r.length<=e;)r.push(null);return r}function Xo(t){return Object.prototype.toString.call(t).slice(8,-1)}function dS(t){for(var e=t.getNumberOfComponents(),r=0,n=new Array(e),a=0;a<t.getNumberOfTuples();++a){t.getTuple(a,n);var i=ta(n,e);i>r&&(r=i)}return r}var TS={computeRange:qv,createRangeHelper:yS,fastComputeRange:lo,getDataType:Xo,getMaxNorm:dS};function SS(t,e){e.classHierarchy.push("vtkDataArray");function r(){e.ranges=null,t.modified()}function n(a){if(a<0)return!1;var i=t.getNumberOfComponents(),s=e.values.length/(i>0?i:1);if(a===s)return!0;if(a>s){var f=e.values;return e.values=ya(e.dataType,(a+s)*i),e.values.set(f),!0}return e.size=a*i,r(),!0}t.initialize=function(){n(0)},t.getElementComponentSize=function(){return e.values.BYTES_PER_ELEMENT},t.getComponent=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[a*e.numberOfComponents+i]},t.setComponent=function(a,i,s){s!==e.values[a*e.numberOfComponents+i]&&(e.values[a*e.numberOfComponents+i]=s,r())},t.getValue=function(a){var i=a/e.numberOfComponents,s=a%e.numberOfComponents;return t.getComponent(i,s)},t.setValue=function(a,i){var s=a/e.numberOfComponents,f=a%e.numberOfComponents;t.setComponent(s,f,i)},t.getData=function(){return e.size===e.values.length?e.values:e.values.subarray(0,e.size)},t.getRange=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=a<0?e.numberOfComponents:a,s=null;return e.ranges||(e.ranges=Bu(e.ranges,e.numberOfComponents)),s=e.ranges[i],s?(e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple):(s=qv(t.getData(),a,e.numberOfComponents),e.ranges[i]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple)},t.setRange=function(a,i){e.ranges||(e.ranges=Bu(e.ranges,e.numberOfComponents));var s={min:a.min,max:a.max};return e.ranges[i]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple},t.setTuple=function(a,i){for(var s=a*e.numberOfComponents,f=0;f<e.numberOfComponents;f++)e.values[s+f]=i[f]},t.setTuples=function(a,i){for(var s=a*e.numberOfComponents,f=Math.min(i.length,e.size-s),o=0;o<f;)e.values[s++]=i[o++]},t.insertTuple=function(a,i){return e.size<=a*e.numberOfComponents&&(e.size=(a+1)*e.numberOfComponents,n(a+1)),t.setTuple(a,i),a},t.insertTuples=function(a,i){var s=a+i.length/e.numberOfComponents;return e.size<s*e.numberOfComponents&&(e.size=s*e.numberOfComponents,n(s)),t.setTuples(a,i),s},t.insertNextTuple=function(a){var i=e.size/e.numberOfComponents;return t.insertTuple(i,a)},t.insertNextTuples=function(a){var i=e.size/e.numberOfComponents;return t.insertTuples(i,a)},t.getTuple=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=e.numberOfComponents||1,f=a*s;switch(s){case 4:i[3]=e.values[f+3];case 3:i[2]=e.values[f+2];case 2:i[1]=e.values[f+1];case 1:i[0]=e.values[f];break;default:for(var o=s-1;o>=0;--o)i[o]=e.values[f+o]}return i},t.getTuples=function(a,i){var s=(a!=null?a:0)*e.numberOfComponents,f=(i!=null?i:t.getNumberOfTuples())*e.numberOfComponents,o=t.getData().subarray(s,f);return o.length>0?o:null},t.getTupleLocation=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return a*e.numberOfComponents},t.getNumberOfComponents=function(){return e.numberOfComponents},t.getNumberOfValues=function(){return e.size},t.getNumberOfTuples=function(){return e.size/e.numberOfComponents},t.getDataType=function(){return e.dataType},t.newClone=function(){return Qv({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents})},t.getName=function(){return e.name||(t.modified(),e.name="vtkDataArray".concat(t.getMTime())),e.name},t.setData=function(a,i){e.values=a,e.size=a.length,e.dataType=Xo(a),i&&(e.numberOfComponents=i),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),r()},t.getState=function(){if(e.deleted)return null;var a=mi(mi({},e),{},{vtkClass:t.getClassName()});a.values=Array.from(a.values),delete a.buffer,Object.keys(a).forEach(function(s){a[s]||delete a[s]});var i={};return Object.keys(a).sort().forEach(function(s){i[s]=a[s]}),i.mtime&&delete i.mtime,i},t.deepCopy=function(a){t.shallowCopy(a),t.setData(a.getData().slice())},t.interpolateTuple=function(a,i,s,f,o,u){var g=e.numberOfComponents||1;(g!==i.getNumberOfComponents()||g!==f.getNumberOfComponents())&&pS("numberOfComponents must match");var c=i.getTuple(s),l=f.getTuple(o),h=[];switch(h.length=g,g){case 4:h[3]=c[3]+(l[3]-c[3])*u;case 3:h[2]=c[2]+(l[2]-c[2])*u;case 2:h[1]=c[1]+(l[1]-c[1])*u;case 1:h[0]=c[0]+(l[0]-c[0])*u;break;default:for(var y=0;y<g;y++)h[y]=c[y]+(l[y]-c[y])*u}return t.insertTuple(a,h)}}var CS={name:"",numberOfComponents:1,dataType:hS,rangeTuple:[0,0]};function Zv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,CS,r),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=Ng(e.dataType,e.values)):e.values=ya(e.dataType,e.size),e.values){var n;e.size=(n=e.size)!==null&&n!==void 0?n:e.values.length,e.dataType=Xo(e.values)}yt(t,e),Bi(t,e,["name","numberOfComponents"]),SS(t,e)}var Qv=Ue(Zv,"vtkDataArray"),Ne=mi(mi({newInstance:Qv,extend:Zv},TS),Iv);function ES(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=function(){t.getInputData()},t.addClippingPlane=function(r){return r.isA("vtkPlane")?e.clippingPlanes.includes(r)?!1:(e.clippingPlanes.push(r),t.modified(),!0):!1},t.getNumberOfClippingPlanes=function(){return e.clippingPlanes.length},t.removeAllClippingPlanes=function(){return e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0)},t.removeClippingPlane=function(r){var n=e.clippingPlanes.indexOf(r);return n===-1?!1:(e.clippingPlanes.splice(n,1),t.modified(),!0)},t.getClippingPlanes=function(){return e.clippingPlanes},t.setClippingPlanes=function(r){if(!!r)if(!Array.isArray(r))t.addClippingPlane(r);else for(var n=r.length,a=0;a<n&&a<6;a++)t.addClippingPlane(r[a])},t.getClippingPlaneInDataCoords=function(r,n,a){var i=e.clippingPlanes,s=r;if(i){var f=i.length;if(n>=0&&n<f){var o=i[n],u=o.getNormal(),g=o.getOrigin(),c=u[0],l=u[1],h=u[2],y=-(c*g[0]+l*g[1]+h*g[2]);a[0]=c*s[0]+l*s[4]+h*s[8]+y*s[12],a[1]=c*s[1]+l*s[5]+h*s[9]+y*s[13],a[2]=c*s[2]+l*s[6]+h*s[10]+y*s[14],a[3]=c*s[3]+l*s[7]+h*s[11]+y*s[15];return}}L.vtkErrorMacro("Clipping plane index ".concat(n," is out of range."))}}var wS={clippingPlanes:[]};function xS(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wS,r),L.obj(t,e),L.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),ES(t,e)}var Jv={extend:xS};function OS(t,e){t.getBounds=function(){return 0},t.getBounds=function(r){t.getBounds();for(var n=0;n<6;n++)r[n]=e.bounds[n]},t.getCenter=function(){t.getBounds();for(var r=0;r<3;r++)e.center[r]=(e.bounds[2*r+1]+e.bounds[2*r])/2;return e.center.slice()},t.getLength=function(){var r=0,n=0;t.getBounds();for(var a=0;a<3;a++)r=e.bounds[2*a+1]-e.bounds[2*a],n+=r*r;return Math.sqrt(n)}}var MS={bounds:[1,-1,1,-1,1,-1],center:[0,0,0]};function DS(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MS,r),Jv.extend(t,e,r),e.bounds||Ni(e.bounds),e.center||(e.center=[0,0,0]),OS(t,e)}var mS={extend:DS},Nu=L.vtkErrorMacro,RS=L.vtkWarningMacro;function LS(t,e){e.classHierarchy.push("vtkFieldData");var r=t.getState;e.arrays&&(e.arrays=e.arrays.map(function(n){return{data:Wt(n.data)}})),t.initialize=function(){t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=function(){e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=function(n){t.initializeFields(),e.copyFieldFlags=n.getCopyFieldFlags().map(function(a){return a}),e.arrays=n.arrays().map(function(a){return{array:a}})},t.getNumberOfArrays=function(){return e.arrays.length},t.getNumberOfActiveArrays=function(){return e.arrays.length},t.addArray=function(n){var a=n.getName(),i=t.getArrayWithIndex(a),s=i.array,f=i.index;return s!=null?(e.arrays[f]={data:n},f):(e.arrays=[].concat(e.arrays,{data:n}),e.arrays.length-1)},t.removeAllArrays=function(){e.arrays=[]},t.removeArray=function(n){e.arrays=e.arrays.filter(function(a){return n!==a.data.getName()})},t.removeArrayByIndex=function(n){e.arrays=e.arrays.filter(function(a,i){return i!==n})},t.getArrays=function(){return e.arrays.map(function(n){return n.data})},t.getArray=function(n){return typeof n=="number"?t.getArrayByIndex(n):t.getArrayByName(n)},t.getArrayByName=function(n){return e.arrays.reduce(function(a,i,s){return i.data.getName()===n?i.data:a},null)},t.getArrayWithIndex=function(n){return e.arrays.reduce(function(a,i,s){return i.data&&i.data.getName()===n?{array:i.data,index:s}:a},{array:null,index:-1})},t.getArrayByIndex=function(n){return n>=0&&n<e.arrays.length?e.arrays[n].data:null},t.hasArray=function(n){return t.getArrayWithIndex(n).index>=0},t.getArrayName=function(n){var a=e.arrays[n];return a?a.data.getName():""},t.getCopyFieldFlags=function(){return e.copyFieldFlags},t.getFlag=function(n){return e.copyFieldFlags[n]},t.passData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;n.getArrays().forEach(function(s){var f=t.getFlag(s.getName());if(f!==!1&&!(e.doCopyAllOff&&f!==!0)&&s){var o=t.getArrayByName(s.getName());if(o)if(s.getNumberOfComponents()===o.getNumberOfComponents())if(a>-1&&a<s.getNumberOfTuples()){var l=i>-1?i:a;o.insertTuple(l,s.getTuple(a))}else o.insertTuples(0,s.getTuples());else Nu("Unhandled case in passData");else if(a<0||a>s.getNumberOfTuples())t.addArray(s),n.getAttributes(s).forEach(function(h){t.setAttribute(s,h)});else{var u=s.getNumberOfComponents(),g=s.getNumberOfValues(),c=i>-1?i:a;g<=c*u&&(g=(c+1)*u),o=Ne.newInstance({name:s.getName(),dataType:s.getDataType(),numberOfComponents:u,values:L.newTypedArray(s.getDataType(),g),size:0}),o.insertTuple(c,s.getTuple(a)),t.addArray(o),n.getAttributes(s).forEach(function(h){t.setAttribute(o,h)})}}})},t.interpolateData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;n.getArrays().forEach(function(o){var u=t.getFlag(o.getName());if(u!==!1&&!(e.doCopyAllOff&&u!==!0)&&o){var g=t.getArrayByName(o.getName());if(g)if(o.getNumberOfComponents()===g.getNumberOfComponents())if(a>-1&&a<o.getNumberOfTuples()){var y=s>-1?s:a;g.interpolateTuple(y,o,a,o,i,f),RS("Unexpected case in interpolateData")}else g.insertTuples(o.getTuples());else Nu("Unhandled case in interpolateData");else if(a<0||i<0||a>o.getNumberOfTuples())t.addArray(o),n.getAttributes(o).forEach(function(S){t.setAttribute(o,S)});else{var c=o.getNumberOfComponents(),l=o.getNumberOfValues(),h=s>-1?s:a;l<=h*c&&(l=(h+1)*c),g=Ne.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:c,values:L.newTypedArray(o.getDataType(),l),size:0}),g.interpolateTuple(h,o,a,o,i,f),t.addArray(g),n.getAttributes(o).forEach(function(S){t.setAttribute(g,S)})}}})},t.copyFieldOn=function(n){e.copyFieldFlags[n]=!0},t.copyFieldOff=function(n){e.copyFieldFlags[n]=!1},t.copyAllOn=function(){(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=function(){(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=function(){e.copyFieldFlags={}},t.deepCopy=function(n){e.arrays=n.getArrays().map(function(a){var i=a.newClone();return i.deepCopy(a),{data:i}})},t.copyFlags=function(n){return n.getCopyFieldFlags().map(function(a){return a})},t.reset=function(){return e.arrays.forEach(function(n){return n.data.reset()})},t.getMTime=function(){return e.arrays.reduce(function(n,a){return a.data.getMTime()>n?a.data.getMTime():n},e.mtime)},t.getNumberOfComponents=function(){return e.arrays.reduce(function(n,a){return n+a.data.getNumberOfComponents()},0)},t.getNumberOfTuples=function(){return e.arrays.length>0?e.arrays[0].getNumberOfTuples():0},t.getState=function(){var n=r();return n&&(n.arrays=e.arrays.map(function(a){return{data:a.data.getState()}})),n}}var VS={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function el(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VS,r),L.obj(t,e),LS(t,e)}var _S=L.newInstance(el,"vtkFieldData"),bS={newInstance:_S,extend:el},kS={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},FS={MAX:0,EXACT:1,NOLIMIT:2},BS={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},NS={DUPLICATEPOINT:1,HIDDENPOINT:2},US={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},GS="vtkGhostType",AS={DEFAULT:0,SINGLE:1,DOUBLE:2},Yo={AttributeCopyOperations:US,AttributeLimitTypes:FS,AttributeTypes:kS,CellGhostTypes:BS,DesiredOutputPrecision:AS,PointGhostTypes:NS,ghostArrayName:GS};function Uu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function PS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var gr=Yo.AttributeTypes,Br=Yo.AttributeCopyOperations,za=L.vtkWarningMacro;function zS(t,e){var r=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function n(i){var s=r.find(function(f){return gr[f.toUpperCase()]===i||typeof i!="number"&&f.toLowerCase()===i.toLowerCase()});return typeof s>"u"&&(s=null),s}e.classHierarchy.push("vtkDataSetAttributes"),t.checkNumberOfComponents=function(i){return!0},t.setAttribute=function(i,s){var f=n(s);if(i&&f.toUpperCase()==="PEDIGREEIDS"&&!i.isA("vtkDataArray"))return za("Cannot set attribute ".concat(f,". The attribute must be a vtkDataArray.")),-1;if(i&&!t.checkNumberOfComponents(i,f))return za("Cannot set attribute ".concat(f,". Incorrect number of components.")),-1;var o=e["active".concat(f)];if(o>=0&&o<e.arrays.length){if(e.arrays[o]===i)return o;t.removeArrayByIndex(o)}return i?(o=t.addArray(i),e["active".concat(f)]=o):e["active".concat(f)]=-1,t.modified(),e["active".concat(f)]},t.getAttributes=function(i){return r.filter(function(s){return t["get".concat(s)]()===i})},t.setActiveAttributeByName=function(i,s){return t.setActiveAttributeByIndex(t.getArrayWithIndex(i).index,s)},t.setActiveAttributeByIndex=function(i,s){var f=n(s);if(i>=0&&i<e.arrays.length){if(f.toUpperCase()!=="PEDIGREEIDS"){var o=t.getArrayByIndex(i);if(!o.isA("vtkDataArray"))return za("Cannot set attribute ".concat(f,". Only vtkDataArray subclasses can be set as active attributes.")),-1;if(!t.checkNumberOfComponents(o,f))return za("Cannot set attribute ".concat(f,". Incorrect number of components.")),-1}return e["active".concat(f)]=i,t.modified(),i}return i===-1&&(e["active".concat(f)]=i,t.modified()),-1},t.getActiveAttribute=function(i){var s=n(i);return t["get".concat(s)]()},t.removeAllArrays=function(){e.arrays=[],r.forEach(function(i){e["active".concat(i)]=-1})},t.removeArray=function(i){e.arrays=e.arrays.filter(function(s,f){return i===s.data.getName()?(r.forEach(function(o){f===e["active".concat(o)]&&(e["active".concat(o)]=-1)}),!1):!0})},t.removeArrayByIndex=function(i){e.arrays=e.arrays.filter(function(s,f){return f!==i}),r.forEach(function(s){i===e["active".concat(s)]&&(e["active".concat(s)]=-1)})},r.forEach(function(i){var s="active".concat(i);t["get".concat(i)]=function(){return t.getArrayByIndex(e[s])},t["set".concat(i)]=function(f){return t.setAttribute(f,i)},t["setActive".concat(i)]=function(f){return t.setActiveAttributeByIndex(t.getArrayWithIndex(f).index,i)},t["copy".concat(i,"Off")]=function(){var f=i.toUpperCase();e.copyAttributeFlags[Br.PASSDATA][gr[f]]=!1},t["copy".concat(i,"On")]=function(){var f=i.toUpperCase();e.copyAttributeFlags[Br.PASSDATA][gr[f]]=!0}}),t.initializeAttributeCopyFlags=function(){e.copyAttributeFlags=[],Object.keys(Br).filter(function(i){return i!=="ALLCOPY"}).forEach(function(i){e.copyAttributeFlags[Br[i]]=Object.keys(gr).filter(function(s){return s!=="NUM_ATTRIBUTES"}).reduce(function(s,f){return s[gr[f]]=!0,s},[])}),e.copyAttributeFlags[Br.COPYTUPLE][gr.GLOBALIDS]=!1,e.copyAttributeFlags[Br.INTERPOLATE][gr.GLOBALIDS]=!1,e.copyAttributeFlags[Br.COPYTUPLE][gr.PEDIGREEIDS]=!1},t.initialize=L.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(function(i){!e.dataArrays[i].ref&&e.dataArrays[i].type==="vtkDataArray"&&t.addArray(Ne.newInstance(e.dataArrays[i]))});var a=t.shallowCopy;t.shallowCopy=function(i,s){a(i,s),e.arrays=i.getArrays().map(function(f){var o=f.newClone();return o.shallowCopy(f,s),{data:o}})},t.initializeAttributeCopyFlags()}var WS={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function tl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WS,r),bS.extend(t,e,r),L.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),zS(t,e)}var jS=L.newInstance(tl,"vtkDataSetAttributes"),Gu=PS({newInstance:jS,extend:tl},Yo),$S={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},HS={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7},KS={FieldDataTypes:$S,FieldAssociations:HS};function Au(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function XS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Au(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Au(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var po=["pointData","cellData","fieldData"];function YS(t,e){e.classHierarchy.push("vtkDataSet"),po.forEach(function(n){e[n]?e[n]=Wt(e[n]):e[n]=Gu.newInstance()});var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),po.forEach(function(i){e[i]=Gu.newInstance(),e[i].shallowCopy(n.getReferenceByName(i))})}}var IS={};function rl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IS,r),L.obj(t,e),L.setGet(t,e,po),YS(t,e)}var qS=L.newInstance(rl,"vtkDataSet"),Vn=XS({newInstance:qS,extend:rl},KS),Nt={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9},nl={StructuredType:Nt};function Pu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ZS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var tr=nl.StructuredType;function QS(t){for(var e=0,r=0;r<3;++r)t[r*2]<t[r*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?tr.EMPTY:e===3?tr.XYZ_GRID:e===2?t[0]===t[1]?tr.YZ_PLANE:t[2]===t[3]?tr.XZ_PLANE:tr.XY_PLANE:e===1?t[0]<t[1]?tr.X_LINE:t[2]<t[3]?tr.Y_LINE:tr.Z_LINE:tr.SINGLE_POINT}var JS=ZS({getDataDescriptionFromExtent:QS},nl),vr=L.vtkErrorMacro;function eC(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return vr("instance deleted - cannot call any method"),!1;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.length===1?n[0]:n;if(i.length!==6)return!1;var s=e.extent.some(function(f,o){return f!==i[o]});return s&&(e.extent=i.slice(),e.dataDescription=JS.getDataDescriptionFromExtent(e.extent),t.modified()),s},t.setDimensions=function(){var r,n,a;if(e.deleted){vr("instance deleted - cannot call any method");return}if(arguments.length===1){var i=arguments.length<=0?void 0:arguments[0];r=i[0],n=i[1],a=i[2]}else if(arguments.length===3)r=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],a=arguments.length<=2?void 0:arguments[2];else{vr("Bad dimension specification");return}t.setExtent(0,r-1,0,n-1,0,a-1)},t.getDimensions=function(){return[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1]},t.getNumberOfCells=function(){for(var r=t.getDimensions(),n=1,a=0;a<3;a++){if(r[a]===0)return 0;r[a]>1&&(n*=r[a]-1)}return n},t.getNumberOfPoints=function(){var r=t.getDimensions();return r[0]*r[1]*r[2]},t.getPoint=function(r){var n=t.getDimensions();if(n[0]===0||n[1]===0||n[2]===0)return vr("Requesting a point from an empty image."),null;var a=new Float64Array(3);switch(e.dataDescription){case Nt.EMPTY:return null;case Nt.SINGLE_POINT:break;case Nt.X_LINE:a[0]=r;break;case Nt.Y_LINE:a[1]=r;break;case Nt.Z_LINE:a[2]=r;break;case Nt.XY_PLANE:a[0]=r%n[0],a[1]=r/n[0];break;case Nt.YZ_PLANE:a[1]=r%n[1],a[2]=r/n[1];break;case Nt.XZ_PLANE:a[0]=r%n[0],a[2]=r/n[0];break;case Nt.XYZ_GRID:a[0]=r%n[0],a[1]=r/n[0]%n[1],a[2]=r/(n[0]*n[1]);break;default:vr("Invalid dataDescription");break}var i=[0,0,0];return t.indexToWorld(a,i),i},t.getBounds=function(){return t.extentToBounds(t.getSpatialExtent())},t.extentToBounds=function(r){for(var n=[[r[0],r[2],r[4]],[r[1],r[2],r[4]],[r[0],r[3],r[4]],[r[1],r[3],r[4]],[r[0],r[2],r[5]],[r[1],r[2],r[5]],[r[0],r[3],r[5]],[r[1],r[3],r[5]]],a=Ce(je.INIT_BOUNDS),i=[],s=0;s<8;++s)t.indexToWorld(n[s],i),je.addPoint.apply(je,[a].concat(i));return a},t.getSpatialExtent=function(){return je.inflate(Ce(e.extent),.5)},t.computeTransforms=function(){fg(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],sa(e.indexToWorld,e.indexToWorld,e.spacing),xt(e.worldToIndex,e.indexToWorld)},t.setDirection=function(){if(e.deleted)return vr("instance deleted - cannot call any method"),!1;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n;if(i.length===1&&(Array.isArray(i[0])||i[0].constructor===Float32Array||i[0].constructor===Float64Array)&&(i=i[0]),i.length!==9)throw new RangeError("Invalid number of values for array setter");var s=!1;if(e.direction.forEach(function(o,u){if(o!==i[u]){if(s)return;s=!0}}),s){for(var f=0;f<9;++f)e.direction[f]=i[f];t.modified()}return!0},t.indexToWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return me(n,r,e.indexToWorld),n},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return me(n,r,e.worldToIndex),n},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[0,0,0],i=[0,0,0];je.computeCornerPoints(r,a,i);var s=[0,0,0],f=[0,0,0];return me(s,a,e.indexToWorld),me(f,i,e.indexToWorld),Mu(s,f,n)},t.worldToIndexBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[0,0,0],i=[0,0,0];je.computeCornerPoints(r,a,i);var s=[0,0,0],f=[0,0,0];return me(s,a,e.worldToIndex),me(f,i,e.worldToIndex),Mu(s,f,n)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=function(){return je.getCenter(t.getBounds())},t.computeHistogram=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=[0,0,0,0,0,0];t.worldToIndexBounds(r,a);var i=[0,0,0],s=[0,0,0];je.computeCornerPoints(a,i,s),Ou(i,i),Ou(s,s);var f=t.getDimensions();Du(i,[0,0,0],[f[0]-1,f[1]-1,f[2]-1],i),Du(s,[0,0,0],[f[0]-1,f[1]-1,f[2]-1],s);for(var o=f[0],u=f[0]*f[1],g=t.getPointData().getScalars().getData(),c=-1/0,l=1/0,h=0,y=0,S=0,T=i[2];T<=s[2];T++)for(var E=i[1];E<=s[1];E++)for(var x=i[0]+E*o+T*u,w=i[0];w<=s[0];w++){if(!n||n([w,E,T],a)){var C=g[x];C>c&&(c=C),C<l&&(l=C),h+=C*C,y+=C,S+=1}++x}var m=S>0?y/S:0,D=S?Math.abs(h/S-m*m):0,b=Math.sqrt(D);return{minimum:l,maximum:c,average:m,variance:D,sigma:b,count:S}},t.computeIncrements=function(r){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=[],i=n,s=0;s<3;++s)a[s]=i,i*=r[s*2+1]-r[s*2]+1;return a},t.computeOffsetIndex=function(r){var n=Ct(r,3),a=n[0],i=n[1],s=n[2],f=t.getExtent(),o=t.getPointData().getScalars().getNumberOfComponents(),u=t.computeIncrements(f,o);return Math.floor((Math.round(a)-f[0])*u[0]+(Math.round(i)-f[2])*u[1]+(Math.round(s)-f[4])*u[2])},t.getOffsetIndexFromWorld=function(r){for(var n=t.getExtent(),a=t.worldToIndex(r),i=0;i<3;++i)if(a[i]<n[i*2]||a[i]>n[i*2+1])return vr("GetScalarPointer: Pixel ".concat(a," is not in memory. Current extent = ").concat(n)),NaN;return t.computeOffsetIndex(a)},t.getScalarValueFromWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=t.getPointData().getScalars().getNumberOfComponents();if(n<0||n>=a)return vr("GetScalarPointer: Scalar Component ".concat(n," is not within bounds. Current Scalar numberOfComponents: ").concat(a)),NaN;var i=t.getOffsetIndexFromWorld(r);return Number.isNaN(i)?i:t.getPointData().getScalars().getComponent(i,n)}}var tC={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Nt.EMPTY};function al(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tC,r),Vn.extend(t,e,r),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=Qr(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),L.get(t,e,["direction","indexToWorld","worldToIndex"]),L.setGetArray(t,e,["origin","spacing"],3),L.getArray(t,e,["extent"],6),eC(t,e)}var rC=L.newInstance(al,"vtkImageData"),nC={newInstance:rC,extend:al},aC={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},ho={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4},Ai={VectorMode:aC,ScalarMappingTarget:ho},iC={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},sC={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},oC={BY_ID:0,BY_NAME:1},Lr={ColorMode:iC,GetArray:oC,ScalarMode:sC};function zu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function fC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Wu=Ai.ScalarMappingTarget,Yt=Ai.VectorMode,on=Ne.VtkDataTypes,ju=Lr.ColorMode,$u=L.vtkErrorMacro;function uC(t){return t}function Hu(t){return Math.floor(t*255+.5)}function cC(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=function(){return t.setVectorMode(Yt.MAGNITUDE)},t.setVectorModeToComponent=function(){return t.setVectorMode(Yt.COMPONENT)},t.setVectorModeToRGBColors=function(){return t.setVectorMode(Yt.RGBCOLORS)},t.build=function(){},t.isOpaque=function(){return!0},t.setAnnotations=function(r,n){if(!(r&&!n||!r&&n)){if(r&&n&&r.length!==n.length){$u("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],n&&r)for(var a=n.length,i=0;i<a;i++)e.annotationArray.push({value:r[i],annotation:String(n[i])});t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=function(r,n){var a=t.checkForAnnotatedValue(r),i=!1;return a>=0?e.annotationArray[a].annotation!==n&&(e.annotationArray[a].annotation=n,i=!0):(e.annotationArray.push({value:r,annotation:n}),a=e.annotationArray.length-1,i=!0),i&&(t.updateAnnotatedValueMap(),t.modified()),a},t.getNumberOfAnnotatedValues=function(){return e.annotationArray.length},t.getAnnotatedValue=function(r){return r<0||r>=e.annotationArray.length?null:e.annotationArray[r].value},t.getAnnotation=function(r){return e.annotationArray[r]===void 0?null:e.annotationArray[r].annotation},t.getAnnotatedValueIndex=function(r){return e.annotationArray.length?t.checkForAnnotatedValue(r):-1},t.removeAnnotation=function(r){var n=t.checkForAnnotatedValue(r),a=n>=0;return a&&(e.annotationArray.splice(n,1),t.updateAnnotatedValueMap(),t.modified()),a},t.resetAnnotations=function(){e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=function(r,n){if(e.indexedLookup){var a=t.getAnnotatedValueIndex(r);t.getIndexedColor(a,n)}else t.getColor(parseFloat(r),n),n[3]=1},t.checkForAnnotatedValue=function(r){return t.getAnnotatedValueIndexInternal(r)},t.getAnnotatedValueIndexInternal=function(r){if(e.annotatedValueMap[r]!==void 0){var n=e.annotationArray.length;return e.annotatedValueMap[r]%n}return-1},t.getIndexedColor=function(r,n){n[0]=0,n[1]=0,n[2]=0,n[3]=0},t.updateAnnotatedValueMap=function(){e.annotatedValueMap=[];for(var r=e.annotationArray.length,n=0;n<r;n++)e.annotatedValueMap[e.annotationArray[n].value]=n},t.mapScalars=function(r,n,a){var i=r.getNumberOfComponents(),s=null;if(n===ju.DEFAULT&&r.getDataType()===on.UNSIGNED_CHAR||n===ju.DIRECT_SCALARS&&r)s=t.convertToRGBA(r,i,r.getNumberOfTuples());else{var f={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:on.UNSIGNED_CHAR},o=L.newTypedArray(f.dataType,4*r.getNumberOfTuples());f.values=o,f.size=o.length,s=Ne.newInstance(f);var u=a;u<0&&i>1?t.mapVectorsThroughTable(r,s,Wu.RGBA,-1,-1):(u<0&&(u=0),u>=i&&(u=i-1),t.mapScalarsThroughTable(r,s,Wu.RGBA,u))}return s},t.mapVectorsToMagnitude=function(r,n,a){for(var i=r.getNumberOfTuples(),s=r.getNumberOfComponents(),f=n.getData(),o=r.getData(),u=0;u<i;u++){for(var g=0,c=0;c<a;c++)g+=o[u*s+c]*o[u*s+c];f[u]=Math.sqrt(g)}},t.mapVectorsThroughTable=function(r,n,a,i,s){var f=t.getVectorMode(),o=s,u=i,g=r.getNumberOfComponents();f===Yt.COMPONENT?(u===-1&&(u=t.getVectorComponent()),u<0&&(u=0),u>=g&&(u=g-1)):(o===-1&&(o=t.getVectorSize()),o<=0?(u=0,o=g):(u<0&&(u=0),u>=g&&(u=g-1),u+o>g&&(o=g-u)),f===Yt.MAGNITUDE&&(g===1||o===1)&&(f=Yt.COMPONENT));var c=0;switch(u>0&&(c=u),f){case Yt.COMPONENT:{t.mapScalarsThroughTable(r,n,a,c);break}case Yt.RGBCOLORS:break;case Yt.MAGNITUDE:default:{var l=Ne.newInstance({numberOfComponents:1,values:new Float32Array(r.getNumberOfTuples())});t.mapVectorsToMagnitude(r,l,o),t.mapScalarsThroughTable(l,n,a,0);break}}},t.luminanceToRGBA=function(r,n,a,i){for(var s=i(a),f=n.getData(),o=r.getData(),u=f.length,g=0,c=1,l=0,h=g;h<u;h+=c){var y=i(f[h]);o[l*4]=y,o[l*4+1]=y,o[l*4+2]=y,o[l*4+3]=s,l++}},t.luminanceAlphaToRGBA=function(r,n,a,i){for(var s=n.getData(),f=r.getData(),o=s.length,u=0,g=2,c=0,l=u;l<o;l+=g){var h=i(s[l]);f[c]=h,f[c+1]=h,f[c+2]=h,f[c+3]=i(s[l+1])*a,c+=4}},t.rGBToRGBA=function(r,n,a,i){for(var s=Hu(a),f=n.getData(),o=r.getData(),u=f.length,g=0,c=3,l=0,h=g;h<u;h+=c)o[l*4]=i(f[h]),o[l*4+1]=i(f[h+1]),o[l*4+2]=i(f[h+2]),o[l*4+3]=s,l++},t.rGBAToRGBA=function(r,n,a,i){for(var s=n.getData(),f=r.getData(),o=s.length,u=0,g=4,c=0,l=u;l<o;l+=g)f[c*4]=i(s[l]),f[c*4+1]=i(s[l+1]),f[c*4+2]=i(s[l+2]),f[c*4+3]=i(s[l+3])*a,c++},t.convertToRGBA=function(r,n,a){var i=e.alpha;if(n===4&&i>=1&&r.getDataType()===on.UNSIGNED_CHAR)return r;var s=Ne.newInstance({numberOfComponents:4,empty:!0,size:4*a,dataType:on.UNSIGNED_CHAR});if(a<=0)return s;i=i>0?i:0,i=i<1?i:1;var f=uC;switch((r.getDataType()===on.FLOAT||r.getDataType()===on.DOUBLE)&&(f=Hu),n){case 1:t.luminanceToRGBA(s,r,i,f);break;case 2:t.luminanceAlphaToRGBA(s,r,f);break;case 3:t.rGBToRGBA(s,r,i,f);break;case 4:t.rGBAToRGBA(s,r,i,f);break;default:return $u("Cannot convert colors"),null}return s},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return 256*256*256},t.setRange=function(r,n){return t.setMappingRange(r,n)},t.getRange=function(r,n){return t.getMappingRange()}}var gC={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:Yt.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function il(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gC,r),L.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],L.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),L.setArray(t,e,["mappingRange"],2),L.getArray(t,e,["mappingRange"]),cC(t,e)}var vC=L.newInstance(il,"vtkScalarsToColors"),sl=fC({newInstance:vC,extend:il},Ai),Ku=L.vtkErrorMacro,Xu=0,Yu=1,Ds=2;function lC(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=function(){if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){var r=!0;e.nanColor[3]<1&&(r=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(r=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(r=0);for(var n=3;n<e.table.length&&r;n+=4)e.table[n]<255&&(r=!1);e.opaqueFlag=r,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return e.table.length},t.linearIndexLookup=function(r,n){var a=0;return r<n.range[0]?a=n.maxIndex+Xu+1.5:r>n.range[1]?a=n.maxIndex+Yu+1.5:(a=(r+n.shift)*n.scale,a=a<n.maxIndex?a:n.maxIndex),Math.floor(a)},t.linearLookup=function(r,n,a){var i=0;gv(r)?i=Math.floor(a.maxIndex+1.5+Ds):i=t.linearIndexLookup(r,a);var s=4*i;return[n[s],n[s+1],n[s+2],n[s+3]]},t.indexedLookupFunction=function(r,n,a){var i=t.getAnnotatedValueIndexInternal(r);i===-1&&(i=e.numberOfColors+Ds);var s=4*i;return[n[s],n[s+1],n[s+2],n[s+3]]},t.lookupShiftAndScale=function(r,n){n.shift=-r[0],n.scale=Number.MAX_VALUE,r[1]>r[0]&&(n.scale=(n.maxIndex+1)/(r[1]-r[0]))},t.mapScalarsThroughTable=function(r,n,a,i){var s=t.linearLookup;e.indexedLookup&&(s=t.indexedLookupFunction);var f=t.getMappingRange(),o={maxIndex:t.getNumberOfColors()-1,range:f,shift:0,scale:0};t.lookupShiftAndScale(f,o);var u=t.getAlpha(),g=r.getNumberOfTuples(),c=r.getNumberOfComponents(),l=n.getData(),h=r.getData();if(u>=1){if(a===ho.RGBA)for(var y=0;y<g;y++){var S=s(h[y*c+i],e.table,o);l[y*4]=S[0],l[y*4+1]=S[1],l[y*4+2]=S[2],l[y*4+3]=S[3]}}else if(a===ho.RGBA)for(var T=0;T<g;T++){var E=s(h[T*c+i],e.table,o);l[T*4]=E[0],l[T*4+1]=E[1],l[T*4+2]=E[2],l[T*4+3]=Math.floor(E[3]*u+.5)}},t.forceBuild=function(){var r=0,n=0,a=0,i=0,s=e.numberOfColors-1;s&&(r=(e.hueRange[1]-e.hueRange[0])/s,n=(e.saturationRange[1]-e.saturationRange[0])/s,a=(e.valueRange[1]-e.valueRange[0])/s,i=(e.alphaRange[1]-e.alphaRange[0])/s);for(var f=[],o=[],u=0;u<=s;u++)f[0]=e.hueRange[0]+u*r,f[1]=e.saturationRange[0]+u*n,f[2]=e.valueRange[0]+u*a,F2(f,o),o[3]=e.alphaRange[0]+u*i,e.table[u*4]=o[0]*255+.5,e.table[u*4+1]=o[1]*255+.5,e.table[u*4+2]=o[2]*255+.5,e.table[u*4+3]=o[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=function(r){if(r.getNumberOfComponents()!==4){Ku("Expected 4 components for RGBA colors");return}if(r.getDataType()!==Dr.UNSIGNED_CHAR){Ku("Expected unsigned char values for RGBA colors");return}e.numberOfColors=r.getNumberOfTuples();for(var n=r.getData(),a=0;a<n.length;a++)e.table[a]=n[a];t.buildSpecialColors(),e.insertTime.modified(),t.modified()},t.buildSpecialColors=function(){var r=e.numberOfColors,n=e.table,a=(r+Xu)*4;e.useBelowRangeColor||r===0?(n[a]=e.belowRangeColor[0]*255+.5,n[a+1]=e.belowRangeColor[1]*255+.5,n[a+2]=e.belowRangeColor[2]*255+.5,n[a+3]=e.belowRangeColor[3]*255+.5):(n[a]=n[0],n[a+1]=n[1],n[a+2]=n[2],n[a+3]=n[3]),a=(r+Yu)*4,e.useAboveRangeColor||r===0?(n[a]=e.aboveRangeColor[0]*255+.5,n[a+1]=e.aboveRangeColor[1]*255+.5,n[a+2]=e.aboveRangeColor[2]*255+.5,n[a+3]=e.aboveRangeColor[3]*255+.5):(n[a]=n[4*(r-1)+0],n[a+1]=n[4*(r-1)+1],n[a+2]=n[4*(r-1)+2],n[a+3]=n[4*(r-1)+3]),a=(r+Ds)*4,n[a]=e.nanColor[0]*255+.5,n[a+1]=e.nanColor[1]*255+.5,n[a+2]=e.nanColor[2]*255+.5,n[a+3]=e.nanColor[3]*255+.5},t.build=function(){(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&e.insertTime.modified()}var pC={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function ol(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pC,r),sl.extend(t,e,r),e.table||(e.table=[]),e.buildTime={},L.obj(e.buildTime),e.opaqueFlagBuildTime={},L.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},L.obj(e.insertTime,{mtime:0}),L.get(t,e,["buildTime"]),L.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),L.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),L.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),L.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),lC(t,e)}var hC=L.newInstance(ol,"vtkLookupTable"),In={newInstance:hC,extend:ol},fl=1,Io=0,yC=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function dC(){return fl}function TC(t){fl=t}function SC(){return Io}function Pi(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;Io=t}function CC(){Pi(0)}function EC(){Pi(0)}function wC(){Pi(1)}function xC(){return yC[Io]}var yo={getResolveCoincidentTopologyAsString:xC,getResolveCoincidentTopologyPolygonOffsetFaces:dC,getResolveCoincidentTopology:SC,setResolveCoincidentTopology:Pi,setResolveCoincidentTopologyPolygonOffsetFaces:TC,setResolveCoincidentTopologyToDefault:CC,setResolveCoincidentTopologyToOff:EC,setResolveCoincidentTopologyToPolygonOffset:wC};function ul(t,e,r){r.forEach(function(n){t["get".concat(n.method)]=function(){return e[n.key]},t["set".concat(n.method)]=function(a,i){e[n.key]={factor:a,offset:i}}})}var qo=["Polygon","Line","Point"],OC={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},$r={};ul($r,OC,qo.map(function(t){return{key:t,method:"ResolveCoincidentTopology".concat(t,"OffsetParameters")}}));function MC(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),L.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(yo).forEach(function(r){t[r]=yo[r]}),Object.keys($r).forEach(function(r){t[r]=$r[r]}),ul(t,e.topologyOffset,qo.map(function(r){return{key:r,method:"RelativeCoincidentTopology".concat(r,"OffsetParameters")}})),t.getCoincidentTopologyPolygonOffsetParameters=function(){var r=$r.getResolveCoincidentTopologyPolygonOffsetParameters(),n=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyLineOffsetParameters=function(){var r=$r.getResolveCoincidentTopologyLineOffsetParameters(),n=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyPointOffsetParameter=function(){var r=$r.getResolveCoincidentTopologyPointOffsetParameters(),n=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}}}var Zo={implementCoincidentTopologyMethods:MC,staticOffsetAPI:$r,otherStaticMethods:yo,CATEGORIES:qo},ht={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3},cl={PassTypes:ht};function Iu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ms(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Iu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Iu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var qu=Vn.FieldAssociations,DC=Zo.staticOffsetAPI,mC=Zo.otherStaticMethods,Rs=Lr.ColorMode,Nr=Lr.ScalarMode,Ls=Lr.GetArray,RC=Ai.VectorMode,LC=Ne.VtkDataTypes;function zn(t){return function(){return L.vtkErrorMacro("vtkMapper::".concat(t," - NOT IMPLEMENTED"))}}function VC(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=function(){var r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=vv(),e.bounds},t.setForceCompileOnly=function(r){e.forceCompileOnly=r},t.createDefaultLookupTable=function(){e.lookupTable=In.newInstance()},t.getColorModeAsString=function(){return L.enumToString(Rs,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return L.enumToString(Nr,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var f=null,o=!1;if(n===Nr.DEFAULT)f=r.getPointData().getScalars(),f||(f=r.getCellData().getScalars(),o=!0);else if(n===Nr.USE_POINT_DATA)f=r.getPointData().getScalars();else if(n===Nr.USE_CELL_DATA)f=r.getCellData().getScalars(),o=!0;else if(n===Nr.USE_POINT_FIELD_DATA){var u=r.getPointData();a===Ls.BY_ID?f=u.getArrayByIndex(i):f=u.getArrayByName(s)}else if(n===Nr.USE_CELL_FIELD_DATA){var g=r.getCellData();o=!0,a===Ls.BY_ID?f=g.getArrayByIndex(i):f=g.getArrayByName(s)}else if(n===Nr.USE_FIELD_DATA){var c=r.getFieldData();a===Ls.BY_ID?f=c.getArrayByIndex(i):f=c.getArrayByName(s)}return{scalars:f,cellFlag:o}},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(r))t.mapScalarsToTexture(a,n);else{e.colorCoordinates=null,e.colorTextureMap=null;var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId))}e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}},t.scalarToTextureCoordinate=function(r,n,a){var i=.5,s=1;return gv(r)||(s=.49,i=(r-n)*a,i>1e3?i=1e3:i<-1e3&&(i=-1e3)),{texCoordS:i,texCoordT:s}},t.createColorTextureCoordinates=function(r,n,a,i,s,f,o,u,g){var c=(f[1]-f[0])/u,l=[];l[0]=f[0]-c,l[1]=f[1]+c;var h=1/(l[1]-l[0]),y=n.getData(),S=r.getData(),T=0,E=0;if(s<0||s>=i)for(var x=0;x<a;++x){for(var w=0,C=0;C<i;++C)w+=S[T]*S[T],T++;var m=Math.sqrt(w);g&&(m=In.applyLogScale(m,o,f));var D=t.scalarToTextureCoordinate(m,l[0],h);y[E]=D.texCoordS,y[E+1]=D.texCoordT,E+=2}else{T+=s;for(var b=0;b<a;++b){var F=S[T];g&&(F=In.applyLogScale(F,o,f));var U=t.scalarToTextureCoordinate(F,l[0],h);y[E]=U.texCoordS,y[E+1]=U.texCoordT,E+=2,T+=i}}},t.mapScalarsToTexture=function(r,n){var a=e.lookupTable.getRange(),i=e.lookupTable.usingLogScale();i&&In.getLogRange(a,a);var s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==n){e.lookupTable.setAlpha(n),e.colorTextureMap=null,e.lookupTable.build();var f=e.lookupTable.getNumberOfAvailableColors();f>4094&&(f=4094),f+=2;for(var o=(a[1]-a[0])/(f-1-2),u=new Float64Array(f*2),g=0;g<f;++g)u[g]=a[0]+g*o-o,i&&(u[g]=Math.pow(10,u[g]));for(var c=0;c<f;++c)u[c+f]=NaN;e.colorTextureMap=nC.newInstance(),e.colorTextureMap.setExtent(0,f-1,0,1,0,0);var l=Ne.newInstance({numberOfComponents:1,values:u});e.colorTextureMap.getPointData().setScalars(e.lookupTable.mapScalars(l,e.colorMode,0)),e.lookupTable.setAlpha(s)}if(!e.colorCoordinates||t.getMTime()>e.colorCoordinates.getMTime()||t.getInputData(0).getMTime()>e.colorCoordinates.getMTime()||e.lookupTable.getMTime()>e.colorCoordinates.getMTime()){e.colorCoordinates=null;var h=r.getNumberOfComponents(),y=r.getNumberOfTuples();e.colorCoordinates=Ne.newInstance({numberOfComponents:2,values:new Float32Array(y*2)});var S=e.lookupTable.getVectorComponent();e.lookupTable.getVectorMode()===RC.MAGNITUDE&&r.getNumberOfComponents()>1&&(S=-1),t.createColorTextureCoordinates(r,e.colorCoordinates,y,h,S,a,e.lookupTable.getRange(),e.colorTextureMap.getPointData().getScalars().getNumberOfTuples()/2-2,i)}},t.getIsOpaque=function(){var r=t.getLookupTable();return r?(r.build(),r.isOpaque()):!0},t.canUseTextureMapForColoring=function(r){if(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup())return!1;var n=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName),a=n.scalars;return!(!a||n.cellFlag||e.colorMode===Rs.DEFAULT&&a.getDataType()===LC.UNSIGNED_CHAR||e.colorMode===Rs.DIRECT_SCALARS)},t.clearColorArrays=function(){e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.getPrimitiveCount=function(){var r=t.getInputData(),n={points:r.getPoints().getNumberOfValues()/3,verts:r.getVerts().getNumberOfValues()-r.getVerts().getNumberOfCells(),lines:r.getLines().getNumberOfValues()-2*r.getLines().getNumberOfCells(),triangles:r.getPolys().getNumberOfValues()-3*r.getPolys().getNumberOfCells()};return n},t.acquireInvertibleLookupTable=zn("AcquireInvertibleLookupTable"),t.valueToColor=zn("ValueToColor"),t.colorToValue=zn("ColorToValue"),t.useInvertibleColorFor=zn("UseInvertibleColorFor"),t.clearInvertibleColor=zn("ClearInvertibleColor"),t.processSelectorPixelBuffers=function(r,n){if(!(!r||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)){var a=r.getRawPixelBuffer(ht.ID_LOW24),i=r.getRawPixelBuffer(ht.ID_HIGH24),s=r.getCurrentPass(),f=r.getFieldAssociation(),o=null;f===qu.FIELD_ASSOCIATION_POINTS?o=e.selectionWebGLIdsToVTKIds.points:f===qu.FIELD_ASSOCIATION_CELLS&&(o=e.selectionWebGLIdsToVTKIds.cells),o&&n.forEach(function(u){if(s===ht.ID_LOW24){var g=0;i&&(g+=i[u],g*=256),g+=a[u+2],g*=256,g+=a[u+1],g*=256,g+=a[u];var c=o[g],l=r.getPixelBuffer(ht.ID_LOW24);l[u]=c&255,l[u+1]=(c&65280)>>8,l[u+2]=(c&16711680)>>16}else if(s===ht.ID_HIGH24&&i){var h=0;h+=i[u],h*=256,h+=a[u],h*=256,h+=a[u+1],h*=256,h+=a[u+2];var y=o[h],S=r.getPixelBuffer(ht.ID_HIGH24);S[u]=(y&4278190080)>>24}})}}}var _C={colorMapColors:null,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,viewSpecificProperties:null,customShaderAttributes:[]};function gl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_C,r),mS.extend(t,e,r),L.get(t,e,["colorCoordinates","colorMapColors","colorTextureMap"]),L.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","selectionWebGLIdsToVTKIds","static","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),L.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),Zo.implementCoincidentTopologyMethods(t,e),VC(t,e)}var bC=L.newInstance(gl,"vtkMapper"),mr=ms(ms(ms({newInstance:bC,extend:gl},DC),mC),Lr);function Zu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ll(t){var e=0;return t.filter(function(r,n){return n===e?(e+=r+1,!0):!1})}function pl(t){for(var e=0,r=0;r<t.length;)r+=t[r]+1,e++;return e}var kC={extractCellSizes:ll,getNumberOfCells:pl};function FC(t,e){e.classHierarchy.push("vtkCellArray"),t.getNumberOfCells=function(a){return e.numberOfCells!==void 0&&!a||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=pl(t.getData())),e.numberOfCells},t.getCellSizes=function(a){return e.cellSizes!==void 0&&!a||(e.cellSizes=ll(t.getData())),e.cellSizes};var r=t.setData;t.setData=function(a){r(a,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=function(a){var i=a,s=e.values[i++];return e.values.subarray(i,i+s)};var n=t.initialize;t.initialize=function(){n(),e.numberOfCells=void 0,e.cellSizes=void 0},t.insertNextCell=function(a){var i=t.getNumberOfCells();return t.insertNextTuples([a.length].concat(Ce(a))),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(a.length),i}}function BC(t){return vl({empty:!0,numberOfComponents:1,dataType:Dr.UNSIGNED_INT},t)}function hl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ne.extend(t,e,BC(r)),FC(t,e)}var NC=L.newInstance(hl,"vtkCellArray"),Qu=vl({newInstance:NC,extend:hl},kC),UC=L.vtkErrorMacro,GC=[1,-1,1,-1,1,-1];function AC(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==r&&(e.size=r*n,e.values=L.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(n),t.modified())},t.setPoint=function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];t.setTuple(r,a)},t.getPoint=t.getTuple,t.insertNextPoint=function(r,n,a){return t.insertNextTuple([r,n,a])},t.getBounds=function(){if(t.getNumberOfComponents()===3){var r=t.getRange(0);e.bounds[0]=r[0],e.bounds[1]=r[1];var n=t.getRange(1);e.bounds[2]=n[0],e.bounds[3]=n[1];var a=t.getRange(2);return e.bounds[4]=a[0],e.bounds[5]=a[1],e.bounds}if(t.getNumberOfComponents()!==2)return UC(`getBounds called on an array with components of
        `.concat(t.getNumberOfComponents())),GC;var i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];var s=t.getRange(1);return e.bounds[2]=s[0],e.bounds[3]=s[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}var PC={empty:!0,numberOfComponents:3,dataType:Dr.FLOAT,bounds:[1,-1,1,-1,1,-1]};function yl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PC,r),Ne.extend(t,e,r),AC(t,e)}var zC=L.newInstance(yl,"vtkPoints"),Ri={newInstance:zC,extend:yl};function WC(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(n){e.pointsIds=n;var i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=L.newTypedArray(r.getDataType(),3*e.pointsIds.length));var s=r.getData();e.pointsIds.forEach(function(f,o){var u=3*f,g=3*o;i[g]=s[u],i[++g]=s[++u],i[++g]=s[++u]}),e.points.setData(i)}else{e.points=r,e.pointsIds=new Array(r.getNumberOfPoints());for(var a=r.getNumberOfPoints()-1;a>=0;--a)e.pointsIds[a]=a}},t.getBounds=function(){var r=e.points.getNumberOfPoints(),n=[];if(r){e.points.getPoint(0,n),e.bounds[0]=n[0],e.bounds[1]=n[0],e.bounds[2]=n[1],e.bounds[3]=n[1],e.bounds[4]=n[2],e.bounds[5]=n[2];for(var a=1;a<r;a++)e.points.getPoint(a,n),e.bounds[0]=n[0]<e.bounds[0]?n[0]:e.bounds[0],e.bounds[1]=n[0]>e.bounds[1]?n[0]:e.bounds[1],e.bounds[2]=n[1]<e.bounds[2]?n[1]:e.bounds[2],e.bounds[3]=n[1]>e.bounds[3]?n[1]:e.bounds[3],e.bounds[4]=n[2]<e.bounds[4]?n[2]:e.bounds[4],e.bounds[5]=n[2]>e.bounds[5]?n[2]:e.bounds[5]}else Ni(e.bounds);return e.bounds},t.getLength2=function(){t.getBounds();for(var r=0,n=0,a=0;a<3;a++)n=e.bounds[2*a+1]-e.bounds[2*a],r+=n*n;return r},t.getParametricDistance=function(r){for(var n,a=0,i=0;i<3;i++)r[i]<0?n=-r[i]:r[i]>1?n=r[i]-1:n=0,n>a&&(a=n);return a},t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.deepCopy=function(r){r.initialize(e.points,e.pointsIds)},t.getCellDimension=function(){},t.intersectWithLine=function(r,n,a,i,s,f,o){},t.evaluatePosition=function(r,n,a,i,s,f){L.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}var jC={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function dl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,jC,r),L.obj(t,e),e.points||(e.points=Ri.newInstance()),L.get(t,e,["points","pointsIds"]),WC(t,e)}var $C=L.newInstance(dl,"vtkCell"),Li={newInstance:$C,extend:dl};function HC(t,e){var r=e;for(e>=t.array.length&&(r+=t.array.length);r>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=r}function KC(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=function(r){var n=r.getPoints().getNumberOfPoints(),a=r.getNumberOfCells(),i=new Uint32Array(n);if(r.isA("vtkPolyData")){for(var s=0;s<a;++s){var f=r.getCellPoints(s),o=f.cellPointIds;o.forEach(function(S){t.incrementLinkCount(S)})}t.allocateLinks(n),e.maxId=n-1;for(var u=function(T){var E=r.getCellPoints(T),x=E.cellPointIds;x.forEach(function(w){t.insertCellReference(w,i[w]++,T)})},g=0;g<a;++g)u(g)}else{for(var c=0;c<a;c++){var l=Li.newInstance();l.getPointsIds().forEach(function(S){t.incrementLinkCount(S)})}t.allocateLinks(n),e.maxId=n-1;for(var h=function(T){var E=Li.newInstance();E.getPointsIds().forEach(function(x){t.insertCellReference(x,i[x]++,T)})},y=0;y<a;++y)h(y)}},t.allocate=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(r).fill().map(function(){return{ncells:0,cells:null}}),e.extend=n,e.maxId=-1},t.initialize=function(){e.array=null},t.getLink=function(r){return e.array[r]},t.getNcells=function(r){return e.array[r].ncells},t.getCells=function(r){return e.array[r].cells},t.insertNextPoint=function(r){e.array.push({ncells:r,cells:Array(r)}),++e.maxId},t.insertNextCellReference=function(r,n){e.array[r].cells[e.array[r].ncells++]=n},t.deletePoint=function(r){e.array[r].ncells=0,e.array[r].cells=null},t.removeCellReference=function(r,n){e.array[n].cells=e.array[n].cells.filter(function(a){return a!==r}),e.array[n].ncells=e.array[n].cells.length},t.addCellReference=function(r,n){e.array[n].cells[e.array[n].ncells++]=r},t.resizeCellList=function(r,n){e.array[r].cells.length=n},t.squeeze=function(){HC(e,e.maxId+1)},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){e.array=Ce(r.array),e.extend=r.extend,e.maxId=r.maxId},t.incrementLinkCount=function(r){++e.array[r].ncells},t.allocateLinks=function(r){for(var n=0;n<r;++n)e.array[n].cells=new Array(e.array[n].ncells)},t.insertCellReference=function(r,n,a){e.array[r].cells[n]=a}}var XC={array:null,maxId:0,extend:0};function Tl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XC,r),L.obj(t,e),KC(t,e)}var YC=L.newInstance(Tl,"vtkCellLinks"),IC={newInstance:YC,extend:Tl},Pe={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},To=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function Ju(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ju(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ju(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZC(t){return t<To.length?To[t]:"UnknownClass"}function QC(t){return To.findIndex(t)}function JC(t){return t<Pe.VTK_QUADRATIC_EDGE||t===Pe.VTK_CONVEX_POINT_SET||t===Pe.VTK_POLYHEDRON}function eE(t){return t===Pe.VTK_TRIANGLE_STRIP||t===Pe.VTK_POLY_LINE||t===Pe.VTK_POLY_VERTEX}var tE={getClassNameFromTypeId:ZC,getTypeIdFromClassName:QC,isLinear:JC,hasSubCells:eE};function rE(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=r>0?r:1,e.extend=n>0?n:1,e.maxId=-1,e.typeArray=new Uint8Array(r),e.locationArray=new Uint32Array(r)},t.insertCell=function(r,n,a){e.typeArray[r]=n,e.locationArray[r]=a,r>e.maxId&&(e.maxId=r)},t.insertNextCell=function(r,n){return t.insertCell(++e.maxId,r,n),e.maxId},t.setCellTypes=function(r,n,a){e.size=r,e.typeArray=n,e.locationArray=a,e.maxId=r-1},t.getCellLocation=function(r){return e.locationArray[r]},t.deleteCell=function(r){e.typeArray[r]=Pe.VTK_EMPTY_CELL},t.getNumberOfTypes=function(){return e.maxId+1},t.isType=function(r){for(var n=t.getNumberOfTypes(),a=0;a<n;++a)if(r===t.getCellType(a))return!0;return!1},t.insertNextType=function(r){return t.insertNextCell(r,-1)},t.getCellType=function(r){return e.typeArray[r]},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){t.allocate(r.getSize(),r.getExtend()),e.typeArray.set(r.getTypeArray()),e.locationArray.set(r.getLocationArray()),e.maxId=r.getMaxId()}}var nE={size:0,maxId:-1,extend:1e3};function Sl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nE,r),L.obj(t,e),L.get(t,e,["size","maxId","extend"]),L.getArray(t,e,["typeArray","locationArray"]),rE(t,e)}var aE=L.newInstance(Sl,"vtkCellTypes"),iE=qC({newInstance:aE,extend:Sl},tE),sE={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2},Cl={IntersectionState:sE};function ec(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ec(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ec(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var vi=Cl.IntersectionState;function Tn(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a={t:Number.MIN_VALUE,distance:0},i=[],s;i[0]=r[0]-e[0],i[1]=r[1]-e[1],i[2]=r[2]-e[2];var f=i[0]*(t[0]-e[0])+i[1]*(t[1]-e[1])+i[2]*(t[2]-e[2]),o=Ee(i,i),u=1e-5*f;return o!==0&&(a.t=f/o),u<0&&(u=-u),-u<o&&o<u||o<=0||a.t<0?s=e:a.t>1?s=r:(s=i,i[0]=e[0]+a.t*i[0],i[1]=e[1]+a.t*i[1],i[2]=e[2]+a.t*i[2]),n&&(n[0]=s[0],n[1]=s[1],n[2]=s[2]),a.distance=Gt(s,t),a}function El(t,e,r,n,a,i){var s=[],f=[],o=[];a[0]=0,i[0]=0,wr(e,t,s),wr(n,r,f),wr(r,t,o);var u=[Ee(s,s),-Ee(s,f),-Ee(s,f),Ee(f,f)],g=[];if(g[0]=Ee(s,o),g[1]=-Ee(f,o),k2(u,g,2)===0){for(var c=Number.MAX_VALUE,l=[t,e,r,n],h=[r,r,t,t],y=[n,n,e,e],S=[i[0],i[0],a[0],a[0]],T=[a[0],a[0],i[0],i[0]],E,x=0;x<4;x++)E=Tn(l[x],h[x],y[x]),E.distance<c&&(c=E.distance,S[x]=E.t,T[x]=x%2);return vi.ON_LINE}return a[0]=g[0],i[0]=g[1],a[0]>=0&&a[0]<=1&&i[0]>=0&&i[0]<=1?vi.YES_INTERSECTION:vi.NO_INTERSECTION}var oE={distanceToLine:Tn,intersection:El};function fE(t,e){e.classHierarchy.push("vtkLine");function r(n){return n>=0&&n<=1}t.getCellDimension=function(){return 1},t.intersectWithLine=function(n,a,i,s,f){var o={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};f[1]=0,f[2]=0;var u=[],g=[],c=[];e.points.getPoint(0,g),e.points.getPoint(1,c);var l=[],h=[],y=El(n,a,g,c,l,h);if(o.t=l[0],o.betweenPoints=r(o.t),f[0]=h[0],y===vi.YES_INTERSECTION){for(var S=0;S<3;S++)s[S]=g[S]+f[0]*(c[S]-g[S]),u[S]=n[S]+o.t*(a[S]-n[S]);if(Gt(s,u)<=i*i)return o.intersect=1,o}else{var T;if(o.t<0)return T=Tn(n,g,c,s),T.distance<=i*i&&(o.t=0,o.intersect=1,o.betweenPoints=!0),o;if(o.t>1)return T=Tn(a,g,c,s),T.distance<=i*i&&(o.t=1,o.intersect=1,o.betweenPoints=!0),o;if(f[0]<0)return f[0]=0,T=Tn(g,n,a,s),o.t=T.t,T.distance<=i*i&&(o.intersect=1),o;if(f[0]>1)return f[0]=1,T=Tn(c,n,a,s),o.t=T.t,T.distance<=i*i&&(o.intersect=1),o}return o},t.evaluateLocation=function(n,a,i){var s=[],f=[];e.points.getPoint(0,s),e.points.getPoint(1,f);for(var o=0;o<3;o++)a[o]=s[o]+n[0]*(f[o]-s[o]);i[0]=1-n[0],i[1]=n[0]}}var uE={};function wl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uE,r),Li.extend(t,e,r),fE(t,e)}var cE=L.newInstance(wl,"vtkLine"),Rt=tc(tc({newInstance:cE,extend:wl},oE),Cl);function gE(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=Wt(e.points):e.points=Ri.newInstance(),t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.getBounds=function(){return e.points.getBounds()},t.computeBounds=function(){t.getBounds()};var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),e.points=Ri.newInstance(),e.points.shallowCopy(n.getPoints())}}var vE={};function xl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vE,r),Vn.extend(t,e,r),L.setGet(t,e,["points"]),gE(t,e)}var lE=L.newInstance(xl,"vtkPointSet"),pE={newInstance:lE,extend:xl};function rc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function hE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Qo(t,e,r,n){var a=r[0]-e[0],i=r[1]-e[1],s=r[2]-e[2],f=t[0]-e[0],o=t[1]-e[1],u=t[2]-e[2];n[0]=i*u-s*o,n[1]=s*f-a*u,n[2]=a*o-i*f}function Vi(t,e,r,n){Qo(t,e,r,n);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);a!==0&&(n[0]/=a,n[1]/=a,n[2]/=a)}function yE(t,e,r,n,a,i){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,f=!1,o=[],u=[],g=[],c=[],l=[];Vi(t,e,r,c),Vi(n,a,i,l);var h=-Ee(c,t),y=-Ee(l,n),S=[Ee(l,t)+y,Ee(l,e)+y,Ee(l,r)+y];if(S[0]*S[1]>s&&S[0]*S[2]>s)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};var T=[Ee(c,n)+h,Ee(c,a)+h,Ee(c,i)+h];if(T[0]*T[1]>s&&T[0]*T[2]>s)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};if(Math.abs(c[0]-l[0])<1e-9&&Math.abs(c[1]-l[1])<1e-9&&Math.abs(c[2]-l[2])<1e-9&&Math.abs(h-y)<1e-9)return f=!0,{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};var E=[t,e,r],x=[n,a,i],w=Ee(c,l),C=(h-y*w)/(w*w-1),m=(y-h*w)/(w*w-1),D=[C*c[0]+m*l[0],C*c[1]+m*l[1],C*c[2]+m*l[2]],b=la(c,l,[]);Mn(b);for(var F=0,U=0,O=[],A=[],W=50,j=50,N=0;N<3;N++){var I=N,X=(N+1)%3,J=Dn.intersectWithLine(E[I],E[X],n,l);J.intersection&&J.t>0-s&&J.t<1+s&&(J.t<1+s&&J.t>1-s&&(W=F),O[F++]=Ee(J.x,b)-Ee(D,b));var P=Dn.intersectWithLine(x[I],x[X],t,c);P.intersection&&P.t>0-s&&P.t<1+s&&(P.t<1+s&&P.t>1-s&&(j=U),A[U++]=Ee(P.x,b)-Ee(D,b))}if(F>2){F--;var G=O[2];O[2]=O[W],O[W]=G}if(U>2){U--;var K=A[2];A[2]=A[j],A[j]=K}if(F!==2||U!==2)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};if(Number.isNaN(O[0])||Number.isNaN(O[1])||Number.isNaN(A[0])||Number.isNaN(A[1]))return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};if(O[0]>O[1]){var te=O[1];O[1]=O[0],O[0]=te}if(A[0]>A[1]){var ee=A[1];A[1]=A[0],A[0]=ee}var fe,ve;return O[1]<A[0]||A[1]<O[0]?{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g}:(O[0]<A[0]?O[1]<A[1]?(g[0]=2,g[1]=1,fe=A[0],ve=O[1]):(g[0]=2,g[1]=2,fe=A[0],ve=A[1]):O[1]<A[1]?(g[0]=1,g[1]=1,fe=O[0],ve=O[1]):(g[0]=1,g[1]=2,fe=O[0],ve=A[1]),xu(D,b,fe,o),xu(D,b,ve,u),{intersect:!0,coplanar:f,pt1:o,pt2:u,surfaceId:g})}var dE={computeNormalDirection:Qo,computeNormal:Vi,intersectWithTriangle:yE};function TE(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=function(){return 2},t.intersectWithLine=function(r,n,a,i,s){var f={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};s[2]=0;var o=[],u=a*a,g=[],c=[],l=[];e.points.getPoint(0,g),e.points.getPoint(1,c),e.points.getPoint(2,l);var h=[],y=[];if(Vi(g,c,l,h),h[0]!==0||h[1]!==0||h[2]!==0){var S=Dn.intersectWithLine(r,n,g,h);if(f.betweenPoints=S.betweenPoints,f.t=S.t,i[0]=S.x[0],i[1]=S.x[1],i[2]=S.x[2],!S.intersection)return s[0]=0,s[1]=0,f.intersect=0,f;var T=t.evaluatePosition(i,o,s,y);if(T.evaluation>=0)return T.dist2<=u?(f.intersect=1,f):(f.intersect=T.evaluation,f)}var E=Gt(g,c),x=Gt(c,l),w=Gt(l,g);e.line||(e.line=Rt.newInstance()),E>x&&E>w?(e.line.getPoints().setPoint(0,g),e.line.getPoints().setPoint(1,c)):x>w&&x>E?(e.line.getPoints().setPoint(0,c),e.line.getPoints().setPoint(1,l)):(e.line.getPoints().setPoint(0,l),e.line.getPoints().setPoint(1,g));var C=e.line.intersectWithLine(r,n,a,i,s);if(f.betweenPoints=C.betweenPoints,f.t=C.t,C.intersect){for(var m=[],D=[],b=[],F=0;F<3;F++)m[F]=g[F]-l[F],D[F]=c[F]-l[F],b[F]=i[F]-l[F];return s[0]=Ee(b,m)/w,s[1]=Ee(b,D)/x,f.intersect=1,f}return s[0]=0,s[1]=0,f.intersect=0,f},t.evaluatePosition=function(r,n,a,i){var s={subId:0,dist2:0,evaluation:-1},f,o,u=[],g=[],c=[],l=[],h,y=[],S=[],T=[],E=0,x=0,w=[],C,m,D,b=[],F=[],U=[],O=[];s.subId=0,a[2]=0,e.points.getPoint(1,u),e.points.getPoint(2,g),e.points.getPoint(0,c),Qo(u,g,c,l),Dn.generalizedProjectPoint(r,u,l,O);var A=0;for(f=0;f<3;f++)l[f]<0?h=-l[f]:h=l[f],h>A&&(A=h,x=f);for(o=0,f=0;f<3;f++)f!==x&&(w[o++]=f);for(f=0;f<2;f++)y[f]=O[w[f]]-c[w[f]],S[f]=u[w[f]]-c[w[f]],T[f]=g[w[f]]-c[w[f]];if(E=gi(S,T),E===0)return a[0]=0,a[1]=0,s.evaluation=-1,s;if(a[0]=gi(y,T)/E,a[1]=gi(S,y)/E,i[0]=1-(a[0]+a[1]),i[1]=a[0],i[2]=a[1],i[0]>=0&&i[0]<=1&&i[1]>=0&&i[1]<=1&&i[2]>=0&&i[2]<=1)n&&(s.dist2=Gt(O,r),n[0]=O[0],n[1]=O[1],n[2]=O[2]),s.evaluation=1;else{var W;if(n){if(i[1]<0&&i[2]<0)for(C=Gt(r,c),m=Rt.distanceToLine(r,u,c,W,F),D=Rt.distanceToLine(r,c,g,W,U),C<m?(s.dist2=C,b=c):(s.dist2=m,b=F),D<s.dist2&&(s.dist2=D,b=U),f=0;f<3;f++)n[f]=b[f];else if(i[2]<0&&i[0]<0)for(C=Gt(r,u),m=Rt.distanceToLine(r,u,c,W,F),D=Rt.distanceToLine(r,u,g,W,U),C<m?(s.dist2=C,b=u):(s.dist2=m,b=F),D<s.dist2&&(s.dist2=D,b=U),f=0;f<3;f++)n[f]=b[f];else if(i[1]<0&&i[0]<0)for(C=Gt(r,g),m=Rt.distanceToLine(r,g,c,W,F),D=Rt.distanceToLine(r,u,g,W,U),C<m?(s.dist2=C,b=g):(s.dist2=m,b=F),D<s.dist2&&(s.dist2=D,b=U),f=0;f<3;f++)n[f]=b[f];else if(i[0]<0){var j=Rt.distanceToLine(r,u,g,n);s.dist2=j.distance}else if(i[1]<0){var N=Rt.distanceToLine(r,g,c,n);s.dist2=N.distance}else if(i[2]<0){var I=Rt.distanceToLine(r,u,c,n);s.dist2=I.distance}}s.evaluation=0}return s},t.evaluateLocation=function(r,n,a){var i=[],s=[],f=[];e.points.getPoint(0,i),e.points.getPoint(1,s),e.points.getPoint(2,f);for(var o=1-r[0]-r[1],u=0;u<3;u++)n[u]=i[u]*o+s[u]*r[0]+f[u]*r[1];a[0]=o,a[1]=r[0],a[2]=r[1]},t.getParametricDistance=function(r){var n,a=0,i=[];i[0]=r[0],i[1]=r[1],i[2]=1-r[0]-r[1];for(var s=0;s<3;s++)i[s]<0?n=-i[s]:i[s]>1?n=i[s]-1:n=0,n>a&&(a=n);return a}}var SE={};function Ol(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SE,r),Li.extend(t,e,r),TE(t,e)}var CE=L.newInstance(Ol,"vtkTriangle"),EE=hE({newInstance:CE,extend:Ol},dE),Vs=["verts","lines","polys","strips"],Wn,nc=L.vtkWarningMacro,wE=(Wn={},de(Wn,Pe.VTK_LINE,Rt),de(Wn,Pe.VTK_POLY_LINE,Rt),de(Wn,Pe.VTK_TRIANGLE,EE),Wn);function xE(t,e){e.classHierarchy.push("vtkPolyData");function r(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(i){return i.toUpperCase()}).replace(/\s+/g,"")}Vs.forEach(function(a){t["getNumberOf".concat(r(a))]=function(){return e[a].getNumberOfCells()},e[a]?e[a]=Wt(e[a]):e[a]=Qu.newInstance()}),t.getNumberOfCells=function(){return Vs.reduce(function(a,i){return a+e[i].getNumberOfCells()},0)};var n=t.shallowCopy;t.shallowCopy=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(a,i),Vs.forEach(function(s){e[s]=Qu.newInstance(),e[s].shallowCopy(a.getReferenceByName(s))})},t.buildCells=function(){var a=t.getNumberOfVerts(),i=t.getNumberOfLines(),s=t.getNumberOfPolys(),f=t.getNumberOfStrips(),o=a+i+s+f,u=new Uint8Array(o),g=u,c=new Uint32Array(o),l=c;if(a){var h=0;e.verts.getCellSizes().forEach(function(E,x){l[x]=h,g[x]=E>1?Pe.VTK_POLY_VERTEX:Pe.VTK_VERTEX,h+=E+1}),l=l.subarray(a),g=g.subarray(a)}if(i){var y=0;e.lines.getCellSizes().forEach(function(E,x){l[x]=y,g[x]=E>2?Pe.VTK_POLY_LINE:Pe.VTK_LINE,E===1&&nc("Building VTK_LINE ",x," with only one point, but VTK_LINE needs at least two points. Check the input."),y+=E+1}),l=l.subarray(i),g=g.subarray(i)}if(s){var S=0;e.polys.getCellSizes().forEach(function(E,x){switch(l[x]=S,E){case 3:g[x]=Pe.VTK_TRIANGLE;break;case 4:g[x]=Pe.VTK_QUAD;break;default:g[x]=Pe.VTK_POLYGON;break}E<3&&nc("Building VTK_TRIANGLE ",x," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),S+=E+1}),l+=l.subarray(s),g+=g.subarray(s)}if(f){var T=0;g.fill(Pe.VTK_TRIANGLE_STRIP,0,f),e.strips.getCellSizes().forEach(function(E,x){l[x]=T,T+=E+1})}e.cells=iE.newInstance(),e.cells.setCellTypes(o,u,c)},t.buildLinks=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=IC.newInstance(),a>0?e.links.allocate(a):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=function(a){return e.cells.getCellType(a)},t.getCellPoints=function(a){var i=t.getCellType(a),s=null;switch(i){case Pe.VTK_VERTEX:case Pe.VTK_POLY_VERTEX:s=e.verts;break;case Pe.VTK_LINE:case Pe.VTK_POLY_LINE:s=e.lines;break;case Pe.VTK_TRIANGLE:case Pe.VTK_QUAD:case Pe.VTK_POLYGON:s=e.polys;break;case Pe.VTK_TRIANGLE_STRIP:s=e.strips;break;default:return s=null,{type:0,cellPointIds:null}}var f=e.cells.getCellLocation(a),o=s.getCell(f);return{cellType:i,cellPointIds:o}},t.getPointCells=function(a){return e.links.getCells(a)},t.getCellEdgeNeighbors=function(a,i,s){var f=e.links.getLink(i),o=e.links.getLink(s);return f.cells.filter(function(u){return u!==a&&o.cells.indexOf(u)!==-1})},t.getCell=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=t.getCellPoints(a),f=i||wE[s.cellType].newInstance();return f.initialize(t.getPoints(),s.cellPointIds),f}}var OE={};function Ml(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,OE,r),pE.extend(t,e,r),L.get(t,e,["cells","links"]),L.setGet(t,e,["verts","lines","polys","strips"]),xE(t,e)}var ME=L.newInstance(Ml,"vtkPolyData"),Rr={newInstance:ME,extend:Ml};function ac(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function DE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ac(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ac(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mE(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=function(){e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=function(r){e.jsImageData!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=r,e.imageLoaded=!0,t.modified())},t.setCanvas=function(r){e.canvas!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=r,t.modified())},t.setImage=function(r){e.image!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=r,e.imageLoaded=!1,r.complete?t.imageLoaded():r.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=function(){var r=0,n=0,a=1;if(t.getInputData()){var i=t.getInputData();r=i.getDimensions()[0],n=i.getDimensions()[1],a=i.getDimensions()[2]}e.jsImageData&&(r=e.jsImageData.width,n=e.jsImageData.height),e.canvas&&(r=e.canvas.width,n=e.canvas.height),e.image&&(r=e.image.width,n=e.image.height);var s=(r>1)+(n>1)+(a>1);return s},t.getInputAsJsImageData=function(){if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas){var r=e.canvas.getContext("2d"),n=r.getImageData(0,0,e.canvas.width,e.canvas.height);return n}if(e.image){var a=document.createElement("canvas");a.width=e.image.width,a.height=e.image.height;var i=a.getContext("2d");i.translate(0,a.height),i.scale(1,-1),i.drawImage(e.image,0,0,e.image.width,e.image.height);var s=i.getImageData(0,0,a.width,a.height);return s}return null}}var RE=function(e,r,n,a){for(var i=[1,2,1],s=4,f=i,o=s,u=e.length/(r*n),g=r,c=n,l=e,h=[l],y=0;y<a;y++){var S=Ce(l);g/=2,c/=2,l=new Uint8ClampedArray(g*c*u);for(var T=u*g,E=0,x=0;x<l.length;x+=u){x%T===0&&(E+=2*u*g);for(var w=0;w<u;w++){var C=S[E+w];C+=S[E+u+w],C+=S[E-2*T+w],C+=S[E-2*T+u+w],C/=4,l[x+w]=C}E+=2*u}for(var m=Ce(l),D=0;D<l.length;D+=u)for(var b=0;b<u;b++){for(var F=-(f.length-1)/2,U=o,O=0,A=0;A<f.length;A++){var W=D+b+F*u,j=W%T-(D+b)%T;j>u&&(W+=T),j<-u&&(W-=T),m[W]?O+=m[W]*f[A]:U-=f[A],F+=1}l[D+b]=O/U}m=Ce(l);for(var N=0;N<l.length;N+=u)for(var I=0;I<u;I++){for(var X=-(f.length-1)/2,J=o,P=0,G=0;G<f.length;G++){var K=N+I+X*T;m[K]?P+=m[K]*f[G]:J-=f[G],X+=1}l[N+I]=P/J}h.push(l)}return h},LE={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0};function Dl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LE,r),L.obj(t,e),L.algo(t,e,6,0),L.get(t,e,["canvas","image","jsImageData","imageLoaded"]),L.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),mE(t,e)}var VE=L.newInstance(Dl,"vtkTexture"),_E={generateMipmaps:RE},zi=DE({newInstance:VE,extend:Dl},_E);function ic(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ic(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ic(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var bE=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],sc=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],Wa=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],oc=[0,1,0,1,0,1,0,1,2,2,2,2],$e=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],le=new Float64Array(3),ja=new Float64Array(3),be=new Float64Array(3),Hr=new Float64Array(3),Ur=new Float64Array(3),$a=new Float64Array(3),_s=new Float64Array(16);function bs(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function kE(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=function(r){e.renderable!==r&&(e.renderable=r,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(r.getProperty()),e.tmActor.setParentProp(r),t.modified())},t.createPolyDataForOneLabel=function(r,n,a,i,s,f,o){var u=e.renderable.get_tmAtlas().get(r);if(!!u){var g=e.renderable.getTextPolyData().getPoints().getData(),c=e.lastSize;le[0]=g[n*3],le[1]=g[n*3+1],le[2]=g[n*3+2],me(be,le,a),be[0]+=.1,me(ja,be,i),Er(Ur,ja,le),be[0]-=.1,be[1]+=.1,me(ja,be,i),Er($a,ja,le);for(var l=0;l<3;l++)Ur[l]/=.5*.1*c[0],$a[l]/=.5*.1*c[1];var h=o.ptIdx,y=o.cellIdx;le[0]=g[n*3],le[1]=g[n*3+1],le[2]=g[n*3+2],s[0]<-.5?hr(be,Ur,s[0]*f-u.width):s[0]>.5?hr(be,Ur,s[0]*f):hr(be,Ur,s[0]*f-u.width/2),Kn(le,le,be),hr(be,$a,s[1]*f-u.height/2),Kn(le,le,be),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[0],o.tcoords[h*2+1]=u.tcoords[1],h++,hr(be,Ur,u.width),Kn(le,le,be),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[2],o.tcoords[h*2+1]=u.tcoords[3],h++,hr(be,$a,u.height),Kn(le,le,be),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[4],o.tcoords[h*2+1]=u.tcoords[5],h++,hr(be,Ur,u.width),Er(le,le,be),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[6],o.tcoords[h*2+1]=u.tcoords[7],h++,o.polys[y*4]=3,o.polys[y*4+1]=h-4,o.polys[y*4+2]=h-3,o.polys[y*4+3]=h-2,y++,o.polys[y*4]=3,o.polys[y*4+1]=h-4,o.polys[y*4+2]=h-2,o.polys[y*4+3]=h-1,o.ptIdx+=4,o.cellIdx+=2}},t.updateTexturePolyData=function(){var r=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);ze(r,r);var n=e.renderable.getTextValues().length,a=n*4,i=n*2,s=new Float64Array(a*3),f=new Uint16Array(i*4),o=new Float32Array(a*2);xt(_s,r);for(var u={ptIdx:0,cellIdx:0,polys:f,points:s,tcoords:o},g=0,c=0,l=0,h=e.renderable.getTextPolyData().getPoints().getData(),y=e.renderable.getTextValues();g<h.length/3;){le[0]=h[g*3],le[1]=h[g*3+1],le[2]=h[g*3+2],me(be,le,r),le[0]=h[g*3+3],le[1]=h[g*3+4],le[2]=h[g*3+5],me(Hr,le,r),Er(be,be,Hr);var S=[be[0],be[1]];V2(S),t.createPolyDataForOneLabel(y[c],g,r,_s,S,e.renderable.getAxisTitlePixelOffset(),u),g+=2,c++;for(var T=0;T<e.renderable.getTickCounts()[l];T++)t.createPolyDataForOneLabel(y[c],g,r,_s,S,e.renderable.getTickLabelPixelOffset(),u),g++,c++;l++}var E=Ne.newInstance({numberOfComponents:2,values:o,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(E),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(f,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=function(r,n,a){(e.lastSize[0]!==r[0]||e.lastSize[1]!==r[1])&&(e.lastSize[0]=r[0],e.lastSize[1]=r[1],e.lastAspectRatio=r[0]/r[1],e.forceUpdate=!0),e.camera=n,t.updateTexturePolyData()}}var FE=L.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),L.obj(t,e),e.tmPolyData=Rr.newInstance(),e.tmMapper=mr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=Mr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),L.setGet(t,e,["renderable"]),L.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},L.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},L.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],kE(t,e)},"vtkCubeAxesActorHelper");function BE(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=function(r){e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=function(){var r=e.camera.getViewMatrix();ze(r,r);for(var n=!1,a=je.getDiagonalLength(e.dataBounds),i=Math.sin(e.faceVisibilityAngle*Math.PI/180),s=0;s<6;s++){var f=!1,o=Math.floor(s/2),u=(o+1)%3,g=(o+2)%3;e.dataBounds[u*2]!==e.dataBounds[u*2+1]&&e.dataBounds[g*2]!==e.dataBounds[g*2+1]&&(le[o]=e.dataBounds[s]-.1*a*bE[s][o],le[u]=.5*(e.dataBounds[u*2]+e.dataBounds[u*2+1]),le[g]=.5*(e.dataBounds[g*2]+e.dataBounds[g*2+1]),me(be,le,r),le[o]=e.dataBounds[s],me(Hr,le,r),Er(be,Hr,be),oa(be,be),f=be[2]>i,e.camera.getParallelProjection()||(oa(Hr,Hr),f=Cg(Hr,be)>i)),f!==e.lastFacesToDraw[s]&&(e.lastFacesToDraw[s]=f,n=!0)}return n},t.updatePolyData=function(r,n,a){var i=0,s=0;i+=8;for(var f=0,o=0;o<12;o++)n[o]>0&&f++;if(s+=f,e.gridLines)for(var u=0;u<6;u++)r[u]&&(i+=a[$e[u][0]].length*2+a[$e[u][1]].length*2,s+=a[$e[u][0]].length+a[$e[u][1]].length);for(var g=new Float64Array(i*3),c=new Uint32Array(s*3),l=0,h=0,y=0;y<2;y++)for(var S=0;S<2;S++)for(var T=0;T<2;T++)g[l*3]=e.dataBounds[T],g[l*3+1]=e.dataBounds[2+S],g[l*3+2]=e.dataBounds[4+y],l++;for(var E=0;E<12;E++)n[E]>0&&(c[h*3]=2,c[h*3+1]=Wa[E][0],c[h*3+2]=Wa[E][1],h++);if(e.gridLines){for(var x=0;x<6;x++)if(r[x]){for(var w=Math.floor(x/2),C=a[$e[x][0]],m=0;m<C.length;m++)g[l*3+w]=e.dataBounds[x],g[l*3+$e[x][0]]=C[m],g[l*3+$e[x][1]]=e.dataBounds[$e[x][1]*2],l++,g[l*3+w]=e.dataBounds[x],g[l*3+$e[x][0]]=C[m],g[l*3+$e[x][1]]=e.dataBounds[$e[x][1]*2+1],l++,c[h*3]=2,c[h*3+1]=l-2,c[h*3+2]=l-1,h++;C=a[$e[x][1]];for(var D=0;D<C.length;D++)g[l*3+w]=e.dataBounds[x],g[l*3+$e[x][1]]=C[D],g[l*3+$e[x][0]]=e.dataBounds[$e[x][0]*2],l++,g[l*3+w]=e.dataBounds[x],g[l*3+$e[x][1]]=C[D],g[l*3+$e[x][0]]=e.dataBounds[$e[x][0]*2+1],l++,c[h*3]=2,c[h*3+1]=l-2,c[h*3+2]=l-1,h++}}e.polyData.getPoints().setData(g,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(c,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=function(r,n,a,i){for(var s=0,f=0;f<12;f++)n[f]===1&&(s+=2,s+=a[oc[f]].length);for(var o=e.polyData.getPoints().getData(),u=new Float64Array(s*3),g=0,c=0,l=0,h=0;h<6;h++)if(r[h])for(var y=0;y<4;y++){var S=sc[h][y];if(n[S]===1){var T=oc[S],E=Wa[S][0]*3,x=Wa[S][1]*3;u[g*3]=.5*(o[E]+o[x]),u[g*3+1]=.5*(o[E+1]+o[x+1]),u[g*3+2]=.5*(o[E+2]+o[x+2]),g++;var w=Math.floor(h/2);u[g*3+w]=e.dataBounds[h],u[g*3+$e[h][0]]=.5*(e.dataBounds[$e[h][0]*2]+e.dataBounds[$e[h][0]*2+1]),u[g*3+$e[h][1]]=.5*(e.dataBounds[$e[h][1]*2]+e.dataBounds[$e[h][1]*2+1]),g++,e.textValues[c]=e.axisLabels[T],c++;var C=(T+1)%3,m=(T+2)%3,D=a[T],b=i[T];e.tickCounts[l]=D.length;for(var F=0;F<D.length;F++)u[g*3+T]=D[F],u[g*3+C]=o[E+C],u[g*3+m]=o[E+m],g++,e.textValues[c]=b[F],c++;l++}}e.textPolyData.getPoints().setData(u,3),e.textPolyData.modified()},t.update=function(){if(!!e.camera){for(var r=t.computeFacesToDraw(),n=e.lastFacesToDraw,a=!1,i=0;i<6;i++)e.dataBounds[i]!==e.lastTickBounds[i]&&(a=!0,e.lastTickBounds[i]=e.dataBounds[i]);if(r||a||e.forceUpdate){for(var s=new Array(12).fill(0),f=0;f<6;f++)if(n[f])for(var o=0;o<4;o++)s[sc[f][o]]++;for(var u=[],g=[],c=0;c<3;c++){var l=Po().domain([e.dataBounds[c*2],e.dataBounds[c*2+1]]);u[c]=l.ticks(5);var h=l.tickFormat(5);g[c]=u[c].map(h)}t.updatePolyData(n,s,u),t.updateTextData(n,s,u,g),(a||e.forceUpdate)&&t.updateTextureAtlas(g)}e.forceUpdate=!1}},t.updateTextureAtlas=function(r){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();for(var n=0,a=1,i=0;i<3;i++){if(!e._tmAtlas.has(e.axisLabels[i])){bs(e.tmContext,e.axisTextStyle);var s=e.tmContext.measureText(e.axisLabels[i]),f={height:s.actualBoundingBoxAscent+2,startingHeight:a,width:s.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[i],f),a+=f.height,n<f.width&&(n=f.width)}bs(e.tmContext,e.tickTextStyle);for(var o=0;o<r[i].length;o++)if(!e._tmAtlas.has(r[i][o])){var u=e.tmContext.measureText(r[i][o]),g={height:u.actualBoundingBoxAscent+2,startingHeight:a,width:u.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[i][o],g),a+=g.height,n<g.width&&(n=g.width)}}n=Pt(n),a=Pt(a),e._tmAtlas.forEach(function(c){c.tcoords=[0,(a-c.startingHeight-c.height)/a,c.width/n,(a-c.startingHeight-c.height)/a,c.width/n,(a-c.startingHeight)/a,0,(a-c.startingHeight)/a]}),e.tmCanvas.width=n,e.tmCanvas.height=a,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,n,a),e._tmAtlas.forEach(function(c,l){bs(e.tmContext,c.textStyle),e.tmContext.fillText(l,1,c.startingHeight+c.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(function(){e.forceUpdate=!0,t.update()}),t.setTickTextStyle=function(r){e.tickTextStyle=qn(qn({},e.tickTextStyle),r),t.modified()},t.setAxisTextStyle=function(r){e.axisTextStyle=qn(qn({},e.axisTextStyle),r),t.modified()},t.get_tmAtlas=function(){return e._tmAtlas},t.getBounds=function(){return t.update(),je.setBounds(e.bounds,e.gridActor.getBounds()),je.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds}}function NE(t){return qn({boundsScaleFactor:1.3,camera:null,dataBounds:Ce(je.INIT_BOUNDS),faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:12,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"}},t)}function ml(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NE(r)),Mr.extend(t,e,r),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=zi.newInstance(),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=mr.newInstance(),e.polyData=Rr.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=Mr.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=Rr.newInstance(),L.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset"]),L.setGetArray(t,e,["dataBounds"],6),L.setGetArray(t,e,["axisLabels"],3),L.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),BE(t,e)}var UE=L.newInstance(ml,"vtkCubeAxesActor"),Rl={newInstance:UE,extend:ml,newCubeAxesActorHelper:FE};function GE(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=function(r){r&&(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.openGLRenderWindow=e.openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.openGLRenderer?e.openGLRenderer.getRenderable().getActiveCamera():null,i=e.openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.openGLRenderWindow.getRenderable())}}}var AE={};function PE(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AE,r),Ie.extend(t,e,r),e.CubeAxesActorHelper=Rl.newCubeAxesActorHelper(),GE(t,e)}var zE=Ue(PE,"vtkOpenGLCubeAxesActor");Mt("vtkCubeAxesActor",zE);var sr={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2},Ll={ObjectType:sr};function fc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function uc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var li=Ll.ObjectType,WE={};function jE(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function r(f){switch(f){case li.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case li.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case li.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}var n=null,a=null,i=!0,s="";t.getType=function(){return n},t.setType=function(f){n=f},t.getHandle=function(){return a},t.isReady=function(){return i===!1},t.generateBuffer=function(f){var o=r(f);return a===null&&(a=e.context.createBuffer(),n=f),r(n)===o},t.upload=function(f,o){var u=t.generateBuffer(o);return u?(e.context.bindBuffer(r(n),a),e.context.bufferData(r(n),f,e.context.STATIC_DRAW),i=!1,!0):(s="Trying to upload array buffer to incompatible buffer.",!1)},t.bind=function(){return a?(e.context.bindBuffer(r(n),a),!0):!1},t.release=function(){return a?(e.context.bindBuffer(r(n),null),!0):!1},t.releaseGraphicsResources=function(){a!==null&&(e.context.bindBuffer(r(n),null),e.context.deleteBuffer(a),a=null)},t.setOpenGLRenderWindow=function(f){e._openGLRenderWindow!==f&&(t.releaseGraphicsResources(),e._openGLRenderWindow=f,e.context=null,f&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=function(){return s}}var $E={objectType:li.ARRAY_BUFFER,context:null};function Vl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$E,r),L.obj(t,e),L.get(t,e,["_openGLRenderWindow"]),L.moveToProtected(t,e,["openGLRenderWindow"]),jE(t,e)}var HE=L.newInstance(Vl),Wi=uc(uc({newInstance:HE,extend:Vl},WE),Ll),cc=L.vtkErrorMacro;function KE(t,e){var r=new Float64Array(3);sd(r,e);var n=new Float64Array(16);return lg(n,Ir(),t,r),n}function XE(t,e){return t===null||e===null?!1:!(Wf(t,[0,0,0])&&Wf(e,[1,1,1]))}function YE(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(sr.ARRAY_BUFFER),t.createVBO=function(r,n,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!r.getData()||!r.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];var f=i.points.getData(),o=null,u=null,g=null,c=i.colors?i.colors.getNumberOfComponents():0,l=i.tcoords?i.tcoords.getNumberOfComponents():0;i.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,o=i.normals.getData()),i.customAttributes&&i.customAttributes.forEach(function(we){we&&(e.customData.push({data:we.getData(),offset:4*e.blockSize,components:we.getNumberOfComponents(),name:we.getName()}),e.blockSize+=we.getNumberOfComponents())}),i.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=l,e.blockSize+=l,u=i.tcoords.getData()),i.colors?(e.colorComponents=i.colors.getNumberOfComponents(),e.colorOffset=0,g=i.colors.getData(),e.colorBO||(e.colorBO=Wi.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;var h=0,y=0,S=0,T=0,E=0,x=0,w,C={anythingToPoints:function(ne,oe,Te){for(var ue=0;ue<ne;++ue)w(oe[Te+ue])},linesToWireframe:function(ne,oe,Te){for(var ue=0;ue<ne-1;++ue)w(oe[Te+ue]),w(oe[Te+ue+1])},polysToWireframe:function(ne,oe,Te){if(ne>2)for(var ue=0;ue<ne;++ue)w(oe[Te+ue]),w(oe[Te+(ue+1)%ne])},stripsToWireframe:function(ne,oe,Te){if(ne>2){for(var ue=0;ue<ne-1;++ue)w(oe[Te+ue]),w(oe[Te+ue+1]);for(var ie=0;ie<ne-2;ie++)w(oe[Te+ie]),w(oe[Te+ie+2])}},polysToSurface:function(ne,oe,Te){for(var ue=0;ue<ne-2;ue++)w(oe[Te+0]),w(oe[Te+ue+1]),w(oe[Te+ue+2])},stripsToSurface:function(ne,oe,Te){for(var ue=0;ue<ne-2;ue++)w(oe[Te+ue]),w(oe[Te+ue+1+ue%2]),w(oe[Te+ue+1+(ue+1)%2])}},m={anythingToPoints:function(ne,oe){return ne},linesToWireframe:function(ne,oe){return ne>1?(ne-1)*2:0},polysToWireframe:function(ne,oe){return ne>2?ne*2:0},stripsToWireframe:function(ne,oe){return ne>2?ne*4-6:0},polysToSurface:function(ne,oe){return ne>2?(ne-2)*3:0},stripsToSurface:function(ne,oe,Te){return ne>2?(ne-2)*3:0}},D=null,b=null;a===_t.POINTS||n==="verts"?(D=C.anythingToPoints,b=m.anythingToPoints):a===_t.WIREFRAME||n==="lines"?(D=C["".concat(n,"ToWireframe")],b=m["".concat(n,"ToWireframe")]):(D=C["".concat(n,"ToSurface")],b=m["".concat(n,"ToSurface")]);for(var F=r.getData(),U=F.length,O=0,A=0;A<U;)O+=b(F[A],F),A+=F[A]+1;var W=null,j=new Float32Array(O*e.blockSize);g&&(W=new Uint8Array(O*4));for(var N=0,I=0,X=0,J=0,P=0;P<3;++P){var G=i.points.getRange(P),K=G[1]-G[0];X+=K*K;var te=.5*(G[1]+G[0]);J+=te*te}var ee=X>0&&(Math.abs(J)/X>1e6||Math.abs(Math.log10(X))>3||X===0&&J>1e6);if(ee){for(var fe=new Float64Array(3),ve=new Float64Array(3),ce=0;ce<3;++ce){var pe=i.points.getRange(ce),Re=pe[1]-pe[0];fe[ce]=.5*(pe[1]+pe[0]),ve[ce]=Re>0?1/Re:1}t.setCoordShiftAndScale(fe,ve)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(s)if(!s.points&&!s.cells)s.points=new Int32Array(O),s.cells=new Int32Array(O);else{var qe=new Int32Array(O+s.points.length);qe.set(s.points),s.points=qe;var He=new Int32Array(O+s.points.length);He.set(s.cells),s.cells=He}var We=i.vertexOffset;w=function(ne){if(s&&(s.points[We]=ne,s.cells[We]=x),++We,h=ne*3,e.coordShiftAndScaleEnabled?(j[N++]=(f[h++]-e.coordShift[0])*e.coordScale[0],j[N++]=(f[h++]-e.coordShift[1])*e.coordScale[1],j[N++]=(f[h++]-e.coordShift[2])*e.coordScale[2]):(j[N++]=f[h++],j[N++]=f[h++],j[N++]=f[h++]),o!==null&&(i.haveCellNormals?y=(x+i.cellOffset)*3:y=ne*3,j[N++]=o[y++],j[N++]=o[y++],j[N++]=o[y++]),e.customData.forEach(function(Te){E=ne*Te.components;for(var ue=0;ue<Te.components;++ue)j[N++]=Te.data[E++]}),u!==null){S=ne*l;for(var oe=0;oe<l;++oe)j[N++]=u[S++]}g!==null&&(i.haveCellScalars?T=(x+i.cellOffset)*c:T=ne*c,W[I++]=g[T++],W[I++]=g[T++],W[I++]=g[T++],W[I++]=c===4?g[T++]:255)};for(var tt=0;tt<U;)D(F[tt],F,tt+1),tt+=F[tt]+1,x++;return e.elementCount=O,t.upload(j,sr.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(W,sr.ARRAY_BUFFER)),x},t.setCoordShiftAndScale=function(r,n){if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){cc("Wrong type for coordShift, expected vec3 or null");return}if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){cc("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||r===null||!jf(r,e.coordShift))&&(e.coordShift=r),(e.coordScale===null||n===null||!jf(n,e.coordScale))&&(e.coordScale=n),e.coordShiftAndScaleEnabled=XE(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=KE(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}var IE={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function _l(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IE,r),Wi.extend(t,e,r),L.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),L.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),YE(t,e)}var qE=L.newInstance(_l),ZE={newInstance:qE,extend:_l},QE=L.vtkErrorMacro;function JE(t,e){e.classHierarchy.push("vtkShader"),t.compile=function(){var r=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":r=e.context.FRAGMENT_SHADER;break;case"Vertex":default:r=e.context.VERTEX_SHADER;break}e.handle=e.context.createShader(r),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle);var n=e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS);if(!n){var a=e.context.getShaderInfoLog(e.handle);return QE("Error compiling shader '".concat(e.source,"': ").concat(a)),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}var ew={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function bl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ew,r),L.obj(t,e),L.setGet(t,e,["shaderType","source","error","handle","context"]),JE(t,e)}var tw=L.newInstance(bl,"vtkShader"),ks={newInstance:tw,extend:bl},Ht=L.vtkErrorMacro;function rw(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Array.isArray(r)?r.join(`
`):r,i=!1;t.search(e)!==-1&&(i=!0);var s="";n&&(s="g");var f=new RegExp(e,s),o=t.replace(f,a);return{replace:i,result:o}}function nw(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=function(){return e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(Ht(e.error),0):t.link()?(t.setCompiled(!0),1):(Ht("Links failed: ".concat(e.error)),0):(Ht(e.fragmentShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),Ht(e.fragmentShader.getError()),0):(Ht(e.vertexShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),Ht(e.vertexShader.getError()),0)},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0)},t.bind=function(){return!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0)},t.isBound=function(){return!!e.bound},t.release=function(){e.context.useProgram(null),t.setBound(!1)},t.setContext=function(r){e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.link=function(){if(e.inked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;e.uniformLocs={},e.context.linkProgram(e.handle);var r=e.context.getProgramParameter(e.handle,e.context.LINK_STATUS);if(!r){var n=e.context.getProgramInfoLog(e.handle);return Ht("Error linking shader ".concat(n)),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix4fv(a,!1,i),!0},t.setUniformMatrix3x3=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix3fv(a,!1,i),!0},t.setUniformf=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1f(a,n),!0)},t.setUniformfv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1fv(a,n),!0)},t.setUniformi=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1i(a,n),!0)},t.setUniformiv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1iv(a,n),!0)},t.setUniform2f=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(i,n,a),!0},t.setUniform2fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2fv(a,n),!0)},t.setUniform2i=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(i,n,a),!0},t.setUniform2iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2iv(a,n),!0)},t.setUniform3f=function(r,n,a,i){var s=t.findUniform(r);if(s===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(s,n,a,i),!0},t.setUniform3fArray=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(!Array.isArray(n)||n.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(a,n[0],n[1],n[2]),!0},t.setUniform3fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3fv(a,n),!0)},t.setUniform3i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(n,f[0],f[1],f[2]),!0},t.setUniform3iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3iv(a,n),!0)},t.setUniform4f=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(n,f[0],f[1],f[2],f[3]),!0},t.setUniform4fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4fv(a,n),!0)},t.setUniform4i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(n,f[0],f[1],f[2],f[3]),!0},t.setUniform4iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4iv(a,n),!0)},t.findUniform=function(r){if(!r||!e.linked)return-1;var n=e.uniformLocs[r];return n!==void 0?n:(n=e.context.getUniformLocation(e.handle,r),n===null?(e.error="Uniform ".concat(r," not found in current shader program."),e.uniformLocs[r]=-1,-1):(e.uniformLocs[r]=n,n))},t.isUniformUsed=function(r){if(!r)return!1;var n=e.uniformLocs[r];return n!==void 0?n!==null:e.linked?(n=e.context.getUniformLocation(e.handle,r),e.uniformLocs[r]=n,n!==null):(Ht("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=function(r){if(!r)return!1;if(r in e.attributeLocs)return!0;if(!e.linked)return Ht("attempt to find uniform when the shader program is not linked"),!1;var n=e.context.getAttribLocation(e.handle,r);return n===-1?!1:(e.attributeLocs[r]=n,!0)},t.attachShader=function(r){if(r.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){var n=e.context.createProgram();if(n===0)return e.error="Could not create shader program.",!1;e.handle=n,e.linked=!1}return r.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.comntext.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=r.getHandle()),r.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=r.getHandle()),e.context.attachShader(e.handle,r.getHandle()),t.setLinked(!1),!0},t.detachShader=function(r){if(r.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),r.getShaderType()){case"Vertex":return e.vertexShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=function(r){e.context=r,e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.setLastCameraMTime=function(r){e.lastCameraMTime=r}}var aw={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function kl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aw,r),e.attributesLocs={},e.uniformLocs={},e.vertexShader=ks.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=ks.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=ks.newInstance(),e.geometryShader.setShaderType("Geometry"),L.obj(t,e),L.get(t,e,["lastCameraMTime"]),L.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),nw(t,e)}var iw=L.newInstance(kl,"vtkShaderProgram"),$={newInstance:iw,extend:kl,substitute:rw};function sw(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=function(){},t.initialize=function(){e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=function(){return e.handleVAO!==0||e.supported===!1},t.bind=function(){if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],f=s.isMatrix?s.size:1,o=0;o<f;++o)r.enableVertexAttribArray(s.index+o),r.vertexAttribPointer(s.index+o,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*o/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+o,1):r.vertexAttribDivisor(s.index+o,1))}},t.release=function(){if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],f=s.isMatrix?s.size:1,o=0;o<f;++o)r.enableVertexAttribArray(s.index+o),r.vertexAttribPointer(s.index+o,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*o/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+o,0):r.vertexAttribDivisor(s.index+o,0)),r.disableVertexAttribArray(s.index+o)}},t.shaderProgramChanged=function(){t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=function(){t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=function(r,n,a,i,s,f,o,u){return t.addAttributeArrayWithDivisor(r,n,a,i,s,f,o,u,0,!1)},t.addAttributeArrayWithDivisor=function(r,n,a,i,s,f,o,u,g,c){if(!r||!r.isBound()||n.getHandle()===0||n.getType()!==sr.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=r.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==r.getHandle()))return!1;var l=e.context,h={};if(h.name=a,h.index=l.getAttribLocation(e.handleProgram,a),h.offset=i,h.stride=s,h.type=f,h.size=o,h.normalize=u,h.isMatrix=c,h.divisor=g,h.Index===-1)return!1;if(n.bind(),l.enableVertexAttribArray(h.index),l.vertexAttribPointer(h.index,h.size,h.type,h.normalize,h.stride,h.offset),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h.index,1):l.vertexAttribDivisor(h.index,1)),h.buffer=n.getHandle(),!e.supported){for(var y=!1,S=0;S<e.buffers.length;++S){var T=e.buffers[S];if(T.buffer===h.buffer){y=!0;for(var E=!1,x=0;x<T.attributes.length;++x){var w=T.attributes[x];w.name===a&&(E=!0,T.attributes[x]=h)}E||T.attributes.push(h)}}y||e.buffers.push({buffer:h.buffer,attributes:[h]})}return!0},t.addAttributeMatrixWithDivisor=function(r,n,a,i,s,f,o,u,g){var c=t.addAttributeArrayWithDivisor(r,n,a,i,s,f,o,u,g,!0);if(!c)return c;for(var l=e.context,h=l.getAttribLocation(e.handleProgram,a),y=1;y<o;y++)l.enableVertexAttribArray(h+y),l.vertexAttribPointer(h+y,o,f,u,s,i+s*y/o),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h+y,1):l.vertexAttribDivisor(h+y,1));return!0},t.removeAttributeArray=function(r){if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(var n=0;n<e.buffers.length;++n)for(var a=e.buffers[n],i=0;i<a.attributes.length;++i){var s=a.attributes[i];if(s.name===r)return a.attributes.splice(i,1),a.attributes.length||e.buffers.splice(n,1),!0}return!0},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var ow={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function Fl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ow,r),e.buffers=[],L.obj(t,e),L.get(t,e,["supported"]),L.setGet(t,e,["forceEmulation"]),sw(t,e)}var fw=L.newInstance(Fl,"vtkOpenGLVertexArrayObject"),Bl={newInstance:fw,extend:Fl},yr={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function uw(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=function(r){e.context=r.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(r),e.CABO.setOpenGLRenderWindow(r)},t.releaseGraphicsResources=function(r){e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=function(r,n,a,i){if(e.CABO.getElementCount()){var s=t.getOpenGLMode(a),f=t.haveWideLines(r,n),o=e.context,u=o.getParameter(o.DEPTH_WRITEMASK);e.pointPicking&&o.depthMask(!1);var g=s===o.LINES;g&&f?(t.updateShaders(r,n,i),o.drawArraysInstanced(s,0,e.CABO.getElementCount(),2*Math.ceil(n.getProperty().getLineWidth()))):(o.lineWidth(n.getProperty().getLineWidth()),t.updateShaders(r,n,i),o.drawArrays(s,0,e.CABO.getElementCount()),o.lineWidth(1));var c=(s===o.POINTS?1:0)||(s===o.LINES?2:3);return e.pointPicking&&o.depthMask(u),e.CABO.getElementCount()/c}return 0},t.getOpenGLMode=function(r){if(e.pointPicking)return e.context.POINTS;var n=e.primitiveType;return r===_t.POINTS||n===yr.Points?e.context.POINTS:r===_t.WIREFRAME||n===yr.Lines||n===yr.TrisEdges||n===yr.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=function(r,n){return n.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=n.getProperty().getLineWidth()):!1},t.getNeedToRebuildShaders=function(r,n,a){return!!(a.getNeedToRebuildShaders(t,r,n)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<a.getMTime()||t.getShaderSourceTime().getMTime()<n.getMTime())},t.updateShaders=function(r,n,a){if(t.getNeedToRebuildShaders(r,n,a)){var i={Vertex:null,Fragment:null,Geometry:null};a.buildShaders(i,r,n);var s=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(i.Vertex,i.Fragment,i.Geometry);s!==t.getProgram()&&(t.setProgram(s),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),a.setMapperShaderParameters(t,r,n),a.setPropertyShaderParameters(t,r,n),a.setCameraShaderParameters(t,r,n),a.setLightingShaderParameters(t,r,n),a.invokeShaderCallbacks(t,r,n)},t.setMapperShaderParameters=function(r,n,a){if(t.haveWideLines(r,n)){t.getProgram().setUniform2f("viewportSize",a.usize,a.vsize);var i=parseFloat(n.getProperty().getLineWidth()),s=i/2;t.getProgram().setUniformf("lineWidthStepSize",i/Math.ceil(i)),t.getProgram().setUniformf("halfLineWidth",s)}e.primitiveType===yr.Points||n.getProperty().getRepresentation()===_t.POINTS?t.getProgram().setUniformf("pointSize",n.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=function(r,n,a){var i=r.Vertex;i=$.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,i=$.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(n,a)&&(i=$.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,i=$.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),r.Vertex=i},t.getPointPickingPrimitiveSize=function(){return e.primitiveType===yr.Points?2:e.primitiveType===yr.Lines?4:6}}var cw={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function Nl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cw,r),L.obj(t,e),e.shaderSourceTime={},L.obj(e.shaderSourceTime),e.attributeUpdateTime={},L.obj(e.attributeUpdateTime),L.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=$.newInstance(),e.VAO=Bl.newInstance(),e.CABO=ZE.newInstance(),uw(t,e)}var gw=L.newInstance(Nl),_n={newInstance:gw,extend:Nl,primTypes:yr},vw={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},So={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5},Jo={Wrap:vw,Filter:So},Ul=new Float32Array(1),lw=new Int32Array(Ul.buffer);function pw(t){Ul[0]=t;var e=lw[0],r=e>>16&32768,n=e>>12&2047,a=e>>23&255;return a<103?r:a>142?(r|=31744,r|=(a===255?0:1)&&e&8388607,r):a<113?(n|=2048,r|=(n>>114-a)+(n>>113-a&1),r):(r|=a-112<<10|n>>1,r+=n&1,r)}function hw(t){var e=(t&32768)>>15,r=(t&31744)>>10,n=t&1023;return r===0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r===31?n?NaN:(e?-1:1)*(1/0):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}var zr={fromHalf:hw,toHalf:pw};function gc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var nr=Jo.Wrap,st=Jo.Filter,Ge=Ne.VtkDataTypes,Fs=Or,fn=ge,dw=Fi;function Tw(t,e){var r=this;e.classHierarchy.push("vtkOpenGLTexture"),t.render=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(o?e._openGLRenderWindow=o:(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent()),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(st.LINEAR),t.setMagnificationFilter(st.LINEAR)):(t.setMinificationFilter(st.NEAREST),t.setMagnificationFilter(st.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(nr.REPEAT),t.setWrapS(nr.REPEAT),t.setWrapT(nr.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR));var u=e.renderable.getCanvas();t.create2DFromRaw(u.width,u.height,4,Ge.UNSIGNED_CHAR,u,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){var g=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(g.width,g.height,4,Ge.UNSIGNED_CHAR,g.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}var c=e.renderable.getInputData(0);if(c&&c.getPointData().getScalars()){for(var l=c.getExtent(),h=c.getPointData().getScalars(),y=[],S=0;S<e.renderable.getNumberOfInputPorts();++S){var T=e.renderable.getInputData(S),E=T?T.getPointData().getScalars().getData():null;E&&y.push(E)}e.renderable.getInterpolate()&&h.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR)),y.length%6===0?t.createCubeFromRaw(l[1]-l[0]+1,l[3]-l[2]+1,h.getNumberOfComponents(),h.getDataType(),y):t.create2DFromRaw(l[1]-l[0]+1,l[3]-l[2]+1,h.getNumberOfComponents(),h.getDataType(),h.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()},t.destroyTexture=function(){t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=function(){e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=function(){return e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1},t.activate=function(){e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=function(){e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=function(o){o&&e.handle&&(o.activateTexture(t),o.deactivateTexture(t),e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(o),e.shaderProgram=null)},t.bind=function(){e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=function(){var o=!1;if(e.context&&e.handle){var u=0;switch(e.target){case e.context.TEXTURE_2D:u=e.context.TEXTURE_BINDING_2D;break;default:dw("impossible case");break}var g=e.context.getIntegerv(u);o=g===e.handle}return o},t.sendParameters=function(){e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=function(o,u){return e.internalFormat||(e.internalFormat=t.getDefaultInternalFormat(o,u)),e.internalFormat||Fs("Unable to find suitable internal format for T=".concat(o," NC= ").concat(u)),e.internalFormat},t.getDefaultInternalFormat=function(o,u){var g=0;return g=e._openGLRenderWindow.getDefaultTextureInternalFormat(o,u,!1),g||(g=r._openGLRenderWindow.getDefaultTextureInternalFormat(o,u,!0),g||(Fs("Unsupported internal texture type!"),Fs("Unable to find suitable internal format for T=".concat(o," NC= ").concat(u))),g)},t.setInternalFormat=function(o){o!==e.internalFormat&&(e.internalFormat=o,t.modified())},t.getFormat=function(o,u){return e.format=t.getDefaultFormat(o,u),e.format},t.getDefaultFormat=function(o,u){if(e._openGLRenderWindow.getWebgl2())switch(u){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(u){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=function(){e.format=0,e.internalFormat=0,e.openGLDataType=0},t.getDefaultDataType=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e._openGLRenderWindow.getWebgl2())switch(o){case Ge.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(u&&Ge.SHORT):return e.context.HALF_FLOAT;case(u&&Ge.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case Ge.FLOAT:case Ge.VOID:default:return e.context.FLOAT}switch(o){case Ge.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case Ge.FLOAT:case Ge.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{var g=e.context.getExtension("OES_texture_half_float");if(g&&e.context.getExtension("OES_texture_half_float_linear"))return g.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return e.openGLDataType||(e.openGLDataType=t.getDefaultDataType(o,u)),e.openGLDataType},t.getShiftAndScale=function(){var o=0,u=1;switch(e.openGLDataType){case e.context.BYTE:u=127.5,o=u-128;break;case e.context.UNSIGNED_BYTE:u=255,o=0;break;case e.context.SHORT:u=32767.5,o=u-32768;break;case e.context.UNSIGNED_SHORT:u=65536,o=0;break;case e.context.INT:u=21474836475e-1,o=u-2147483648;break;case e.context.UNSIGNED_INT:u=4294967295,o=0;break;case e.context.FLOAT:}return{shift:o,scale:u}},t.getOpenGLFilterMode=function(o){switch(o){case st.NEAREST:return e.context.NEAREST;case st.LINEAR:return e.context.LINEAR;case st.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case st.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case st.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case st.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=function(o){switch(o){case nr.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case nr.REPEAT:return e.context.REPEAT;case nr.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function n(o,u){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=[],l=e.width*e.height*e.components;if(g&&(l*=e.depth),o!==Ge.FLOAT&&e.openGLDataType===e.context.FLOAT)for(var h=0;h<u.length;h++)if(u[h]){var y=u[h].length>l?u[h].subarray(0,l):u[h];c.push(new Float32Array(y))}else c.push(null);if(o!==Ge.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(var S=0;S<u.length;S++)if(u[S]){var T=u[S].length>l?u[S].subarray(0,l):u[S];c.push(new Uint8Array(T))}else c.push(null);var E=e.context.getExtension("OES_texture_half_float"),x=e._openGLRenderWindow.getWebgl2()?e.openGLDataType===e.context.HALF_FLOAT:E&&e.openGLDataType===E.HALF_FLOAT_OES;if(x)for(var w=0;w<u.length;w++)if(u[w]){for(var C=new Uint16Array(l),m=0;m<l;m++)C[m]=zr.toHalf(u[w][m]);c.push(C)}else c.push(null);if(c.length===0)for(var D=0;D<u.length;D++)c.push(u[D]);return c}function a(o){if(e._openGLRenderWindow.getWebgl2())return o;var u=[],g=e.width,c=e.height,l=e.components;if(o&&(!Aa(g)||!Aa(c)))for(var h=e.context.getExtension("OES_texture_half_float"),y=Pt(g),S=Pt(c),T=y*S*e.components,E=0;E<o.length;E++)if(o[E]!==null){var x=null,w=c/S,C=g/y,m=!1;e.openGLDataType===e.context.FLOAT?x=new Float32Array(T):h&&e.openGLDataType===h.HALF_FLOAT_OES?(x=new Uint16Array(T),m=!0):x=new Uint8Array(T);for(var D=0;D<S;D++){var b=D*y*l,F=D*w,U=Math.floor(F),O=Math.ceil(F);O>=c&&(O=c-1);var A=F-U,W=1-A;U=U*g*l,O=O*g*l;for(var j=0;j<y;j++){var N=j*l,I=j*C,X=Math.floor(I),J=Math.ceil(I);J>=g&&(J=g-1);var P=I-X;X*=l,J*=l;for(var G=0;G<l;G++)m?x[b+N+G]=zr.toHalf(zr.fromHalf(o[E][U+X+G])*W*(1-P)+zr.fromHalf(o[E][U+J+G])*W*P+zr.fromHalf(o[E][O+X+G])*A*(1-P)+zr.fromHalf(o[E][O+J+G])*A*P):x[b+N+G]=o[E][U+X+G]*W*(1-P)+o[E][U+J+G]*W*P+o[E][O+X+G]*A*(1-P)+o[E][O+J+G]*A*P}}u.push(x),e.width=y,e.height=S}else u.push(null);if(u.length===0)for(var K=0;K<o.length;K++)u.push(o[K]);return u}t.create2DFromRaw=function(o,u,g,c,l){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(c),t.getInternalFormat(c,g),t.getFormat(c,g),!e.internalFormat||!e.format||!e.openGLDataType)return fn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=g,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var y=[l],S=n(c,y),T=a(S);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,h),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,T[0]),e.generateMipmap&&e.context.generateMipmap(e.target),h&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),t.deactivate(),!0},t.createCubeFromRaw=function(o,u,g,c,l){if(t.getOpenGLDataType(c),t.getInternalFormat(c,g),t.getFormat(c,g),!e.internalFormat||!e.format||!e.openGLDataType)return fn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=g,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=l.length/6-1,t.createTexture(),t.bind();for(var h=n(c,l),y=a(h),S=[],T=e.width,E=e.height,x=0;x<y.length;x++){x%6===0&&x!==0&&(T/=2,E/=2),S[x]=ya(c,E*T*e.components);for(var w=0;w<E;++w){var C=w*T*e.components,m=(E-w-1)*T*e.components;S[x].set(y[x].slice(m,m+T*e.components),C)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);for(var D=0;D<6;D++)for(var b=0,F=e.width,U=e.height;F>=1&&U>=1;){var O=null;b<=e.maxLevel&&(O=S[6*b+D]),e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+D,b,e.internalFormat,F,U,0,e.format,e.openGLDataType,O),b++,F/=2,U/=2}return t.deactivate(),!0},t.createDepthFromRaw=function(o,u,g,c){return t.getOpenGLDataType(g),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?g===Ge.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(fn("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,c),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0)},t.create2DFromImage=function(o){if(t.getOpenGLDataType(Ge.UNSIGNED_CHAR),t.getInternalFormat(Ge.UNSIGNED_CHAR,4),t.getFormat(Ge.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return fn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.width=o.width,e.height=o.height,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);var u=!Aa(o.width)||!Aa(o.height),g=document.createElement("canvas");g.width=u?Pt(o.width):o.width,g.height=u?Pt(o.height):o.height;var c=g.getContext("2d");c.translate(0,g.height),c.scale(1,-1),c.drawImage(o,0,0,o.width,o.height,0,0,g.width,g.height);var l=g;return e.context.texImage2D(e.target,0,e.internalFormat,e.format,e.openGLDataType,l),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0};function i(o,u,g){for(var c=[],l=[],h=0;h<o;++h)c[h]=g[h],l[h]=g[h];for(var y=0,S=0;S<u;++S)for(var T=0;T<o;++T)g[y]<c[T]&&(c[T]=g[y]),g[y]>l[T]&&(l[T]=g[y]),y++;for(var E=[],x=[],w=0;w<o;++w)c[w]===l[w]&&(l[w]=c[w]+1),E[w]=c[w],x[w]=l[w]-c[w];return{scale:x,offset:E}}function s(o,u){for(var g=0;g<o.length;g++){var c=o[g],l=u[g]+c;if(c<-2048||c>2048||l<-2048||l>2048)return!1}return!0}function f(o,u,g,c){var l=!0;t.getOpenGLDataType(o,l);var h=e.context.getExtension("OES_texture_half_float"),y=e._openGLRenderWindow.getWebgl2()?e.openGLDataType===e.context.HALF_FLOAT:h&&e.openGLDataType===h.HALF_FLOAT_OES;return!(!y||!s(u,g)&&!c)}t.create3DFromRaw=function(o,u,g,c,l,h){var y=!0;if(t.getOpenGLDataType(l,y),t.getInternalFormat(l,c),t.getFormat(l,c),!e.internalFormat||!e.format||!e.openGLDataType)return fn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=c,e.width=o,e.height=u,e.depth=g,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var S=[h],T=!0,E=n(l,S,T),x=a(E);return e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,x[0]),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0},t.create3DFilterableFromRaw=function(o,u,g,c,l,h){for(var y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,S=o*u*g,T=[],E=[],x=0;x<c;++x)T[x]=0,E[x]=1;e.volumeInfo={scale:E,offset:T,width:o,height:u,depth:g};var w=i(c,S,h),C=w.offset,m=w.scale;e.volumeInfo.dataComputedScale=m,e.volumeInfo.dataComputedOffset=C;var D=f(l,C,m,y);if(e._openGLRenderWindow.getWebgl2()){if(l===Ge.FLOAT||D&&(l===Ge.SHORT||l===Ge.UNSIGNED_SHORT))return t.create3DFromRaw(o,u,g,c,l,h);if(l===Ge.UNSIGNED_CHAR){for(var b=0;b<c;++b)e.volumeInfo.scale[b]=255;return t.create3DFromRaw(o,u,g,c,l,h)}var F=new Float32Array(S*c);e.volumeInfo.offset=C,e.volumeInfo.scale=m;for(var U=0,O=m.map(function(ie){return 1/ie}),A=0;A<S;A++)for(var W=0;W<c;W++)F[U]=(h[U]-C[W])*O[W],U++;return t.create3DFromRaw(o,u,g,c,Ge.FLOAT,F)}var j=i(c,S,h),N=function(Se,vt,Et,Ft,$t){Se[vt]=Et},I=Ge.UNSIGNED_CHAR;if(l===Ge.UNSIGNED_CHAR)for(var X=0;X<c;++X)j.offset[X]=0,j.scale[X]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(I=Ge.FLOAT,N=function(Se,vt,Et,Ft,$t){Se[vt]=(Et-Ft)/$t}):(I=Ge.UNSIGNED_CHAR,N=function(Se,vt,Et,Ft,$t){Se[vt]=255*(Et-Ft)/$t});if(t.getOpenGLDataType(I),t.getInternalFormat(I,c),t.getFormat(I,c),!e.internalFormat||!e.format||!e.openGLDataType)return fn("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=c,e.depth=1,e.numberOfDimensions=2;var J=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);J>4096&&(I===Ge.FLOAT||c>=3)&&(J=4096);var P=1,G=1;S>J*J&&(P=Math.ceil(Math.sqrt(S/(J*J))),G=P);var K=Math.sqrt(S)/P;K=Pt(K);var te=Math.floor(K*P/o),ee=Math.ceil(g/te),fe=Pt(u*ee/G);e.width=K,e.height=fe,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=te,e.volumeInfo.yreps=ee,e.volumeInfo.xstride=P,e.volumeInfo.ystride=G,e.volumeInfo.offset=j.offset,e.volumeInfo.scale=j.scale;var ve,ce=K*fe*c;I===Ge.FLOAT?ve=new Float32Array(ce):ve=new Uint8Array(ce);for(var pe=0,Re=Math.floor(o/P),qe=Math.floor(u/G),He=0;He<ee;He++)for(var We=Math.min(te,g-He*te),tt=c*(e.width-We*Math.floor(o/P)),we=0;we<qe;we++){for(var ne=0;ne<We;ne++)for(var oe=c*((He*te+ne)*o*u+G*we*o),Te=0;Te<Re;Te++)for(var ue=0;ue<c;ue++)N(ve,pe,h[oe+P*Te*c+ue],j.offset[ue],j.scale[ue]),pe++;pe+=tt}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,ve),t.deactivate(),!0},t.setOpenGLRenderWindow=function(o){e._openGLRenderWindow!==o&&(t.releaseGraphicsResources(),e._openGLRenderWindow=o,e.context=null,o&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=function(o){return o&&o.isCurrent()?o.getIntegerv(o.MAX_TEXTURE_SIZE):-1}}var Sw={_openGLRenderWindow:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:nr.CLAMP_TO_EDGE,wrapT:nr.CLAMP_TO_EDGE,wrapR:nr.CLAMP_TO_EDGE,minificationFilter:st.NEAREST,magnificationFilter:st.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1};function Gl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Sw,r),Ie.extend(t,e,r),e.sendParametersTime={},yt(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},yt(e.textureBuildTime,{mtime:0}),Bi(t,e,["format","openGLDataType"]),gt(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap"]),kt(t,e,["width","height","volumeInfo","components","handle","target"]),Tw(t,e)}var Al=Ue(Gl,"vtkOpenGLTexture"),xr=yw({newInstance:Al,extend:Gl},Jo);Mt("vtkTexture",Al);var Cw=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,ef=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;function Ew(t,e){t.replaceShaderCoincidentOffset=function(r,n,a){var i=t.getCoincidentParameters(n,a);if(i&&(i.factor!==0||i.offset!==0)){var s=r.Fragment;s=$.substitute(s,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(i.factor!==0?(s=$.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(i.factor!==0?(s=$.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),r.Fragment=s}}}var Pl={implementReplaceShaderCoincidentOffset:Ew},Bs=Vn.FieldAssociations,Je=_n.primTypes,un=Ln.Representation,vc=Ln.Shading,Ha=mr.ScalarMode,lc=xr.Filter,pc=xr.Wrap,Gr=ge,ww={type:"StartEvent"},xw={type:"EndEvent"},Ow=Sa.CoordinateSystem;function Mw(t){var e=t.getSelector();return e?e.getCurrentPass():ht.MIN_KNOWN_PASS-1}function Dw(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=function(n){n&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e.openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.openGLCamera=e.openGLRenderer.getViewNodeFor(e.openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=function(n,a){n&&(e.currentRenderPass=a,t.render())},t.opaqueZBufferPass=function(n){n&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaquePass=function(n){n&&t.render()},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=Je.Start;a<Je.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor.getRenderable(),s=e.openGLRenderer.getRenderable();t.renderPiece(s,i)},t.buildShaders=function(n,a,i){t.getShaderTemplate(n,a,i),e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);var s=e.renderable.getViewSpecificProperties().OpenGL,f=null;if(s&&(f=s.ShaderReplacements),f)for(var o=0;o<f.length;o++){var u=f[o];if(u.replaceFirst){var g=u.shaderType,c=n[g],l=$.substitute(c,u.originalValue,u.replacementValue,u.replaceAll);n[g]=l.result}}if(t.replaceShaderValues(n,a,i),f)for(var h=0;h<f.length;h++){var y=f[h];if(!y.replaceFirst){var S=y.shaderType,T=n[S],E=$.substitute(T,y.originalValue,y.replacementValue,y.replaceAll);n[S]=E.result}}},t.getShaderTemplate=function(n,a,i){var s=e.renderable.getViewSpecificProperties().OpenGL,f=Cw;if(s){var o=s.VertexShaderCode;o!==void 0&&o!==""&&(f=o)}n.Vertex=f;var u=ef;if(s){var g=s.FragmentShaderCode;g!==void 0&&g!==""&&(u=g)}n.Fragment=u;var c="";if(s){var l=s.GeometryShaderCode;l!==void 0&&(c=l)}n.Geometry=c},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getReferenceByName("lastLightComplexity"),g=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];u&&(g=g.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));var c=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];u&&(c=c.concat(["  vec3 specularColor;","  float specularPower;"])),c=c.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),u&&(c=c.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(g=g.concat(["varying vec4 vertexColorVSOutput;"]),s=$.substitute(s,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,s=$.substitute(s,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,f=$.substitute(f,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,f=$.substitute(f,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?o=$.substitute(o,"//VTK::Color::Impl",c.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:e.renderable.getInterpolateScalarsBeforeMapping()&&e.renderable.getColorCoordinates()&&!e.drawingEdges?o=$.substitute(o,"//VTK::Color::Impl",c.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(i.getBackfaceProperty()&&!e.drawingEdges&&(g=g.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),u?(g=g.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),c=c.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):c=c.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(g=g.concat(["uniform samplerBuffer texture1;"])),o=$.substitute(o,"//VTK::Color::Impl",c).result),o=$.substitute(o,"//VTK::Color::Dec",g).result,n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderLight=function(n,a,i){var s=n.Fragment,f="",o=e.lastBoundBO.getReferenceByName("lastLightComplexity"),u=e.lastBoundBO.getReferenceByName("lastLightCount"),g=[];switch(o){case 0:s=$.substitute(s,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:s=$.substitute(s,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(var c=0;c<u;++c)g=g.concat(["uniform vec3 lightColor".concat(c,";"),"uniform vec3 lightDirectionVC".concat(c,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(c,"; // normalized")]);s=$.substitute(s,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(var l=0;l<u;++l)g=g.concat(["  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC".concat(l,"));"),"  diffuseL += ((df".concat(f,") * lightColor").concat(l,");"),"  if (dot(normalVCVSOutput, lightDirectionVC".concat(l,") < 0.0)"),"    {","    float sf = pow( max(0.0, dot(lightHalfAngleVC".concat(l,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(f,") * lightColor").concat(l,");"),"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=$.substitute(s,"//VTK::Light::Impl",g,!1).result;break;case 3:for(var h=0;h<u;++h)g=g.concat(["uniform vec3 lightColor".concat(h,";"),"uniform vec3 lightDirectionVC".concat(h,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(h,"; // normalized"),"uniform vec3 lightPositionVC".concat(h,";"),"uniform vec3 lightAttenuation".concat(h,";"),"uniform float lightConeAngle".concat(h,";"),"uniform float lightExponent".concat(h,";"),"uniform int lightPositional".concat(h,";")]);s=$.substitute(s,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(var y=0;y<u;++y)g=g.concat(["  attenuation = 1.0;","  if (lightPositional".concat(y," == 0)"),"    {","      vertLightDirectionVC = lightDirectionVC".concat(y,";"),"    }","  else","    {","    vertLightDirectionVC = vertexVC.xyz - lightPositionVC".concat(y,";"),"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /","      (lightAttenuation".concat(y,".x"),"       + lightAttenuation".concat(y,".y * distanceVC"),"       + lightAttenuation".concat(y,".z * distanceVC * distanceVC);"),"    // per OpenGL standard cone angle is 90 or less for a spot light","    if (lightConeAngle".concat(y," <= 90.0)"),"      {","      float coneDot = dot(vertLightDirectionVC, lightDirectionVC".concat(y,");"),"      // if inside the cone","      if (coneDot >= cos(radians(lightConeAngle".concat(y,")))"),"        {","        attenuation = attenuation * pow(coneDot, lightExponent".concat(y,");"),"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));","    diffuseL += ((df".concat(f,") * lightColor").concat(y,");"),"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {","      float sf = attenuation*pow( max(0.0, dot(lightHalfAngleVC".concat(y,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(f,") * lightColor").concat(y,");"),"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=$.substitute(s,"//VTK::Light::Impl",g,!1).result;break;default:Gr("bad light complexity")}n.Fragment=s},t.replaceShaderNormal=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(s>0){var f=n.Vertex,o=n.Geometry,u=n.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(f=$.substitute(f,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,f=$.substitute(f,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,o=$.substitute(o,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,o=$.substitute(o,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,u=$.substitute(u,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(u=$.substitute(u,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES?(u=$.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(u=$.substitute(u,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,u=$.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),n.Vertex=f,n.Geometry=o,n.Fragment=u}},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i);var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getReferenceByName("lastLightComplexity");u>0?(s=$.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=$.substitute(s,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,s=$.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,f=$.substitute(f,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,f=$.substitute(f,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,o=$.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=$.substitute(o,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(s=$.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,s=$.substitute(s,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,f=n.Geometry,o=n.Fragment;if(e.drawingEdges)return;s=$.substitute(s,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;var u=e.openGLActor.getActiveTextures(),g=2,c=2;if(u&&u.length>0&&(g=u[0].getComponents(),u[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(c=3)),e.renderable.getColorTextureMap()&&(g=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),c=2),c===2){if(s=$.substitute(s,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,f=$.substitute(f,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,f=$.substitute(f,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=$.substitute(o,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u&&u.length>=1)switch(g){case 1:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(s=$.substitute(s,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,f=$.substitute(f,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,f=$.substitute(f,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=$.substitute(o,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,g){case 1:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}n.Vertex=s,n.Geometry=f,n.Fragment=o}},t.replaceShaderClip=function(n,a,i){var s=n.Vertex,f=n.Fragment;if(e.renderable.getNumberOfClippingPlanes()){var o=e.renderable.getNumberOfClippingPlanes();s=$.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[".concat(o,"];"),"varying float clipDistancesVSOutput[".concat(o,"];")]).result,s=$.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(o,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,f=$.substitute(f,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[".concat(o,"];")]).result,f=$.substitute(f,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(o,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}n.Vertex=s,n.Fragment=f},t.getCoincidentParameters=function(n,a){var i={factor:0,offset:0},s=a.getProperty();if(e.renderable.getResolveCoincidentTopology()||s.getEdgeVisibility()&&s.getRepresentation()===un.SURFACE){var f=e.lastBoundBO.getPrimitiveType();f===Je.Points||s.getRepresentation()===un.POINTS?i=e.renderable.getCoincidentTopologyPointOffsetParameter():f===Je.Lines||s.getRepresentation()===un.WIREFRAME?i=e.renderable.getCoincidentTopologyLineOffsetParameters():(f===Je.Tris||f===Je.TriStrips)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(f===Je.TrisEdges||f===Je.TriStripsEdges)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),i.factor/=2,i.offset/=2)}var o=e.openGLRenderer.getSelector();return o&&o.getFieldAssociation()===Bs.FIELD_ASSOCIATION_POINTS&&(i.offset-=2),i},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment,f=n.Vertex;if(s=$.substitute(s,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e.openGLRenderer.getSelector()){switch((e.lastSelectionState===ht.ID_LOW24||e.lastSelectionState===ht.ID_HIGH24)&&(f=$.substitute(f,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,f=$.substitute(f,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,s=$.substitute(s,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,s=$.substitute(s,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case ht.ID_LOW24:s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case ht.ID_HIGH24:s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx)/255.0, 0.0, 0.0, 1.0);").result;break;default:s=$.substitute(s,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}n.Fragment=s,n.Vertex=f}},t.replaceShaderValues=function(n,a,i){if(t.replaceShaderColor(n,a,i),t.replaceShaderNormal(n,a,i),t.replaceShaderLight(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderClip(n,a,i),t.replaceShaderCoincidentOffset(n,a,i),t.replaceShaderPositionVC(n,a,i),e.haveSeenDepthRequest){var s=n.Fragment;s=$.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=$.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=s}},t.getNeedToRebuildShaders=function(n,a,i){var s=0,f=0,o=n.getPrimitiveType(),u=e.currentInput,g=!1,c=u.getPointData().getNormals(),l=u.getCellData().getNormals(),h=i.getProperty().getInterpolation()===vc.FLAT,y=i.getProperty().getRepresentation(),S=n.getOpenGLMode(y,o);if((S===e.context.TRIANGLES||l&&!c||!h&&c||!h&&S===e.context.LINES)&&(g=!0),i.getProperty().getLighting()&&g){s=0;for(var T=a.getLightsByReference(),E=0;E<T.length;++E){var x=T[E],w=x.getSwitch();w>0&&(f++,s===0&&(s=1)),s===1&&(f>1||x.getIntensity()!==1||!x.lightTypeIsHeadLight())&&(s=2),s<3&&x.getPositional()&&(s=3)}}var C=!1,m=e.lastBoundBO.getReferenceByName("lastLightComplexity"),D=e.lastBoundBO.getReferenceByName("lastLightCount");return(m!==s||D!==f)&&(e.lastBoundBO.set({lastLightComplexity:s},!0),e.lastBoundBO.set({lastLightCount:f},!0),C=!0),!e.currentRenderPass&&e.lastRenderPassShaderReplacement&&(C=!0,e.lastRenderPassShaderReplacement=null),e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement&&(e.lastRenderPassShaderReplacement=e.currentRenderPass.getShaderReplacement(),C=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||n.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||C?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(f){f.callback(f.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isUniformUsed("VertexIDOffset")&&n.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Gr("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("normalMC")&&n.getCABO().getNormalOffset()&&s>0?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"normalMC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Gr("Error setting normalMC in shader VAO."):n.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach(function(D,b){n.getProgram().isAttributeUsed("".concat(D,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(D,"MC"),n.getCABO().getCustomData()[b].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[b].components,!1)||Gr("Error setting ".concat(D,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||Gr("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),n.getProgram().isAttributeUsed("scalarColor")&&n.getCABO().getColorComponents()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"scalarColor",n.getCABO().getColorOffset(),n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||Gr("Error setting scalarColor in shader VAO."):n.getVAO().removeAttributeArray("scalarColor"),n.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){var f=e.renderable.getNumberOfClippingPlanes(),o=[],u=n.getCABO().getCoordShiftAndScaleEnabled(),g=u?n.getCABO().getInverseShiftAndScaleMatrix():null,c=g?ut(e.tmpMat4,i.getMatrix()):i.getMatrix();g&&(ze(c,c),St(c,c,g),ze(c,c));for(var l=0;l<f;l++){var h=[];e.renderable.getClippingPlaneInDataCoords(c,l,h);for(var y=0;y<4;y++)o.push(h[y])}n.getProgram().setUniformi("numClipPlanes",f),n.getProgram().setUniform4fv("clipPlanes",o)}e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var S=e.openGLActor.getActiveTextures();if(S)for(var T=0;T<S.length;++T){var E=S[T],x=E.getTextureUnit(),w="texture".concat(x+1);n.getProgram().isUniformUsed(w)&&n.getProgram().setUniformi(w,x)}if(e.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){var C=t.getCoincidentParameters(a,i);n.getProgram().setUniformf("coffset",C.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",C.factor)}n.setMapperShaderParameters(a,i,e.openGLRenderer.getTiledSizeAndOrigin());var m=e.openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",m?m.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",m?m.getCurrentPass()+1:0)},t.setLightingShaderParameters=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(s<2)){for(var f=n.getProgram(),o=0,u=a.getLightsByReference(),g=0;g<u.length;++g){var c=u[g],l=c.getSwitch();if(l>0){var h=c.getColorByReference(),y=c.getIntensity();e.lightColor[0]=h[0]*y,e.lightColor[1]=h[1]*y,e.lightColor[2]=h[2]*y;var S=c.getDirection(),T=a.getActiveCamera().getViewMatrix(),E=Ce(S);c.lightTypeIsSceneLight()&&(E[0]=T[0]*S[0]+T[1]*S[1]+T[2]*S[2],E[1]=T[4]*S[0]+T[5]*S[1]+T[6]*S[2],E[2]=T[8]*S[0]+T[9]*S[1]+T[10]*S[2],Mn(E)),e.lightDirection[0]=E[0],e.lightDirection[1]=E[1],e.lightDirection[2]=E[2],e.lightHalfAngle[0]=-e.lightDirection[0],e.lightHalfAngle[1]=-e.lightDirection[1],e.lightHalfAngle[2]=-e.lightDirection[2]+1,Mn(e.lightDirection),f.setUniform3fArray("lightColor".concat(o),e.lightColor),f.setUniform3fArray("lightDirectionVC".concat(o),e.lightDirection),f.setUniform3fArray("lightHalfAngleVC".concat(o),e.lightHalfAngle),o++}}if(!(s<3)){var x=a.getActiveCamera(),w=x.getViewMatrix();ze(w,w),o=0;for(var C=0;C<u.length;++C){var m=u[C],D=m.getSwitch();if(D>0){var b=m.getTransformedPosition(),F=new Float64Array(3);me(F,b,w),f.setUniform3fArray("lightAttenuation".concat(o),m.getAttenuationValuesByReference()),f.setUniformi("lightPositional".concat(o),m.getPositional()),f.setUniformf("lightExponent".concat(o),m.getExponent()),f.setUniformf("lightConeAngle".concat(o),m.getConeAngle()),f.setUniform3fArray("lightPositionVC".concat(o),[F[0],F[1],F[2]]),o++}}}}};function r(n,a,i){return a.identity(i),n.reduce(function(s,f,o){return o===0?f?a.copy(s,f):a.identity(s):f?a.multiply(s,s,f):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=e.openGLCamera.getKeyMatrices(a),o=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrixTime().getMTime(),g=s.getLastCameraMTime(),c=n.getCABO().getCoordShiftAndScaleEnabled(),l=c?n.getCABO().getInverseShiftAndScaleMatrix():null,h=i.getIsIdentity(),y=h?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(i.getCoordinateSystem()===Ow.DISPLAY){var S=e.openGLRenderer.getTiledSizeAndOrigin();De(e.tmpMat4),e.tmpMat4[0]=2/S.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/S.vsize,e.tmpMat4[13]=-1,St(e.tmpMat4,e.tmpMat4,l),s.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else s.setUniformMatrix("MCPCMatrix",r([f.wcpc,y.mcwc,l],Ys,e.tmpMat4));s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",r([f.wcvc,y.mcwc,l],Ys,e.tmpMat4)),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",r([f.normalMatrix,y.normalMatrix],by,e.tmpMat3)),g!==u&&(s.isUniformUsed("cameraParallel")&&s.setUniformi("cameraParallel",o.getParallelProjection()),s.setLastCameraMTime(u)),h||s.setLastCameraMTime(0)},t.setPropertyShaderParameters=function(n,a,i){var s=n.getProgram(),f=i.getProperty(),o=f.getOpacity(),u=e.drawingEdges?f.getEdgeColorByReference():f.getAmbientColorByReference(),g=e.drawingEdges?f.getEdgeColorByReference():f.getDiffuseColorByReference(),c=e.drawingEdges?1:f.getAmbient(),l=e.drawingEdges?0:f.getDiffuse(),h=e.drawingEdges?0:f.getSpecular(),y=f.getSpecularPower();s.setUniformf("opacityUniform",o),s.setUniform3fArray("ambientColorUniform",u),s.setUniform3fArray("diffuseColorUniform",g),s.setUniformf("ambient",c),s.setUniformf("diffuse",l);var S=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(S<1)){var T=f.getSpecularColorByReference();if(s.setUniform3fArray("specularColorUniform",T),s.setUniformf("specularPowerUniform",y),s.setUniformf("specular",h),s.isUniformUsed("ambientIntensityBF")){if(f=i.getBackfaceProperty(),o=f.getOpacity(),u=f.getAmbientColor(),c=f.getAmbient(),g=f.getDiffuseColor(),l=f.getDiffuse(),T=f.getSpecularColor(),h=f.getSpecular(),s.setUniformf("ambientIntensityBF",c),s.setUniformf("diffuseIntensityBF",l),s.setUniformf("opacityUniformBF",o),s.setUniform3fArray("ambientColorUniformBF",u),s.setUniform3fArray("diffuseColorUniformBF",g),S<1)return;s.setUniformf("specularIntensityBF",h),s.setUniform3fArray("specularColorUniformBF",T),s.setUniformf("specularPowerUniformBF",y)}}},t.updateMaximumPointCellIds=function(n,a){var i,s,f,o,u=e.openGLRenderer.getSelector();if(!!u){if((i=e.selectionWebGLIdsToVTKIds)!==null&&i!==void 0&&(s=i.points)!==null&&s!==void 0&&s.length){var g=e.selectionWebGLIdsToVTKIds.points.length;u.setMaximumPointId(g-1)}if((f=e.selectionWebGLIdsToVTKIds)!==null&&f!==void 0&&(o=f.cells)!==null&&o!==void 0&&o.length){var c=e.selectionWebGLIdsToVTKIds.cells.length;u.setMaximumCellId(c-1)}var l=u.getFieldAssociation();l===Bs.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)}},t.renderPieceStart=function(n,a){e.primitiveIDOffset=0,e.vertexIDOffset=0;var i=Mw(e.openGLRenderer);if(e.lastSelectionState!==i&&(e.selectionStateChanged.modified(),e.lastSelectionState=i),e.openGLRenderer.getSelector())switch(i){default:e.openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=function(n,a){for(var i=a.getProperty().getRepresentation(),s=a.getProperty().getEdgeVisibility()&&i===un.SURFACE,f=e.openGLRenderer.getSelector(),o=f&&f.getFieldAssociation()===Bs.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===ht.ID_LOW24||e.lastSelectionState===ht.ID_HIGH24),u=Je.Start;u<Je.End;u++){e.primitives[u].setPointPicking(o);var g=e.primitives[u].getCABO();g.getElementCount()&&(e.drawingEdges=s&&(u===Je.TrisEdges||u===Je.TriStripsEdges),(!e.drawingEdges||!e.renderDepth)&&(e.lastBoundBO=e.primitives[u],e.primitiveIDOffset+=e.primitives[u].drawArrays(n,a,i,t),e.vertexIDOffset+=e.primitives[u].getCABO().getElementCount()))}},t.renderPieceFinish=function(n,a){e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=function(n,a){if(t.invokeEvent(ww),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(xw),!e.currentInput){Gr("No input!");return}if(!(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())){var i=e.context,s=a.getProperty().getBackfaceCulling(),f=a.getProperty().getFrontfaceCulling();!s&&!f?e._openGLRenderWindow.disableCullFace():f?(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.FRONT)):(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.BACK)),t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a)}},t.computeBounds=function(n,a){if(!t.getInput()){Ni(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return i<t.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var f=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(f===Ha.USE_CELL_DATA||f===Ha.USE_CELL_FIELD_DATA||f===Ha.USE_FIELD_DATA||!i.getPointData().getScalars())&&f!==Ha.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var o=a.getProperty().getInterpolation()!==vc.FLAT?i.getPointData().getNormals():null;o===null&&i.getCellData().getNormals()&&(e.haveCellNormals=!0,o=i.getCellData().getNormals());var u=a.getProperty().getRepresentation(),g=i.getPointData().getTCoords();if(e.openGLActor.getActiveTextures()||(g=null),e.renderable.getColorCoordinates()){g=e.renderable.getColorCoordinates(),e.internalColorTexture||(e.internalColorTexture=xr.newInstance());var c=e.internalColorTexture;c.setMinificationFilter(lc.NEAREST),c.setMagnificationFilter(lc.NEAREST),c.setWrapS(pc.CLAMP_TO_EDGE),c.setWrapT(pc.CLAMP_TO_EDGE),c.setOpenGLRenderWindow(e._openGLRenderWindow);var l=e.renderable.getColorTextureMap(),h=l.getExtent(),y=l.getPointData().getScalars();c.create2DFromRaw(h[1]-h[0]+1,h[3]-h[2]+1,y.getNumberOfComponents(),y.getDataType(),y.getData()),c.activate(),c.sendParameters(),c.deactivate()}var S="".concat(i.getMTime(),"A").concat(u,"B").concat(i.getMTime())+"C".concat(o?o.getMTime():1,"D").concat(s?s.getMTime():1)+"E".concat(a.getProperty().getEdgeVisibility())+"F".concat(g?g.getMTime():1);if(e.VBOBuildString!==S){var T=i.getPoints(),E={points:T,normals:o,tcoords:g,colors:s,cellOffset:0,vertexOffset:0,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(function(m){return i.getPointData().getArrayByName(m)})};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});for(var x=[{inRep:"verts",cells:i.getVerts()},{inRep:"lines",cells:i.getLines()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()}],w=a.getProperty().getEdgeVisibility()&&u===un.SURFACE,C=Je.Start;C<Je.End;C++)C!==Je.TrisEdges&&C!==Je.TriStripsEdges?(E.cellOffset+=e.primitives[C].getCABO().createVBO(x[C].cells,x[C].inRep,u,E,e.selectionWebGLIdsToVTKIds),E.vertexOffset+=e.primitives[C].getCABO().getElementCount()):w?e.primitives[C].getCABO().createVBO(x[C].cells,x[C].inRep,un.WIREFRAME,{points:T,normals:o,tcoords:null,colors:null,cellOffset:0,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[C].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&(e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),t.updateMaximumPointCellIds()),e.VBOBuildTime.modified(),e.VBOBuildString=S}}}}var mw={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightHalfAngle:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:ht.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function zl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mw,r),Ie.extend(t,e,r),Pl.implementReplaceShaderCoincidentOffset(t,e,r),e.primitives=[],e.primTypes=Je,e.tmpMat3=Qr(new Float64Array(9)),e.tmpMat4=De(new Float64Array(16));for(var n=Je.Start;n<Je.End;n++)e.primitives[n]=_n.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);gt(t,e,["context"]),e.VBOBuildTime={},yt(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},yt(e.selectionStateChanged,{mtime:0}),Dw(t,e)}var Wl=Ue(zl,"vtkOpenGLPolyDataMapper"),jl={newInstance:Wl,extend:zl};Mt("vtkMapper",Wl);var Rw=Lr.ColorMode,Ar=Lr.ScalarMode,Ns=Lr.GetArray;function Lw(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=function(){e.lookupTable=In.newInstance()},t.getColorModeAsString=function(){return L.enumToString(Rw,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return L.enumToString(Ar,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var f=null,o=!1;if(n===Ar.DEFAULT)f=r.getPointData().getScalars(),f||(f=r.getCellData().getScalars(),o=!0);else if(n===Ar.USE_POINT_DATA)f=r.getPointData().getScalars();else if(n===Ar.USE_CELL_DATA)f=r.getCellData().getScalars(),o=!0;else if(n===Ar.USE_POINT_FIELD_DATA){var u=r.getPointData();a===Ns.BY_ID?f=u.getArrayByIndex(i):f=u.getArrayByName(s)}else if(n===Ar.USE_CELL_FIELD_DATA){var g=r.getCellData();o=!0,a===Ns.BY_ID?f=g.getArrayByIndex(i):f=g.getArrayByName(s)}else if(n===Ar.USE_FIELD_DATA){var c=r.getFieldData();a===Ns.BY_ID?f=c.getArrayByIndex(i):f=c.getArrayByName(s)}return{scalars:f,cellFlag:o}},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId)),e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}}}var Vw={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function $l(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Vw,r),Jv.extend(t,e,r),L.get(t,e,["colorMapColors"]),L.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),L.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),Lw(t,e)}var _w=L.newInstance($l,"vtkMapper2D"),bw={newInstance:_w,extend:$l},kw=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,Fw=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`,Hl={BACKGROUND:0,FOREGROUND:1},Kl={DisplayLocation:Hl},Ut=_n.primTypes,Ka=bw.ScalarMode,Xa=ge,Bw={type:"StartEvent"},Nw={type:"EndEvent"};function Uw(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=function(n){n&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e.openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.openGLCamera=e.openGLRenderer.getViewNodeFor(e.openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=function(n){n&&t.render()},t.getShaderTemplate=function(n,a,i){var s=e.renderable.getViewSpecificProperties().OpenGL,f=Fw;if(s){var o=s.VertexShaderCode;o!==void 0&&o!==""&&(f=o)}n.Vertex=f;var u=kw;if(s){var g=s.FragmentShaderCode;g!==void 0&&g!==""&&(u=g)}n.Fragment=u;var c="";if(s){var l=s.GeometryShaderCode;l!==void 0&&(c=l)}n.Geometry=c},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=Ut.Start;a<Ut.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor2D.getRenderable(),s=e.openGLRenderer.getRenderable();t.renderPiece(s,i)},t.renderPiece=function(n,a){if(t.invokeEvent(Bw),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(Nw),!e.currentInput){Xa("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a))},t.renderPieceStart=function(n,a){if(e.primitiveIDOffset=0,e.openGLRenderer.getSelector())switch(e.openGLRenderer.getSelector().getCurrentPass()){default:e.openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.lastBoundBO=null},t.getNeedToRebuildShaders=function(n,a,i){return n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return!!(i<t.getMTime()||i<e._openGLRenderWindow.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&i<n.getMTime())},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,a.getProperty().getOpacity());var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var f=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(f===Ka.USE_CELL_DATA||f===Ka.USE_CELL_FIELD_DATA||f===Ka.USE_FIELD_DATA||!i.getPointData().getScalars())&&f!==Ka.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var o=a.getProperty().getRepresentation(),u=i.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(u=null);var g=e.renderable.getTransformCoordinate(),c=n.getRenderWindow().getViews()[0],l=c.getViewportSize(n),h="".concat(i.getMTime(),"A").concat(o,"B").concat(i.getMTime())+"C".concat(s?s.getMTime():1)+"D".concat(u?u.getMTime():1)+"E".concat(g?n.getMTime():1)+"F".concat(l);if(e.VBOBuildString!==h){var y=i.getPoints();if(g){var S=Ri.newInstance(),T=y.getNumberOfPoints();S.setNumberOfPoints(T);for(var E=[],x=0;x<T;++x){y.getPoint(x,E),g.setValue(E);var w=g.getComputedDoubleViewportValue(n);S.setPoint(x,w[0],w[1],0)}y=S}var C={points:y,tcoords:u,colors:s,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(function(m){return i.getPointData().getArrayByName(m)})};C.cellOffset+=e.primitives[Ut.Points].getCABO().createVBO(i.getVerts(),"verts",o,C),C.cellOffset+=e.primitives[Ut.Lines].getCABO().createVBO(i.getLines(),"lines",o,C),C.cellOffset+=e.primitives[Ut.Tris].getCABO().createVBO(i.getPolys(),"polys",o,C),C.cellOffset+=e.primitives[Ut.TriStrips].getCABO().createVBO(i.getStrips(),"strips",o,C),e.VBOBuildTime.modified(),e.VBOBuildString=h}}},t.renderPieceDraw=function(n,a){var i=a.getProperty().getRepresentation(),s=e.context;s.depthMask(!0);for(var f=Ut.Start;f<Ut.End;f++){var o=e.primitives[f].getCABO();o.getElementCount()&&(e.lastBoundBO=e.primitives[f],e.primitiveIDOffset+=e.primitives[f].drawArrays(n,a,i,t))}},t.renderPieceFinish=function(n,a){e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.buildShaders=function(n,a,i){t.getShaderTemplate(n,a,i);var s=e.renderable.getViewSpecificProperties().OpenGL,f=null;if(s&&(f=s.ShaderReplacements),f)for(var o=0;o<f.length;o++){var u=f[o];if(u.replaceFirst){var g=u.shaderType,c=n[g],l=$.substitute(c,u.originalValue,u.replacementValue,u.replaceAll);n[g]=l.result}}if(t.replaceShaderValues(n,a,i),f)for(var h=0;h<f.length;h++){var y=f[h];if(!y.replaceFirst){var S=y.shaderType,T=n[S],E=$.substitute(T,y.originalValue,y.replacementValue,y.replaceAll);n[S]=E.result}}},t.replaceShaderValues=function(n,a,i){t.replaceShaderColor(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderPositionVC(n,a,i)},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,f=n.Geometry,o=n.Fragment;e.haveCellScalars&&(o=$.substitute(o,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,o=$.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(s=$.substitute(s,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,s=$.substitute(s,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,f=$.substitute(f,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,f=$.substitute(f,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,o=$.substitute(o,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,o=$.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(o=$.substitute(o,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,o=$.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getCABO().getTCoordComponents();u===1?(s=$.substitute(s,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,s=$.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,f=$.substitute(f,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,f=$.substitute(f,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,o=$.substitute(o,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o=$.substitute(o,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):u===2&&(s=$.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,s=$.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,f=$.substitute(f,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,f=$.substitute(f,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,o=$.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o=$.substitute(o,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(f=$.substitute(f,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o}},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment;s=$.substitute(s,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,n.Fragment=s},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i)},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(f){f.callback(f.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isAttributeUsed("vertexWC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexWC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Xa("Error setting vertexWC in shader VAO.")),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach(function(l,h){n.getProgram().isAttributeUsed("".concat(l,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(l,"MC"),n.getCABO().getCustomData()[h].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[h].components,!1)||Xa("Error setting ".concat(l,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||Xa("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var s=e.openGLActor2D.getActiveTextures();if(s)for(var f=0;f<s.length;++f){var o=s[f],u=o.getTextureUnit(),g="texture".concat(u+1);n.getProgram().isUniformUsed(g)&&n.getProgram().setUniformi(g,u)}n.setMapperShaderParameters(a,i,e.openGLRenderer.getTiledSizeAndOrigin());var c=e.openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",c?c.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",c?c.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=function(n,a,i){var s=e.renderable.getColorMapColors();if(!s||s.getNumberOfComponents()===0){var f=n.getProgram(),o=i.getProperty(),u=o.getOpacity(),g=o.getColor(),c=[g[0],g[1],g[2],u];f.setUniform4f("diffuseColor",c)}},t.setLightingShaderParameters=function(n,a,i){};function r(n,a,i){return a.identity(i),n.reduce(function(s,f,o){return o===0?f?a.copy(s,f):a.identity(s):f?a.multiply(s,s,f):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=n.getCABO().getCoordShiftAndScaleEnabled(),o=f?n.getCABO().getInverseShiftAndScaleMatrix():null,u=a.getRenderWindow().getViews()[0],g=u.getViewportSize(a),c=a.getViewport(),l=i.getActualPositionCoordinate().getComputedDoubleViewportValue(a),h=[0,0,1,1],y=[0,0,1,1];if(y[0]=c[0]>=h[0]?c[0]:h[0],y[1]=c[1]>=h[1]?c[1]:h[1],y[2]=c[2]<=h[2]?c[2]:h[2],y[3]=c[3]<=h[3]?c[3]:h[3],!(y[0]>=y[2])&&!(y[1]>=y[3])){g[0]=Ga(g[0]*(y[2]-y[0])/(c[2]-c[0])),g[1]=Ga(g[1]*(y[3]-y[1])/(c[3]-c[1]));var S=e.openGLRenderer.getParent().getSize(),T=Ga(l[0]-(y[0]-c[0])*S[0]),E=Ga(l[1]-(y[1]-c[1])*S[1]),x=-T,w=-T+g[0],C=-E,m=-E+g[1];x===w&&(w=x+1),C===m&&(m=C+1);var D=De(new Float64Array(16));D[0]=2/(w-x),D[1*4+1]=2/(m-C),D[0*4+3]=-1*(w+x)/(w-x),D[1*4+3]=-1*(m+C)/(m-C),D[2*4+2]=0,D[2*4+3]=i.getProperty().getDisplayLocation()===Hl.FOREGROUND?-1:1,D[3*4+3]=1,ze(D,D),s.setUniformMatrix("WCVCMatrix",r([D,o],Ys,e.tmpMat4))}}}var Gw={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function Aw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Gw,r),Ie.extend(t,e,r),Pl.implementReplaceShaderCoincidentOffset(t,e,r),e.primitives=[],e.primTypes=Ut,e.tmpMat4=De(new Float64Array(16));for(var n=Ut.Start;n<Ut.End;n++)e.primitives[n]=_n.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);gt(t,e,["context"]),e.VBOBuildTime={},yt(e.VBOBuildTime,{mtime:0}),Uw(t,e)}var Pw=Ue(Aw,"vtkOpenGLPolyDataMapper2D");Mt("vtkMapper2D",Pw);function hc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ir(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var zw=sl.VectorMode;function Us(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function Xl(t,e){return function(r){var n=r.getLastSize(),a=Math.pow(n[0]/700,.8),i=Math.pow(n[1]/700,.8),s=Math.min(a,i),f=r.getAxisTextStyle(),o=r.getTickTextStyle();Object.assign(f,e.axisTextStyle),Object.assign(o,e.tickTextStyle),f.fontSize=Math.max(24*s,12),r.getLastAspectRatio()>1?o.fontSize=Math.max(20*s,10):o.fontSize=Math.max(16*s,10);var u=r.updateTextureAtlas();r.setTopTitle(!1);var g=r.getBoxSizeByReference();if(r.getLastAspectRatio()>1)r.setTickLabelPixelOffset(.3*o.fontSize),u.titleWidth<=u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize?(r.setTopTitle(!0),r.setAxisTitlePixelOffset(.2*o.fontSize),g[0]=2*(u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize)/n[0],r.setBoxPosition([.98-g[0],-.92])):(r.setAxisTitlePixelOffset(.2*o.fontSize),g[0]=2*(u.titleHeight+r.getAxisTitlePixelOffset()+u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize)/n[0],r.setBoxPosition([.99-g[0],-.92])),g[1]=Math.max(1.2,Math.min(1.84/i,1.84));else{r.setAxisTitlePixelOffset(1.2*o.fontSize),r.setTickLabelPixelOffset(.1*o.fontSize);var c=2*(.8*o.fontSize+u.titleHeight+r.getAxisTitlePixelOffset())/n[1],l=2*u.tickWidth/n[0];g[0]=Math.min(1.9,Math.max(1.4,1.4*l*(r.getTicks().length+3))),g[1]=c,r.setBoxPosition([-.5*g[0],-.97])}r.recomputeBarSegments(u)}}function Yl(t,e){return function(r){var n=r.getLastTickBounds(),a=Po().domain([n[0],n[1]]),i=a.ticks(5),s=a.tickFormat(5);r.setTicks(i),r.setTickStrings(i.map(s))}}function Ww(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=function(a){e.renderable!==a&&(e.renderable=a,e.barActor.setProperty(a.getProperty()),e.barActor.setParentProp(a),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(a.getProperty()),e.tmActor.setParentProp(a),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=a.generateTicks,e.axisTextStyle=ir({},a.getAxisTextStyle()),e.tickTextStyle=ir({},a.getTickTextStyle()),t.modified())},t.updateAPISpecificData=function(a,i,s){(e.lastSize[0]!==a[0]||e.lastSize[1]!==a[1])&&(e.lastSize[0]=a[0],e.lastSize[1]=a[1],e.lastAspectRatio=a[0]/a[1],e.forceUpdate=!0);var f=e.renderable.getScalarsToColors();if(!(!f||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(f),e.camera=i,e.renderWindow=s,e.forceUpdate||Math.max(f.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){var o=f.getMappingRange();if(e.lastTickBounds=Ce(o),e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle=ir({},e.renderable.getAxisTextStyle()),e.tickTextStyle=ir({},e.renderable.getTickTextStyle()),e.barPosition=Ce(e.renderable.getBarPosition()),e.barSize=Ce(e.renderable.getBarSize()),e.boxPosition=Ce(e.renderable.getBoxPosition()),e.boxSize=Ce(e.renderable.getBoxSize()),e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();var u=t.updateTextureAtlas();t.recomputeBarSegments(u)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=function(){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";var a={},i=new Map,s=0,f=1;Us(e.tmContext,e.axisTextStyle);var o=e.tmContext.measureText(e.renderable.getAxisLabel()),u={height:o.actualBoundingBoxAscent+2,startingHeight:f,width:o.width+2,textStyle:e.axisTextStyle};i.set(e.renderable.getAxisLabel(),u),f+=u.height,s=u.width,a.titleWidth=u.width,a.titleHeight=u.height,a.tickWidth=0,a.tickHeight=0,Us(e.tmContext,e.tickTextStyle);for(var g=[].concat(Ce(t.getTickStrings()),["NaN","Below","Above"]),c=0;c<g.length;c++)i.has(g[c])||(o=e.tmContext.measureText(g[c]),u={height:o.actualBoundingBoxAscent+2,startingHeight:f,width:o.width+2,textStyle:e.tickTextStyle},i.set(g[c],u),f+=u.height,s<u.width&&(s=u.width),a.tickWidth<u.width&&(a.tickWidth=u.width),a.tickHeight<u.height&&(a.tickHeight=u.height));return s=Pt(s),f=Pt(f),i.forEach(function(l){l.tcoords=[0,(f-l.startingHeight-l.height)/f,l.width/s,(f-l.startingHeight-l.height)/f,l.width/s,(f-l.startingHeight)/f,0,(f-l.startingHeight)/f]}),e.tmCanvas.width=s,e.tmCanvas.height=f,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,s,f),i.forEach(function(l,h){Us(e.tmContext,l.textStyle),e.tmContext.fillText(h,1,l.startingHeight+l.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=i,a},t.computeBarSize=function(a){e.vertical=e.boxSize[1]>e.boxSize[0];var i=2*a.tickHeight/e.lastSize[1],s=[1,1];if(e.vertical){var f=2*(a.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){var o=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-f,e.barSize[1]=e.boxSize[1]-o}else{var u=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-u-f,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+f,e.barPosition[1]=e.boxPosition[1],s[1]=i}else{var g=(2*a.tickWidth-8)/e.lastSize[0],c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-c,e.barPosition[1]=e.boxPosition[1],s[0]=g}return s},t.recomputeBarSegments=function(a){var i,s,f,o,u=t.computeBarSize(a);e.barSegments=[];var g=[0,0],c=e.vertical?1:0,l=e.vertical?.01:.02;function h(T,E){e.barSegments.push({corners:[[].concat(g),[g[0]+u[0],g[1]],[g[0]+u[0],g[1]+u[1]],[g[0],g[1]+u[1]]],scalars:E,title:T}),g[c]+=u[c]+l}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&h("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&(i=(s=e.renderable.getScalarsToColors()).getUseBelowRangeColor)!==null&&i!==void 0&&i.call(s)&&h("Below",[-.1,-.1,-.1,-.1]);var y=(f=(o=e.renderable.getScalarsToColors()).getUseAboveRangeColor)===null||f===void 0?void 0:f.call(o);g[c]+=l;var S=u[c];u[c]=y?1-2*l-u[c]-g[c]:1-l-g[c],h("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&y&&(u[c]=S,g[c]+=l,h("Above",[1.1,1.1,1.1,1.1]))};var r=new Float64Array(3);t.createPolyDataForOneLabel=function(a,i,s,f,o,u){var g=e._tmAtlas.get(a);if(!!g){var c=u.ptIdx,l=u.cellIdx;r[0]=(.5*i[0]+.5)*e.lastSize[0],r[1]=(.5*i[1]+.5)*e.lastSize[1],r[2]=i[2],r[0]+=o[0],r[1]+=o[1];var h=[],y=f==="vertical"?[1,0]:[0,1];f==="vertical"?(h[0]=g.width,h[1]=-g.height,s[0]==="middle"?r[1]-=g.width/2:s[0]==="right"&&(r[1]-=g.width),s[1]==="middle"?r[0]+=g.height/2:s[1]==="top"&&(r[0]+=g.height)):(h[0]=g.width,h[1]=g.height,s[0]==="middle"?r[0]-=g.width/2:s[0]==="right"&&(r[0]-=g.width),s[1]==="middle"?r[1]-=g.height/2:s[1]==="top"&&(r[1]-=g.height)),u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[0],u.tcoords[c*2+1]=g.tcoords[1],c++,r[y[0]]+=h[0],u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[2],u.tcoords[c*2+1]=g.tcoords[3],c++,r[y[1]]+=h[1],u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[4],u.tcoords[c*2+1]=g.tcoords[5],c++,r[y[0]]-=h[0],u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[6],u.tcoords[c*2+1]=g.tcoords[7],c++,u.polys[l*4]=3,u.polys[l*4+1]=c-4,u.polys[l*4+2]=c-3,u.polys[l*4+3]=c-2,l++,u.polys[l*4]=3,u.polys[l*4+1]=c-4,u.polys[l*4+2]=c-2,u.polys[l*4+3]=c-1,u.ptIdx+=4,u.cellIdx+=2}};var n=new Float64Array(3);t.updatePolyDataForLabels=function(){var a=t.getTickStrings().length+e.barSegments.length,i=a*4,s=a*2,f=new Float64Array(i*3),o=new Uint16Array(s*4),u=new Float32Array(i*2),g={ptIdx:0,cellIdx:0,polys:o,points:f,tcoords:u},c=e.vertical?0:1,l=e.vertical?1:0;n[2]=-.99;var h=e.vertical?["right","middle"]:["middle","bottom"],y=[0,1],S=[0,0];e.vertical?(S[0]=-e.tickLabelPixelOffset,e.topTitle?(n[0]=e.boxPosition[0]+.5*e.boxSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)):(n[0]=e.barPosition[0]+e.barSize[0],n[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],g)),y=[-1,0]):(S[1]=e.tickLabelPixelOffset,n[0]=e.barPosition[0]+.5*e.barSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)),n[c]=e.barPosition[c]+(.5*y[c]+.5)*e.barSize[c],n[l]=e.barPosition[l]+e.barSize[l]*.5;for(var T=null,E=0;E<e.barSegments.length;E++){var x=e.barSegments[E];x.title==="ticks"?T=x:(n[l]=e.barPosition[l]+.5*e.barSize[l]*(x.corners[2][l]+x.corners[0][l]),t.createPolyDataForOneLabel(x.title,n,h,"horizontal",S,g))}for(var w=e.barPosition[l]+e.barSize[l]*T.corners[0][l],C=e.barSize[l]*(T.corners[2][l]-T.corners[0][l]),m=t.getTicks(),D=t.getTickStrings(),b=0;b<m.length;b++){var F=(m[b]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);n[l]=w+C*F,t.createPolyDataForOneLabel(D[b],n,h,"horizontal",S,g)}var U=Ne.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(U),e.tmPolyData.getPoints().setData(f,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(o,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=function(){var a,i,s=e.renderable.getScalarsToColors(),f=0;e.renderable.getDrawNanAnnotation()&&s.getNanColor()&&(f+=1),e.renderable.getDrawBelowRangeSwatch()&&(a=s.getUseBelowRangeColor)!==null&&a!==void 0&&a.call(s)&&(f+=1),e.renderable.getDrawAboveRangeSwatch()&&(i=s.getUseAboveRangeColor)!==null&&i!==void 0&&i.call(s)&&(f+=1);var o=4*(1+f),u=o,g=1;s.getVectorMode()===zw.COMPONENT&&(g=s.getVectorComponent()+1);for(var c=new Float64Array(o*3),l=new Uint16Array(u*5),h=new Float32Array(o*g),y=0,S=0,T=0;T<e.barSegments.length;T++){for(var E=e.barSegments[T],x=0;x<4;x++){n[0]=e.barPosition[0]+E.corners[x][0]*e.barSize[0],n[1]=e.barPosition[1]+E.corners[x][1]*e.barSize[1],c[y*3]=(.5*n[0]+.5)*e.lastSize[0],c[y*3+1]=(.5*n[1]+.5)*e.lastSize[1],c[y*3+2]=n[2];for(var w=0;w<g;w++)h[y*g+w]=e.lastTickBounds[0]+E.scalars[x]*(e.lastTickBounds[1]-e.lastTickBounds[0]);y++}l[S*5]=4,l[S*5+1]=y-4,l[S*5+2]=y-3,l[S*5+3]=y-2,l[S*5+4]=y-1,S++}var C=Ne.newInstance({numberOfComponents:g,values:h,name:"Scalars"});e.polyData.getPointData().setScalars(C),e.polyData.getPoints().setData(c,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(l,1),e.polyData.getPolys().modified(),e.polyData.modified()}}var jw=L.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),L.obj(t,e),L.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),L.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),L.getArray(t,e,["boxPosition","boxSize"]),L.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},L.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=mr.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=Rr.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=Mr.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=Rr.newInstance(),e.tmMapper=mr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=zi.newInstance(),e.tmTexture.setInterpolate(!1),e.tmActor=Mr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],Ww(t,e)},"vtkScalarBarActorHelper");function $w(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=function(r){e.tickTextStyle=ir(ir({},e.tickTextStyle),r),t.modified()},t.setAxisTextStyle=function(r){e.axisTextStyle=ir(ir({},e.axisTextStyle),r),t.modified()},t.resetAutoLayoutToDefault=function(){t.setAutoLayout(Xl(t,e))},t.resetGenerateTicksToDefault=function(){t.setGenerateTicks(Yl())}}function Hw(t){return ir({automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0},t)}function Il(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Hw(r)),e.autoLayout||(e.autoLayout=Xl(t,e)),e.generateTicks||(e.generateTicks=Yl()),Mr.extend(t,e,r),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),L.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),L.get(t,e,["axisTextStyle","tickTextStyle"]),L.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),L.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),$w(t,e)}var Kw=L.newInstance(Il,"vtkScalarBarActor"),ql={newInstance:Kw,extend:Il,newScalarBarActorHelper:jw};function Xw(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=function(r){r&&(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.openGLRenderer?e.openGLRenderer.getRenderable().getActiveCamera():null,i=e.openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e._openGLRenderWindow.getRenderable())}}}var Yw={};function Iw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Yw,r),Ie.extend(t,e,r),e.scalarBarActorHelper=ql.newScalarBarActorHelper(),Xw(t,e)}var qw=Ue(Iw,"vtkOpenGLScalarBarActor");Mt("vtkScalarBarActor",qw);var yc=ge;function Zw(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=function(r){if(r){e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);var n=e.openGLRenderer.getRenderable();e.openGLCamera=e.openGLRenderer.getViewNodeFor(n.getActiveCamera())}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOpaqueActorCount()}},t.opaquePass=function(r,n){if(r&&!e.openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);var a=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",a);var i=e.openGLRenderer.getRenderable(),s=e.openGLCamera.getKeyMatrices(i),f=new Float64Array(16);if(xt(f,s.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",f),e.lastFormat==="box"){var o=i.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",o[0],o[1],o[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=function(){if(!e.tris.getCABO().getElementCount()){for(var r=new Float32Array(12),n=0;n<4;n++)r[n*3]=n%2*2-1,r[n*3+1]=n>1?1:-1,r[n*3+2]=1;var a=Ne.newInstance({numberOfComponents:3,values:r});a.setName("points");var i=new Uint16Array(8);i[0]=3,i[1]=0,i[2]=1,i[3]=3,i[4]=3,i[5]=0,i[6]=3,i[7]=2;var s=Ne.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",_t.SURFACE,{points:a,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||yc("Error setting vertexMC in shader VAO."));var f=e.renderable.getTextures();f.length||yc("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==f[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(f[0]))}}var Qw={context:null};function Jw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Qw,r),Ie.extend(t,e,r),e.openGLTexture=xr.newInstance(),e.tris=_n.newInstance(),e.keyMatrixTime={},yt(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Qr(new Float64Array(9)),mcwc:De(new Float64Array(16))},gt(t,e,["context"]),kt(t,e,["activeTextures"]),Zw(t,e)}var ex=Ue(Jw);Mt("vtkSkybox",ex);var tx=Or;function rx(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent();var a=e.openGLRenderer.getAspectRatio(),i=e.openGLRenderer?e.openGLRenderer.getRenderable().getActiveCamera():null,s=e.openGLRenderer.getTiledSizeAndOrigin(),f=null;if(e.renderable.getUseZValues()){var o=n.getZBufferTexture(),u=Math.floor(o.getWidth()),g=Math.floor(o.getHeight()),c=e._openGLRenderWindow.getContext();o.bind();var l=n.getFramebuffer();l?l.saveCurrentBindingsAndBuffers():tx("No framebuffer to save/restore");var h=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,h),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o.getHandle(),0),c.checkFramebufferStatus(c.FRAMEBUFFER)===c.FRAMEBUFFER_COMPLETE&&(f=new Uint8Array(u*g*4),c.viewport(0,0,u,g),c.readPixels(0,0,u,g,c.RGBA,c.UNSIGNED_BYTE,f)),l&&l.restorePreviousBindingsAndBuffers(),c.deleteFramebuffer(h)}e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,f)},t.queryPass=function(r,n){r&&e.renderable.getUseZValues()&&n.requestDepth()}}var nx={};function ax(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nx,r),Ie.extend(t,e,r),rx(t,e)}var ix=Ue(ax,"vtkOpenGLPixelSpaceCallbackMapper");Mt("vtkPixelSpaceCallbackMapper",ix);var Zl=Object.create(null);function jt(t,e){Zl[t]=e}function sx(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}var ox={};function fx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ox,r),e.overrides=Zl,Xg.extend(t,e,r),sx(t,e)}L.newInstance(fx,"vtkWebGPUViewNodeFactory");function ux(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=function(r,n,a,i){if(De(r),e.renderable.getParallelProjection()){var s=e.renderable.getParallelScale(),f=s*n,o=s,u=(i[0]-1)*f,g=(i[0]+1)*f,c=(i[1]-1)*o,l=(i[1]+1)*o,h=1/(g-u),y=1/(l-c);r[0]=2*h,r[5]=2*y,r[10]=1/(a[1]-a[0]),r[12]=(g+u)*h,r[13]=(l+c)*y,r[14]=a[1]/(a[1]-a[0])}else{var S=Math.tan(Math.PI*e.renderable.getViewAngle()/360),T,E;e.renderable.getUseHorizontalViewAngle()===!0?(T=a[0]*S,E=a[0]*S/n):(T=a[0]*S*n,E=a[0]*S);var x=(i[0]-1)*T,w=(i[0]+1)*T,C=(i[1]-1)*E,m=(i[1]+1)*E;r[0]=2*a[0]/(w-x),r[5]=2*a[0]/(m-C),r[12]=(x+w)/(w-x),r[13]=(C+m)/(m-C),r[10]=0,r[14]=a[0],r[11]=-1,r[15]=0}},t.convertToOpenGLDepth=function(r){if(e.renderable.getParallelProjection())return 1-r;var n=e.renderable.getClippingRangeByReference(),a=-n[0]/r;return a=(n[0]+n[1])/(n[1]-n[0])+2*n[0]*n[1]/(a*(n[1]-n[0])),.5*a+.5},t.getKeyMatrices=function(r){var n=r.getRenderable(),a=r.getParent();if(Math.max(a.getMTime(),t.getMTime(),n.getMTime(),e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatrixTime.getMTime()){var i=e.renderable.getViewMatrix();ut(e.keyMatrices.normalMatrix,i),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,xt(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ze(e.keyMatrices.wcvc,i);var s=r.getStabilizedCenterByReference();et(e.keyMatrices.scvc,e.keyMatrices.wcvc,s);var f=r.getAspectRatio(),o=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,f,o,e.renderable.getWindowCenterByReference()),St(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),xt(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}var cx={keyMatrixTime:null,keyMatrices:null};function gx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cx,r),Ie.extend(t,e,r),e.keyMatrixTime={},L.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},L.setGet(t,e,["keyMatrixTime"]),ux(t,e)}var vx=L.newInstance(gx);jt("vtkCamera",vx);function lx(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=function(r){if(e.bindables.length===r.length){for(var n=!0,a=0;a<e.bindables.length;a++)e.bindables[a]!==r[a]&&(n=!1);if(n)return}e.bindables=r,t.modified()},t.getBindGroupLayout=function(r){for(var n=[],a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupLayoutEntry();i.binding=a,n.push(i)}return r.getBindGroupLayout({entries:n})},t.getBindGroup=function(r){for(var n=t.getMTime(),a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupTime().getMTime();n=i>n?i:n}if(n<e.bindGroupTime.getMTime())return e.bindGroup;for(var s=[],f=0;f<e.bindables.length;f++){var o=e.bindables[f].getBindGroupEntry();o.binding=f,s.push(o)}return e.bindGroup=r.getHandle().createBindGroup({layout:t.getBindGroupLayout(r),entries:s,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=function(r){for(var n=[],a=r.getBindGroupLayoutCount(e.label),i=0;i<e.bindables.length;i++)n.push(e.bindables[i].getShaderCode(i,a));return n.join(`
`)}}var px={device:null,handle:null,label:null};function Ql(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,px,r),L.obj(t,e),e.bindables=[],e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),L.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),L.setGet(t,e,["label","device","arrayInformation"]),lx(t,e)}var hx=L.newInstance(Ql),Jl={newInstance:hx,extend:Ql};function yx(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=function(r,n){e.device=r,e.handle=e.device.getHandle().createShaderModule({code:n.getCode()})}}var dx={device:null,handle:null};function ep(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dx,r),L.obj(t,e),L.get(t,e,["lastCameraMTime"]),L.setGet(t,e,["device","handle"]),yx(t,e)}var Tx=L.newInstance(ep,"vtkWebGPUShaderModule"),Sx={newInstance:Tx,extend:ep};function Cx(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Array.isArray(r)?r.join(`
`):r,i=!1;t.search(e)!==-1&&(i=!0);var s="";n&&(s="g");var f=new RegExp(e,s),o=t.replace(f,a);return{replace:i,result:o}}function Ex(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=function(r){for(var n=r.getType(),a=r.getHash(),i=e._shaderModules.keys(),s=0;s<i.length;s++){var f=i[s];if(f.getHash()===a&&f.getType()===n)return e._shaderModules.get(f)}var o=Sx.newInstance();return o.initialize(e.device,r),e._shaderModules.set(r,o),o}}var wx={shaderModules:null,device:null,window:null};function tp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wx,r),e._shaderModules=new Map,L.obj(t,e),L.setGet(t,e,["device","window"]),Ex(t,e)}var xx=L.newInstance(tp,"vtkWebGPUShaderCache"),ke={newInstance:xx,extend:tp,substitute:Cx};function Ox(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=function(){return e.shaderDescriptions},t.initialize=function(r,n){e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=n;for(var a=[],i=0;i<e.layouts.length;i++)a.push(e.layouts[i].layout);e.pipelineLayout=r.getHandle().createPipelineLayout({bindGroupLayouts:a}),e.pipelineDescription.layout=e.pipelineLayout;for(var s=0;s<e.shaderDescriptions.length;s++){var f=e.shaderDescriptions[s],o=r.getShaderModule(f);f.getType()==="vertex"&&(e.pipelineDescription.vertex.module=o.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),f.getType()==="fragment"&&(e.pipelineDescription.fragment.module=o.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=r.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=function(r){for(var n=0;n<e.shaderDescriptions.length;n++)if(e.shaderDescriptions[n].getType()===r)return e.shaderDescriptions[n];return null},t.addBindGroupLayout=function(r){!r||e.layouts.push({layout:r.getBindGroupLayout(e.device),label:r.getLabel()})},t.getBindGroupLayout=function(r){return e.layouts[r].layout},t.getBindGroupLayoutCount=function(r){for(var n=0;n<e.layouts.length;n++)if(e.layouts[n].label===r)return n;return 0},t.bindVertexInput=function(r,n){n.bindBuffers(r)}}var Mx={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function rp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Mx,r),yt(t,e),e.layouts=[],e.shaderDescriptions=[],kt(t,e,["handle","pipelineDescription"]),gt(t,e,["device","renderEncoder","topology","vertexState"]),Ox(t,e)}var Dx=Ue(rp,"vtkWebGPUPipeline"),mx={newInstance:Dx,extend:rp};function Rx(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=function(r){return e.outputNames.includes(r)},t.addOutput=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(r),e.outputNames.push(n),e.outputInterpolations.push(a)},t.addBuiltinOutput=function(r,n){e.builtinOutputTypes.push(r),e.builtinOutputNames.push(n)},t.addBuiltinInput=function(r,n){e.builtinInputTypes.push(r),e.builtinInputNames.push(n)},t.replaceShaderCode=function(r,n){var a=[],i=[];if(n&&a.push(n.getShaderCode()),r||e.builtinInputNames.length){var s=[];if(s.push("struct ".concat(e.type,`Input
{`)),r)for(var f=r.getOutputNamesByReference(),o=r.getOutputTypesByReference(),u=r.getOutputInterpolationsByReference(),g=0;g<f.length;g++)u[g]!==void 0?s.push("  @location(".concat(g,") @interpolate(").concat(u[g],") ").concat(f[g]," : ").concat(o[g],",")):s.push("  @location(".concat(g,") ").concat(f[g]," : ").concat(o[g],","));for(var c=0;c<e.builtinInputNames.length;c++)s.push("  ".concat(e.builtinInputNames[c]," : ").concat(e.builtinInputTypes[c],","));s.length>1&&(s.push("};"),i=s,a[a.length-1]+=",",a.push("input: ".concat(e.type,"Input")))}if(a.length&&(e.code=ke.substitute(e.code,"//VTK::IOStructs::Input",a).result),e.outputNames.length+e.builtinOutputNames.length){for(var l=["struct ".concat(e.type,`Output
{`)],h=0;h<e.outputNames.length;h++)e.outputInterpolations[h]!==void 0?l.push("  @location(".concat(h,") @interpolate(").concat(e.outputInterpolations[h],") ").concat(e.outputNames[h]," : ").concat(e.outputTypes[h],",")):l.push("  @location(".concat(h,") ").concat(e.outputNames[h]," : ").concat(e.outputTypes[h],","));for(var y=0;y<e.builtinOutputNames.length;y++)l.push("  ".concat(e.builtinOutputNames[y]," : ").concat(e.builtinOutputTypes[y],","));l.push("};"),i=i.concat(l),e.code=ke.substitute(e.code,"//VTK::IOStructs::Output",["-> ".concat(e.type,"Output")]).result}e.code=ke.substitute(e.code,"//VTK::IOStructs::Dec",i).result}}var Lx={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function np(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Lx,r),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],L.obj(t,e),L.setGet(t,e,["type","hash","code"]),L.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),Rx(t,e)}var Vx=L.newInstance(np,"vtkWebGPUShaderDescription"),dc={newInstance:Vx,extend:np},Tc={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function _x(t){return!t||t.length<6?0:t in Tc?Tc[t]:(ge("unknown format ".concat(t)),null)}function bx(t){if(!t||t.length<5)return 0;var e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));var r=e===1?t.length-1:t.length-3,n=Number(t[r]);if(Number.isNaN(n))return ge("unknown format ".concat(t)),0;var a=5-n/2;return e*a}function kx(t){if(!t||t.length<5)return 0;var e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function Fx(t){if(!t||t.length<5)return 0;var e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{ge("unknown format ".concat(t));return}var r=t.split("x")[0],n=Number(r[r.length-1]);if(Number.isNaN(n)){ge("unknown format ".concat(t));return}return e+=8*(5-n/2),e+="Array",e}function Bx(t){var e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{ge("unknown format ".concat(t));return}var r=1;return t[t.length-2]==="x"&&(r=Number(t[t.length-1])),r===4?"vec4<".concat(e,">"):r===3?"vec3<".concat(e,">"):r===2?"vec2<".concat(e,">"):e}function Nx(t){if(!t)return 0;var e=1;t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]);var r=4;return e*r}function Ux(t){if(!!t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";ge("unknown format ".concat(t))}}var ot={getDetailsFromTextureFormat:_x,getByteStrideFromBufferFormat:bx,getNumberOfComponentsFromBufferFormat:kx,getNativeTypeFromBufferFormat:Fx,getShaderTypeFromBufferFormat:Bx,getByteStrideFromShaderFormat:Nx,getNativeTypeFromShaderFormat:Ux};function Gx(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!e.includes(t[r]))return!1;return!0}function Ax(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",i=n;Array.isArray(i)||(i=[i]);for(var s=0;s<e.inputs.length;s++)if(Gx(e.inputs[s].names,i)){if(e.inputs[s].buffer===r)return;e.inputs[s].buffer=r;return}e.inputs.push({buffer:r,stepMode:a,names:i}),e.inputs=e.inputs.sort(function(f,o){return f.names[0]<o.names[0]?-1:f.names[0]>o.names[0]?1:0})},t.removeBufferIfPresent=function(r){for(var n=0;n<e.inputs.length;n++)e.inputs[n].names.includes(r)&&e.inputs.splice(n,1)},t.getBuffer=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer;return null},t.hasAttribute=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return!0;return!1},t.getAttributeTime=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer.getSourceTime();return 0},t.getShaderCode=function(){for(var r="",n=0,a=0;a<e.inputs.length;a++)for(var i=0;i<e.inputs[a].names.length;i++){var s=e.inputs[a].buffer.getArrayInformation()[i],f=ot.getShaderTypeFromBufferFormat(s.format);n>0&&(r+=`,
`),r="".concat(r,"  @location(").concat(n,") ").concat(e.inputs[a].names[i]," : ").concat(f),n++}return r},t.getVertexInputInformation=function(){var r={};if(e.inputs.length){for(var n=[],a=0,i=0;i<e.inputs.length;i++){for(var s=e.inputs[i].buffer,f={arrayStride:s.getStrideInBytes(),stepMode:e.inputs[i].stepMode,attributes:[]},o=s.getArrayInformation(),u=0;u<e.inputs[i].names.length;u++)f.attributes.push({shaderLocation:a,offset:o[u].offset,format:o[u].format}),a++;n.push(f)}r.buffers=n}return r},t.bindBuffers=function(r){for(var n=0;n<e.inputs.length;n++)r.setVertexBuffer(n,e.inputs[n].buffer.getHandle());e.indexBuffer&&r.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=function(){},t.releaseGraphicsResources=function(){e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}var Px={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function ap(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Px,r),yt(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],gt(t,e,["created","device","handle","indexBuffer"]),Ax(t,e)}var zx=Ue(ap,"vtkWebGPUVertexInput"),Wx={newInstance:zx,extend:ap},jx=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,$x=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function Hx(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=function(r,n,a){var i=dc.newInstance({type:"vertex",hash:r,code:e.vertexShaderTemplate}),s=dc.newInstance({type:"fragment",hash:r,code:e.fragmentShaderTemplate}),f=n.getShaderDescriptions();f.push(i),f.push(s);for(var o=e.vertexShaderTemplate+e.fragmentShaderTemplate,u=new RegExp("//VTK::[^:]*::","g"),g=o.match(u).filter(function(y,S,T){return T.indexOf(y)===S}),c=g.map(function(y){return"replaceShader".concat(y.substring(7,y.length-2))}),l=0;l<c.length;l++){var h=c[l];h!=="replaceShaderIOStructs"&&e.shaderReplacements.has(h)&&e.shaderReplacements.get(h)(r,n,a)}t.replaceShaderIOStructs(r,n,a)},t.replaceShaderIOStructs=function(r,n,a){var i=n.getShaderDescription("vertex");i.replaceShaderCode(null,a);var s=n.getShaderDescription("fragment");s.replaceShaderCode(i)},t.replaceShaderRenderEncoder=function(r,n,a){e.renderEncoder.replaceShaderCode(n)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=function(r,n,a){if(!!e.WebGPURenderer){var i=e.WebGPURenderer.getBindGroup().getShaderCode(n),s=n.getShaderDescription("vertex"),f=s.getCode();f=ke.substitute(f,"//VTK::Renderer::Dec",[i]).result,s.setCode(f);var o=n.getShaderDescription("fragment");f=o.getCode(),f=ke.substitute(f,"//VTK::Renderer::Dec",[i]).result,o.setCode(f)}},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=function(r,n,a){var i=e.bindGroup.getShaderCode(n),s=n.getShaderDescription("vertex"),f=s.getCode();f=ke.substitute(f,"//VTK::Mapper::Dec",[i]).result,s.setCode(f);var o=n.getShaderDescription("fragment");o.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),f=o.getCode(),f=ke.substitute(f,"//VTK::Mapper::Dec",[i]).result,o.setCode(f)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var s=i.getCode();s=ke.substitute(s,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=function(r,n,a){var i=n.getShaderDescription("vertex");i.addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=function(r){e.textureViews.includes(r)||e.textureViews.push(r)},t.prepareToDraw=function(r){e.renderEncoder=r,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=function(){},t.updateBuffers=function(){},t.updateBindings=function(){e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=function(){},t.registerDrawCallback=function(r){r.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=function(r){t.prepareToDraw(r),r.setPipeline(e.pipeline),t.draw(r)},t.draw=function(r){var n=r.getBoundPipeline();r.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(r),n.bindVertexInput(r,e.vertexInput);var a=e.vertexInput.getIndexBuffer();a?r.drawIndexed(a.getIndexCount(),e.numberOfInstances,0,0,0):r.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=function(){var r=Ce(e.additionalBindables);e.UBO&&r.push(e.UBO),e.SSBO&&r.push(e.SSBO);for(var n=0;n<e.textureViews.length;n++){r.push(e.textureViews[n]);var a=e.textureViews[n].getSampler();a&&r.push(a)}return r},t.updatePipeline=function(){t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=mx.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}var Kx={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function ip(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Kx,r),Ie.extend(t,e,r),e.textureViews=[],e.vertexInput=Wx.newInstance(),e.bindGroup=Jl.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||$x,e.vertexShaderTemplate=e.vertexShaderTemplate||jx,e.shaderReplacements=new Map,L.get(t,e,["pipeline","vertexInput"]),L.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),Hx(t,e)}var Xx=L.newInstance(ip,"vtkWebGPUSimpleMapper"),sp={newInstance:Xx,extend:ip};function Yx(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();s=ke.substitute(s,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=function(){var r=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(r,["vertexBC"]),e.numberOfVertices=6}}var Ix={};function op(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ix,r),sp.extend(t,e,r),Yx(t,e)}var qx=L.newInstance(op,"vtkWebGPUFullScreenQuad"),Sc={newInstance:qx,extend:op},Zx={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},Qx={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6},Ca={BufferUsage:Zx,PrimitiveTypes:Qx};function Cc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Jx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Gs=["getMappedRange","mapAsync","unmap"];function eO(t,e,r,n){var a=n.byteLength,i=t.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),s=i.getMappedRange(0,a);new Uint8Array(s).set(new Uint8Array(n)),i.unmap();var f=t.createCommandEncoder();f.copyBufferToBuffer(i,0,e,r,a);var o=f.finish(),u=t.queue;u.submit([o]),i.destroy()}function tO(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a,usage:i,label:e.label}),e.sizeInBytes=a,e.usage=i},t.write=function(a){eO(e.device.getHandle(),e.handle,0,a.buffer)},t.createAndWrite=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a.byteLength,usage:i,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=a.byteLength,e.usage=i,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(a.buffer)),e.handle.unmap()};for(var r=function(i){t[Gs[i]]=function(){var s;return(s=e.handle)[Gs[i]].apply(s,arguments)}},n=0;n<Gs.length;n++)r(n)}var rO={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function fp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rO,r),L.obj(t,e),L.get(t,e,["handle","sizeInBytes","usage"]),L.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),tO(t,e)}var nO=L.newInstance(fp),Co=Jx({newInstance:nO,extend:fp},Ca);function Ec(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function aO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ec(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ec(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var wc=Ln.Representation,Sr=Ca.PrimitiveTypes,iO=function(){function t(){bo(this,t),this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}return ko(t,[{key:"clear",value:function(){this.count=0}},{key:"has",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return!0}},{key:"get",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return this.values[n]}},{key:"set",value:function(r,n){this.count<9&&(this.keys[this.count]=r,this.values[this.count++]=n)}}]),t}();function sO(t){switch(t){case Sr.Points:return"points";case Sr.Lines:return"lines";case Sr.Triangles:case Sr.TriangleEdges:return"polys";case Sr.TriangleStripEdges:case Sr.TriangleStrips:return"strips";default:return""}}function Ya(t,e,r){var n=t.pointIdToFlatId[e];return n<0&&(n=t.flatId,t.pointIdToFlatId[e]=n,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=r,t.flatId++),n}function oO(t,e,r){for(var n=t.length,a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i)){r.ibo[r.iboId++]=r.cellProvokedMap.get(i);for(var s=a+1;s<a+n;s++){i=t[s%n];var f=Ya(r,i,e);r.ibo[r.iboId++]=f}return}}for(var o=0;o<n;o++){var u=t[o];if(!r.provokedPointIds[u]){var g=Ya(r,u,e);r.provokedPointIds[u]=1,r.cellProvokedMap.set(u,g),r.flatIdToCellId[g]=e,r.ibo[r.iboId++]=g;for(var c=o+1;c<o+n;c++)u=t[c%n],g=Ya(r,u,e),r.ibo[r.iboId++]=g;return}}var l=t[0],h=r.flatId;r.cellProvokedMap.set(l,h),r.flatIdToPointId[r.flatId]=l,r.flatIdToCellId[r.flatId]=e,r.flatId++,r.ibo[r.iboId++]=h;for(var y=1;y<n;y++)l=t[y],h=Ya(r,l,e),r.ibo[r.iboId++]=h}function fO(t,e,r){var n=t.length;r.iboSize+=n;for(var a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i))return}for(var s=0;s<n;s++){var f=t[s];if(!r.provokedPointIds[f]){r.provokedPointIds[f]=1,r.cellProvokedMap.set(f,1);return}}r.cellProvokedMap.set(t[0],1),r.extraPoints++}var rr,xc=new Uint32Array(1),mt=new Uint32Array(2),lr=new Uint32Array(3),As={anythingToPoints:function(e,r,n,a,i){for(var s=0;s<e;++s)xc[0]=r[n+s],rr(xc,a,i)},linesToWireframe:function(e,r,n,a,i){for(var s=0;s<e-1;++s)mt[0]=r[n+s],mt[1]=r[n+s+1],rr(mt,a,i)},polysToWireframe:function(e,r,n,a,i){if(e>2)for(var s=0;s<e;++s)mt[0]=r[n+s],mt[1]=r[n+(s+1)%e],rr(mt,a,i)},stripsToWireframe:function(e,r,n,a,i){if(e>2){for(var s=0;s<e-1;++s)mt[0]=r[n+s],mt[1]=r[n+s+1],rr(mt,a,i);for(var f=0;f<e-2;f++)mt[0]=r[n+f],mt[1]=r[n+f+2],rr(mt,a,i)}},polysToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)lr[0]=r[n],lr[1]=r[n+s+1],lr[2]=r[n+s+2],rr(lr,a,i)},stripsToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)lr[0]=r[n+s],lr[1]=r[n+s+1+s%2],lr[2]=r[n+s+1+(s+1)%2],rr(lr,a,i)}};function uO(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=function(r){var n=r.cells,a=r.primitiveType,i=r.representation,s=r.cellOffset,f=n.getData(),o=f.length,u=sO(a),g=r.numberOfPoints,c={provokedPointIds:new Uint8Array(g),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new iO},l=null;i===wc.POINTS||a===Sr.Points?l=As.anythingToPoints:i===wc.WIREFRAME||a===Sr.Lines?l=As["".concat(u,"ToWireframe")]:l=As["".concat(u,"ToSurface")],rr=fO;for(var h=s||0,y=0;y<o;)c.cellProvokedMap.clear(),l(f[y],f,y+1,h,c),y+=f[y]+1,h++;g<=65535?c.flatIdToPointId=new Uint16Array(g+c.extraPoints):c.flatIdToPointId=new Uint32Array(g+c.extraPoints),g+c.extraPoints<36863?c.pointIdToFlatId=new Int16Array(g):c.pointIdToFlatId=new Int32Array(g),g+c.extraPoints<=65535?(c.ibo=new Uint16Array(c.iboSize),r.format="uint16"):(c.ibo=new Uint32Array(c.iboSize),r.format="uint32"),h<=65535?c.flatIdToCellId=new Uint16Array(g+c.extraPoints):c.flatIdToCellId=new Uint32Array(g+c.extraPoints),c.pointIdToFlatId.fill(-1),c.provokedPointIds.fill(0),rr=oO,h=s||0;for(var S=0;S<o;)c.cellProvokedMap.clear(),l(f[S],f,S+1,h,c),S+=f[S]+1,h++;delete c.provokedPointIds,delete c.pointIdToFlatId,r.nativeArray=c.ibo,e.flatIdToPointId=c.flatIdToPointId,e.flatIdToCellId=c.flatIdToCellId,e.flatSize=c.flatId,e.indexCount=c.iboId}}var cO={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function up(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cO,r),Co.extend(t,e,r),L.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),uO(t,e)}var gO=L.newInstance(up),vO=aO({newInstance:gO,extend:up},Ca);function Oc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Mc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Oc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Oc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var pr=Ca.BufferUsage,lO=ge,Pr=Ne.VtkDataTypes,pO={};function hO(t){var e;switch(t.getDataType()){case Pr.UNSIGNED_CHAR:e="uint8";break;case Pr.FLOAT:e="float32";break;case Pr.UNSIGNED_INT:e="uint32";break;case Pr.INT:e="sint32";break;case Pr.DOUBLE:e="float32";break;case Pr.UNSIGNED_SHORT:e="uint16";break;case Pr.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||lO("unsupported x3 type for ".concat(e)),e+="x3";break;case 4:e+="x4";break}return e}function Dc(t,e,r,n,a){var i={},s=t.getFlatSize();if(!s)return i;var f=[0,0,0,0];a.shift&&(a.shift.length?f=a.shift:f.fill(a.shift));var o=[1,1,1,1];a.scale&&(a.scale.length?o=a.scale:o.fill(a.scale));var u=Object.prototype.hasOwnProperty.call(a,"packExtra")?a.packExtra:!1,g,c=0,l=r+(u?1:0),h=ya(n,s*l),y=t.getFlatIdToPointId();a.cellData&&(y=t.getFlatIdToCellId()),r===1?g=function(x){h[c++]=o[0]*e[x]+f[0]}:r===2?g=function(x){h[c++]=o[0]*e[x]+f[0],h[c++]=o[1]*e[x+1]+f[1]}:r===3&&!u?g=function(x){h[c++]=o[0]*e[x]+f[0],h[c++]=o[1]*e[x+1]+f[1],h[c++]=o[2]*e[x+2]+f[2]}:r===3&&u?g=function(x){h[c++]=o[0]*e[x]+f[0],h[c++]=o[1]*e[x+1]+f[1],h[c++]=o[2]*e[x+2]+f[2],h[c++]=o[3]*1+f[3]}:r===4&&(g=function(x){h[c++]=o[0]*e[x]+f[0],h[c++]=o[1]*e[x+1]+f[1],h[c++]=o[2]*e[x+2]+f[2],h[c++]=o[3]*e[x+3]+f[3]});for(var S=0;S<s;S++){var T=r*y[S];g(T)}return i.nativeArray=h,i}function yO(t,e,r,n){var a=[t[n*3]-t[r*3],t[n*3+1]-t[r*3+1],t[n*3+2]-t[r*3+2]],i=[t[e*3]-t[r*3],t[e*3+1]-t[r*3+1],t[e*3+2]-t[r*3+2]],s=[];return la(a,i,s),Mn(s),s}function dO(t,e){var r=e.getData(),n=t.getData();if(!n||!r)return null;for(var a=new Int8Array(t.getNumberOfCells()*4),i=n.length,s=0,f=0;f<i;){var o=yO(r,n[f+1],n[f+2],n[f+3]);a[s++]=127*o[0],a[s++]=127*o[1],a[s++]=127*o[2],a[s++]=127,f+=n[f]+1}return a}function TO(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function r(n){n.dataArray&&!n.nativeArray&&(n.nativeArray=n.dataArray.getData());var a,i;if(n.usage===pr.Index&&(a=vO.newInstance({label:n.label}),a.setDevice(e.device),i=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,a.buildIndexBuffer(n),a.createAndWrite(n.nativeArray,i),a.setArrayInformation([{format:n.format}])),a||(a=Co.newInstance({label:n.label}),a.setDevice(e.device)),n.usage===pr.UniformArray&&(i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===pr.Storage&&(i=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===pr.Texture&&(i=GPUBufferUsage.COPY_SRC,a.createAndWrite(n.nativeArray,i)),n.usage===pr.PointArray){i=GPUBufferUsage.VERTEX;var s=ot.getNativeTypeFromBufferFormat(n.format),f=Dc(n.indexBuffer,n.dataArray.getData(),n.dataArray.getNumberOfComponents(),s,{packExtra:n.packExtra,shift:n.shift,scale:n.scale,cellData:n.cellData,cellOffset:n.cellOffset});a.createAndWrite(f.nativeArray,i),a.setStrideInBytes(ot.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:n.cellData?"flat":"perspective"}])}if(n.usage===pr.NormalsFromPoints){i=GPUBufferUsage.VERTEX;var o=ot.getNativeTypeFromBufferFormat(n.format),u=dO(n.cells,n.dataArray),g=Dc(n.indexBuffer,u,4,o,{cellData:!0});a.createAndWrite(g.nativeArray,i),a.setStrideInBytes(ot.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:"flat"}])}return n.usage===pr.RawVertex&&(i=GPUBufferUsage.VERTEX,a.createAndWrite(n.nativeArray,i),a.setStrideInBytes(ot.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format}])),a.setSourceTime(n.time),a}t.hasBuffer=function(n){return e.device.hasCachedObject(n)},t.getBuffer=function(n){return n.hash?e.device.getCachedObject(n.hash,r,n):r(n)},t.getBufferForPointArray=function(n,a){var i=hO(n),s={hash:"".concat(n.getMTime(),"I").concat(a.getMTime()).concat(i),usage:pr.PointArray,format:i,dataArray:n,indexBuffer:a};return t.getBuffer(s)},t.getFullScreenQuadBuffer=function(){if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=Co.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);var n=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(n,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}var SO={device:null,fullScreenQuadBuffer:null};function cp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SO,r),yt(t,e),gt(t,e,["device"]),TO(t,e)}var CO=Ue(cp),fr=Mc(Mc({newInstance:CO,extend:cp},pO),Ca),EO=fr.BufferUsage,cn=L.vtkErrorMacro;function wO(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){cn("entry named ".concat(r," already exists"));return}e._bufferEntryNames.set(r,e.bufferEntries.length);var a=ot.getByteStrideFromShaderFormat(n);e.bufferEntries.push({name:r,type:n,sizeInBytes:a,offset:e.sizeInBytes,nativeType:ot.getNativeTypeFromShaderFormat(n)}),e.sizeInBytes+=a},t.send=function(r){if(!e._buffer){var n={nativeArray:e.Float32Array,usage:EO.Storage,label:e.label};e._buffer=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e._sendTime.modified();return}r.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[r]=L.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){cn("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);var f=e[s.nativeType];f[(s.offset+n*e.sizeInBytes)/f.BYTES_PER_ELEMENT]=a},t.setArray=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){cn("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);for(var f=e[s.nativeType],o=(s.offset+n*e.sizeInBytes)/f.BYTES_PER_ELEMENT,u=0;u<a.length;u++)f[o+u]=a[u]},t.setAllInstancesFromArray=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){cn("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=n.length/e.numberOfInstances,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,g=0;g<f;g++)s[u+g]=n[o*f+g]},t.setAllInstancesFromArrayColorToFloat=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){cn("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=n.length/e.numberOfInstances,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,g=0;g<f;g++)s[u+g]=n[o*f+g]/255},t.setAllInstancesFromArray3x3To4x4=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){cn("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=9,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,g=0;g<3;g++)for(var c=0;c<3;c++)s[u+g*4+c]=n[o*f+g*3+c]},t.getSendTime=function(){return e._sendTime.getMTime()},t.getShaderCode=function(r,n){for(var a=["struct ".concat(e.label,`StructEntry
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`
};
struct `.concat(e.label,`Struct
{
  values: array<`).concat(e.label,`StructEntry>,
};
@binding(`).concat(r,") @group(").concat(n,") var<storage, read> ").concat(e.label,": ").concat(e.label,`Struct;
`)),a.join(`
`)},t.getBindGroupEntry=function(){var r={resource:{buffer:e._buffer.getHandle()}};return r},t.clearData=function(){e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}var xO={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function gp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xO,r),L.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},L.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},L.get(t,e,["bindGroupTime"]),L.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),wO(t,e)}var OO=L.newInstance(gp,"vtkWebGPUStorageBuffer"),MO={newInstance:OO,extend:gp},DO=fr.BufferUsage,Ps=L.vtkErrorMacro;function mO(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){Ps("entry named ".concat(r," already exists"));return}e.sortDirty=!0,e._bufferEntryNames.set(r,e.bufferEntries.length),e.bufferEntries.push({name:r,type:n,sizeInBytes:ot.getByteStrideFromShaderFormat(n),offset:-1,nativeType:ot.getNativeTypeFromShaderFormat(n),packed:!1})},t.sortBufferEntries=function(){if(!!e.sortDirty){for(var r=0,n=[],a=4,i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];s.sizeInBytes%16===0&&(a=Math.max(16,a)),s.sizeInBytes%8===0&&(a=Math.max(8,a))}for(var f=0;f<e.bufferEntries.length;f++){var o=e.bufferEntries[f];o.packed===!1&&o.sizeInBytes%16===0&&(o.packed=!0,o.offset=r,n.push(o),r+=o.sizeInBytes)}for(var u=0;u<e.bufferEntries.length;u++){var g=e.bufferEntries[u];if(g.packed===!1&&g.sizeInBytes===12)for(var c=0;c<e.bufferEntries.length;c++){var l=e.bufferEntries[c];if(l.packed===!1&&l.sizeInBytes===4){g.packed=!0,g.offset=r,n.push(g),r+=g.sizeInBytes,l.packed=!0,l.offset=r,n.push(l),r+=l.sizeInBytes;break}}}for(var h=0;h<e.bufferEntries.length;h++){var y=e.bufferEntries[h];if(!y.packed&&y.sizeInBytes%8===0)for(var S=h+1;S<e.bufferEntries.length;S++){var T=e.bufferEntries[S];if(!T.packed&&T.sizeInBytes%8===0){y.packed=!0,y.offset=r,n.push(y),r+=y.sizeInBytes,T.packed=!0,T.offset=r,n.push(T),r+=T.sizeInBytes;break}}}for(var E=0;E<e.bufferEntries.length;E++){var x=e.bufferEntries[E];if(!x.packed&&x.sizeInBytes%8===0)for(var w=!1,C=0;!w&&C<e.bufferEntries.length;C++){var m=e.bufferEntries[C];if(!m.packed&&m.sizeInBytes===4)for(var D=C+1;D<e.bufferEntries.length;D++){var b=e.bufferEntries[D];if(!b.packed&&b.sizeInBytes===4){x.packed=!0,x.offset=r,n.push(x),r+=x.sizeInBytes,m.packed=!0,m.offset=r,n.push(m),r+=m.sizeInBytes,b.packed=!0,b.offset=r,n.push(b),r+=b.sizeInBytes,w=!0;break}}}}for(var F=0;F<e.bufferEntries.length;F++){var U=e.bufferEntries[F];!U.packed&&U.sizeInBytes>4&&(U.packed=!0,U.offset=r,n.push(U),r+=U.sizeInBytes)}for(var O=0;O<e.bufferEntries.length;O++){var A=e.bufferEntries[O];A.packed||(A.packed=!0,A.offset=r,n.push(A),r+=A.sizeInBytes)}e.bufferEntries=n,e._bufferEntryNames.clear();for(var W=0;W<e.bufferEntries.length;W++)e._bufferEntryNames.set(e.bufferEntries[W].name,W);e.sizeInBytes=r,e.sizeInBytes=a*Math.ceil(e.sizeInBytes/a),e.sortDirty=!1}},t.sendIfNeeded=function(r){if(!e.UBO){var n={nativeArray:e.Float32Array,usage:DO.UniformArray,label:e.label};e.UBO=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(r.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[r]=L.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){Ps("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);var s=e[i.nativeType];i.lastValue!==n&&(s[i.offset/s.BYTES_PER_ELEMENT]=n,e.sendDirty=!0),i.lastValue=n},t.setArray=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){Ps("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=!1,o=0;o<n.length;o++)(!i.lastValue||i.lastValue[o]!==n[o])&&(s[i.offset/s.BYTES_PER_ELEMENT+o]=n[o],f=!0);f&&(e.sendDirty=!0,i.lastValue=Ce(n))},t.getBindGroupEntry=function(){var r={resource:{buffer:e.UBO.getHandle()}};return r},t.getSendTime=function(){return e.sendTime.getMTime()},t.getShaderCode=function(r,n){t.sortBufferEntries();for(var a=["struct ".concat(e.label,`Struct
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`};
@binding(`.concat(r,") @group(").concat(n,") var<uniform> ").concat(e.label,": ").concat(e.label,"Struct;")),a.join(`
`)}}var RO={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function vp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RO,r),L.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},L.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,L.get(t,e,["binding","bindGroupTime"]),L.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),mO(t,e)}var LO=L.newInstance(vp,"vtkWebGPUUniformBuffer"),na={newInstance:LO,extend:vp},VO=Or,mc=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,_O=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,Ia=new Float64Array(16),Rc=new Float64Array(16);function bO(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function kO(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=function(){var r=e.camera.getClippingRange(),n=e.camera.getPositionByReference(),a=e.camera.getDirectionOfProjectionByReference(),i=[],s=[];hr(s,a,.5*(r[0]+r[1])),Kn(i,n,s),Is(s,i,e.stabilizedCenter);var f=Eg(s);f/(r[1]-r[0])>e.recenterThreshold&&(e.stabilizedCenter=i,e.stabilizedTime.modified())},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(VO("No lights are on, creating one."),e.renderable.createLight()),r},t.updateUBO=function(){var r=e.UBO.getSendTime();if(e._parent.getMTime()>r||t.getMTime()>r||e.camera.getMTime()>r||e.renderable.getMTime()>r){var n,a=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",a.wcvc),e.UBO.setArray("SCPCMatrix",a.scpc),e.UBO.setArray("PCSCMatrix",a.pcsc),e.UBO.setArray("SCVCMatrix",a.scvc),e.UBO.setArray("VCPCMatrix",a.vcpc),e.UBO.setArray("WCVCNormals",a.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",(n=e.renderable.getEnvironmentTexture())===null||n===void 0?void 0:n.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());var i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());var s=e._parent.getDevice();e.UBO.sendIfNeeded(s)}},t.updateSSBO=function(){for(var r=e.renderable.getLights(),n=e.webgpuCamera.getKeyMatrices(t),a="".concat(e.renderable.getMTime()),i=0;i<r.length;i++)a+=r[i].getMTime();if(a!==e.lightTimeString){for(var s=new Float32Array(r.length*4),f=new Float32Array(r.length*4),o=new Float32Array(r.length*4),u=new Float32Array(r.length*4),g=0;g<r.length;g++){var c=g*4,l=r[g].getPosition();me(l,l,n.wcvc),s[c]=l[0],s[c+1]=l[1],s[c+2]=l[2],s[c+3]=0,f[c]=-r[g].getDirection()[0],f[c+1]=-r[g].getDirection()[1],f[c+2]=-r[g].getDirection()[2],f[c+3]=0,o[c]=r[g].getColor()[0],o[c+1]=r[g].getColor()[1],o[c+2]=r[g].getColor()[2],o[c+3]=r[g].getIntensity()*5,u[c]=bO(r[g]),u[c+1]=Math.cos(Ke(r[g].getConeAngle())),u[c+2]=Math.cos(Ke(r[g].getConeAngle()+r[g].getConeFalloff())),u[c+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(r.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",s),e.SSBO.setAllInstancesFromArray("LightDir",f),e.SSBO.setAllInstancesFromArray("LightColor",o),e.SSBO.setAllInstancesFromArray("LightData",u);var h=e._parent.getDevice();e.SSBO.send(h)}e.lightTimeString=a},t.scissorAndViewport=function(r){var n=t.getYInvertedTiledSizeAndOrigin();r.getHandle().setViewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize,0,1),r.getHandle().setScissorRect(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)},t.bindUBO=function(r){r.activateBindGroup(e.bindGroup)},t.opaquePass=function(r){r?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=function(){var r;if(!(e.renderable.getTransparent()||e.suppressClear)){var n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=Sc.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(mc);var a=na.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&(r=e.backgroundTex)!==null&&r!==void 0&&r.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(_O);var i=na.newInstance({label:"mapperUBO"});i.addEntry("FSQMatrix","mat4x4<f32>"),i.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(i);var s=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(s.getReady()){var f=s.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([f]),e.backgroundTexLoaded=!0;var o=e.backgroundTex.getInterpolate()?"linear":"nearest";f.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:o,magFilter:o,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=Sc.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(mc);var u=na.newInstance({label:"mapperUBO"});u.addEntry("FSQMatrix","mat4x4<f32>"),u.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(u)}var g=e.webgpuCamera.getKeyMatrices(t),c=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",c),ze(Rc,g.normalMatrix),Xs(Ia,g.scvc,g.pcsc),Xs(Ia,Rc,Ia),e.clearFSQ.getUBO().setArray("FSQMatrix",Ia),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)}},t.translucentPass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.convertToOpenGLDepth=function(r){return e.webgpuCamera.convertToOpenGLDepth(r)},t.getYInvertedTiledSizeAndOrigin=function(){var r=t.getTiledSizeAndOrigin(),n=e._parent.getSizeByReference();return r.lowerLeftV=n[1]-r.vsize-r.lowerLeftV,r},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),f=Math.round(s[0]),o=Math.round(s[1]),u=r[2]-n[0],g=r[3]-n[1],c=e._parent.normalizedDisplayToDisplay(u,g),l=Math.round(c[0])-f,h=Math.round(c[1])-o;return l<0&&(l=0),h<0&&(h=0),{usize:l,vsize:h,lowerLeftU:f,lowerLeftV:o}},t.getPropFromID=function(r){for(var n=0;n<e.children.length;n++){var a=e.children[n].getPropID?e.children[n].getPropID():-1;if(a===r)return e.children[n]}return null},t.getStabilizedTime=function(){return e.stabilizedTime.getMTime()},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()}}var FO={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function BO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FO,r),Ie.extend(t,e,r),e.UBO=na.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=MO.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=Jl.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=De(new Float64Array(16)),e.stabilizedTime={},yt(e.stabilizedTime,{mtime:0}),kt(t,e,["bindGroup","stabilizedTime"]),da(t,e,["stabilizedCenter"]),gt(t,e,["renderEncoder","selector","suppressClear","UBO"]),kO(t,e)}var NO=Ue(BO,"vtkWebGPURenderer");jt("vtkRenderer",NO);var Lc=Sa.CoordinateSystem;function UO(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();var n=e.renderable.getMatrix();e.bufferShift[0]=n[3],e.bufferShift[1]=n[7],e.bufferShift[2]=n[11];var a=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Lc.WORLD&&(e.bufferShift[0]-=a[0],e.bufferShift[1]-=a[1],e.bufferShift[2]-=a[2]),ze(e.keyMatrices.bcwc,n),e.renderable.getIsIdentity()?De(e.keyMatrices.normalMatrix):(ut(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,xt(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),ze(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),et(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Lc.WORLD?et(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-a[0],-a[1],-a[2]]):ut(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var GO={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function AO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GO,r),Ie.extend(t,e,r),e.keyMatricesTime={},L.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},L.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],UO(t,e)}var PO=L.newInstance(AO);jt("vtkActor",PO);var Vc=Sa.CoordinateSystem;function zO(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;var n=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Vc.WORLD&&(e.bufferShift[0]-=n[0],e.bufferShift[1]-=n[1],e.bufferShift[2]-=n[2]),De(e.keyMatrices.bcwc),De(e.keyMatrices.normalMatrix),et(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Vc.WORLD?et(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-n[0],-n[1],-n[2]]):ut(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var WO={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function jO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WO,r),Ie.extend(t,e,r),e.keyMatricesTime={},L.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},L.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],zO(t,e)}var $O=L.newInstance(jO);jt("vtkActor2D",$O);function HO(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var KO={};function XO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KO,r),Ie.extend(t,e,r),e.CubeAxesActorHelper=Rl.newCubeAxesActorHelper(),HO(t,e)}var YO=Ue(XO,"vtkWebGPUCubeAxesActor");jt("vtkCubeAxesActor",YO);function _c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function IO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_c(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_c(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Eo=Kl.DisplayLocation;function qO(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=function(){return t.setDisplayLocation(Eo.BACKGROUND)},t.setDisplayLocationToForeground=function(){return t.setDisplayLocation(Eo.FOREGROUND)},t.setRepresentationToWireframe=function(){return t.setRepresentation(_t.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(_t.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(_t.POINTS)},t.getRepresentationAsString=function(){return L.enumToString(_t,e.representation)}}var ZO={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:_t.SURFACE,displayLocation:Eo.FOREGROUND};function lp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZO,r),L.obj(t,e),L.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),L.setGetArray(t,e,["color"],3),qO(t,e)}var QO=L.newInstance(lp,"vtkProperty2D"),JO=IO({newInstance:QO,extend:lp},Kl),nt=fr.BufferUsage,lt=fr.PrimitiveTypes,qa=Ln.Representation,Za=mr.ScalarMode,eM=Sa.CoordinateSystem,tM=JO.DisplayLocation,rM=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,nM=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359; 
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1, max(NdotL, NdotV), step(0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2) + k*k) / (pow((ior + 1.0), 2) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359; 

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;
  
  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1, schlickGGX(N, V, k));
  var ggx2: f32 = min(1, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); 
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  var incoming: vec3<f32> = color * (1. / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  
  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1);
  var _roughnessMap: vec4<f32> = vec4<f32>(1);
  var _metallicMap: vec4<f32> = vec4<f32>(1);
  var _normalMap: vec4<f32> = vec4<f32>(0, 0, 1, 0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1);
  var _emissionMap: vec4<f32> = vec4<f32>(0);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function bc(t){return t.indexOf("edge")>=0}function aM(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=function(r){r&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==eM.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty(),a=e.UBO.getSendTime();if(t.getMTime()>a||n.getMTime()>a||e.renderable.getMTime()>a){var i,s=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",s.bcwc),e.UBO.setArray("BCSCMatrix",s.bcsc),e.UBO.setArray("MCWCNormals",s.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===tM.FOREGROUND?1:0);var f=n.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[f[0],f[1],f[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{var o=n.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",n.getAmbient()),e.UBO.setArray("AmbientColor",[o[0],o[1],o[2],1]),e.UBO.setValue("DiffuseIntensity",n.getDiffuse()),o=n.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[o[0],o[1],o[2],1]),e.UBO.setValue("Roughness",n.getRoughness()),e.UBO.setValue("BaseIOR",n.getBaseIOR()),e.UBO.setValue("Metallic",n.getMetallic()),e.UBO.setValue("NormalStrength",n.getNormalStrength()),e.UBO.setValue("Emission",n.getEmission()),e.UBO.setValue("SpecularIntensity",n.getSpecular()),o=n.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[o[0],o[1],o[2],1])}var u=(i=n.getEdgeColorByReference)===null||i===void 0?void 0:i.call(n);u&&e.UBO.setArray("EdgeColor",[u[0],u[1],u[2],1]),e.UBO.setValue("LineWidth",n.getLineWidth()),e.UBO.setValue("Opacity",n.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());var g=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(g)}},t.haveWideLines=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();return r.getProperty().getLineWidth()<=1||e.primitiveType===lt.Verts?!1:e.primitiveType===lt.Triangles||e.primitiveType===lt.TriangleStrips?n===qa.WIREFRAME:!0},t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();e.useRendererMatrix?(s=ke.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(s=ke.substitute(s,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(s=ke.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(s=ke.substitute(s,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(i.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),s=ke.substitute(s,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),s=ke.substitute(s,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=function(r,n,a){var i=a.getBuffer("normalMC"),s=e.WebGPUActor.getRenderable();if(i){var f=n.getShaderDescription("vertex");f.hasOutput("normalVC")||f.addOutput("vec3<f32>","normalVC",i.getArrayInformation()[0].interpolation),f.hasOutput("tangentVC")||f.addOutput("vec3<f32>","tangentVC",i.getArrayInformation()[0].interpolation),f.hasOutput("bitangentVC")||f.addOutput("vec3<f32>","bitangentVC",i.getArrayInformation()[0].interpolation);var o=f.getCode();o=ke.substitute(o,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,f.setCode(o);var u=n.getShaderDescription("fragment");o=u.getCode(),s.getProperty().getNormalTexture()?o=ke.substitute(o,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:o=ke.substitute(o,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,u.setCode(o)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=function(r,n,a){if(!r.includes("sel")){var i=n.getShaderDescription("vertex");i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=e.WebGPURenderer.getRenderable(),f=n.getShaderDescription("fragment"),o=f.getCode();if(o.includes("var normal:")&&e.useRendererMatrix&&!bc(r)&&!e.is2D&&!r.includes("sel")){var u,g=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];(u=s.getEnvironmentTexture())!==null&&u!==void 0&&u.getImageLoaded()&&g.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),o=ke.substitute(o,"//VTK::Light::Impl",g).result,f.setCode(o)}else o=ke.substitute(o,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,f.setCode(o)}},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=function(r,n,a){if(bc(r)){var i=n.getShaderDescription("fragment"),s=i.getCode();s=ke.substitute(s,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,i.setCode(s);return}var f=a.getBuffer("colorVI");if(!!f){var o=n.getShaderDescription("vertex");o.addOutput("vec4<f32>","color",f.getArrayInformation()[0].interpolation);var u=o.getCode();u=ke.substitute(u,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,o.setCode(u);var g=n.getShaderDescription("fragment");u=g.getCode(),u=ke.substitute(u,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,g.setCode(u)}},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=function(r,n,a){var i,s,f,o,u,g,c,l,h,y,S,T,E,x,w,C,m,D;if(!!a.hasAttribute("tcoord")){var b=n.getShaderDescription("vertex"),F=a.getBuffer("tcoord"),U=ot.getNumberOfComponentsFromBufferFormat(F.getArrayInformation()[0].format),O=b.getCode();b.addOutput("vec".concat(U,"<f32>"),"tcoordVS"),O=ke.substitute(O,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,b.setCode(O);var A=n.getShaderDescription("fragment");O=A.getCode();var W=e.WebGPUActor.getRenderable(),j=function(P){if(!P)return!1;var G=P.getDimensionality();return G===U},N=[];if((i=(s=W.getProperty()).getDiffuseTexture)!==null&&i!==void 0&&(f=i.call(s))!==null&&f!==void 0&&f.getImageLoaded()||W.getTextures()[0]||e.colorTexture){var I,X;(j((I=(X=W.getProperty()).getDiffuseTexture)===null||I===void 0?void 0:I.call(X))||j(W.getTextures()[0])||j(e.colorTexture))&&N.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);")}(o=(u=W.getProperty()).getRoughnessTexture)!==null&&o!==void 0&&(g=o.call(u))!==null&&g!==void 0&&g.getImageLoaded()&&j(W.getProperty().getRoughnessTexture())&&N.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),(c=(l=W.getProperty()).getMetallicTexture)!==null&&c!==void 0&&(h=c.call(l))!==null&&h!==void 0&&h.getImageLoaded()&&j(W.getProperty().getMetallicTexture())&&N.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),(y=(S=W.getProperty()).getNormalTexture)!==null&&y!==void 0&&(T=y.call(S))!==null&&T!==void 0&&T.getImageLoaded()&&j(W.getProperty().getNormalTexture())&&N.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),(E=(x=W.getProperty()).getAmbientOcclusionTexture)!==null&&E!==void 0&&(w=E.call(x))!==null&&w!==void 0&&w.getImageLoaded()&&j(W.getProperty().getAmbientOcclusionTexture())&&N.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),(C=(m=W.getProperty()).getEmissionTexture)!==null&&C!==void 0&&(D=C.call(m))!==null&&D!==void 0&&D.getImageLoaded()&&j(W.getProperty().getEmissionTexture())&&N.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),O=ke.substitute(O,"//VTK::TCoord::Impl",N).result,A.setCode(O)}},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=function(r,n,a){if(r.includes("sel")){var i=n.getShaderDescription("fragment"),s=i.getCode();s=ke.substitute(s,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,i.setCode(s)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=function(r,n){return r===qa.POINTS||n===lt.Points?nt.Verts:n===lt.Lines?nt.Lines:r===qa.WIREFRAME?n===lt.Triangles?nt.LinesFromTriangles:nt.LinesFromStrips:n===lt.Triangles?nt.Triangles:n===lt.TriangleStrips?nt.Strips:n===lt.TriangleEdges?nt.LinesFromTriangles:nt.LinesFromStrips},t.getHashFromUsage=function(r){return"pt".concat(r)},t.getTopologyFromUsage=function(r){switch(r){case nt.Triangles:return"triangle-list";case nt.Verts:return"point-list";case nt.Lines:default:return"line-list"}},t.buildVertexInput=function(){var r,n,a=e.currentInput,i=e.cellArray,s=e.primitiveType,f=e.WebGPUActor.getRenderable(),o=f.getProperty().getRepresentation(),u=e.WebGPURenderWindow.getDevice(),g=!1;s===lt.TriangleEdges&&(g=!0,o=qa.WIREFRAME);var c=e.vertexInput,l=a.getPoints(),h;if(i){var y={hash:"R".concat(o,"P").concat(s).concat(i.getMTime()),usage:nt.Index,cells:i,numberOfPoints:l.getNumberOfPoints(),primitiveType:s,representation:o};h=u.getBufferManager().getBuffer(y),c.setIndexBuffer(h)}else c.setIndexBuffer(null);if(l){var S=e.WebGPUActor.getBufferShift(e.WebGPURenderer),T={hash:"".concat(l.getMTime(),"I").concat(h.getMTime()).concat(S.join(),"float32x4"),usage:nt.PointArray,format:"float32x4",dataArray:l,indexBuffer:h,shift:S,packExtra:!0},E=u.getBufferManager().getBuffer(T);c.addBuffer(E,["vertexBC"])}else c.removeBufferIfPresent("vertexBC");var x=t.getUsage(o,s);if(e._usesCellNormals=!1,!e.is2D&&(x===nt.Triangles||x===nt.Strips)){var w=a.getPointData().getNormals(),C={format:"snorm8x4",indexBuffer:h,packExtra:!0,shift:0,scale:127};if(w){C.hash="".concat(w.getMTime(),"I").concat(h.getMTime(),"snorm8x4"),C.dataArray=w,C.usage=nt.PointArray;var m=u.getBufferManager().getBuffer(C);c.addBuffer(m,["normalMC"])}else if(s===lt.Triangles){e._usesCellNormals=!0,C.hash="PFN".concat(l.getMTime(),"I").concat(h.getMTime(),"snorm8x4"),C.dataArray=l,C.cells=i,C.usage=nt.NormalsFromPoints;var D=u.getBufferManager().getBuffer(C);c.addBuffer(D,["normalMC"])}else c.removeBufferIfPresent("normalMC")}else c.removeBufferIfPresent("normalMC");var b=!1;if(e.renderable.getScalarVisibility()){var F=e.renderable.getColorMapColors();if(F&&!g){var U=e.renderable.getScalarMode(),O=!1;(U===Za.USE_CELL_DATA||U===Za.USE_CELL_FIELD_DATA||U===Za.USE_FIELD_DATA||!a.getPointData().getScalars())&&U!==Za.USE_POINT_FIELD_DATA&&F&&(O=!0);var A={usage:nt.PointArray,format:"unorm8x4",hash:"".concat(O).concat(F.getMTime(),"I").concat(h.getMTime(),"unorm8x4"),dataArray:F,indexBuffer:h,cellData:O,cellOffset:0},W=u.getBufferManager().getBuffer(A);c.addBuffer(W,["colorVI"]),b=!0}}b||c.removeBufferIfPresent("colorVI");var j=null;if((r=(n=e.renderable).getInterpolateScalarsBeforeMapping)!==null&&r!==void 0&&r.call(n)&&e.renderable.getColorCoordinates()?j=e.renderable.getColorCoordinates():j=a.getPointData().getTCoords(),j&&!g){var N=u.getBufferManager().getBufferForPointArray(j,c.getIndexBuffer());c.addBuffer(N,["tcoord"])}else c.removeBufferIfPresent("tcoord")},t.updateTextures=function(){var r,n,a,i,s,f,o,u,g,c,l,h,y,S,T,E=[],x=[],w=(r=(n=e.renderable).getColorTextureMap)===null||r===void 0?void 0:r.call(n);w&&(e.colorTexture||(e.colorTexture=zi.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(w),x.push(["Diffuse",e.colorTexture]));var C=e.WebGPUActor.getRenderable(),m=e.WebGPURenderer.getRenderable(),D=[];if((a=(i=C.getProperty()).getDiffuseTexture)!==null&&a!==void 0&&a.call(i)){var b=["Diffuse",C.getProperty().getDiffuseTexture()];D.push(b)}if(C.getTextures()[0]){var F=["Diffuse",C.getTextures()[0]];D.push(F)}if(e.colorTexture){var U=["Diffuse",e.colorTexture];D.push(U)}if((s=(f=C.getProperty()).getRoughnessTexture)!==null&&s!==void 0&&s.call(f)){var O=["Roughness",C.getProperty().getRoughnessTexture()];D.push(O)}if((o=(u=C.getProperty()).getMetallicTexture)!==null&&o!==void 0&&o.call(u)){var A=["Metallic",C.getProperty().getMetallicTexture()];D.push(A)}if((g=(c=C.getProperty()).getNormalTexture)!==null&&g!==void 0&&g.call(c)){var W=["Normal",C.getProperty().getNormalTexture()];D.push(W)}if((l=(h=C.getProperty()).getAmbientOcclusionTexture)!==null&&l!==void 0&&l.call(h)){var j=["AmbientOcclusion",C.getProperty().getAmbientOcclusionTexture()];D.push(j)}if((y=(S=C.getProperty()).getEmissionTexture)!==null&&y!==void 0&&y.call(S)){var N=["Emission",C.getProperty().getEmissionTexture()];D.push(N)}if((T=m.getEnvironmentTexture)!==null&&T!==void 0&&T.call(m)){var I=["Environment",m.getEnvironmentTexture()];D.push(I)}for(var X=0;X<D.length;X++)(D[X][1].getInputData()||D[X][1].getJsImageData()||D[X][1].getCanvas())&&x.push(D[X]),D[X][1].getImage()&&D[X][1].getImageLoaded()&&x.push(D[X]);for(var J=0;J<x.length;J++){var P=x[J][1],G=x[J][0],K=e.device.getTextureManager().getTextureForVTKTexture(P);if(K.getReady()){for(var te=!1,ee=0;ee<e.textures.length;ee++)e.textures[ee]===K&&(te=!0,E[ee]=!0);if(!te){E[e.textures.length]=!0;var fe=K.createView("".concat(G,"Texture"));e.textures.push(K),e.textureViews.push(fe);var ve=P.getInterpolate()?"linear":"nearest",ce=null;!ce&&P.getEdgeClamp()&&P.getRepeat()&&(ce="mirror-repeat"),!ce&&P.getEdgeClamp()&&(ce="clamp-to-edge"),!ce&&P.getRepeat()&&(ce="repeat"),G!=="Environment"?fe.addSampler(e.device,{addressModeU:ce,addressModeV:ce,addressModeW:ce,minFilter:ve,magFilter:ve}):fe.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:ve,magFilter:ve,mipmapFilter:"linear"})}}}for(var pe=e.textures.length-1;pe>=0;pe--)E[pe]||(e.textures.splice(pe,1),e.textureViews.splice(pe,1))},t.computePipelineHash=function(){var r="pd".concat(e.useRendererMatrix?"r":"").concat(e.forceZValue?"z":"");if(e.primitiveType===lt.TriangleEdges||e.primitiveType===lt.TriangleStripEdges)r+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(r+="n"),e.vertexInput.hasAttribute("colorVI")&&(r+="c"),e.vertexInput.hasAttribute("tcoord")){var n=e.vertexInput.getBuffer("tcoord"),a=ot.getNumberOfComponentsFromBufferFormat(n.getArrayInformation()[0].format);r+="t".concat(a)}e.textures.length&&(r+="tx".concat(e.textures.length))}e._usesCellNormals&&(r+="cn"),e.SSBO&&(r+="ssbo");var i=t.getHashFromUsage(e.usage);r+=i,r+=e.renderEncoder.getPipelineHash(),e.pipelineHash=r},t.updateBuffers=function(){e.primitiveType!==lt.TriangleEdges&&e.primitiveType!==lt.TriangleStripEdges&&t.updateTextures();var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();e.usage=t.getUsage(n,e.primitiveType),t.buildVertexInput();var a=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(a.getSizeInBytes()/a.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){var i=r.getProperty();t.setNumberOfInstances(Math.ceil(i.getLineWidth()*2))}else t.setNumberOfInstances(1)}}var iM={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function pp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iM,r),sp.extend(t,e,r),e.fragmentShaderTemplate=nM,e.vertexShaderTemplate=rM,e._tmpMat3=Qr(new Float64Array(9)),e._tmpMat4=De(new Float64Array(16)),e.UBO=na.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),gt(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],aM(t,e)}var sM=Ue(pp,"vtkWebGPUCellArrayMapper"),ji={newInstance:sM,extend:pp},Qa=fr.PrimitiveTypes;function oM(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=function(){return ji.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=Qa.Points;s<=Qa.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var f=e.primitives[s];f.setCellArray(n[s]),f.setCurrentInput(r),f.setCellOffset(i),f.setPrimitiveType(s),f.setRenderable(e.renderable),i+=n[s].getNumberOfCells(),a.push(f)}else e.primitives[s]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(var o=Qa.TriangleEdges;o<=Qa.TriangleStripEdges;o++)if(n[o-2].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());var u=e.primitives[o];u.setCellArray(n[o-2]),u.setCurrentInput(r),u.setCellOffset(e.primitives[o-2].getCellOffset()),u.setPrimitiveType(o),u.setRenderable(e.renderable),a.push(u)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}var fM={primitives:null};function uM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fM,r),Ie.extend(t,e,r),e.primitives=[],oM(t,e)}var cM=Ue(uM,"vtkWebGPUPolyDataMapper");jt("vtkMapper",cM);function kc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function gM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Fc=fr.PrimitiveTypes;function vM(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=function(){return ji.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=Fc.Points;s<=Fc.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var f=e.primitives[s];f.setCellArray(n[s]),f.setCurrentInput(r),f.setCellOffset(i),f.setPrimitiveType(s),f.setRenderable(e.renderable),f.setIs2D(!0),i+=n[s].getNumberOfCells(),a.push(f)}else e.primitives[s]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}function lM(t){return gM({primitives:[]},t)}function pM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lM(r)),Ie.extend(t,e,r),e.primitives=[],vM(t,e)}var hM=Ue(pM,"vtkWebGPUPolyDataMapper2D");jt("vtkMapper2D",hM);function yM(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var dM={};function TM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dM,r),Ie.extend(t,e,r),e.scalarBarActorHelper=ql.newScalarBarActorHelper(),yM(t,e)}var SM=Ue(TM,"vtkWebGPUScalarBarActor");jt("vtkScalarBarActor",SM);function CM(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=r,e.options.addressModeU=n.addressModeU?n.addressModeU:"clamp-to-edge",e.options.addressModeV=n.addressModeV?n.addressModeV:"clamp-to-edge",e.options.addressModeW=n.addressModeW?n.addressModeW:"clamp-to-edge",e.options.magFilter=n.magFilter?n.magFilter:"nearest",e.options.minFilter=n.minFilter?n.minFilter:"nearest",e.options.mipmapFilter=n.mipmapFilter?n.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=function(r,n){var a="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": sampler;");return a},t.getBindGroupEntry=function(){var r={resource:e.handle};return r}}var EM={device:null,handle:null,label:null,options:null};function hp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,EM,r),L.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),L.get(t,e,["bindGroupTime","handle","options"]),L.setGet(t,e,["bindGroupLayoutEntry","device","label"]),CM(t,e)}var wM=L.newInstance(hp),xM={newInstance:wM,extend:hp};function OM(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=function(r,n){e.texture=r,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=ot.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=a.sampleType},t.createFromTextureHandle=function(r,n){e.texture=null,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=ot.getDetailsFromTextureFormat(n.format);e.bindGroupLayoutEntry.texture.sampleType=a.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=function(){var r={resource:t.getHandle()};return r},t.getShaderCode=function(r,n){var a="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?a="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(a="u32");var i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_").concat(e.options.dimension,"<").concat(a,">;");return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_depth_").concat(e.options.dimension,";")),i},t.addSampler=function(r,n){var a=xM.newInstance({label:"".concat(e.label,"Sampler")});a.create(r,n),t.setSampler(a)},t.getBindGroupTime=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime},t.getHandle=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle}}var MM={texture:null,handle:null,sampler:null,label:null};function yp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MM,r),L.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),L.get(t,e,["bindGroupTime","texture"]),L.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),OM(t,e)}var DM=L.newInstance(yp),mM={newInstance:DM,extend:yp},Bc=fr.BufferUsage;function RM(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=function(r,n){e.device=r,e.width=n.width,e.height=n.height,e.depth=n.depth?n.depth:1;var a=e.depth===1?"2d":"3d";e.format=n.format?n.format:"rgba8unorm",e.mipLevel=n.mipLevel?n.mipLevel:0,e.usage=n.usage?n.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:a,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=function(r,n,a){e.device=r,e.handle=n,e.width=a.width,e.height=a.height,e.depth=a.depth?a.depth:1,e.format=a.format?a.format:"rgba8unorm",e.usage=a.usage?a.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=function(r){var n=[];if(r.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:r.canvas,flipY:r.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}r.jsImageData&&!r.nativeArray&&(r.width=r.jsImageData.width,r.height=r.jsImageData.height,r.depth=1,r.format="rgba8unorm",r.flip=!0,r.nativeArray=r.jsImageData.data);var a=ot.getDetailsFromTextureFormat(e.format),i=e.width*a.stride,s=function(D,b,F){var U=D.length/(b*F)*D.BYTES_PER_ELEMENT,O=a.elementSize===2&&a.sampleType==="float";if(O||U%256){for(var A=D,W=U/A.BYTES_PER_ELEMENT,j=a.elementSize,N=256*Math.floor((W*j+255)/256),I=N/j,X=L.newTypedArray(O?"Uint16Array":A.constructor.name,I*b*F),J=0;J<b*F;J++)if(O)for(var P=0;P<W;P++)X[J*I+P]=zr.toHalf(A[J*W+P]);else X.set(A.subarray(J*W,(J+1)*W),J*I);return[X,N]}return[D,U]};if(r.nativeArray&&(n=r.nativeArray),r.image){var f=document.createElement("canvas");f.width=r.image.width,f.height=r.image.height;var o=f.getContext("2d");o.translate(0,f.height),o.scale(1,-1),o.drawImage(r.image,0,0,r.image.width,r.image.height,0,0,f.width,f.height);var u=o.getImageData(0,0,r.image.width,r.image.height);n=u.data}var g=e.device.createCommandEncoder();if(t.getDimensionality()!==3){for(var c=zi.generateMipmaps(n,e.width,e.height,e.mipLevel),l=e.width,h=e.height,y=0;y<=e.mipLevel;y++){var S=s(c[y],h,1);i=S[1];var T={dataArray:r.dataArray?r.dataArray:null,nativeArray:S[0],usage:Bc.Texture},E=e.device.getBufferManager().getBuffer(T);g.copyBufferToTexture({buffer:E.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:h},{texture:e.handle,mipLevel:y},[l,h,1]),l/=2,h/=2}e.device.submitCommandEncoder(g),e.ready=!0}else{var x=s(n,e.height,e.depth);i=x[1];var w={dataArray:r.dataArray?r.dataArray:null,usage:Bc.Texture};w.nativeArray=x[0];var C=e.device.getBufferManager().getBuffer(w);g.copyBufferToTexture({buffer:C.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(g),e.ready=!0}},t.getScale=function(){var r=ot.getDetailsFromTextureFormat(e.format),n=r.elementSize===2&&r.sampleType==="float";return n?1:255},t.getNumberOfComponents=function(){var r=ot.getDetailsFromTextureFormat(e.format);return r.numComponents},t.getDimensionality=function(){var r=0;return e.width>1&&r++,e.height>1&&r++,e.depth>1&&r++,r},t.resizeToMatch=function(r){(r.getWidth()!==e.width||r.getHeight()!==e.height||r.getDepth()!==e.depth)&&(e.width=r.getWidth(),e.height=r.getHeight(),e.depth=r.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(r!==e.width||n!==e.height||a!==e.depth)&&(e.width=r,e.height=n,e.depth=a,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n.dimension||(n.dimension=e.depth===1?"2d":"3d");var a=mM.newInstance({label:r});return a.create(t,n),a}}var LM={device:null,handle:null,buffer:null,ready:!1,label:null};function VM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LM,r),L.obj(t,e),L.get(t,e,["handle","ready","width","height","depth","format","usage"]),L.setGet(t,e,["device","label"]),RM(t,e)}L.newInstance(VM);function _M(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();var a=e.WebGPURenderer.getAspectRatio(),i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin(),f=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,f)}}var bM={};function kM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,bM,r),Ie.extend(t,e,r),_M(t,e)}var FM=L.newInstance(kM,"vtkWebGPUPixelSpaceCallbackMapper");jt("vtkPixelSpaceCallbackMapper",FM);var BM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkSphereMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Spheres

attribute vec4 vertexMC;
attribute vec2 offsetMC;

// optional normal declaration
//VTK::Normal::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying vec3 centerVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  // compute the projected vertex position
  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = length(offsetMC)*0.5;

  // make the triangle face the camera
  if (cameraParallel == 0)
    {
    vec3 dir = normalize(-vertexVCVSOutput.xyz);
    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));
    vec3 base1 = cross(base2,dir);
    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + offsetMC.x*base1 + offsetMC.y*base2;
    }
  else
    {
    // add in the offset
    vertexVCVSOutput.xy = vertexVCVSOutput.xy + offsetMC;
    }

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;function Nc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function NM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var UM=ge;function GM(t,e){e.classHierarchy.push("vtkOpenGLSphereMapper");var r=NM({},t);t.getShaderTemplate=function(n,a,i){n.Vertex=BM,n.Fragment=ef,n.Geometry=""},t.replaceShaderValues=function(n,a,i){var s=n.Vertex,f=n.Fragment;s=$.substitute(s,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,f=$.substitute(f,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,f=$.substitute(f,"//VTK::PositionVC::Impl",[`vec4 vertexVC = vertexVCVSOutput;
`]).result;var o=[`uniform float invertedDepth;
`,`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];f=$.substitute(f,"//VTK::Normal::Dec",o).result;var u="";e.context.getExtension("EXT_frag_depth")&&(u=`gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(u=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),f=$.substitute(f,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float b = 2.0*dot(EyePos,EyeDir);
`,`  float c = dot(EyePos,EyePos) - 1.0;
`,`  float d = b*b - 4.0*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t = (-b - invertedDepth*sqrt(d))*0.5;
`,`    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);
`,`    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,u]).result,f=$.substitute(f,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(f=$.substitute(f,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=s,n.Fragment=f,r.replaceShaderValues(n,a,i)},t.setMapperShaderParameters=function(n,a,i){n.getCABO().getElementCount()&&(e.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&n.getProgram().isAttributeUsed("offsetMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"offsetMC",12,n.getCABO().getStride(),e.context.FLOAT,2,!1)||UM("Error setting 'offsetMC' in shader VAO.")),n.getProgram().isUniformUsed("invertedDepth")&&n.getProgram().setUniformf("invertedDepth",e.invert?-1:1),r.setMapperShaderParameters(n,a,i)},t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=a.getActiveCamera(),o=e.openGLCamera.getKeyMatrices(a);if(s.isUniformUsed("VCPCMatrix")&&s.setUniformMatrix("VCPCMatrix",o.vcpc),s.isUniformUsed("MCVCMatrix"))if(i.getIsIdentity())s.setUniformMatrix("MCVCMatrix",o.wcvc);else{var u=e.openGLActor.getKeyMatrices(),g=new Float64Array(16);St(g,o.wcvc,u.mcwc),s.setUniformMatrix("MCVCMatrix",g)}s.isUniformUsed("cameraParallel")&&n.getProgram().setUniformi("cameraParallel",f.getParallelProjection())},t.getOpenGLMode=function(n,a){return e.context.TRIANGLES},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors(),f=e.primitives[e.primTypes.Tris].getCABO(),o=i.getPointData(),u=i.getPoints(),g=u.getNumberOfPoints(),c=u.getData(),l=5,h=null;e.renderable.getScaleArray()!=null&&o.hasArray(e.renderable.getScaleArray())&&(h=o.getArray(e.renderable.getScaleArray()).getData());var y=null,S=0,T=null;s?(S=s.getNumberOfComponents(),f.setColorOffset(0),f.setColorBOStride(4),y=s.getData(),T=new Uint8Array(3*g*4),f.getColorBO()||f.setColorBO(Wi.newInstance()),f.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow)):f.getColorBO()&&f.setColorBO(null),f.setColorComponents(S);var E=new Float32Array(l*g*3);f.setStride(l*4);for(var x=Math.cos(Ke(30)),w=0,C=0,m=0,D=0,b=0;b<g;++b){var F=e.renderable.getRadius();h&&(F=h[b]),w=b*3,E[m++]=c[w++],E[m++]=c[w++],E[m++]=c[w++],E[m++]=-2*F*x,E[m++]=-F,y&&(C=b*S,T[D++]=y[C],T[D++]=y[C+1],T[D++]=y[C+2],T[D++]=y[C+3]),w=b*3,E[m++]=c[w++],E[m++]=c[w++],E[m++]=c[w++],E[m++]=2*F*x,E[m++]=-F,y&&(T[D++]=y[C],T[D++]=y[C+1],T[D++]=y[C+2],T[D++]=y[C+3]),w=b*3,E[m++]=c[w++],E[m++]=c[w++],E[m++]=c[w++],E[m++]=0,E[m++]=2*F,y&&(T[D++]=y[C],T[D++]=y[C+1],T[D++]=y[C+2],T[D++]=y[C+3])}f.setElementCount(m/l),f.upload(E,sr.ARRAY_BUFFER),s&&f.getColorBO().upload(T,sr.ARRAY_BUFFER),e.VBOBuildTime.modified()}}}var AM={};function PM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AM,r),jl.extend(t,e,r),GM(t,e)}var zM=Ue(PM,"vtkOpenGLSphereMapper");Mt("vtkSphereMapper",zM);var WM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkStickMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Sticks

attribute vec4 vertexMC;
attribute vec3 orientMC;
attribute vec4 offsetMC;
attribute float radiusMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying float lengthVCVSOutput;
varying vec3 centerVCVSOutput;
varying vec3 orientVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = radiusMC;
  lengthVCVSOutput = length(orientMC);
  orientVCVSOutput = normalMatrix * normalize(orientMC);

  // make sure it is pointing out of the screen
  if (orientVCVSOutput.z < 0.0)
    {
    orientVCVSOutput = -orientVCVSOutput;
    }

  // make the basis
  vec3 xbase;
  vec3 ybase;
  vec3 dir = vec3(0.0,0.0,1.0);
  if (cameraParallel == 0)
    {
    dir = normalize(-vertexVCVSOutput.xyz);
    }
  if (abs(dot(dir,orientVCVSOutput)) == 1.0)
    {
    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));
    ybase = cross(xbase,orientVCVSOutput);
    }
  else
    {
    xbase = normalize(cross(orientVCVSOutput,dir));
    ybase = cross(orientVCVSOutput,xbase);
    }

  vec3 offsets = offsetMC.xyz*2.0-1.0;
  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +
    radiusVCVSOutput*offsets.x*xbase +
    radiusVCVSOutput*offsets.y*ybase +
    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;function Uc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Ja=ge;function $M(t,e){e.classHierarchy.push("vtkOpenGLStickMapper");var r=jM({},t);t.getShaderTemplate=function(n,a,i){n.Vertex=WM,n.Fragment=ef,n.Geometry=""},t.replaceShaderValues=function(n,a,i){var s=n.Vertex,f=n.Fragment;s=$.substitute(s,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,f=$.substitute(f,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,f=$.substitute(f,"//VTK::PositionVC::Impl",`  vec4 vertexVC = vertexVCVSOutput;
`).result;var o=[`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 orientVCVSOutput;
`,`varying float lengthVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];f=$.substitute(f,"//VTK::Normal::Dec",o).result;var u="";e.context.getExtension("EXT_frag_depth")&&(u=`  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(u=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),f=$.substitute(f,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  vec3 base1;
`,`  if (abs(orientVCVSOutput.z) < 0.99) {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }
`,`  else {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }
`,`  vec3 base2 = cross(orientVCVSOutput,base1);
`,`  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));
`,`  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
`,`  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
`,`  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
`,`  float d = b*b - 4.0*a*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t =  (-b - sqrt(d))/(2.0*a);
`,`    float tz = EyePos.z + t*EyeDir.z;
`,`    vec3 iPoint = EyePos + t*EyeDir;
`,`    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {
`,`      float t2 = (-b + sqrt(d))/(2.0*a);
`,`      float tz2 = EyePos.z + t2*EyeDir.z;
`,`      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }
`,`      else {
`,`        normalVCVSOutput = orientVCVSOutput;
`,`        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;
`,`        iPoint = EyePos + t3*EyeDir;
`,`        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`        }
`,`      }
`,`    else {
`,`      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;
`,`      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`      }
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,u]).result,f=$.substitute(f,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(f=$.substitute(f,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=s,n.Fragment=f,r.replaceShaderValues(n,a,i)},t.setMapperShaderParameters=function(n,a,i){n.getCABO().getElementCount()&&(e.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(n.getProgram().isAttributeUsed("orientMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"orientMC",12,n.getCABO().getStride(),e.context.FLOAT,3,!1)||Ja("Error setting 'orientMC' in shader VAO.")),n.getProgram().isAttributeUsed("offsetMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"offsetMC",0,n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,3,!0)||Ja("Error setting 'offsetMC' in shader VAO.")),n.getProgram().isAttributeUsed("radiusMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"radiusMC",24,n.getCABO().getStride(),e.context.FLOAT,1,!1)||Ja("Error setting 'radiusMC' in shader VAO."))),r.setMapperShaderParameters(n,a,i)},t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=a.getActiveCamera(),o=e.openGLCamera.getKeyMatrices(a);if(s.isUniformUsed("VCPCMatrix")&&s.setUniformMatrix("VCPCMatrix",o.vcpc),i.getIsIdentity())s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",o.wcvc),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",o.normalMatrix);else{var u=e.openGLActor.getKeyMatrices();if(s.isUniformUsed("MCVCMatrix")){var g=new Float64Array(16);St(g,o.wcvc,u.mcwc),s.setUniformMatrix("MCVCMatrix",g)}if(s.isUniformUsed("normalMatrix")){var c=new Float64Array(9);Ro(c,o.normalMatrix,u.normalMatrix),s.setUniformMatrix3x3("normalMatrix",c)}}s.isUniformUsed("cameraParallel")&&n.getProgram().setUniformi("cameraParallel",f.getParallelProjection())},t.getOpenGLMode=function(n,a){return e.context.TRIANGLES},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors(),f=e.primitives[e.primTypes.Tris].getCABO(),o=i.getPointData(),u=i.getPoints(),g=u.getNumberOfPoints(),c=u.getData(),l=3;l+=4;var h=null,y=0;f.setColorBOStride(4),f.getColorBO()||f.setColorBO(Wi.newInstance()),f.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow),s&&(y=s.getNumberOfComponents(),f.setColorOffset(4),h=s.getData(),f.setColorBOStride(8)),f.setColorComponents(y),f.setStride(l*4);var S=new Float32Array(l*g*12),T=new Uint8Array(12*g*(h?8:4)),E=null,x=null;e.renderable.getScaleArray()!=null&&o.hasArray(e.renderable.getScaleArray())&&(E=o.getArray(e.renderable.getScaleArray()).getData()),e.renderable.getOrientationArray()!=null&&o.hasArray(e.renderable.getOrientationArray())?x=o.getArray(e.renderable.getOrientationArray()).getData():Ja([`Error setting orientationArray.
`,"You have to specify the stick orientation"]);for(var w=[0,1,3,0,3,2,2,3,5,2,5,4],C=0,m=0,D=0,b=0,F=0;F<g;++F){var U=e.renderable.getLength(),O=e.renderable.getRadius();E&&(U=E[F*2],O=E[F*2+1]);for(var A=0;A<w.length;++A)C=F*3,S[D++]=c[C++],S[D++]=c[C++],S[D++]=c[C++],C=F*3,S[D++]=x[C++]*U,S[D++]=x[C++]*U,S[D++]=x[C++]*U,S[D++]=O,T[b++]=255*(w[A]%2),T[b++]=w[A]>=4?255:0,T[b++]=w[A]>=2?255:0,T[b++]=255,m=F*y,h&&(T[b++]=h[m],T[b++]=h[m+1],T[b++]=h[m+2],T[b++]=h[m+3])}f.setElementCount(D/l),f.upload(S,sr.ARRAY_BUFFER),f.getColorBO().upload(T,sr.ARRAY_BUFFER),e.VBOBuildTime.modified()}}}var HM={};function KM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HM,r),jl.extend(t,e,r),$M(t,e)}var XM=Ue(KM,"vtkOpenGLStickMapper");Mt("vtkStickMapper",XM);var zs=fr.BufferUsage,YM=ge,IM=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::Color::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertexVC: vec4<f32> = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);

  //VTK::Color::Impl

  // compute the projected vertex position
  output.centerVC = vertexVC.xyz;
  output.radiusVC = length(offsetMC)*0.5;

  // make the triangle face the camera
  if (rendererUBO.cameraParallel == 0u)
    {
    var dir: vec3<f32> = normalize(-vertexVC.xyz);
    var base2: vec3<f32> = normalize(cross(dir,vec3<f32>(1.0,0.0,0.0)));
    var base1: vec3<f32> = cross(base2,dir);
    dir = vertexVC.xyz + offsetMC.x*base1 + offsetMC.y*base2;
    vertexVC = vec4<f32>(dir, 1.0);
    }
  else
    {
    // add in the offset
    var tmp2: vec2<f32> = vertexVC.xy + offsetMC;
    vertexVC = vec4<f32>(tmp2, vertexVC.zw);
    }

  output.vertexVC = vec4<f32>(vertexVC.xyz, 0.0);

  //VTK::Position::Impl

  return output;
}
`;function qM(t,e){e.classHierarchy.push("vtkWebGPUSphereMapper");var r=t.buildPass;t.buildPass=function(n){if(n){e.renderable.getStatic()||e.renderable.update();var a=e.renderable.getInputData();t.setCellArray(a.getVerts()),t.setCurrentInput(a)}r(n)},t.replaceShaderNormal=function(n,a,i){var s=a.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC"),s.addOutput("vec3<f32>","centerVC"),s.addOutput("f32","radiusVC");var f=a.getShaderDescription("fragment");f.addBuiltinOutput("f32","@builtin(frag_depth) fragDepth");var o=`
    // compute the eye position and unit direction
    var vertexVC: vec4<f32>;
    var EyePos: vec3<f32>;
    var EyeDir: vec3<f32>;
    var invertedDepth: f32 = 1.0;
    if (rendererUBO.cameraParallel != 0u) {
      EyePos = vec3<f32>(input.vertexVC.x, input.vertexVC.y, input.vertexVC.z + 3.0*input.radiusVC);
      EyeDir = vec3<f32>(0.0, 0.0, -1.0);
    }
    else {
      EyeDir = input.vertexVC.xyz;
      EyePos = vec3<f32>(0.0,0.0,0.0);
      var lengthED: f32 = length(EyeDir);
      EyeDir = normalize(EyeDir);
      // we adjust the EyePos to be closer if it is too far away
      // to prevent floating point precision noise
      if (lengthED > input.radiusVC*3.0) {
        EyePos = input.vertexVC.xyz - EyeDir*3.0*input.radiusVC;
      }
    }

    // translate to Sphere center
    EyePos = EyePos - input.centerVC;
    // scale to radius 1.0
    EyePos = EyePos * (1.0 / input.radiusVC);
    // find the intersection
    var b: f32 = 2.0*dot(EyePos,EyeDir);
    var c: f32 = dot(EyePos,EyePos) - 1.0;
    var d: f32 = b*b - 4.0*c;
    var normal: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
    if (d < 0.0) { discard; }
    else {
      var t: f32 = (-b - invertedDepth*sqrt(d))*0.5;

      // compute the normal, for unit sphere this is just
      // the intersection point
      normal = invertedDepth*normalize(EyePos + t*EyeDir);
      // compute the intersection point in VC
      vertexVC = vec4<f32>(normal * input.radiusVC + input.centerVC, 1.0);
    }
    // compute the pixel's depth
    var pos: vec4<f32> = rendererUBO.VCPCMatrix * vertexVC;
    output.fragDepth = pos.z / pos.w;
    `,u=f.getCode();u=ke.substitute(u,"//VTK::Normal::Impl",[o]).result,f.setCode(u)},t.replaceShaderPosition=function(n,a,i){var s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var f=s.getCode();f=ke.substitute(f,"//VTK::Position::Impl",["  output.Position = rendererUBO.VCPCMatrix*vertexVC;"]).result,s.setCode(f)},t.computePipelineHash=function(){e.pipelineHash="spm",e.vertexInput.hasAttribute("colorVI")&&(e.pipelineHash+="c"),e.pipelineHash+=e.renderEncoder.getPipelineHash()},t.updateBuffers=function(){var n=e.currentInput;e.renderable.mapScalars(n,1);var a=n.getPoints(),i=a.getNumberOfPoints(),s=a.getData();t.setNumberOfInstances(1),t.setNumberOfVertices(3*i);var f=e.vertexInput,o="spm".concat(a.getMTime(),"float32x3");if(!e.device.getBufferManager().hasBuffer(o)){for(var u={hash:o,usage:zs.RawVertex,format:"float32x3"},g=new Float32Array(3*i*3),c=0,l=0,h=0;h<i;++h)c=h*3,g[l++]=s[c],g[l++]=s[c+1],g[l++]=s[c+2],g[l++]=s[c],g[l++]=s[c+1],g[l++]=s[c+2],g[l++]=s[c],g[l++]=s[c+1],g[l++]=s[c+2];u.nativeArray=g;var y=e.device.getBufferManager().getBuffer(u);f.addBuffer(y,["vertexBC"])}var S=n.getPointData(),T=null;e.renderable.getScaleArray()!=null&&S.hasArray(e.renderable.getScaleArray())&&(T=S.getArray(e.renderable.getScaleArray()).getData());var E=e.renderable.getRadius();if(T||E!==e._lastRadius){if(o="spm".concat(T?S.getArray(e.renderable.getScaleArray()).getMTime():E,"float32x2"),!e.device.getBufferManager().hasBuffer(o)){for(var x={hash:o,usage:zs.RawVertex,format:"float32x2"},w=new Float32Array(3*i*2),C=Math.cos(Ke(30)),m=0,D=0;D<i;++D){var b=e.renderable.getRadius();T&&(b=T[D]),w[m++]=-2*b*C,w[m++]=-b,w[m++]=2*b*C,w[m++]=-b,w[m++]=0,w[m++]=2*b}x.nativeArray=w;var F=e.device.getBufferManager().getBuffer(x);f.addBuffer(F,["offsetMC"])}e._lastRadius=E}var U=!1;if(e.renderable.getScalarVisibility()){var O=e.renderable.getColorMapColors();if(O){if(o="spm".concat(O.getMTime(),"unorm8x4"),!e.device.getBufferManager().hasBuffer(o)){var A={hash:o,usage:zs.RawVertex,format:"unorm8x4"},W=O.getNumberOfComponents();W!==4&&YM("this should be 4");for(var j=new Uint8Array(3*i*4),N=0,I=O.getData(),X=0;X<i;++X)for(var J=X*W,P=0;P<3;P++)j[N++]=I[J],j[N++]=I[J+1],j[N++]=I[J+2],j[N++]=I[J+3];A.nativeArray=j;var G=e.device.getBufferManager().getBuffer(A);f.addBuffer(G,["colorVI"])}U=!0}}U||f.removeBufferIfPresent("colorVI"),t.setTopology("triangle-list"),t.updateUBO()}}var ZM={};function QM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZM,r),ji.extend(t,e,r),t.setVertexShaderTemplate(IM),qM(t,e);var n=e.shaderReplacements;n.set("replaceShaderPosition",t.replaceShaderPosition),n.set("replaceShaderNormal",t.replaceShaderNormal)}var JM=Ue(QM,"vtkWebGPUSphereMapper");jt("vtkSphereMapper",JM);var ei=fr.BufferUsage,Gc=ge,eD=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::Color::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var offsetsArray: array<vec3<f32>, 12> = array<vec3<f32>, 12>(
    vec3<f32>(-1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, 1.0),

    vec3<f32>(-1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, 1.0),
    vec3<f32>(-1.0, -1.0, 1.0),

    vec3<f32>(-1.0, -1.0, 1.0),
    vec3<f32>(1.0, -1.0, 1.0),
    vec3<f32>(1.0, 1.0, 1.0),

    vec3<f32>(-1.0, -1.0, 1.0),
    vec3<f32>(1.0, 1.0, 1.0),
    vec3<f32>(-1.0, 1.0, 1.0)
  );

  var output : vertexOutput;

  var vertexVC: vec4<f32> = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);

  //VTK::Color::Impl

  // compute the projected vertex position
  output.centerVC = vertexVC.xyz;
  output.radiusVC = radiusMC;
  output.lengthVC = length(orientMC);
  output.orientVC = (rendererUBO.WCVCNormals * vec4<f32>(normalize(orientMC), 0.0)).xyz;

  // make sure it is pointing out of the screen
  if (output.orientVC.z < 0.0)
    {
    output.orientVC = -output.orientVC;
    }

  // make the basis
  var xbase: vec3<f32>;
  var ybase: vec3<f32>;
  var dir: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
  if (rendererUBO.cameraParallel == 0u)
    {
    dir = normalize(-vertexVC.xyz);
    }
  if (abs(dot(dir,output.orientVC)) == 1.0)
    {
    xbase = normalize(cross(vec3<f32>(0.0,1.0,0.0),output.orientVC));
    ybase = cross(xbase,output.orientVC);
    }
  else
    {
    xbase = normalize(cross(output.orientVC,dir));
    ybase = cross(output.orientVC,xbase);
    }


  var vertIdx: u32 = input.vertexIndex % 12u;
  var offsets: vec3<f32> = offsetsArray[vertIdx];

  vertexVC = vec4<f32>(vertexVC.xyz +
    output.radiusVC * offsets.x * xbase +
    output.radiusVC * offsets.y * ybase +
    0.5 * output.lengthVC * offsets.z * output.orientVC, 1.0);

  output.vertexVC = vertexVC;

  //VTK::Position::Impl

  return output;
}
`;function tD(t,e){e.classHierarchy.push("vtkWebGPUStickMapper");var r=t.buildPass;t.buildPass=function(n){if(n){e.renderable.getStatic()||e.renderable.update();var a=e.renderable.getInputData();t.setCellArray(a.getVerts()),t.setCurrentInput(a)}r(n)},t.replaceShaderNormal=function(n,a,i){var s=a.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC"),s.addOutput("vec3<f32>","centerVC"),s.addOutput("vec3<f32>","orientVC"),s.addOutput("f32","radiusVC"),s.addOutput("f32","lengthVC"),s.addBuiltinInput("u32","@builtin(vertex_index) vertexIndex");var f=a.getShaderDescription("fragment");f.addBuiltinOutput("f32","@builtin(frag_depth) fragDepth");var o=`
    // compute the eye position and unit direction
    var vertexVC: vec4<f32>;
    var EyePos: vec3<f32>;
    var EyeDir: vec3<f32>;

    if (rendererUBO.cameraParallel != 0u)
    {
      EyePos = vec3<f32>(input.vertexVC.x, input.vertexVC.y, input.vertexVC.z + 3.0*input.radiusVC);
      EyeDir = vec3<f32>(0.0, 0.0, -1.0);
    }
    else
    {
      EyeDir = input.vertexVC.xyz;
      EyePos = vec3<f32>(0.0,0.0,0.0);
      var lengthED: f32 = length(EyeDir);
      EyeDir = normalize(EyeDir);
      // we adjust the EyePos to be closer if it is too far away
      // to prevent floating point precision noise
      if (lengthED > input.radiusVC*3.0)
      {
        EyePos = input.vertexVC.xyz - EyeDir*3.0*input.radiusVC;
      }
    }
    // translate to Sphere center
    EyePos = EyePos - input.centerVC;

    // rotate to new basis
    // base1, base2, orientVC
    var base1: vec3<f32>;
    if (abs(input.orientVC.z) < 0.99)
    {
      base1 = normalize(cross(input.orientVC,vec3<f32>(0.0,0.0,1.0)));
    }
    else
    {
      base1 = normalize(cross(input.orientVC,vec3<f32>(0.0,1.0,0.0)));
    }
    var base2: vec3<f32> = cross(input.orientVC,base1);
    EyePos = vec3<f32>(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,input.orientVC));
    EyeDir = vec3<f32>(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,input.orientVC));

    // scale to radius 1.0
    EyePos = EyePos * (1.0 / input.radiusVC);

    // find the intersection
    var a: f32 = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
    var b: f32 = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
    var c: f32 = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
    var d: f32 = b*b - 4.0*a*c;
    var normal: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
    if (d < 0.0) { discard; }
    else
    {
      var t: f32 = (-b - sqrt(d))*(0.5 / a);
      var tz: f32 = EyePos.z + t*EyeDir.z;
      var iPoint: vec3<f32> = EyePos + t*EyeDir;
      if (abs(iPoint.z)*input.radiusVC > input.lengthVC*0.5)
      {
        // test for end cap
        var t2: f32 = (-b + sqrt(d))*(0.5 / a);
        var tz2: f32 = EyePos.z + t2*EyeDir.z;
        if (tz2*input.radiusVC > input.lengthVC*0.5 || tz*input.radiusVC < -0.5*input.lengthVC) { discard; }
        else
        {
          normal = input.orientVC;
          var t3: f32 = (input.lengthVC*0.5/input.radiusVC - EyePos.z)/EyeDir.z;
          iPoint = EyePos + t3*EyeDir;
          vertexVC = vec4<f32>(input.radiusVC*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*input.orientVC) + input.centerVC, 1.0);
        }
      }
      else
      {
        // The normal is the iPoint.xy rotated back into VC
        normal = iPoint.x*base1 + iPoint.y*base2;
        // rescale rerotate and translate
        vertexVC = vec4<f32>(input.radiusVC*(normal + iPoint.z*input.orientVC) + input.centerVC, 1.0);
      }
    }
    // compute the pixel's depth
    var pos: vec4<f32> = rendererUBO.VCPCMatrix * vertexVC;
    output.fragDepth = pos.z / pos.w;
  `,u=f.getCode();u=ke.substitute(u,"//VTK::Normal::Impl",[o]).result,f.setCode(u)},t.replaceShaderPosition=function(n,a,i){var s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var f=s.getCode();f=ke.substitute(f,"//VTK::Position::Impl",["  output.Position = rendererUBO.VCPCMatrix*vertexVC;"]).result,s.setCode(f)},t.computePipelineHash=function(){e.pipelineHash="stm",e.vertexInput.hasAttribute("colorVI")&&(e.pipelineHash+="c"),e.pipelineHash+=e.renderEncoder.getPipelineHash()},t.updateBuffers=function(){var n=e.currentInput;e.renderable.mapScalars(n,1);var a=e.device,i=n.getPoints(),s=n.getPointData(),f=i.getNumberOfPoints(),o=i.getData();t.setNumberOfInstances(f),t.setNumberOfVertices(12);var u=e.vertexInput,g="stm".concat(i.getMTime(),"float32x3");if(!a.getBufferManager().hasBuffer(g)){for(var c={hash:g,usage:ei.RawVertex,format:"float32x3"},l=new Float32Array(f*3),h=0,y=0,S=0;S<f;++S)h=S*3,l[y++]=o[h],l[y++]=o[h+1],l[y++]=o[h+2];c.nativeArray=l;var T=a.getBufferManager().getBuffer(c);u.addBuffer(T,["vertexBC"],"instance")}var E=null;e.renderable.getScaleArray()!=null&&s.hasArray(e.renderable.getScaleArray())&&(E=s.getArray(e.renderable.getScaleArray()).getData());var x=e.renderable.getRadius();if(E||x!==e._lastRadius){if(g="stm".concat(E?s.getArray(e.renderable.getScaleArray()).getMTime():x,"float32"),!a.getBufferManager().hasBuffer(g)){for(var w={hash:g,usage:ei.RawVertex,format:"float32"},C=new Float32Array(f),m=0,D=0;D<f;++D){var b=e.renderable.getRadius();E&&(b=E[D*2+1]),C[m++]=b}w.nativeArray=C;var F=a.getBufferManager().getBuffer(w);u.addBuffer(F,["radiusMC"],"instance")}e._lastRadius=x}var U=null;if(e.renderable.getOrientationArray()!=null&&s.hasArray(e.renderable.getOrientationArray())?U=s.getArray(e.renderable.getOrientationArray()).getData():Gc([`Error setting orientationArray.
`,"You have to specify the stick orientation"]),g="stm".concat(s.getArray(e.renderable.getOrientationArray()).getMTime(),"float32x3"),!a.getBufferManager().hasBuffer(g)){for(var O={hash:g,usage:ei.RawVertex,format:"float32x3"},A=new Float32Array(f*3),W=0,j=0,N=0;N<f;++N){W=N*3;var I=e.renderable.getLength();E&&(I=E[N*2]),A[j++]=U[W]*I,A[j++]=U[W+1]*I,A[j++]=U[W+2]*I}O.nativeArray=A;var X=a.getBufferManager().getBuffer(O);u.addBuffer(X,["orientMC"],"instance")}var J=!1;if(e.renderable.getScalarVisibility()){var P=e.renderable.getColorMapColors();if(P){if(g="stm".concat(P.getMTime(),"unorm8x4"),!a.getBufferManager().hasBuffer(g)){var G={usage:ei.RawVertex,format:"unorm8x4"},K=P.getNumberOfComponents();K!==4&&Gc("this should be 4");for(var te=new Uint8Array(f*4),ee=0,fe=P.getData(),ve=0;ve<f;++ve){var ce=ve*K;te[ee++]=fe[ce],te[ee++]=fe[ce+1],te[ee++]=fe[ce+2],te[ee++]=fe[ce+3]}G.nativeArray=te;var pe=a.getBufferManager().getBuffer(G);u.addBuffer(pe,["colorVI"],"instance")}J=!0}}J||u.removeBufferIfPresent("colorVI"),t.setTopology("triangle-list"),t.updateUBO()}}var rD={};function nD(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rD,r),ji.extend(t,e,r),t.setVertexShaderTemplate(eD),tD(t,e);var n=e.shaderReplacements;n.set("replaceShaderPosition",t.replaceShaderPosition),n.set("replaceShaderNormal",t.replaceShaderNormal)}var aD=Ue(nD,"vtkWebGPUStickMapper");jt("vtkStickMapper",aD);function _i(){}function dp(t){return t()}function Ac(){return Object.create(null)}function $i(t){t.forEach(dp)}function iD(t){return typeof t=="function"}function sD(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function oD(t){return Object.keys(t).length===0}function jn(t,e){t.appendChild(e)}function fD(t,e,r){t.insertBefore(e,r||null)}function Tp(t){t.parentNode.removeChild(t)}function ti(t){return document.createElement(t)}function Sp(t){return document.createTextNode(t)}function uD(){return Sp(" ")}function gn(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function cD(t){return Array.from(t.childNodes)}function gD(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let pa;function aa(t){pa=t}function vD(){if(!pa)throw new Error("Function called outside component initialization");return pa}function lD(t){vD().$$.on_mount.push(t)}const Zn=[],wo=[],pi=[],Pc=[],pD=Promise.resolve();let xo=!1;function hD(){xo||(xo=!0,pD.then(Cp))}function Oo(t){pi.push(t)}const Ws=new Set;let ri=0;function Cp(){const t=pa;do{for(;ri<Zn.length;){const e=Zn[ri];ri++,aa(e),yD(e.$$)}for(aa(null),Zn.length=0,ri=0;wo.length;)wo.pop()();for(let e=0;e<pi.length;e+=1){const r=pi[e];Ws.has(r)||(Ws.add(r),r())}pi.length=0}while(Zn.length);for(;Pc.length;)Pc.pop()();xo=!1,Ws.clear(),aa(t)}function yD(t){if(t.fragment!==null){t.update(),$i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Oo)}}const dD=new Set;function TD(t,e){t&&t.i&&(dD.delete(t),t.i(e))}function SD(t,e,r,n){const{fragment:a,on_mount:i,on_destroy:s,after_update:f}=t.$$;a&&a.m(e,r),n||Oo(()=>{const o=i.map(dp).filter(iD);s?s.push(...o):$i(o),t.$$.on_mount=[]}),f.forEach(Oo)}function CD(t,e){const r=t.$$;r.fragment!==null&&($i(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function ED(t,e){t.$$.dirty[0]===-1&&(Zn.push(t),hD(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function wD(t,e,r,n,a,i,s,f=[-1]){const o=pa;aa(t);const u=t.$$={fragment:null,ctx:null,props:i,update:_i,not_equal:a,bound:Ac(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:Ac(),dirty:f,skip_bound:!1,root:e.target||o.$$.root};s&&s(u.root);let g=!1;if(u.ctx=r?r(t,e.props||{},(c,l,...h)=>{const y=h.length?h[0]:l;return u.ctx&&a(u.ctx[c],u.ctx[c]=y)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](y),g&&ED(t,c)),l}):[],u.update(),g=!0,$i(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const c=cD(e.target);u.fragment&&u.fragment.l(c),c.forEach(Tp)}else u.fragment&&u.fragment.c();e.intro&&TD(t.$$.fragment),SD(t,e.target,e.anchor,e.customElement),Cp()}aa(o)}class xD{$destroy(){CD(this,1),this.$destroy=_i}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const a=n.indexOf(r);a!==-1&&n.splice(a,1)}}$set(e){this.$$set&&!oD(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function zc(t,e,r,n,a,i,s){try{var f=t[i](s),o=f.value}catch(u){r(u);return}f.done?e(o):Promise.resolve(o).then(n,a)}function wn(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function s(o){zc(i,n,a,s,f,"next",o)}function f(o){zc(i,n,a,s,f,"throw",o)}s(void 0)})}}var Ep={exports:{}},wp={exports:{}};(function(t){var e=function(r){var n=Object.prototype,a=n.hasOwnProperty,i,s=typeof Symbol=="function"?Symbol:{},f=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function g(P,G,K){return Object.defineProperty(P,G,{value:K,enumerable:!0,configurable:!0,writable:!0}),P[G]}try{g({},"")}catch{g=function(G,K,te){return G[K]=te}}function c(P,G,K,te){var ee=G&&G.prototype instanceof x?G:x,fe=Object.create(ee.prototype),ve=new I(te||[]);return fe._invoke=A(P,K,ve),fe}r.wrap=c;function l(P,G,K){try{return{type:"normal",arg:P.call(G,K)}}catch(te){return{type:"throw",arg:te}}}var h="suspendedStart",y="suspendedYield",S="executing",T="completed",E={};function x(){}function w(){}function C(){}var m={};g(m,f,function(){return this});var D=Object.getPrototypeOf,b=D&&D(D(X([])));b&&b!==n&&a.call(b,f)&&(m=b);var F=C.prototype=x.prototype=Object.create(m);w.prototype=C,g(F,"constructor",C),g(C,"constructor",w),w.displayName=g(C,u,"GeneratorFunction");function U(P){["next","throw","return"].forEach(function(G){g(P,G,function(K){return this._invoke(G,K)})})}r.isGeneratorFunction=function(P){var G=typeof P=="function"&&P.constructor;return G?G===w||(G.displayName||G.name)==="GeneratorFunction":!1},r.mark=function(P){return Object.setPrototypeOf?Object.setPrototypeOf(P,C):(P.__proto__=C,g(P,u,"GeneratorFunction")),P.prototype=Object.create(F),P},r.awrap=function(P){return{__await:P}};function O(P,G){function K(fe,ve,ce,pe){var Re=l(P[fe],P,ve);if(Re.type==="throw")pe(Re.arg);else{var qe=Re.arg,He=qe.value;return He&&typeof He=="object"&&a.call(He,"__await")?G.resolve(He.__await).then(function(We){K("next",We,ce,pe)},function(We){K("throw",We,ce,pe)}):G.resolve(He).then(function(We){qe.value=We,ce(qe)},function(We){return K("throw",We,ce,pe)})}}var te;function ee(fe,ve){function ce(){return new G(function(pe,Re){K(fe,ve,pe,Re)})}return te=te?te.then(ce,ce):ce()}this._invoke=ee}U(O.prototype),g(O.prototype,o,function(){return this}),r.AsyncIterator=O,r.async=function(P,G,K,te,ee){ee===void 0&&(ee=Promise);var fe=new O(c(P,G,K,te),ee);return r.isGeneratorFunction(G)?fe:fe.next().then(function(ve){return ve.done?ve.value:fe.next()})};function A(P,G,K){var te=h;return function(fe,ve){if(te===S)throw new Error("Generator is already running");if(te===T){if(fe==="throw")throw ve;return J()}for(K.method=fe,K.arg=ve;;){var ce=K.delegate;if(ce){var pe=W(ce,K);if(pe){if(pe===E)continue;return pe}}if(K.method==="next")K.sent=K._sent=K.arg;else if(K.method==="throw"){if(te===h)throw te=T,K.arg;K.dispatchException(K.arg)}else K.method==="return"&&K.abrupt("return",K.arg);te=S;var Re=l(P,G,K);if(Re.type==="normal"){if(te=K.done?T:y,Re.arg===E)continue;return{value:Re.arg,done:K.done}}else Re.type==="throw"&&(te=T,K.method="throw",K.arg=Re.arg)}}}function W(P,G){var K=P.iterator[G.method];if(K===i){if(G.delegate=null,G.method==="throw"){if(P.iterator.return&&(G.method="return",G.arg=i,W(P,G),G.method==="throw"))return E;G.method="throw",G.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var te=l(K,P.iterator,G.arg);if(te.type==="throw")return G.method="throw",G.arg=te.arg,G.delegate=null,E;var ee=te.arg;if(!ee)return G.method="throw",G.arg=new TypeError("iterator result is not an object"),G.delegate=null,E;if(ee.done)G[P.resultName]=ee.value,G.next=P.nextLoc,G.method!=="return"&&(G.method="next",G.arg=i);else return ee;return G.delegate=null,E}U(F),g(F,u,"Generator"),g(F,f,function(){return this}),g(F,"toString",function(){return"[object Generator]"});function j(P){var G={tryLoc:P[0]};1 in P&&(G.catchLoc=P[1]),2 in P&&(G.finallyLoc=P[2],G.afterLoc=P[3]),this.tryEntries.push(G)}function N(P){var G=P.completion||{};G.type="normal",delete G.arg,P.completion=G}function I(P){this.tryEntries=[{tryLoc:"root"}],P.forEach(j,this),this.reset(!0)}r.keys=function(P){var G=[];for(var K in P)G.push(K);return G.reverse(),function te(){for(;G.length;){var ee=G.pop();if(ee in P)return te.value=ee,te.done=!1,te}return te.done=!0,te}};function X(P){if(P){var G=P[f];if(G)return G.call(P);if(typeof P.next=="function")return P;if(!isNaN(P.length)){var K=-1,te=function ee(){for(;++K<P.length;)if(a.call(P,K))return ee.value=P[K],ee.done=!1,ee;return ee.value=i,ee.done=!0,ee};return te.next=te}}return{next:J}}r.values=X;function J(){return{value:i,done:!0}}return I.prototype={constructor:I,reset:function(P){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(N),!P)for(var G in this)G.charAt(0)==="t"&&a.call(this,G)&&!isNaN(+G.slice(1))&&(this[G]=i)},stop:function(){this.done=!0;var P=this.tryEntries[0],G=P.completion;if(G.type==="throw")throw G.arg;return this.rval},dispatchException:function(P){if(this.done)throw P;var G=this;function K(pe,Re){return fe.type="throw",fe.arg=P,G.next=pe,Re&&(G.method="next",G.arg=i),!!Re}for(var te=this.tryEntries.length-1;te>=0;--te){var ee=this.tryEntries[te],fe=ee.completion;if(ee.tryLoc==="root")return K("end");if(ee.tryLoc<=this.prev){var ve=a.call(ee,"catchLoc"),ce=a.call(ee,"finallyLoc");if(ve&&ce){if(this.prev<ee.catchLoc)return K(ee.catchLoc,!0);if(this.prev<ee.finallyLoc)return K(ee.finallyLoc)}else if(ve){if(this.prev<ee.catchLoc)return K(ee.catchLoc,!0)}else if(ce){if(this.prev<ee.finallyLoc)return K(ee.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(P,G){for(var K=this.tryEntries.length-1;K>=0;--K){var te=this.tryEntries[K];if(te.tryLoc<=this.prev&&a.call(te,"finallyLoc")&&this.prev<te.finallyLoc){var ee=te;break}}ee&&(P==="break"||P==="continue")&&ee.tryLoc<=G&&G<=ee.finallyLoc&&(ee=null);var fe=ee?ee.completion:{};return fe.type=P,fe.arg=G,ee?(this.method="next",this.next=ee.finallyLoc,E):this.complete(fe)},complete:function(P,G){if(P.type==="throw")throw P.arg;return P.type==="break"||P.type==="continue"?this.next=P.arg:P.type==="return"?(this.rval=this.arg=P.arg,this.method="return",this.next="end"):P.type==="normal"&&G&&(this.next=G),E},finish:function(P){for(var G=this.tryEntries.length-1;G>=0;--G){var K=this.tryEntries[G];if(K.finallyLoc===P)return this.complete(K.completion,K.afterLoc),N(K),E}},catch:function(P){for(var G=this.tryEntries.length-1;G>=0;--G){var K=this.tryEntries[G];if(K.tryLoc===P){var te=K.completion;if(te.type==="throw"){var ee=te.arg;N(K)}return ee}}throw new Error("illegal catch attempt")},delegateYield:function(P,G,K){return this.delegate={iterator:X(P),resultName:G,nextLoc:K},this.method==="next"&&(this.arg=i),E}},r}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(wp);(function(t){t.exports=wp.exports})(Ep);const Lt=Cd(Ep.exports);var OD=navigator.gpu?"WebGPU":"WebGL",bi=Object.create(null);function xp(t,e){bi[t]=e}function MD(){return Object.keys(bi)}function Op(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return bi[t]&&bi[t](e)}function DD(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=function(r){t.hasRenderer(r)||(r.setRenderWindow(t),e.renderers.push(r),t.modified())},t.removeRenderer=function(r){e.renderers=e.renderers.filter(function(n){return n!==r}),t.modified()},t.hasRenderer=function(r){return e.renderers.indexOf(r)!==-1},t.newAPISpecificView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Op(r||e.defaultViewAPI,n)},t.addView=function(r){t.hasView(r)||(r.setRenderable(t),e.views.push(r),t.modified())},t.removeView=function(r){e.views=e.views.filter(function(n){return n!==r}),t.modified()},t.hasView=function(r){return e.views.indexOf(r)!==-1},t.preRender=function(){e.renderers.forEach(function(r){r.isActiveCameraCreated()||r.resetCamera()})},t.render=function(){t.preRender(),e.interactor?e.interactor.render():e.views.forEach(function(r){return r.traverseAllPasses()})},t.getStatistics=function(){var r={propCount:0,invisiblePropCount:0};return e.renderers.forEach(function(n){var a=n.getViewProps();a.forEach(function(i){if(i.getVisibility()){r.propCount+=1;var s=i.getMapper&&i.getMapper();if(s&&s.getPrimitiveCount){var f=s.getPrimitiveCount();Object.keys(f).forEach(function(o){r[o]||(r[o]=0),r[o]+=f[o]})}}else r.invisiblePropCount+=1})}),r.str=Object.keys(r).map(function(n){return"".concat(n,": ").concat(r[n])}).join(`
`),r},t.captureImages=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return L.setImmediate(t.render),e.views.map(function(a){return a.captureNextImage?a.captureNextImage(r,n):void 0}).filter(function(a){return!!a})}}var mD={defaultViewAPI:OD,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1};function Mp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mD,r),L.obj(t,e),L.setGet(t,e,["interactor","numberOfLayers","views","defaultViewAPI"]),L.get(t,e,["neverRendered"]),L.getArray(t,e,["renderers"]),L.event(t,e,"completion"),DD(t,e)}var RD=L.newInstance(Mp,"vtkRenderWindow"),LD={newInstance:RD,extend:Mp,registerViewConstructor:xp,listViewAPIs:MD,newAPISpecificView:Op};function VD(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=function(){return e.context.FRAMEBUFFER},t.saveCurrentBindingsAndBuffers=function(r){var n=typeof r<"u"?r:t.getBothMode();t.saveCurrentBindings(n),t.saveCurrentBuffers(n)},t.saveCurrentBindings=function(r){if(!e.context){ge("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}var n=e.context;e.previousDrawBinding=n.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=function(r){},t.restorePreviousBindingsAndBuffers=function(r){var n=typeof r<"u"?r:t.getBothMode();t.restorePreviousBindings(n),t.restorePreviousBuffers(n)},t.restorePreviousBindings=function(r){if(!e.context){ge("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}var n=e.context;n.bindFramebuffer(n.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=function(r){},t.bind=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=r;n===null&&(n=e.context.FRAMEBUFFER),e.context.bindFramebuffer(n,e.glFramebuffer);for(var a=0;a<e.colorBuffers.length;a++)e.colorBuffers[a].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=function(r,n){if(!e.context){ge("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=r,e.glFramebuffer.height=n},t.setColorBuffer=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=e.context;if(!a){ge("you must set the OpenGLRenderWindow before calling setColorBuffer");return}var i=a.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())i+=n;else{ge("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[n]=r,a.framebufferTexture2D(a.FRAMEBUFFER,i,a.TEXTURE_2D,r.getHandle(),0)},t.removeColorBuffer=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=e.context;if(!n){ge("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}var a=n.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())a+=r;else{ge("Using multiple framebuffer attachments requires WebGL 2");return}n.framebufferTexture2D(n.FRAMEBUFFER,a,n.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(r,1)},t.setDepthBuffer=function(r){if(!e.context){ge("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){var n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,r.getHandle(),0)}else ge("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=function(){if(!e.context){ge("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){var r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,null,0)}else ge("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=function(){return e.glFramebuffer},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=function(){e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=function(){var r=[0,0];return e.glFramebuffer!==null&&(r[0]=e.glFramebuffer.width,r[1]=e.glFramebuffer.height),r},t.populateFramebuffer=function(){if(!e.context){ge("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();var r=e.context,n=xr.newInstance();n.setOpenGLRenderWindow(e._openGLRenderWindow),n.setMinificationFilter(So.LINEAR),n.setMagnificationFilter(So.LINEAR),n.create2DFromRaw(e.glFramebuffer.width,e.glFramebuffer.height,4,Dr.UNSIGNED_CHAR,null),t.setColorBuffer(n),e.depthTexture=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,e.depthTexture),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e.depthTexture)},t.getColorTexture=function(){return e.colorBuffers[0]}}var _D={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function Dp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_D,r),yt(t,e),e.colorBuffers&&ge("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],da(t,e,["colorBuffers"]),VD(t,e)}var bD=Ue(Dp,"vtkFramebuffer"),tf={newInstance:bD,extend:Dp};function kD(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=function(){return e.currentOperation},t.setCurrentOperation=function(r){e.currentOperation=r,e.currentTraverseOperation="traverse".concat(L.capitalize(e.currentOperation))},t.getTraverseOperation=function(){return e.currentTraverseOperation},t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e.currentParent=n,e.preDelegateOperations.forEach(function(a){t.setCurrentOperation(a),r.traverse(t)}),e.delegates.forEach(function(a){a.traverse(r,t)}),e.postDelegateOperations.forEach(function(a){t.setCurrentOperation(a),r.traverse(t)}))}}var FD={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function mp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FD,r),L.obj(t,e),L.get(t,e,["currentOperation"]),L.setGet(t,e,["delegates","currentParent","preDelegateOperations","postDelegateOperations"]),kD(t,e)}var BD=L.newInstance(mp,"vtkRenderPass"),rf={newInstance:BD,extend:mp},ND=Ln.Representation,Wc=L.vtkErrorMacro;function UD(t){var e=$.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}var GD=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function AD(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=function(){var r=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),n=new Float32Array([0,0,1,0,0,1,1,1]),a=new Uint16Array([4,0,1,3,2]),i=Ne.newInstance({numberOfComponents:3,values:r});i.setName("points");var s=Ne.newInstance({numberOfComponents:2,values:n});s.setName("tcoords");var f=Ne.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(f,"polys",ND.SURFACE,{points:i,tcoords:s,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=function(r){var n,a=r.getSize(),i=r.getContext();e.framebuffer=tf.newInstance(),e.framebuffer.setOpenGLRenderWindow(r),(n=e.framebuffer).create.apply(n,Ce(a)),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=xr.newInstance(),e.translucentRGBATexture.setInternalFormat(i.RGBA16F),e.translucentRGBATexture.setFormat(i.RGBA),e.translucentRGBATexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(r),e.translucentRGBATexture.create2DFromRaw(a[0],a[1],4,"Float32Array",null),e.translucentRTexture=xr.newInstance(),e.translucentRTexture.setInternalFormat(i.R16F),e.translucentRTexture.setFormat(i.RED),e.translucentRTexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(r),e.translucentRTexture.create2DFromRaw(a[0],a[1],1,"Float32Array",null),e.translucentZTexture=xr.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(r),e.translucentZTexture.createDepthFromRaw(a[0],a[1],"Float32Array",null),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=function(r){e.copyShader=r.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),GD,"")},t.createVBO=function(r){var n=r.getContext();e.tris.setOpenGLRenderWindow(r),t.createVertexBuffer();var a=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),n.FLOAT,3,n.FALSE)||Wc("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),n.FLOAT,2,n.FALSE)||Wc("Error setting vertexDC in copy shader VAO.")},t.traverse=function(r,n,a){if(!e.deleted){var i=r.getSize(),s=r.getContext();if(e._supported=!1,n.getSelector()||!s||!r.getWebgl2()||!s.getExtension("EXT_color_buffer_half_float")&&!s.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),n.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(r);else{var f=e.framebuffer.getSize();f===null||f[0]!==i[0]||f[1]!==i[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(r),e.translucentRTexture.releaseGraphicsResources(r),e.translucentZTexture.releaseGraphicsResources(r),t.createFramebuffer(r)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}s.drawBuffers([s.COLOR_ATTACHMENT0]),s.clearBufferfv(s.COLOR,0,[0,0,0,0]),s.clearBufferfv(s.DEPTH,0,[1]),s.colorMask(!1,!1,!1,!1),a.getOpaqueActorCount()>0&&(a.setCurrentOperation("opaquePass"),n.traverse(a)),s.colorMask(!0,!0,!0,!0),s.drawBuffers([s.COLOR_ATTACHMENT0,s.COLOR_ATTACHMENT1]),s.viewport(0,0,i[0],i[1]),s.scissor(0,0,i[0],i[1]),s.clearBufferfv(s.COLOR,0,[0,0,0,1]),s.clearBufferfv(s.COLOR,1,[0,0,0,0]),s.enable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFuncSeparate(s.ONE,s.ONE,s.ZERO,s.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),n.traverse(t),s.drawBuffers([s.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(r):r.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=Bl.newInstance(),e.copyVAO.setOpenGLRenderWindow(r)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(r),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),s.depthMask(!1),s.depthFunc(s.ALWAYS),s.viewport(0,0,i[0],i[1]),s.scissor(0,0,i[0],i[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),s.drawArrays(s.TRIANGLES,0,e.tris.getCABO().getElementCount()),s.depthMask(!0),s.depthFunc(s.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate()}},t.getShaderReplacement=function(){return e._supported?UD:null},t.releaseGraphicsResources=function(r){e.framebuffer&&(e.framebuffer.releaseGraphicsResources(r),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(r),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(r),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(r),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(r),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(r),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(r),e.tris=null),t.modified()}}var PD={framebuffer:null,copyShader:null,tris:null};function Rp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PD,r),rf.extend(t,e,r),e.VBOBuildTime={},L.obj(e.VBOBuildTime,{mtime:0}),e.tris=_n.newInstance(),L.get(t,e,["framebuffer"]),AD(t,e)}var zD=L.newInstance(Rp,"vtkOpenGLOrderIndependentTranslucentPass"),WD={newInstance:zD,extend:Rp};function jD(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e.deleted){e.currentParent=n,t.setCurrentOperation("buildPass"),r.traverse(t);for(var a=r.getRenderable().getNumberOfLayers(),i=r.getChildren(),s=0;s<a;s++)for(var f=0;f<i.length;f++){var o=i[f],u=r.getRenderable().getRenderers()[f];if(u.getDraw()&&u.getLayer()===s){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),o.traverse(t),e.opaqueActorCount>0&&e.volumeCount>0||e.depthRequested){var g=r.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=tf.newInstance()),e.framebuffer.setOpenGLRenderWindow(r),e.framebuffer.saveCurrentBindingsAndBuffers();var c=e.framebuffer.getSize();(c===null||c[0]!==g[0]||c[1]!==g[1])&&(e.framebuffer.create(g[0],g[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("opaqueZBufferPass"),o.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),o.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),o.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=WD.newInstance()),e.translucentPass.traverse(r,o,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),o.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),o.traverse(t))}}}},t.getZBufferTexture=function(){return e.framebuffer?e.framebuffer.getColorTexture():null},t.requestDepth=function(){e.depthRequested=!0},t.incrementOpaqueActorCount=function(){return e.opaqueActorCount++},t.incrementTranslucentActorCount=function(){return e.translucentActorCount++},t.incrementVolumeCount=function(){return e.volumeCount++},t.incrementOverlayActorCount=function(){return e.overlayActorCount++}}var $D={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function Lp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$D,r),rf.extend(t,e,r),L.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),jD(t,e)}var HD=L.newInstance(Lp,"vtkForwardPass"),KD={newInstance:HD,extend:Lp},XD=Vn.FieldAssociations;function YD(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=function(){var r=wn(Lt.mark(function n(a,i,s,f,o){return Lt.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:case"end":return g.stop()}},n)}));return function(n,a,i,s,f){return r.apply(this,arguments)}}(),t.selectAsync=function(){var r=wn(Lt.mark(function n(a,i,s,f,o){var u;return Lt.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getSourceDataAsync(a,i,s,f,o);case 2:if(u=c.sent,!u){c.next=5;break}return c.abrupt("return",u.generateSelection(i,s,f,o));case 5:return c.abrupt("return",[]);case 6:case"end":return c.stop()}},n)}));return function(n,a,i,s,f){return r.apply(this,arguments)}}()}var ID={fieldAssociation:XD.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function Vp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ID,r),L.obj(t,e),L.setGet(t,e,["fieldAssociation","captureZValues"]),YD(t,e)}var qD=L.newInstance(Vp,"vtkHardwareSelector"),ZD={newInstance:qD,extend:Vp},QD={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},JD={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5},em={SelectionContent:QD,SelectionField:JD};function jc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function tm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rm(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=function(){return e.points.getBounds()}}var nm={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function _p(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nm,r),L.obj(t,e),e.properties={},L.setGet(t,e,["contentType","fieldType","properties","selectionList"]),rm(t,e)}var am=L.newInstance(_p,"vtkSelectionNode"),nf=tm({newInstance:am,extend:_p},em);function $c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function im(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$c(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$c(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Qe=cl.PassTypes,sm=nf.SelectionContent,Hc=nf.SelectionField,ia=Vn.FieldAssociations,bp=L.vtkErrorMacro,Cr=1;function kp(t){return"".concat(t.propID," ").concat(t.compositeID)}function Fp(t,e,r,n){if(!r)return 0;var a=(e*(n[2]-n[0]+1)+t)*4;return r[a+3]}function ar(t,e,r,n){if(!r)return 0;var a=(e*(n[2]-n[0]+1)+t)*4,i=[];i[0]=r[a],i[1]=r[a+1],i[2]=r[a+2];var s=i[2];return s*=256,s+=i[1],s*=256,s+=i[0],s}function Bp(t,e){var r=e;return r<<=24,r|=t,r}function hn(t,e,r,n){var a=r<0?0:r;if(a===0){if(n[0]=e[0],n[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;var i=[e[0]-t.area[0],e[1]-t.area[1]],s=ar(i[0],i[1],t.pixBuffer[Qe.ACTOR_PASS],t.area);if(s<=0||s-Cr>=t.props.length)return null;var f={};f.valid=!0,f.propID=s-Cr,f.prop=t.props[f.propID];var o=ar(i[0],i[1],t.pixBuffer[Qe.COMPOSITE_INDEX_PASS],t.area);if((o<0||o>16777215)&&(o=0),f.compositeID=o-Cr,t.captureZValues){var u=(i[1]*(t.area[2]-t.area[0]+1)+i[0])*4;f.zValue=(256*t.zBuffer[u]+t.zBuffer[u+1])/65535,f.displayPosition=e}if(t.pixBuffer[Qe.ID_LOW24]&&Fp(i[0],i[1],t.pixBuffer[Qe.ID_LOW24],t.area)===0)return f;var g=ar(i[0],i[1],t.pixBuffer[Qe.ID_LOW24],t.area),c=ar(i[0],i[1],t.pixBuffer[Qe.ID_HIGH24],t.area);return f.attributeID=Bp(g,c),f}var l=[e[0],e[1]],h=[0,0],y=hn(t,e,0,n);if(y&&y.valid)return y;for(var S=1;S<a;++S){for(var T=l[1]>S?l[1]-S:0;T<=l[1]+S;++T)if(h[1]=T,l[0]>=S&&(h[0]=l[0]-S,y=hn(t,h,0,n),y&&y.valid)||(h[0]=l[0]+S,y=hn(t,h,0,n),y&&y.valid))return y;for(var E=l[0]>=S?l[0]-(S-1):0;E<=l[0]+(S-1);++E)if(h[0]=E,l[1]>=S&&(h[1]=l[1]-S,y=hn(t,h,0,n),y&&y.valid)||(h[1]=l[1]+S,y=hn(t,h,0,n),y&&y.valid))return y}return n[0]=e[0],n[1]=e[1],null}function Np(t,e,r,n,a){var i=[],s=0;return e.forEach(function(f,o){var u=nf.newInstance();switch(u.setContentType(sm.INDICES),t){case ia.FIELD_ASSOCIATION_CELLS:u.setFieldType(Hc.CELL);break;case ia.FIELD_ASSOCIATION_POINTS:u.setFieldType(Hc.POINT);break;default:bp("Unknown field association")}u.getProperties().propID=f.info.propID,u.getProperties().prop=f.info.prop,u.getProperties().compositeID=f.info.compositeID,u.getProperties().attributeID=f.info.attributeID,u.getProperties().pixelCount=f.pixelCount,r&&(u.getProperties().displayPosition=[f.info.displayPosition[0],f.info.displayPosition[1],f.info.zValue],u.getProperties().worldPosition=a.displayToWorld(f.info.displayPosition[0],f.info.displayPosition[1],f.info.zValue,n)),u.setSelectionList(f.attributeIDs),i[s]=u,s++}),i}function om(t,e,r,n,a){for(var i=Math.floor(e),s=Math.floor(r),f=Math.floor(n),o=Math.floor(a),u=new Map,g=[0,0],c=s;c<=o;c++)for(var l=i;l<=f;l++){var h=[l,c],y=hn(t,h,0,g);if(y&&y.valid){var S=kp(y);if(!u.has(S))u.set(S,{info:y,pixelCount:1,attributeIDs:[y.attributeID]});else{var T=u.get(S);T.pixelCount++,t.captureZValues&&y.zValue<T.info.zValue&&(T.info=y),T.attributeIDs.indexOf(y.attributeID)===-1&&T.attributeIDs.push(y.attributeID)}}}return Np(t.fieldAssociation,u,t.captureZValues,t.renderer,t.openGLRenderWindow)}function fm(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=function(){e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=function(){e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e.maxAttributeId=0;var n=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=tf.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(n[0],n[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();var a=e.framebuffer.getSize();a[0]!==n[0]||a[1]!==n[1]?(e.framebuffer.create(n[0],n[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===ia.FIELD_ASSOCIATION_POINTS){var i=e._openGLRenderWindow.getContext(),s=i.isEnabled(i.BLEND);i.disable(i.BLEND),e._openGLRenderWindow.traverseAllPasses(),e._renderer.setPreserveDepthBuffer(!0),s&&i.enable(i.BLEND)}},t.endSelection=function(){e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers(),e._renderer.setPreserveDepthBuffer(!1)},t.preCapturePass=function(){var n=e._openGLRenderWindow.getContext();e.originalBlending=n.isEnabled(n.BLEND),n.disable(n.BLEND)},t.postCapturePass=function(){var n=e._openGLRenderWindow.getContext();e.originalBlending&&n.enable(n.BLEND)},t.select=function(){var n=null;return t.captureBuffers()&&(n=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),n},t.getSourceDataAsync=function(){var n=wn(Lt.mark(function a(i,s,f,o,u){var g,c;return Lt.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(e._renderer=i,s===void 0?(g=e._openGLRenderWindow.getSize(),t.setArea(0,0,g[0]-1,g[1]-1)):t.setArea(s,f,o,u),t.captureBuffers()){h.next=4;break}return h.abrupt("return",!1);case 4:return c={area:Ce(e.area),pixBuffer:Ce(e.pixBuffer),captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:Ce(e.props),fieldAssociation:e.fieldAssociation,renderer:i,openGLRenderWindow:e._openGLRenderWindow},c.generateSelection=function(){for(var y=arguments.length,S=new Array(y),T=0;T<y;T++)S[T]=arguments[T];return om.apply(void 0,[c].concat(S))},h.abrupt("return",c);case 7:case"end":return h.stop()}},a)}));return function(a,i,s,f,o){return n.apply(this,arguments)}}(),t.captureBuffers=function(){if(!e._renderer||!e._openGLRenderWindow)return bp("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);var n=e._openGLRenderWindow.getRenderPasses();for(t.beginSelection(),e.currentPass=Qe.MIN_KNOWN_PASS;e.currentPass<=Qe.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===Qe.ACTOR_PASS&&typeof n[0].requestDepth=="function"&&typeof n[0].getFramebuffer=="function"&&n[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),t.processPixelBuffers());return t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=function(){e.props.forEach(function(n,a){t.isPropHit(a)&&n.processSelectorPixelBuffers(t,e.propPixels[a])})},t.passRequired=function(n){if(n===Qe.ID_HIGH24){if(e.fieldAssociation===ia.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===ia.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=function(n){if(e.pixBuffer[n]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[n]){var a=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[n]=new Uint8Array(a),e.rawPixBuffer[n].set(e.pixBuffer[n])}if(n===Qe.ACTOR_PASS){if(e.captureZValues){var i=e._openGLRenderWindow.getRenderPasses();if(typeof i[0].requestDepth=="function"&&typeof i[0].getFramebuffer=="function"){var s=i[0].getFramebuffer();s.saveCurrentBindingsAndBuffers(),s.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),s.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[n])}},t.buildPropHitList=function(n){for(var a=0,i=0;i<=e.area[3]-e.area[1];i++)for(var s=0;s<=e.area[2]-e.area[0];s++){var f=ar(s,i,n,e.area);f>0&&(f--,f in e.hitProps||(e.hitProps[f]=!0,e.propPixels[f]=[]),e.propPixels[f].push(a*4)),++a}},t.renderProp=function(n){e.currentPass===Qe.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+Cr),e.props.push(n))},t.renderCompositeIndex=function(n){e.currentPass===Qe.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(n+Cr)},t.renderAttributeId=function(n){n<0||(e.maxAttributeId=n>e.maxAttributeId?n:e.maxAttributeId)},t.passTypeToString=function(n){return L.enumToString(Qe,n)},t.isPropHit=function(n){return Boolean(e.hitProps[n])},t.setPropColorValueFromInt=function(n){e.propColorValue[0]=n%256/255,e.propColorValue[1]=Math.floor(n/256)%256/255,e.propColorValue[2]=Math.floor(n/65536)%256/255},t.getPixelInformation=function(n,a,i){var s=a<0?0:a;if(s===0){if(i[0]=n[0],i[1]=n[1],n[0]<e.area[0]||n[0]>e.area[2]||n[1]<e.area[1]||n[1]>e.area[3])return null;var f=[n[0]-e.area[0],n[1]-e.area[1]],o=ar(f[0],f[1],e.pixBuffer[Qe.ACTOR_PASS],e.area);if(o<=0||o-Cr>=e.props.length)return null;var u={};u.valid=!0,u.propID=o-Cr,u.prop=e.props[u.propID];var g=ar(f[0],f[1],e.pixBuffer[Qe.COMPOSITE_INDEX_PASS],e.area);if((g<0||g>16777215)&&(g=0),u.compositeID=g-Cr,e.captureZValues){var c=(f[1]*(e.area[2]-e.area[0]+1)+f[0])*4;u.zValue=(256*e.zBuffer[c]+e.zBuffer[c+1])/65535,u.displayPosition=n}if(e.pixBuffer[Qe.ID_LOW24]&&Fp(f[0],f[1],e.pixBuffer[Qe.ID_LOW24],e.area)===0)return u;var l=ar(f[0],f[1],e.pixBuffer[Qe.ID_LOW24],e.area),h=ar(f[0],f[1],e.pixBuffer[Qe.ID_HIGH24],e.area);return u.attributeID=Bp(l,h),u}var y=[n[0],n[1]],S=[0,0],T=t.getPixelInformation(n,0,i);if(T&&T.valid)return T;for(var E=1;E<s;++E){for(var x=y[1]>E?y[1]-E:0;x<=y[1]+E;++x)if(S[1]=x,y[0]>=E&&(S[0]=y[0]-E,T=t.getPixelInformation(S,0,i),T&&T.valid)||(S[0]=y[0]+E,T=t.getPixelInformation(S,0,i),T&&T.valid))return T;for(var w=y[0]>=E?y[0]-(E-1):0;w<=y[0]+(E-1);++w)if(S[0]=w,y[1]>=E&&(S[1]=y[1]-E,T=t.getPixelInformation(S,0,i),T&&T.valid)||(S[1]=y[1]+E,T=t.getPixelInformation(S,0,i),T&&T.valid))return T}return i[0]=n[0],i[1]=n[1],null},t.generateSelection=function(n,a,i,s){for(var f=Math.floor(n),o=Math.floor(a),u=Math.floor(i),g=Math.floor(s),c=new Map,l=[0,0],h=o;h<=g;h++)for(var y=f;y<=u;y++){var S=[y,h],T=t.getPixelInformation(S,0,l);if(T&&T.valid){var E=kp(T);if(!c.has(E))c.set(E,{info:T,pixelCount:1,attributeIDs:[T.attributeID]});else{var x=c.get(E);x.pixelCount++,e.captureZValues&&T.zValue<x.info.zValue&&(x.info=T),x.attributeIDs.indexOf(T.attributeID)===-1&&x.attributeIDs.push(T.attributeID)}}}return Np(e.fieldAssociation,c,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=function(n){return e.rawPixBuffer[n]},t.getPixelBuffer=function(n){return e.pixBuffer[n]},t.attach=function(n,a){e._openGLRenderWindow=n,e._renderer=a};var r=t.setArea;t.setArea=function(){return r.apply(void 0,arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}var um={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function Up(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,um,r),ZD.extend(t,e,r),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),L.setGetArray(t,e,["area"],4),L.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),L.setGetArray(t,e,["propColorValue"],3),L.moveToProtected(t,e,["renderer","openGLRenderWindow"]),L.event(t,e,"event"),fm(t,e)}var cm=L.newInstance(Up,"vtkOpenGLHardwareSelector"),Gp=im({newInstance:cm,extend:Up},cl),Ap={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(r){var n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(E,x){var w=E[0],C=E[1],m=E[2],D=E[3];w+=(C&m|~C&D)+x[0]-680876936|0,w=(w<<7|w>>>25)+C|0,D+=(w&C|~w&m)+x[1]-389564586|0,D=(D<<12|D>>>20)+w|0,m+=(D&w|~D&C)+x[2]+606105819|0,m=(m<<17|m>>>15)+D|0,C+=(m&D|~m&w)+x[3]-1044525330|0,C=(C<<22|C>>>10)+m|0,w+=(C&m|~C&D)+x[4]-176418897|0,w=(w<<7|w>>>25)+C|0,D+=(w&C|~w&m)+x[5]+1200080426|0,D=(D<<12|D>>>20)+w|0,m+=(D&w|~D&C)+x[6]-1473231341|0,m=(m<<17|m>>>15)+D|0,C+=(m&D|~m&w)+x[7]-45705983|0,C=(C<<22|C>>>10)+m|0,w+=(C&m|~C&D)+x[8]+1770035416|0,w=(w<<7|w>>>25)+C|0,D+=(w&C|~w&m)+x[9]-1958414417|0,D=(D<<12|D>>>20)+w|0,m+=(D&w|~D&C)+x[10]-42063|0,m=(m<<17|m>>>15)+D|0,C+=(m&D|~m&w)+x[11]-1990404162|0,C=(C<<22|C>>>10)+m|0,w+=(C&m|~C&D)+x[12]+1804603682|0,w=(w<<7|w>>>25)+C|0,D+=(w&C|~w&m)+x[13]-40341101|0,D=(D<<12|D>>>20)+w|0,m+=(D&w|~D&C)+x[14]-1502002290|0,m=(m<<17|m>>>15)+D|0,C+=(m&D|~m&w)+x[15]+1236535329|0,C=(C<<22|C>>>10)+m|0,w+=(C&D|m&~D)+x[1]-165796510|0,w=(w<<5|w>>>27)+C|0,D+=(w&m|C&~m)+x[6]-1069501632|0,D=(D<<9|D>>>23)+w|0,m+=(D&C|w&~C)+x[11]+643717713|0,m=(m<<14|m>>>18)+D|0,C+=(m&w|D&~w)+x[0]-373897302|0,C=(C<<20|C>>>12)+m|0,w+=(C&D|m&~D)+x[5]-701558691|0,w=(w<<5|w>>>27)+C|0,D+=(w&m|C&~m)+x[10]+38016083|0,D=(D<<9|D>>>23)+w|0,m+=(D&C|w&~C)+x[15]-660478335|0,m=(m<<14|m>>>18)+D|0,C+=(m&w|D&~w)+x[4]-405537848|0,C=(C<<20|C>>>12)+m|0,w+=(C&D|m&~D)+x[9]+568446438|0,w=(w<<5|w>>>27)+C|0,D+=(w&m|C&~m)+x[14]-1019803690|0,D=(D<<9|D>>>23)+w|0,m+=(D&C|w&~C)+x[3]-187363961|0,m=(m<<14|m>>>18)+D|0,C+=(m&w|D&~w)+x[8]+1163531501|0,C=(C<<20|C>>>12)+m|0,w+=(C&D|m&~D)+x[13]-1444681467|0,w=(w<<5|w>>>27)+C|0,D+=(w&m|C&~m)+x[2]-51403784|0,D=(D<<9|D>>>23)+w|0,m+=(D&C|w&~C)+x[7]+1735328473|0,m=(m<<14|m>>>18)+D|0,C+=(m&w|D&~w)+x[12]-1926607734|0,C=(C<<20|C>>>12)+m|0,w+=(C^m^D)+x[5]-378558|0,w=(w<<4|w>>>28)+C|0,D+=(w^C^m)+x[8]-2022574463|0,D=(D<<11|D>>>21)+w|0,m+=(D^w^C)+x[11]+1839030562|0,m=(m<<16|m>>>16)+D|0,C+=(m^D^w)+x[14]-35309556|0,C=(C<<23|C>>>9)+m|0,w+=(C^m^D)+x[1]-1530992060|0,w=(w<<4|w>>>28)+C|0,D+=(w^C^m)+x[4]+1272893353|0,D=(D<<11|D>>>21)+w|0,m+=(D^w^C)+x[7]-155497632|0,m=(m<<16|m>>>16)+D|0,C+=(m^D^w)+x[10]-1094730640|0,C=(C<<23|C>>>9)+m|0,w+=(C^m^D)+x[13]+681279174|0,w=(w<<4|w>>>28)+C|0,D+=(w^C^m)+x[0]-358537222|0,D=(D<<11|D>>>21)+w|0,m+=(D^w^C)+x[3]-722521979|0,m=(m<<16|m>>>16)+D|0,C+=(m^D^w)+x[6]+76029189|0,C=(C<<23|C>>>9)+m|0,w+=(C^m^D)+x[9]-640364487|0,w=(w<<4|w>>>28)+C|0,D+=(w^C^m)+x[12]-421815835|0,D=(D<<11|D>>>21)+w|0,m+=(D^w^C)+x[15]+530742520|0,m=(m<<16|m>>>16)+D|0,C+=(m^D^w)+x[2]-995338651|0,C=(C<<23|C>>>9)+m|0,w+=(m^(C|~D))+x[0]-198630844|0,w=(w<<6|w>>>26)+C|0,D+=(C^(w|~m))+x[7]+1126891415|0,D=(D<<10|D>>>22)+w|0,m+=(w^(D|~C))+x[14]-1416354905|0,m=(m<<15|m>>>17)+D|0,C+=(D^(m|~w))+x[5]-57434055|0,C=(C<<21|C>>>11)+m|0,w+=(m^(C|~D))+x[12]+1700485571|0,w=(w<<6|w>>>26)+C|0,D+=(C^(w|~m))+x[3]-1894986606|0,D=(D<<10|D>>>22)+w|0,m+=(w^(D|~C))+x[10]-1051523|0,m=(m<<15|m>>>17)+D|0,C+=(D^(m|~w))+x[1]-2054922799|0,C=(C<<21|C>>>11)+m|0,w+=(m^(C|~D))+x[8]+1873313359|0,w=(w<<6|w>>>26)+C|0,D+=(C^(w|~m))+x[15]-30611744|0,D=(D<<10|D>>>22)+w|0,m+=(w^(D|~C))+x[6]-1560198380|0,m=(m<<15|m>>>17)+D|0,C+=(D^(m|~w))+x[13]+1309151649|0,C=(C<<21|C>>>11)+m|0,w+=(m^(C|~D))+x[4]-145523070|0,w=(w<<6|w>>>26)+C|0,D+=(C^(w|~m))+x[11]-1120210379|0,D=(D<<10|D>>>22)+w|0,m+=(w^(D|~C))+x[2]+718787259|0,m=(m<<15|m>>>17)+D|0,C+=(D^(m|~w))+x[9]-343485551|0,C=(C<<21|C>>>11)+m|0,E[0]=w+E[0]|0,E[1]=C+E[1]|0,E[2]=m+E[2]|0,E[3]=D+E[3]|0}function i(E){var x=[],w;for(w=0;w<64;w+=4)x[w>>2]=E.charCodeAt(w)+(E.charCodeAt(w+1)<<8)+(E.charCodeAt(w+2)<<16)+(E.charCodeAt(w+3)<<24);return x}function s(E){var x=[],w;for(w=0;w<64;w+=4)x[w>>2]=E[w]+(E[w+1]<<8)+(E[w+2]<<16)+(E[w+3]<<24);return x}function f(E){var x=E.length,w=[1732584193,-271733879,-1732584194,271733878],C,m,D,b,F,U;for(C=64;C<=x;C+=64)a(w,i(E.substring(C-64,C)));for(E=E.substring(C-64),m=E.length,D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C=0;C<m;C+=1)D[C>>2]|=E.charCodeAt(C)<<(C%4<<3);if(D[C>>2]|=128<<(C%4<<3),C>55)for(a(w,D),C=0;C<16;C+=1)D[C]=0;return b=x*8,b=b.toString(16).match(/(.*?)(.{0,8})$/),F=parseInt(b[2],16),U=parseInt(b[1],16)||0,D[14]=F,D[15]=U,a(w,D),w}function o(E){var x=E.length,w=[1732584193,-271733879,-1732584194,271733878],C,m,D,b,F,U;for(C=64;C<=x;C+=64)a(w,s(E.subarray(C-64,C)));for(E=C-64<x?E.subarray(C-64):new Uint8Array(0),m=E.length,D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],C=0;C<m;C+=1)D[C>>2]|=E[C]<<(C%4<<3);if(D[C>>2]|=128<<(C%4<<3),C>55)for(a(w,D),C=0;C<16;C+=1)D[C]=0;return b=x*8,b=b.toString(16).match(/(.*?)(.{0,8})$/),F=parseInt(b[2],16),U=parseInt(b[1],16)||0,D[14]=F,D[15]=U,a(w,D),w}function u(E){var x="",w;for(w=0;w<4;w+=1)x+=n[E>>w*8+4&15]+n[E>>w*8&15];return x}function g(E){var x;for(x=0;x<E.length;x+=1)E[x]=u(E[x]);return E.join("")}g(f("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function E(x,w){return x=x|0||0,x<0?Math.max(x+w,0):Math.min(x,w)}ArrayBuffer.prototype.slice=function(x,w){var C=this.byteLength,m=E(x,C),D=C,b,F,U,O;return w!==r&&(D=E(w,C)),m>D?new ArrayBuffer(0):(b=D-m,F=new ArrayBuffer(b),U=new Uint8Array(F),O=new Uint8Array(this,m,b),U.set(O),F)}}();function c(E){return/[\u0080-\uFFFF]/.test(E)&&(E=unescape(encodeURIComponent(E))),E}function l(E,x){var w=E.length,C=new ArrayBuffer(w),m=new Uint8Array(C),D;for(D=0;D<w;D+=1)m[D]=E.charCodeAt(D);return x?m:C}function h(E){return String.fromCharCode.apply(null,new Uint8Array(E))}function y(E,x,w){var C=new Uint8Array(E.byteLength+x.byteLength);return C.set(new Uint8Array(E)),C.set(new Uint8Array(x),E.byteLength),w?C:C.buffer}function S(E){var x=[],w=E.length,C;for(C=0;C<w-1;C+=2)x.push(parseInt(E.substr(C,2),16));return String.fromCharCode.apply(String,x)}function T(){this.reset()}return T.prototype.append=function(E){return this.appendBinary(c(E)),this},T.prototype.appendBinary=function(E){this._buff+=E,this._length+=E.length;var x=this._buff.length,w;for(w=64;w<=x;w+=64)a(this._hash,i(this._buff.substring(w-64,w)));return this._buff=this._buff.substring(w-64),this},T.prototype.end=function(E){var x=this._buff,w=x.length,C,m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D;for(C=0;C<w;C+=1)m[C>>2]|=x.charCodeAt(C)<<(C%4<<3);return this._finish(m,w),D=g(this._hash),E&&(D=S(D)),this.reset(),D},T.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},T.prototype.setState=function(E){return this._buff=E.buff,this._length=E.length,this._hash=E.hash,this},T.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},T.prototype._finish=function(E,x){var w=x,C,m,D;if(E[w>>2]|=128<<(w%4<<3),w>55)for(a(this._hash,E),w=0;w<16;w+=1)E[w]=0;C=this._length*8,C=C.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(C[2],16),D=parseInt(C[1],16)||0,E[14]=m,E[15]=D,a(this._hash,E)},T.hash=function(E,x){return T.hashBinary(c(E),x)},T.hashBinary=function(E,x){var w=f(E),C=g(w);return x?S(C):C},T.ArrayBuffer=function(){this.reset()},T.ArrayBuffer.prototype.append=function(E){var x=y(this._buff.buffer,E,!0),w=x.length,C;for(this._length+=E.byteLength,C=64;C<=w;C+=64)a(this._hash,s(x.subarray(C-64,C)));return this._buff=C-64<w?new Uint8Array(x.buffer.slice(C-64)):new Uint8Array(0),this},T.ArrayBuffer.prototype.end=function(E){var x=this._buff,w=x.length,C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m,D;for(m=0;m<w;m+=1)C[m>>2]|=x[m]<<(m%4<<3);return this._finish(C,w),D=g(this._hash),E&&(D=S(D)),this.reset(),D},T.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.ArrayBuffer.prototype.getState=function(){var E=T.prototype.getState.call(this);return E.buff=h(E.buff),E},T.ArrayBuffer.prototype.setState=function(E){return E.buff=l(E.buff,!0),T.prototype.setState.call(this,E)},T.ArrayBuffer.prototype.destroy=T.prototype.destroy,T.ArrayBuffer.prototype._finish=T.prototype._finish,T.ArrayBuffer.hash=function(E,x){var w=o(new Uint8Array(E)),C=g(w);return x?S(C):C},T})})(Ap);const gm=Ap.exports;var vm=["lastShaderBound","context","_openGLRenderWindow"];function lm(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=function(r,n,a){var i=n;a.length>0&&(i=$.substitute(i,"VSOut","GSOut").result);var s=e._openGLRenderWindow.getWebgl2(),f=`
`,o=`#version 100
`;s?o=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(f=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(f+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),i=$.substitute(i,"//VTK::System::Dec",["".concat(o,`
`),s?"":`#extension GL_OES_standard_derivatives : enable
`,f,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;var u=$.substitute(r,"//VTK::System::Dec",["".concat(o,`
`),"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(s){u=$.substitute(u,"varying","out").result,i=$.substitute(i,"varying","in").result;for(var g="",c=0;i.includes("gl_FragData[".concat(c,"]"));)i=$.substitute(i,"gl_FragData\\[".concat(c,"\\]"),"fragOutput".concat(c)).result,g+="layout(location = ".concat(c,") out vec4 fragOutput").concat(c,`;
`),c++;i=$.substitute(i,"//VTK::Output::Dec",g).result}var l=$.substitute(a,"//VTK::System::Dec",o).result;return{VSSource:u,FSSource:i,GSSource:l}},t.readyShaderProgramArray=function(r,n,a){var i=t.replaceShaderValues(r,n,a),s=t.getShaderProgram(i.VSSource,i.FSSource,i.GSSource);return t.readyShaderProgram(s)},t.readyShaderProgram=function(r){return!r||!r.getCompiled()&&!r.compileShader()||!t.bindShader(r)?null:r},t.getShaderProgram=function(r,n,a){var i="".concat(r).concat(n).concat(a),s=gm.hash(i);if(!(s in e.shaderPrograms)){var f=$.newInstance();return f.setContext(e.context),f.getVertexShader().setSource(r),f.getFragmentShader().setSource(n),a&&f.getGeometryShader().setSource(a),f.setMd5Hash(s),e.shaderPrograms[s]=f,f}return e.shaderPrograms[s]},t.releaseGraphicsResources=function(r){t.releaseCurrentShader(),Object.keys(e.shaderPrograms).map(function(n){return e.shaderPrograms[n]}).forEach(function(n){return n.releaseGraphicsResources(r)})},t.releaseGraphicsResources=function(){e.astShaderBound&&(e.lastShaderBound.release(),e.lastShaderBound=null)},t.bindShader=function(r){return e.lastShaderBound===r||(e.lastShaderBound&&e.lastShaderBound.release(),r.bind(),e.lastShaderBound=r),1}}var pm={lastShaderBound:null,shaderPrograms:null,context:null};function Pp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pm,r),e.shaderPrograms={},L.obj(t,e),L.setGet(t,e,vm),L.moveToProtected(t,e,["openGLRenderWindow"]),lm(t,e)}var hm=L.newInstance(Pp,"vtkShaderCache"),ym={newInstance:hm,extend:Pp},dm=L.vtkErrorMacro;function Tm(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=function(){for(var r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]===!0&&dm("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=function(r){if(e.context!==r){if(e.context!==0&&t.deleteTable(),e.context=r,e.context){e.numberOfTextureUnits=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);for(var n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}t.modified()}},t.allocate=function(){for(var r=0;r<e.numberOfTextureUnits;r++)if(!t.isAllocated(r))return e.textureUnits[r]=!0,r;return-1},t.allocateUnit=function(r){return t.isAllocated(r)?-1:(e.textureUnits[r]=!0,r)},t.isAllocated=function(r){return e.textureUnits[r]},t.free=function(r){e.textureUnits[r]=!1}}var Sm={context:null,numberOfTextureUnits:0,textureUnits:0};function zp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Sm,r),L.obj(t,e),e.textureUnits=[],L.get(t,e,["numberOfTextureUnits"]),L.setGet(t,e,["context"]),Tm(t,e)}var Cm=L.newInstance(zp,"vtkOpenGLTextureUnitManager"),Em={newInstance:Cm,extend:zp};function wm(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=function(){return null},t.getAspectRatio=function(){return e.size[0]/e.size[1]},t.getAspectRatioForRenderer=function(r){var n=r.getViewportByReference();return e.size[0]*(n[2]-n[0])/((n[3]-n[1])*e.size[1])},t.isInViewport=function(r,n,a){var i=a.getViewportByReference(),s=t.getFramebufferSize();return i[0]*s[0]<=r&&i[2]*s[0]>=r&&i[1]*s[1]<=n&&i[3]*s[1]>=n},t.getViewportSize=function(r){var n=r.getViewportByReference(),a=t.getFramebufferSize();return[(n[2]-n[0])*a[0],(n[3]-n[1])*a[1]]},t.getViewportCenter=function(r){var n=t.getViewportSize(r);return[n[0]*.5,n[1]*.5]},t.displayToNormalizedDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r/i[0],n/i[1],a]},t.normalizedDisplayToDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r*i[0],n*i[1],a]},t.worldToView=function(r,n,a,i){return i.worldToView(r,n,a)},t.viewToWorld=function(r,n,a,i){return i.viewToWorld(r,n,a)},t.worldToDisplay=function(r,n,a,i){var s=i.worldToView(r,n,a),f=t.getViewportSize(i),o=i.viewToProjection(s[0],s[1],s[2],f[0]/f[1]),u=i.projectionToNormalizedDisplay(o[0],o[1],o[2]);return t.normalizedDisplayToDisplay(u[0],u[1],u[2])},t.displayToWorld=function(r,n,a,i){var s=t.displayToNormalizedDisplay(r,n,a),f=i.normalizedDisplayToProjection(s[0],s[1],s[2]),o=t.getViewportSize(i),u=i.projectionToView(f[0],f[1],f[2],o[0]/o[1]);return i.viewToWorld(u[0],u[1],u[2])},t.normalizedDisplayToViewport=function(r,n,a,i){var s=i.getViewportByReference();s=t.normalizedDisplayToDisplay(s[0],s[1],0);var f=t.normalizedDisplayToDisplay(r,n,a);return[f[0]-s[0]-.5,f[1]-s[1]-.5,a]},t.viewportToNormalizedViewport=function(r,n,a,i){var s=t.getViewportSize(i);return s&&s[0]!==0&&s[1]!==0?[r/(s[0]-1),n/(s[1]-1),a]:[r,n,a]},t.normalizedViewportToViewport=function(r,n,a,i){var s=t.getViewportSize(i);return[r*(s[0]-1),n*(s[1]-1),a]},t.displayToLocalDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r,i[1]-n-1,a]},t.viewportToNormalizedDisplay=function(r,n,a,i){var s=i.getViewportByReference();s=t.normalizedDisplayToDisplay(s[0],s[1],0);var f=r+s[0]+.5,o=n+s[1]+.5;return t.displayToNormalizedDisplay(f,o,a)},t.getPixelData=function(r,n,a,i){L.vtkErrorMacro("not implemented")},t.createSelector=function(){L.vtkErrorMacro("not implemented")}}var xm={size:void 0,selector:void 0};function Wp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xm,r),e.size||(e.size=[300,300]),L.getArray(t,e,["size"],2),L.get(t,e,["selector"]),Ie.extend(t,e,r),wm(t,e)}var Om=L.newInstance(Wp,"vtkRenderWindowViewNode"),Mm={newInstance:Om,extend:Wp};function Dm(){var t=new Map,e={apply:function(i,s,f){return t.has(f[0])?t.get(f[0]):i.apply(s,f)}};function r(a){return{apply:function(s,f,o){return t.set(a,o[0]),s.apply(f,o)}}}var n=Object.create(null);return n.getParameter=function(a,i,s,f){return new Proxy(f.bind(a),e)},n.depthMask=function(a,i,s,f){return new Proxy(f.bind(a),r(a.DEPTH_WRITEMASK))},{get:function(i,s,f){var o=Reflect.get(i,s,i);o instanceof Function&&(o=o.bind(i));var u=n[s];return u?u(i,s,f,o):o}}}var Kc=L.vtkDebugMacro,Xc=L.vtkErrorMacro,mm={position:"absolute",top:0,left:0,width:"100%",height:"100%"},vn={vr:{rescaleFactor:1,translateZ:-.7},ar:{rescaleFactor:.25,translateZ:-.5}};function pt(t,e,r){var n=t.createFramebuffer(),a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,r,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),i===t.FRAMEBUFFER_COMPLETE}var ki=0,Hi=[];function Rm(){ki++,Hi.forEach(function(t){return t(ki)})}function Lm(){ki--,Hi.forEach(function(t){return t(ki)})}function Vm(t){Hi.push(t)}function _m(t){return Hi.pop()}function bm(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");var r=Dm();t.getViewNodeFactory=function(){return e.myFactory},e.canvas.addEventListener("webglcontextlost",function(o){o.preventDefault()},!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);var n=navigator.xr!==void 0&&navigator.xr.isSessionSupported("immersive-vr"),a=[0,0];function i(){e.renderable&&(e.size[0]!==a[0]||e.size[1]!==a[1])&&(a[0]=e.size[0],a[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(i),t.buildPass=function(o){if(o){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(function(u){u.setOpenGLRenderWindow(t)})}},t.initialize=function(){if(!e.initialized){e.context=t.get3DContext(),e.textureUnitManager=Em.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);var o=e.context;o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.depthFunc(o.LEQUAL),o.enable(o.BLEND),e.initialized=!0}},t.makeCurrent=function(){e.context.makeCurrent()},t.setContainer=function(o){e.el&&e.el!==o&&(e.canvas.parentNode!==e.el&&Xc("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==o&&(e.el=o,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=function(){return e.el},t.getContainerSize=function(){if(!e.containerSize&&e.el){var o=e.el.getBoundingClientRect(),u=o.width,g=o.height;e.containerSize=[u,g]}return e.containerSize||e.size},t.getFramebufferSize=function(){return e.activeFramebuffer?e.activeFramebuffer.getSize():e.size},t.getPixelData=function(o,u,g,c){var l=new Uint8Array((g-o+1)*(c-u+1)*4);return e.context.readPixels(o,u,g-o+1,c-u+1,e.context.RGBA,e.context.UNSIGNED_BYTE,l),l},t.get3DContext=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},u=null;n&&t.invokeHaveVRDisplay();var g=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&g&&(u=e.canvas.getContext("webgl2",o),u&&(e.webgl2=!0,Kc("using webgl2"))),u||(Kc("using webgl1"),u=e.canvas.getContext("webgl",o)||e.canvas.getContext("experimental-webgl",o)),new Proxy(u,r)},t.startXR=function(o){if(navigator.xr===void 0)throw new Error("WebXR is not available");e.xrSessionIsAR=o;var u=o?"immersive-ar":"immersive-vr";if(!navigator.xr.isSessionSupported(u))throw o?new Error("Device does not support AR session"):new Error("VR display is not available");if(e.xrSession===null)navigator.xr.requestSession(u).then(t.enterXR,function(){throw new Error("Failed to create XR session!")});else throw new Error("XR Session already exists!")},t.enterXR=function(){var o=wn(Lt.mark(function u(g){var c,l;return Lt.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e.xrSession=g,e.oldCanvasSize=e.size.slice(),e.xrSession===null){y.next=15;break}return c=t.get3DContext(),y.next=6,c.makeXRCompatible();case 6:l=new global.XRWebGLLayer(e.xrSession,c),t.setSize(l.framebufferWidth,l.framebufferHeight),e.xrSession.updateRenderState({baseLayer:l}),e.xrSession.requestReferenceSpace("local").then(function(S){e.xrReferenceSpace=S}),t.resetXRScene(),e.renderable.getInteractor().switchToXRAnimation(),e.xrSceneFrame=e.xrSession.requestAnimationFrame(t.xrRender),y.next=16;break;case 15:throw new Error("Failed to enter VR with a null xrSession.");case 16:case"end":return y.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),t.resetXRScene=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vn.vr.rescaleFactor,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vn.vr.translateZ,g=o,c=u;e.xrSessionIsAR&&g===vn.vr.rescaleFactor&&(g=vn.ar.rescaleFactor),e.xrSessionIsAR&&c===vn.vr.translateZ&&(c=vn.ar.translateZ);var l=e.renderable.getRenderers()[0];l.resetCamera();var h=l.getActiveCamera(),y=h.getPhysicalScale(),S=h.getPhysicalTranslation();y/=g,c*=y,S[2]+=c,h.setPhysicalScale(y),h.setPhysicalTranslation(S),h.setClippingRange(.1*y,100*y)},t.stopXR=wn(Lt.mark(function o(){var u,g;return Lt.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(navigator.xr!==void 0){l.next=2;break}return l.abrupt("return");case 2:if(e.xrSession===null){l.next=10;break}return e.xrSession.cancelAnimationFrame(e.xrSceneFrame),e.renderable.getInteractor().returnFromXRAnimation(),u=t.get3DContext(),u.bindFramebuffer(u.FRAMEBUFFER,null),l.next=9,e.xrSession.end().catch(function(h){if(!(h instanceof DOMException))throw h});case 9:e.xrSession=null;case 10:e.oldCanvasSize!==void 0&&t.setSize.apply(t,Ce(e.oldCanvasSize)),g=e.renderable.getRenderers()[0],g.getActiveCamera().setProjectionMatrix(null),g.resetCamera(),g.setViewport(0,0,1,1),t.traverseAllPasses();case 16:case"end":return l.stop()}},o)})),t.xrRender=function(){var o=wn(Lt.mark(function u(g,c){var l,h,y,S,T;return Lt.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:l=c.session,e.renderable.getInteractor().updateXRGamepads(l,c,e.xrReferenceSpace),e.xrSceneFrame=e.xrSession.requestAnimationFrame(t.xrRender),h=c.getViewerPose(e.xrReferenceSpace),h&&(y=t.get3DContext(),e.xrSessionIsAR&&e.oldCanvasSize!==void 0&&(y.canvas.width=e.oldCanvasSize[0],y.canvas.height=e.oldCanvasSize[1]),S=l.renderState.baseLayer,y.bindFramebuffer(y.FRAMEBUFFER,S.framebuffer),y.clear(y.COLOR_BUFFER_BIT),y.clear(y.DEPTH_BUFFER_BIT),T=e.renderable.getRenderers()[0],h.views.forEach(function(w){var C=S.getViewport(w);if(y.viewport(C.x,C.y,C.width,C.height),!e.xrSessionIsAR)if(w.eye==="left")T.setViewport(0,0,.5,1);else if(w.eye==="right")T.setViewport(.5,0,1,1);else return;T.getActiveCamera().computeViewParametersFromPhysicalMatrix(w.transform.inverse.matrix),T.getActiveCamera().setProjectionMatrix(w.projectionMatrix),t.traverseAllPasses()}));case 5:case"end":return x.stop()}},u)}));return function(u,g){return o.apply(this,arguments)}}(),t.restoreContext=function(){var o=rf.newInstance();o.setCurrentOperation("Release"),o.traverse(t,null)},t.activateTexture=function(o){var u=e._textureResourceIds.get(o);if(u!==void 0){e.context.activeTexture(e.context.TEXTURE0+u);return}var g=t.getTextureUnitManager().allocate();if(g<0){Xc("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(o,g),e.context.activeTexture(e.context.TEXTURE0+g)},t.deactivateTexture=function(o){var u=e._textureResourceIds.get(o);u!==void 0&&(t.getTextureUnitManager().free(u),delete e._textureResourceIds.delete(o))},t.getTextureUnitForTexture=function(o){var u=e._textureResourceIds.get(o);return u!==void 0?u:-1},t.getDefaultTextureInternalFormat=function(o,u,g){if(e.webgl2)switch(o){case Dr.UNSIGNED_CHAR:switch(u){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case Dr.FLOAT:default:switch(u){case 1:return e.context.R16F;case 2:return e.context.RG16F;case 3:return e.context.RGB16F;case 4:default:return e.context.RGBA16F}}switch(u){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=function(o){e.bgImage.src=o.src},t.setUseBackgroundImage=function(o){e.useBackgroundImage=o,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function s(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat,u=document.createElement("canvas"),g=u.getContext("2d");u.width=e.canvas.width,u.height=e.canvas.height,g.drawImage(e.canvas,0,0);var c=e.canvas.getBoundingClientRect(),l=e.renderable,h=l.getRenderers();h.forEach(function(S){var T=S.getViewProps();T.forEach(function(E){if(E.getContainer)for(var x=E.getContainer(),w=x.getElementsByTagName("canvas"),C=0;C<w.length;C++){var m=w[C],D=m.getBoundingClientRect(),b=D.x-c.x,F=D.y-c.y;g.drawImage(m,b,F)}})});var y=u.toDataURL(o);u.remove(),t.invokeImageReady(y)}t.captureNextImage=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=u.resetCamera,c=g===void 0?!1:g,l=u.size,h=l===void 0?null:l,y=u.scale,S=y===void 0?1:y;if(e.deleted)return null;e.imageFormat=o;var T=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:!!h||S!==1?h||e.size.map(function(E){return E*S}):null},new Promise(function(E,x){var w=t.onImageReady(function(C){if(e._screenshot.size===null)e.notifyStartCaptureImage=T,w.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(function(b){var F=b.restoreParamsFn,U=b.arg;return F(U)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),E(C);else{var m=document.createElement("img");if(m.style=mm,m.src=C,e._screenshot.placeHolder=e.el.appendChild(m),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e._screenshot.size=null,t.modified(),c){var D=c!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(function(b){var F=b.getActiveCamera(),U=F.get("focalPoint","position","parallelScale");return{resetCameraArgs:D?{renderer:b}:void 0,resetCameraFn:D?c:b.resetCamera,restoreParamsFn:F.set,arg:JSON.parse(JSON.stringify(U))}}),e._screenshot.cameras.forEach(function(b){var F=b.resetCameraFn,U=b.resetCameraArgs;return F(U)})}t.traverseAllPasses()}})})};var f;t.getHardwareMaximumLineWidth=function(){if(f!=null)return f;var o=t.get3DContext(),u=o.getParameter(o.ALIASED_LINE_WIDTH_RANGE);return f=u[1],u[1]},t.getGLInformations=function(){for(var o=t.get3DContext(),u=o.getExtension("OES_texture_float"),g=o.getExtension("OES_texture_half_float"),c=o.getExtension("WEBGL_debug_renderer_info"),l=o.getExtension("WEBGL_draw_buffers"),h=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),y=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",o.getParameter(o.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",o.getParameter(o.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",o.getParameter(o.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",h&&o.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",o.getParameter(o.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",o.getParameter(o.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",o.getParameter(o.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",o.getParameter(o.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",o.getParameter(o.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",o.getParameter(o.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",o.getParameter(o.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",o.getParameter(o.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",o.getParameter(o.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",o.getParameter(o.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",o.getParameter(o.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",o.getParameter(o.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",o.getParameter(o.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[u&&pt(o,o.RGBA,o.UNSIGNED_BYTE)?"RGBA":"",u&&pt(o,o.RGB,o.UNSIGNED_BYTE)?"RGB":"",u&&pt(o,o.LUMINANCE,o.UNSIGNED_BYTE)?"LUMINANCE":"",u&&pt(o,o.ALPHA,o.UNSIGNED_BYTE)?"ALPHA":"",u&&pt(o,o.LUMINANCE_ALPHA,o.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[g&&pt(o,o.RGBA,g.HALF_FLOAT_OES)?"RGBA":"",g&&pt(o,o.RGB,g.HALF_FLOAT_OES)?"RGB":"",g&&pt(o,o.LUMINANCE,g.HALF_FLOAT_OES)?"LUMINANCE":"",g&&pt(o,o.ALPHA,g.HALF_FLOAT_OES)?"ALPHA":"",g&&pt(o,o.LUMINANCE_ALPHA,g.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[u&&pt(o,o.RGBA,o.FLOAT)?"RGBA":"",u&&pt(o,o.RGB,o.FLOAT)?"RGB":"",u&&pt(o,o.LUMINANCE,o.FLOAT)?"LUMINANCE":"",u&&pt(o,o.ALPHA,o.FLOAT)?"ALPHA":"",u&&pt(o,o.LUMINANCE_ALPHA,o.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",l?o.getParameter(l.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",o.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",o.getParameter(o.RENDERER)],["WebGL Vendor","VENDOR",o.getParameter(o.VENDOR)],["WebGL Version","VERSION",o.getParameter(o.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",o.getParameter(o.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",c&&o.getParameter(c.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",c&&o.getParameter(c.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],S={};y.length;){var T=y.pop(),E=Ct(T,3),x=E[0],w=E[1],C=E[2];w&&(S[w]={label:x,value:C})}return S},t.traverseAllPasses=function(){if(e.renderPasses)for(var o=0;o<e.renderPasses.length;++o)e.renderPasses[o].traverse(t,null);e.notifyStartCaptureImage&&s()},t.disableCullFace=function(){e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=function(){e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=function(o){if(e.viewStream===o)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=o,e.viewStream){var u=e.renderable.getRenderers()[0];u.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(function(g){return t.setBackgroundImage(g.image)}),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=function(){var o=Gp.newInstance();return o.setOpenGLRenderWindow(t),o},t.delete=L.chain(t.delete,t.setViewStream,Lm)}var km={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,xrSession:null,xrSessionIsAR:!1,xrReferenceSpace:null,xrSupported:!0,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function jp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,km,r),Mm.extend(t,e,r),e.canvas=document.createElement("canvas"),e.canvas.style.width="100%",Rm(),e.selector||(e.selector=Gp.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e.myFactory=tT.newInstance(),e.myFactory.registerOverride("vtkRenderWindow",af),e.shaderCache=ym.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=KD.newInstance(),L.event(t,e,"imageReady"),L.event(t,e,"haveVRDisplay"),L.get(t,e,["shaderCache","textureUnitManager","webgl2","vrDisplay","useBackgroundImage","xrSupported"]),L.setGet(t,e,["initialized","context","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen","activeFramebuffer"]),L.setGetArray(t,e,["size"],2),bm(t,e)}var af=L.newInstance(jp,"vtkOpenGLRenderWindow");xp("WebGL",af);var Fm={newInstance:af,extend:jp,pushMonitorGLContextCount:Vm,popMonitorGLContextCount:_m},ni=L.vtkDebugMacro;function Bm(t,e){e.classHierarchy.push("vtkCamera");var r=new Float64Array(3),n=new Float64Array([0,0,-1]),a=new Float64Array([0,1,0]),i=De(new Float64Array(16)),s=De(new Float64Array(16)),f=new Float64Array(3),o=new Float64Array(3),u=new Float64Array(3),g=De(new Float64Array(16)),c=De(new Float64Array(16)),l=new Float64Array(3),h=new Float64Array(3);function y(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=function(){var S=t.getViewMatrix();e.viewUp[0]=S[4],e.viewUp[1]=S[5],e.viewUp[2]=S[6],t.modified()},t.setPosition=function(S,T,E){S===e.position[0]&&T===e.position[1]&&E===e.position[2]||(e.position[0]=S,e.position[1]=T,e.position[2]=E,t.computeDistance(),t.modified())},t.setFocalPoint=function(S,T,E){S===e.focalPoint[0]&&T===e.focalPoint[1]&&E===e.focalPoint[2]||(e.focalPoint[0]=S,e.focalPoint[1]=T,e.focalPoint[2]=E,t.computeDistance(),t.modified())},t.setDistance=function(S){if(e.distance!==S){e.distance=S,e.distance<1e-20&&(e.distance=1e-20,ni("Distance is set to minimum."));var T=e.directionOfProjection;e.focalPoint[0]=e.position[0]+T[0]*e.distance,e.focalPoint[1]=e.position[1]+T[1]*e.distance,e.focalPoint[2]=e.position[2]+T[2]*e.distance,t.modified()}},t.computeDistance=function(){var S=e.focalPoint[0]-e.position[0],T=e.focalPoint[1]-e.position[1],E=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(S*S+T*T+E*E),e.distance<1e-20){e.distance=1e-20,ni("Distance is set to minimum.");var x=e.directionOfProjection;e.focalPoint[0]=e.position[0]+x[0]*e.distance,e.focalPoint[1]=e.position[1]+x[1]*e.distance,e.focalPoint[2]=e.position[2]+x[2]*e.distance}e.directionOfProjection[0]=S/e.distance,e.directionOfProjection[1]=T/e.distance,e.directionOfProjection[2]=E/e.distance,y()},t.dolly=function(S){if(!(S<=0)){var T=e.distance/S;t.setPosition(e.focalPoint[0]-T*e.directionOfProjection[0],e.focalPoint[1]-T*e.directionOfProjection[1],e.focalPoint[2]-T*e.directionOfProjection[2])}},t.roll=function(S){var T=e.position,E=e.focalPoint,x=e.viewUp,w=new Float64Array([x[0],x[1],x[2],0]);De(g);var C=new Float64Array([E[0]-T[0],E[1]-T[1],E[2]-T[2]]);Xt(g,g,Ke(S),C),yn(w,w,g),e.viewUp[0]=w[0],e.viewUp[1]=w[1],e.viewUp[2]=w[2],t.modified()},t.azimuth=function(S){var T=e.focalPoint;De(c),et(c,c,T),Xt(c,c,Ke(S),e.viewUp),et(c,c,[-T[0],-T[1],-T[2]]),me(l,e.position,c),t.setPosition(l[0],l[1],l[2])},t.yaw=function(S){var T=e.position;De(c),et(c,c,T),Xt(c,c,Ke(S),e.viewUp),et(c,c,[-T[0],-T[1],-T[2]]),me(h,e.focalPoint,c),t.setFocalPoint(h[0],h[1],h[2])},t.elevation=function(S){var T=e.focalPoint,E=t.getViewMatrix(),x=[-E[0],-E[1],-E[2]];De(c),et(c,c,T),Xt(c,c,Ke(S),x),et(c,c,[-T[0],-T[1],-T[2]]),me(l,e.position,c),t.setPosition(l[0],l[1],l[2])},t.pitch=function(S){var T=e.position,E=t.getViewMatrix(),x=[E[0],E[1],E[2]];De(c),et(c,c,T),Xt(c,c,Ke(S),x),et(c,c,[-T[0],-T[1],-T[2]]),me(h,e.focalPoint,c),t.setFocalPoint.apply(t,Ce(h))},t.zoom=function(S){S<=0||(e.parallelProjection?e.parallelScale/=S:e.viewAngle/=S,t.modified())},t.translate=function(S,T,E){var x=[S,T,E];co(e.position,x,e.position),co(e.focalPoint,x,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=function(S){var T=[].concat(Ce(e.viewUp),[1]),E=[],x=[],w=[];T[0]+=e.position[0],T[1]+=e.position[1],T[2]+=e.position[2],yn(E,[].concat(Ce(e.position),[1]),S),yn(x,[].concat(Ce(e.focalPoint),[1]),S),yn(w,T,S),w[0]-=E[0],w[1]-=E[1],w[2]-=E[2],t.setPosition.apply(t,Ce(E.slice(0,3))),t.setFocalPoint.apply(t,Ce(x.slice(0,3))),t.setViewUp.apply(t,Ce(w.slice(0,3)))},t.getThickness=function(){return e.clippingRange[1]-e.clippingRange[0]},t.setThickness=function(S){var T=S;T<1e-20&&(T=1e-20,ni("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+T)},t.setThicknessFromFocalPoint=function(S){var T=S;T<1e-20&&(T=1e-20,ni("Thickness is set to minimum.")),t.setClippingRange(e.distance-T/2,e.distance+T/2)},t.setRoll=function(S){},t.getRoll=function(){},t.setObliqueAngles=function(S,T){},t.getOrientation=function(){},t.getOrientationWXYZ=function(){},t.getFrustumPlanes=function(S){},t.getCameraLightTransformMatrix=function(S){return ut(S,e.cameraLightTransform),S},t.computeCameraLightTransform=function(){ut(i,t.getViewMatrix()),xt(i,i),ug(s,[e.distance,e.distance,e.distance]),St(i,i,s),De(e.cameraLightTransform),et(e.cameraLightTransform,i,[0,0,-1])},t.deepCopy=function(S){},t.physicalOrientationToWorldDirection=function(S){var T=Hf(S[0],S[1],S[2],S[3]),E=Ir(),x=Hf(0,0,1,0);return gd(E,T),$f(x,T,x),$f(x,x,E),[x[0],x[1],x[2]]},t.getPhysicalToWorldMatrix=function(S){t.getWorldToPhysicalMatrix(S),xt(S,S)},t.getWorldToPhysicalMatrix=function(S){De(S);var T=[3];la(e.physicalViewNorth,e.physicalViewUp,T),S[0]=T[0],S[1]=T[1],S[2]=T[2],S[4]=e.physicalViewUp[0],S[5]=e.physicalViewUp[1],S[6]=e.physicalViewUp[2],S[8]=-e.physicalViewNorth[0],S[9]=-e.physicalViewNorth[1],S[10]=-e.physicalViewNorth[2],ze(S,S),yi(f,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),sa(S,S,f),et(S,S,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=function(S){xt(i,S),me(f,r,i),t.computeDistance();var T=e.distance;t.setPosition(f[0],f[1],f[2]),me(o,n,i),Er(o,o,f),oa(o,o),t.setDirectionOfProjection(o[0],o[1],o[2]),me(u,a,i),Er(u,u,f),oa(u,u),t.setViewUp(u[0],u[1],u[2]),t.setDistance(T)},t.computeViewParametersFromPhysicalMatrix=function(S){t.getWorldToPhysicalMatrix(i),St(i,S,i),t.computeViewParametersFromViewMatrix(i)},t.setViewMatrix=function(S){e.viewMatrix=S,e.viewMatrix&&(ut(i,e.viewMatrix),t.computeViewParametersFromViewMatrix(i),ze(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=function(){if(e.viewMatrix)return e.viewMatrix;dg(i,e.position,e.focalPoint,e.viewUp),ze(i,i);var S=new Float64Array(16);return ut(S,i),S},t.setProjectionMatrix=function(S){e.projectionMatrix=S},t.getProjectionMatrix=function(S,T,E){var x=new Float64Array(16);if(De(x),e.projectionMatrix){var w=1/e.physicalScale;return yi(f,w,w,w),ut(x,e.projectionMatrix),sa(x,x,f),ze(x,x),x}De(i);var C=e.clippingRange[1]-e.clippingRange[0],m=[e.clippingRange[0]+(T+1)*C/2,e.clippingRange[0]+(E+1)*C/2];if(e.parallelProjection){var D=e.parallelScale*S,b=e.parallelScale,F=(e.windowCenter[0]-1)*D,U=(e.windowCenter[0]+1)*D,O=(e.windowCenter[1]-1)*b,A=(e.windowCenter[1]+1)*b;yg(i,F,U,O,A,m[0],m[1]),ze(i,i)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");var W=Math.tan(Ke(e.viewAngle)/2),j,N;e.useHorizontalViewAngle===!0?(j=e.clippingRange[0]*W,N=e.clippingRange[0]*W/S):(j=e.clippingRange[0]*W*S,N=e.clippingRange[0]*W);var I=(e.windowCenter[0]-1)*j,X=(e.windowCenter[0]+1)*j,J=(e.windowCenter[1]-1)*N,P=(e.windowCenter[1]+1)*N,G=m[0],K=m[1];i[0]=2*G/(X-I),i[5]=2*G/(P-J),i[2]=(I+X)/(X-I),i[6]=(J+P)/(P-J),i[10]=-(G+K)/(K-G),i[14]=-1,i[11]=-2*G*K/(K-G),i[15]=0}return ut(x,i),x},t.getCompositeProjectionMatrix=function(S,T,E){var x=t.getViewMatrix(),w=t.getProjectionMatrix(S,T,E);return St(w,x,w),w},t.setDirectionOfProjection=function(S,T,E){if(!(e.directionOfProjection[0]===S&&e.directionOfProjection[1]===T&&e.directionOfProjection[2]===E)){e.directionOfProjection[0]=S,e.directionOfProjection[1]=T,e.directionOfProjection[2]=E;var x=e.directionOfProjection;e.focalPoint[0]=e.position[0]+x[0]*e.distance,e.focalPoint[1]=e.position[1]+x[1]*e.distance,e.focalPoint[2]=e.position[2]+x[2]*e.distance,y()}},t.setDeviceAngles=function(S,T,E,x){var w=[3];la(e.physicalViewNorth,e.physicalViewUp,w);var C=De(new Float64Array(16));Xt(C,C,Ke(S),e.physicalViewUp),Xt(C,C,Ke(T),w),Xt(C,C,Ke(E),e.physicalViewNorth),Xt(C,C,Ke(-x),e.physicalViewUp);var m=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),D=new Float64Array(e.physicalViewNorth);me(m,m,C),me(D,D,C),t.setDirectionOfProjection(m[0],m[1],m[2]),t.setViewUp(D[0],D[1],D[2]),t.modified()},t.setOrientationWXYZ=function(S,T,E,x){var w=De(new Float64Array(16));if(S!==0&&(T!==0||E!==0||x!==0)){var C=Ke(S),m=Ir();_o(m,[T,E,x],C),Vo(w,m)}var D=new Float64Array(3);me(D,[0,0,-1],w);var b=new Float64Array(3);me(b,[0,1,0],w),t.setDirectionOfProjection.apply(t,Ce(D)),t.setViewUp.apply(t,Ce(b)),t.modified()},t.computeClippingRange=function(S){var T=null,E=null;T=e.viewPlaneNormal,E=e.position;for(var x=-T[0],w=-T[1],C=-T[2],m=-(x*E[0]+w*E[1]+C*E[2]),D=[x*S[0]+w*S[2]+C*S[4]+m,1e-18],b=0;b<2;b++)for(var F=0;F<2;F++)for(var U=0;U<2;U++){var O=x*S[U]+w*S[2+F]+C*S[4+b]+m;D[0]=O<D[0]?O:D[0],D[1]=O>D[1]?O:D[1]}return D}}var Nm={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:Lo(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function $p(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Nm,r),L.obj(t,e),L.get(t,e,["distance"]),L.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),L.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),L.setGetArray(t,e,["clippingRange","windowCenter"],2),L.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),Bm(t,e)}var Um=L.newInstance($p,"vtkCamera"),Gm={newInstance:Um,extend:$p},Am=["HeadLight","CameraLight","SceneLight"];function Pm(t,e){e.classHierarchy.push("vtkLight");var r=new Float64Array(3);t.getTransformedPosition=function(){return e.transformMatrix?me(r,e.position,e.transformMatrix):yi(r,e.position[0],e.position[1],e.position[2]),r},t.getTransformedFocalPoint=function(){return e.transformMatrix?me(r,e.focalPoint,e.transformMatrix):yi(r,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),r},t.getDirection=function(){return e.directionMTime<e.mtime&&(Is(e.direction,e.focalPoint,e.position),Mn(e.direction),e.directionMTime=e.mtime),e.direction},t.setDirection=function(n){var a=new Float64Array(3);Is(a,e.position,n),e.focalPoint=a},t.setDirectionAngle=function(n,a){var i=Ke(n),s=Ke(a);t.setPosition(Math.cos(i)*Math.sin(s),Math.sin(i),Math.cos(i)*Math.cos(s)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=function(){t.setLightType("HeadLight")},t.setLightTypeToCameraLight=function(){t.setLightType("CameraLight")},t.setLightTypeToSceneLight=function(){t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=function(){return e.lightType==="HeadLight"},t.lightTypeIsSceneLight=function(){return e.lightType==="SceneLight"},t.lightTypeIsCameraLight=function(){return e.lightType==="CameraLight"}}var zm={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function Hp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zm,r),L.obj(t,e),L.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),L.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),Pm(t,e)}var Wm=L.newInstance(Hp,"vtkLight"),jm={newInstance:Wm,extend:Hp,LIGHT_TYPES:Am},hi=L.vtkErrorMacro;function $m(t){return function(){return hi("vtkViewport::".concat(t," - NOT IMPLEMENTED"))}}function Hm(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=function(){return e.props},t.hasViewProp=function(n){return!!e.props.filter(function(a){return a===n}).length},t.addViewProp=function(n){n&&!t.hasViewProp(n)&&(e.props=e.props.concat(n))},t.removeViewProp=function(n){var a=e.props.filter(function(i){return i!==n});e.props.length!==a.length&&(e.props=a)},t.removeAllViewProps=function(){e.props=[]};function r(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];a.push(n);var i=n.getNestedProps();if(i&&i.length)for(var s=0;s<i.length;s++)r(i[s],a);return a}t.getViewPropsWithNestedProps=function(){for(var n=[],a=0;a<e.props.length;a++)r(e.props[a],n);return n},t.addActor2D=t.addViewProp,t.removeActor2D=function(n){t.removeViewProp(n)},t.getActors2D=function(){return e.actors2D=[],e.props.forEach(function(n){e.actors2D=e.actors2D.concat(n.getActors2D())}),e.actors2D},t.displayToView=function(){return hi("call displayToView on your view instead")},t.viewToDisplay=function(){return hi("callviewtodisplay on your view instead")},t.getSize=function(){return hi("call getSize on your View instead")},t.normalizedDisplayToProjection=function(n,a,i){var s=t.normalizedDisplayToNormalizedViewport(n,a,i);return t.normalizedViewportToProjection(s[0],s[1],s[2])},t.normalizedDisplayToNormalizedViewport=function(n,a,i){var s=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(n-e.viewport[0])/s[0],(a-e.viewport[1])/s[1],i]},t.normalizedViewportToProjection=function(n,a,i){return[n*2-1,a*2-1,i*2-1]},t.projectionToNormalizedDisplay=function(n,a,i){var s=t.projectionToNormalizedViewport(n,a,i);return t.normalizedViewportToNormalizedDisplay(s[0],s[1],s[2])},t.normalizedViewportToNormalizedDisplay=function(n,a,i){var s=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[n*s[0]+e.viewport[0],a*s[1]+e.viewport[1],i]},t.projectionToNormalizedViewport=function(n,a,i){return[(n+1)*.5,(a+1)*.5,(i+1)*.5]},t.PickPropFrom=$m("PickPropFrom")}var Km={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function Kp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Km,r),L.obj(t,e),L.event(t,e,"event"),L.setGetArray(t,e,["viewport"],4),L.setGetArray(t,e,["background","background2"],3),Hm(t,e)}var Xm=L.newInstance(Kp,"vtkViewport"),Ym={newInstance:Xm,extend:Kp},$n=Or,dr=ge,Im=Fi;function Yc(t){return function(){return dr("vtkRenderer::".concat(t," - NOT IMPLEMENTED"))}}function qm(t,e){e.classHierarchy.push("vtkRenderer");var r={type:"ComputeVisiblePropBoundsEvent",renderer:t},n={type:"ResetCameraClippingRangeEvent",renderer:t},a={type:"ResetCameraEvent",renderer:t};t.updateCamera=function(){return e.activeCamera||($n("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0},t.updateLightsGeometryToFollowCamera=function(){var i=t.getActiveCameraAndResetIfCreated();e.lights.forEach(function(s){s.lightTypeIsSceneLight()||(s.lightTypeIsHeadLight()?(s.setPositionFrom(i.getPositionByReference()),s.setFocalPointFrom(i.getFocalPointByReference()),s.modified(i.getMTime())):s.lightTypeIsCameraLight()?s.setTransformMatrix(i.getCameraLightTransformMatrix(Lo())):dr("light has unknown light type",s.get()))})},t.updateLightGeometry=function(){return e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0},t.allocateTime=Yc("allocateTime"),t.updateGeometry=Yc("updateGeometry"),t.getVTKWindow=function(){return e._renderWindow},t.setLayer=function(i){$n(t.getClassName(),t,"setting Layer to ",i),e.layer!==i&&(e.layer=i,t.modified()),t.setPreserveColorBuffer(!!i)},t.setActiveCamera=function(i){return e.activeCamera===i?!1:(e.activeCamera=i,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:i}),!0)},t.makeCamera=function(){var i=Gm.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:i}),i},t.getActiveCamera=function(){return e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera},t.getActiveCameraAndResetIfCreated=function(){return e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera},t.getActors=function(){return e.actors=[],e.props.forEach(function(i){e.actors=e.actors.concat(i.getActors())}),e.actors},t.addActor=t.addViewProp,t.removeActor=function(i){e.actors=e.actors.filter(function(s){return s!==i}),t.removeViewProp(i),t.modified()},t.removeAllActors=function(){var i=t.getActors();i.forEach(function(s){t.removeViewProp(s)}),e.actors=[],t.modified()},t.getVolumes=function(){return e.volumes=[],e.props.forEach(function(i){e.volumes=e.volumes.concat(i.getVolumes())}),e.volumes},t.addVolume=t.addViewProp,t.removeVolume=function(i){e.volumes=e.volumes.filter(function(s){return s!==i}),t.removeViewProp(i),t.modified()},t.removeAllVolumes=function(){var i=t.getVolumes();i.forEach(function(s){t.removeViewProp(s)}),e.volumes=[],t.modified()},t.addLight=function(i){e.lights=[].concat(e.lights,i),t.modified()},t.removeLight=function(i){e.lights=e.lights.filter(function(s){return s!==i}),t.modified()},t.removeAllLights=function(){e.lights=[],t.modified()},t.setLightCollection=function(i){e.lights=i,t.modified()},t.makeLight=jm.newInstance,t.createLight=function(){!e.automaticLightCreation||(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=function(i,s,f,o){var u=t.normalizedDisplayToProjection(i,s,f);return u=t.projectionToView(u[0],u[1],u[2],o),t.viewToWorld(u[0],u[1],u[2])},t.worldToNormalizedDisplay=function(i,s,f,o){var u=t.worldToView(i,s,f);return u=t.viewToProjection(u[0],u[1],u[2],o),t.projectionToNormalizedDisplay(u[0],u[1],u[2])},t.viewToWorld=function(i,s,f){if(e.activeCamera===null)return dr("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];var o=e.activeCamera.getViewMatrix();xt(o,o),ze(o,o);var u=new Float64Array([i,s,f]);return me(u,u,o),u},t.projectionToView=function(i,s,f,o){if(e.activeCamera===null)return dr("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];var u=e.activeCamera.getProjectionMatrix(o,-1,1);xt(u,u),ze(u,u);var g=new Float64Array([i,s,f]);return me(g,g,u),g},t.worldToView=function(i,s,f){if(e.activeCamera===null)return dr("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];var o=e.activeCamera.getViewMatrix();ze(o,o);var u=new Float64Array([i,s,f]);return me(u,u,o),u},t.viewToProjection=function(i,s,f,o){if(e.activeCamera===null)return dr("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];var u=e.activeCamera.getProjectionMatrix(o,-1,1);ze(u,u);var g=new Float64Array([i,s,f]);return me(g,g,u),g},t.computeVisiblePropBounds=function(){e.allBounds[0]=je.INIT_BOUNDS[0],e.allBounds[1]=je.INIT_BOUNDS[1],e.allBounds[2]=je.INIT_BOUNDS[2],e.allBounds[3]=je.INIT_BOUNDS[3],e.allBounds[4]=je.INIT_BOUNDS[4],e.allBounds[5]=je.INIT_BOUNDS[5];var i=!0;t.invokeEvent(r);for(var s=0;s<e.props.length;++s){var f=e.props[s];if(f.getVisibility()&&f.getUseBounds()){var o=f.getBounds();o&&Os(o)&&(i=!1,o[0]<e.allBounds[0]&&(e.allBounds[0]=o[0]),o[1]>e.allBounds[1]&&(e.allBounds[1]=o[1]),o[2]<e.allBounds[2]&&(e.allBounds[2]=o[2]),o[3]>e.allBounds[3]&&(e.allBounds[3]=o[3]),o[4]<e.allBounds[4]&&(e.allBounds[4]=o[4]),o[5]>e.allBounds[5]&&(e.allBounds[5]=o[5]))}}return i&&(Ni(e.allBounds),$n("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=i||t.computeVisiblePropBounds(),f=[0,0,0];if(!Os(s))return $n("Cannot reset camera!"),!1;var o=null;if(t.getActiveCamera())o=e.activeCamera.getViewPlaneNormal();else return dr("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),f[0]=(s[0]+s[1])/2,f[1]=(s[2]+s[3])/2,f[2]=(s[4]+s[5])/2;var u=s[1]-s[0],g=s[3]-s[2],c=s[5]-s[4];u*=u,g*=g,c*=c;var l=u+g+c;l=l===0?1:l,l=Math.sqrt(l)*.5;var h=Ke(e.activeCamera.getViewAngle()),y=l,S=l/Math.sin(h*.5),T=e.activeCamera.getViewUp();return Math.abs(Ee(T,o))>.999&&(Im("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-T[2],T[0],T[1])),e.activeCamera.setFocalPoint(f[0],f[1],f[2]),e.activeCamera.setPosition(f[0]+S*o[0],f[1]+S*o[1],f[2]+S*o[2]),t.resetCameraClippingRange(s),e.activeCamera.setParallelScale(y),e.activeCamera.setPhysicalScale(l),e.activeCamera.setPhysicalTranslation(-f[0],-f[1],-f[2]),t.invokeEvent(a),!0},t.resetCameraClippingRange=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=i||t.computeVisiblePropBounds();if(!Os(s))return $n("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return dr("Trying to reset clipping range of non-existent camera"),!1;var f=e.activeCamera.computeClippingRange(s),o=0;if(e.activeCamera.getParallelProjection())o=.2*e.activeCamera.getParallelScale();else{var u=Ke(e.activeCamera.getViewAngle());o=.2*Math.tan(u/2)*f[1]}return f[1]-f[0]<o&&(o=o-f[1]+f[0],f[1]+=o/2,f[0]-=o/2),f[0]<0&&(f[0]=0),f[0]=.99*f[0]-(f[1]-f[0])*e.clippingRangeExpansion,f[1]=1.01*f[1]+(f[1]-f[0])*e.clippingRangeExpansion,f[0]=f[0]>=f[1]?.01*f[1]:f[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),f[0]<e.nearClippingPlaneTolerance*f[1]&&(f[0]=e.nearClippingPlaneTolerance*f[1]),e.activeCamera.setClippingRange(f[0],f[1]),t.invokeEvent(n),!1},t.setRenderWindow=function(i){i!==e._renderWindow&&(e._vtkWindow=i,e._renderWindow=i)},t.visibleActorCount=function(){return e.props.filter(function(i){return i.getVisibility()}).length},t.visibleVolumeCount=t.visibleActorCount,t.getMTime=function(){var i=e.mtime,s=e.activeCamera?e.activeCamera.getMTime():0;s>i&&(i=s);var f=e._createdLight?e._createdLight.getMTime():0;return f>i&&(i=f),i},t.getTransparent=function(){return!!e.preserveColorBuffer},t.isActiveCameraCreated=function(){return!!e.activeCamera}}var Zm={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:vv(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function Xp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,Zm,r),Ym.extend(t,e,r),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),kt(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),gt(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),da(t,e,["actors","volumes","lights"]),zg(t,e,["background"],4,1),Bo(t,e,["renderWindow"]),qm(t,e)}var Qm=Ue(Xp,"vtkRenderer"),Jm={newInstance:Qm,extend:Xp},Mo={Unknown:0,LeftController:1,RightController:2},Qn={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},eR={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4},sf={Device:Mo,Input:Qn,Axis:eR};function Ic(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Be(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ic(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ic(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ai=sf.Device,Wr=sf.Input,ii=L.vtkWarningMacro,si=L.vtkErrorMacro,tR=L.normalizeWheel,rR=L.vtkOnceErrorMacro,ln=new MouseEvent(""),js={"xr-standard":[Wr.Trigger,Wr.Grip,Wr.TrackPad,Wr.Thumbstick,Wr.A,Wr.B]},of=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function Hn(t){t.cancelable&&t.preventDefault()}function oi(t){var e=Object.create(null);return t.forEach(function(r){var n=r.pointerId,a=r.position;e[n]=a}),e}function nR(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");var r=new Set,n=new Map;t.start=function(){!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=function(c){si("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=function(c){e.interactorStyle!==c&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=c,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=function(){e.initialized=!0,t.enable(),t.render()},t.enable=function(){return t.setEnabled(!0)},t.disable=function(){return t.setEnabled(!1)},t.startEventLoop=function(){return ii("empty event loop")};function a(c,l){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(c,l))}t.getCurrentRenderer=function(){return e.currentRenderer||a(0,0),e.currentRenderer};function i(c){var l=e._view.getCanvas(),h=l.getBoundingClientRect(),y=l.width/h.width,S=l.height/h.height,T={x:y*(c.clientX-h.left),y:S*(h.height-c.clientY+h.top),z:0};return(n.size<=1||!e.currentRenderer)&&a(T.x,T.y),T}function s(c){return{controlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey}}function f(c){var l=s(c),h=Be({key:c.key,keyCode:c.charCode},l);return h}function o(c){return c.pointerType||""}t.bindEvents=function(c){e.container=c,c.addEventListener("contextmenu",Hn),c.addEventListener("wheel",t.handleWheel),c.addEventListener("DOMMouseScroll",t.handleWheel),c.addEventListener("pointerenter",t.handlePointerEnter),c.addEventListener("pointerleave",t.handlePointerLeave),c.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),c.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),c.addEventListener("pointerup",t.handlePointerUp),c.addEventListener("pointercancel",t.handlePointerCancel),document.addEventListener("keypress",t.handleKeyPress),document.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),c.style.touchAction="none",c.style.userSelect="none",c.style.webkitTapHighlightColor="rgba(0,0,0,0)"},t.unbindEvents=function(){var c=e.container;c.removeEventListener("contextmenu",Hn),c.removeEventListener("wheel",t.handleWheel),c.removeEventListener("DOMMouseScroll",t.handleWheel),c.removeEventListener("pointerenter",t.handlePointerEnter),c.removeEventListener("pointerleave",t.handlePointerLeave),c.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),c.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),c.removeEventListener("pointerup",t.handlePointerUp),c.removeEventListener("pointercancel",t.handlePointerCancel),document.removeEventListener("keypress",t.handleKeyPress),document.removeEventListener("keydown",t.handleKeyDown),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),e.container=null,n.clear()},t.handleKeyPress=function(c){var l=f(c);t.keyPressEvent(l)},t.handleKeyDown=function(c){var l=f(c);t.keyDownEvent(l)},t.handleKeyUp=function(c){var l=f(c);t.keyUpEvent(l)},t.handlePointerEnter=function(c){var l=Be(Be({},s(c)),{},{position:i(c),deviceType:o(c)});t.pointerEnterEvent(l),l.deviceType==="mouse"&&t.mouseEnterEvent(l)},t.handlePointerLeave=function(c){var l=Be(Be({},s(c)),{},{position:i(c),deviceType:o(c)});t.pointerLeaveEvent(l),l.deviceType==="mouse"&&t.mouseLeaveEvent(l)},t.handlePointerDown=function(c){if(!(c.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&Hn(c),c.target.hasPointerCapture(c.pointerId)&&c.target.releasePointerCapture(c.pointerId),e.container.setPointerCapture(c.pointerId),n.has(c.pointerId)&&ii("[RenderWindowInteractor] duplicate pointerId detected"),n.set(c.pointerId,{pointerId:c.pointerId,position:i(c)}),c.pointerType){case"pen":case"touch":t.handleTouchStart(c);break;case"mouse":default:t.handleMouseDown(c);break}},t.handlePointerUp=function(c){if(n.has(c.pointerId))switch(e.preventDefaultOnPointerUp&&Hn(c),n.delete(c.pointerId),e.container.releasePointerCapture(c.pointerId),c.pointerType){case"pen":case"touch":t.handleTouchEnd(c);break;case"mouse":default:t.handleMouseUp(c);break}},t.handlePointerCancel=function(c){if(n.has(c.pointerId))switch(n.delete(c.pointerId),c.pointerType){case"pen":case"touch":t.handleTouchEnd(c);break;case"mouse":default:t.handleMouseUp(c);break}},t.handlePointerMove=function(c){if(n.has(c.pointerId)){var l=n.get(c.pointerId);l.position=i(c)}switch(c.pointerType){case"pen":case"touch":t.handleTouchMove(c);break;case"mouse":default:t.handleMouseMove(c);break}},t.handleMouseDown=function(c){var l=Be(Be({},s(c)),{},{position:i(c),deviceType:o(c)});switch(c.button){case 0:t.leftButtonPressEvent(l);break;case 1:t.middleButtonPressEvent(l);break;case 2:t.rightButtonPressEvent(l);break;default:si("Unknown mouse button pressed: ".concat(c.button));break}},t.requestPointerLock=function(){e.container&&e.container.requestPointerLock()},t.exitPointerLock=function(){return document.exitPointerLock()},t.isPointerLocked=function(){return!!e.container&&document.pointerLockElement===e.container},t.handlePointerLockChange=function(){t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function u(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=function(c){if(c===void 0){si("undefined requester, can not start animating");return}if(r.has(c)){ii("requester is already registered for animating");return}r.add(c),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=function(c){var l=Date.now()+c;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,l),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=function(){return e.xrAnimation||e.animationRequest!==null},t.cancelAnimation=function(c){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(c)){if(!l){var h=c&&c.getClassName?c.getClassName():c;ii("".concat(h," did not request an animation"))}return}r.delete(c),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=function(){e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=function(){e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=function(c,l,h){c.inputSources.forEach(function(y){var S=y.gripSpace==null?null:l.getPose(y.gripSpace,h),T=y.gamepad,E=y.handedness;if(T){T.index in e.lastGamepadValues||(e.lastGamepadValues[T.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(var x=0;x<T.buttons.length;++x)x in e.lastGamepadValues[T.index][E].buttons||(e.lastGamepadValues[T.index][E].buttons[x]=!1),e.lastGamepadValues[T.index][E].buttons[x]!==T.buttons[x].pressed&&S!=null&&(t.button3DEvent({gamepad:T,position:S.transform.position,orientation:S.transform.orientation,pressed:T.buttons[x].pressed,device:y.handedness==="left"?ai.LeftController:ai.RightController,input:js[T.mapping]&&js[T.mapping][x]?js[T.mapping][x]:Wr.Trigger}),e.lastGamepadValues[T.index][E].buttons[x]=T.buttons[x].pressed),e.lastGamepadValues[T.index][E].buttons[x]&&S!=null&&t.move3DEvent({gamepad:T,position:S.transform.position,orientation:S.transform.orientation,device:y.handedness==="left"?ai.LeftController:ai.RightController})}})},t.handleMouseMove=function(c){var l=Be(Be({},s(c)),{},{position:i(c),deviceType:o(c)});e.moveTimeoutID===0?t.startMouseMoveEvent(l):(t.mouseMoveEvent(l),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(function(){t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=function(){var c=Date.now();e._animationFrameCount++,c-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(c-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=c,e._animationFrameCount=1),t.animationEvent(),u(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=function(c){Hn(c);var l=Be(Be(Be({},tR(c)),s(c)),{},{position:i(c),deviceType:o(c)});e.wheelTimeoutID===0?t.startMouseWheelEvent(l):(t.mouseWheelEvent(l),clearTimeout(e.wheelTimeoutID)),e.wheelTimeoutID=setTimeout(function(){t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=function(c){var l=Be(Be({},s(c)),{},{position:i(c),deviceType:o(c)});switch(c.button){case 0:t.leftButtonReleaseEvent(l);break;case 1:t.middleButtonReleaseEvent(l);break;case 2:t.rightButtonReleaseEvent(l);break;default:si("Unknown mouse button released: ".concat(c.button));break}},t.handleTouchStart=function(c){var l=Ce(n.values());if(e.recognizeGestures&&l.length>1){var h=oi(n);if(l.length===2){var y=Be(Be({},s(ln)),{},{position:l[0].position,deviceType:o(c)});t.leftButtonReleaseEvent(y)}t.recognizeGesture("TouchStart",h)}else if(l.length===1){var S=Be(Be({},s(ln)),{},{position:i(c),deviceType:o(c)});t.leftButtonPressEvent(S)}},t.handleTouchMove=function(c){var l=Ce(n.values());if(e.recognizeGestures&&l.length>1){var h=oi(n);t.recognizeGesture("TouchMove",h)}else if(l.length===1){var y=Be(Be({},s(ln)),{},{position:l[0].position,deviceType:o(c)});t.mouseMoveEvent(y)}},t.handleTouchEnd=function(c){var l=Ce(n.values());if(e.recognizeGestures)if(l.length===0){var h=Be(Be({},s(ln)),{},{position:i(c),deviceType:o(c)});t.leftButtonReleaseEvent(h)}else if(l.length===1){var y=oi(n);t.recognizeGesture("TouchEnd",y);var S=Be(Be({},s(ln)),{},{position:l[0].position,deviceType:o(c)});t.leftButtonPressEvent(S)}else{var T=oi(n);t.recognizeGesture("TouchMove",T)}else if(l.length===1){var E=Be(Be({},s(ln)),{},{position:l[0].position,deviceType:o(c)});t.leftButtonReleaseEvent(E)}},t.setView=function(c){e._view!==c&&(e._view=c,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=function(){var c,l,h;return(c=e._view)===null||c===void 0||(l=c.getRenderable())===null||l===void 0||(h=l.getRenderersByReference())===null||h===void 0?void 0:h[0]},t.findPokedRenderer=function(){var c,l,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;var S=(c=e._view)===null||c===void 0||(l=c.getRenderable())===null||l===void 0?void 0:l.getRenderers();if(!S)return null;S.sort(function(m,D){return m.getLayer()-D.getLayer()});for(var T=null,E=null,x=null,w=S.length;w--;){var C=S[w];if(e._view.isInViewport(h,y,C)&&C.getInteractive()){x=C;break}T===null&&C.getInteractive()&&(T=C),E===null&&e._view.isInViewport(h,y,C)&&(E=C)}return x===null&&(x=T),x===null&&(x=E),x==null&&(x=S[0]),x},t.render=function(){!t.isAnimating()&&!e.inRender&&u()},of.forEach(function(c){var l=c.charAt(0).toLowerCase()+c.slice(1);t["".concat(l,"Event")]=function(h){if(!!e.enabled){var y=t.getCurrentRenderer();if(!y){rR(`
          Can not forward events without a current renderer on the interactor.
        `);return}var S=Be({type:c,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer()},h);t["invoke".concat(c)](S)}}}),t.recognizeGesture=function(c,l){if(!(Object.keys(l).length>2)){if(e.startingEventPositions||(e.startingEventPositions={}),c==="TouchStart"){Object.keys(l).forEach(function(X){e.startingEventPositions[X]=l[X]}),e.currentGesture="Start";return}if(c==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}var h=0,y=[],S=[];Object.keys(l).forEach(function(X){y[h]=l[X],S[h]=e.startingEventPositions[X],h++});var T=Math.sqrt((S[0].x-S[1].x)*(S[0].x-S[1].x)+(S[0].y-S[1].y)*(S[0].y-S[1].y)),E=Math.sqrt((y[0].x-y[1].x)*(y[0].x-y[1].x)+(y[0].y-y[1].y)*(y[0].y-y[1].y)),x=va(Math.atan2(S[1].y-S[0].y,S[1].x-S[0].x)),w=va(Math.atan2(y[1].y-y[0].y,y[1].x-y[0].x)),C=w-x;w=w+180>=360?w-180:w+180,x=x+180>=360?x-180:x+180,Math.abs(w-x)<Math.abs(C)&&(C=w-x);var m=[];if(m[0]=(y[0].x-S[0].x+y[1].x-S[1].x)/2,m[1]=(y[0].y-S[0].y+y[1].y-S[1].y)/2,c==="TouchMove")if(e.currentGesture==="Start"){var D=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);D<15&&(D=15);var b=Math.abs(E-T),F=E*3.1415926*Math.abs(C)/360,U=Math.sqrt(m[0]*m[0]+m[1]*m[1]);if(b>D&&b>F&&b>U){e.currentGesture="Pinch";var O={scale:1,touches:l};t.startPinchEvent(O)}else if(F>D&&F>U){e.currentGesture="Rotate";var A={rotation:0,touches:l};t.startRotateEvent(A)}else if(U>D){e.currentGesture="Pan";var W={translation:[0,0],touches:l};t.startPanEvent(W)}}else{if(e.currentGesture==="Rotate"){var j={rotation:C,touches:l};t.rotateEvent(j)}if(e.currentGesture==="Pinch"){var N={scale:E/T,touches:l};t.pinchEvent(N)}if(e.currentGesture==="Pan"){var I={translation:m,touches:l};t.panEvent(I)}}}},t.handleVisibilityChange=function(){e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=function(c){e._forcedRenderer=!!c,e.currentRenderer=c};var g=t.delete;t.delete=function(){for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),g()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}var aR={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1};function Yp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,aR,r),L.obj(t,e),e._animationExtendedEnd=0,L.event(t,e,"RenderEvent"),of.forEach(function(n){return L.event(t,e,n)}),L.get(t,e,["initialized","container","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),L.setGet(t,e,["lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp"]),L.moveToProtected(t,e,["view"]),nR(t,e)}var iR=L.newInstance(Yp,"vtkRenderWindowInteractor"),Ip=Be({newInstance:iR,extend:Yp,handledEvents:of},sf);function qc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var sR=L.vtkErrorMacro,oR=L.VOID;function fR(t,e,r,n){var a=t.getRenderWindow().getViews()[0];return a.worldToDisplay(e,r,n,t)}function uR(t,e,r,n){var a=t.getRenderWindow().getViews()[0];return a.displayToWorld(e,r,n,t)}var cR={computeWorldToDisplay:fR,computeDisplayToWorld:uR};function gR(t,e){e.classHierarchy.push("vtkInteractorObserver");var r=qp({},t);function n(){for(;e.subscribedEvents.length;)e.subscribedEvents.pop().unsubscribe()}function a(){Ip.handledEvents.forEach(function(i){t["handle".concat(i)]&&e.subscribedEvents.push(e._interactor["on".concat(i)](function(s){return e.processEvents?t["handle".concat(i)](s):oR},e.priority))})}t.setInteractor=function(i){i!==e._interactor&&(n(),e._interactor=i,i&&e.enabled&&a(),t.modified())},t.setEnabled=function(i){i!==e.enabled&&(n(),i&&(e._interactor?a():sR(`
          The interactor must be set before subscribing to events
        `)),e.enabled=i,t.modified())},t.computeDisplayToWorld=function(i,s,f,o){return i?e._interactor.getView().displayToWorld(s,f,o,i):null},t.computeWorldToDisplay=function(i,s,f,o){return i?e._interactor.getView().worldToDisplay(s,f,o,i):null},t.setPriority=function(i){var s=r.setPriority(i);s&&e._interactor&&(n(),a())}}var vR={enabled:!0,priority:0,processEvents:!0,subscribedEvents:[]};function Zp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vR,r),L.obj(t,e),L.event(t,e,"InteractionEvent"),L.event(t,e,"StartInteractionEvent"),L.event(t,e,"EndInteractionEvent"),L.get(t,e,["_interactor","enabled"]),L.setGet(t,e,["priority","processEvents"]),L.moveToProtected(t,e,["interactor"]),gR(t,e)}var lR=L.newInstance(Zp,"vtkInteractorObserver"),pR=qp({newInstance:lR,extend:Zp},cR),hR={IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025},ff={States:hR};function Zc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var It=ff.States,$s={Rotate:It.IS_ROTATE,Pan:It.IS_PAN,Spin:It.IS_SPIN,Dolly:It.IS_DOLLY,CameraPose:It.IS_CAMERA_POSE,WindowLevel:It.IS_WINDOW_LEVEL,Slice:It.IS_SLICE};function dR(t,e){e.classHierarchy.push("vtkInteractorStyle"),Object.keys($s).forEach(function(r){L.event(t,e,"Start".concat(r,"Event")),t["start".concat(r)]=function(){e.state===It.IS_NONE&&(e.state=$s[r],e._interactor.requestAnimation(t),t.invokeStartInteractionEvent({type:"StartInteractionEvent"}),t["invokeStart".concat(r,"Event")]({type:"Start".concat(r,"Event")}))},L.event(t,e,"End".concat(r,"Event")),t["end".concat(r)]=function(){e.state===$s[r]&&(e.state=It.IS_NONE,e._interactor.cancelAnimation(t),t.invokeEndInteractionEvent({type:"EndInteractionEvent"}),t["invokeEnd".concat(r,"Event")]({type:"End".concat(r,"Event")}),e._interactor.render())}}),t.handleKeyPress=function(r){var n=e._interactor,a=null;switch(r.key){case"r":case"R":r.pokedRenderer.resetCamera(),n.render();break;case"w":case"W":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToWireframe&&s.setRepresentationToWireframe()}),n.render();break;case"s":case"S":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToSurface&&s.setRepresentationToSurface()}),n.render();break;case"v":case"V":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToPoints&&s.setRepresentationToPoints()}),n.render();break}}}var TR={state:It.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function Qp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TR,r),pR.extend(t,e,r),dR(t,e)}var SR=L.newInstance(Qp,"vtkInteractorStyle"),CR=yR({newInstance:SR,extend:Qp},ff),Kt=ff.States;function ER(t,e){e.classHierarchy.push("vtkInteractorStyleTrackballCamera"),t.handleMouseMove=function(r){var n=r.position,a=r.pokedRenderer;switch(e.state){case Kt.IS_ROTATE:t.handleMouseRotate(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_PAN:t.handleMousePan(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_DOLLY:t.handleMouseDolly(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_SPIN:t.handleMouseSpin(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break}e.previousPosition=n},t.handleButton3D=function(r){if(r&&r.pressed&&r.device===Mo.RightController&&(r.input===Qn.Trigger||r.input===Qn.TrackPad)){t.startCameraPose();return}r&&!r.pressed&&r.device===Mo.RightController&&(r.input===Qn.Trigger||r.input===Qn.TrackPad)&&e.state===Kt.IS_CAMERA_POSE&&t.endCameraPose()},t.handleMove3D=function(r){switch(e.state){case Kt.IS_CAMERA_POSE:t.updateCameraPose(r);break}},t.updateCameraPose=function(r){var n=r.pokedRenderer.getActiveCamera(),a=n.getPhysicalTranslation(),i=.5,s=i*.05*n.getPhysicalScale(),f=n.physicalOrientationToWorldDirection([r.orientation.x,r.orientation.y,r.orientation.z,r.orientation.w]);n.setPhysicalTranslation(a[0]+f[0]*s,a[1]+f[1]*s,a[2]+f[2]*s)},t.handleLeftButtonPress=function(r){var n=r.position;e.previousPosition=n,r.shiftKey?r.controlKey||r.altKey?t.startDolly():t.startPan():r.controlKey||r.altKey?t.startSpin():t.startRotate()},t.handleLeftButtonRelease=function(){switch(e.state){case Kt.IS_DOLLY:t.endDolly();break;case Kt.IS_PAN:t.endPan();break;case Kt.IS_SPIN:t.endSpin();break;case Kt.IS_ROTATE:t.endRotate();break}},t.handleStartMouseWheel=function(r){t.startDolly(),t.handleMouseWheel(r)},t.handleEndMouseWheel=function(){t.endDolly()},t.handleStartPinch=function(r){e.previousScale=r.scale,t.startDolly()},t.handleEndPinch=function(){t.endDolly()},t.handleStartRotate=function(r){e.previousRotation=r.rotation,t.startRotate()},t.handleEndRotate=function(){t.endRotate()},t.handleStartPan=function(r){e.previousTranslation=r.translation,t.startPan()},t.handleEndPan=function(){t.endPan()},t.handlePinch=function(r){t.dollyByFactor(r.pokedRenderer,r.scale/e.previousScale),e.previousScale=r.scale},t.handlePan=function(r){var n=r.pokedRenderer.getActiveCamera(),a=n.getFocalPoint();a=t.computeWorldToDisplay(r.pokedRenderer,a[0],a[1],a[2]);var i=a[2],s=r.translation,f=e.previousTranslation,o=t.computeDisplayToWorld(r.pokedRenderer,a[0]+s[0]-f[0],a[1]+s[1]-f[1],i),u=t.computeDisplayToWorld(r.pokedRenderer,a[0],a[1],i),g=[];g[0]=u[0]-o[0],g[1]=u[1]-o[1],g[2]=u[2]-o[2],a=n.getFocalPoint();var c=n.getPosition();n.setFocalPoint(g[0]+a[0],g[1]+a[1],g[2]+a[2]),n.setPosition(g[0]+c[0],g[1]+c[1],g[2]+c[2]),e._interactor.getLightFollowCamera()&&r.pokedRenderer.updateLightsGeometryToFollowCamera(),n.orthogonalizeViewUp(),e.previousTranslation=r.translation},t.handleRotate=function(r){var n=r.pokedRenderer.getActiveCamera();n.roll(r.rotation-e.previousRotation),n.orthogonalizeViewUp(),e.previousRotation=r.rotation},t.handleMouseRotate=function(r,n){if(!!e.previousPosition){var a=e._interactor,i=n.x-e.previousPosition.x,s=n.y-e.previousPosition.y,f=a.getView().getViewportSize(r),o=-.1,u=-.1;f[0]&&f[1]&&(o=-20/f[1],u=-20/f[0]);var g=i*u*e.motionFactor,c=s*o*e.motionFactor,l=r.getActiveCamera();!Number.isNaN(g)&&!Number.isNaN(c)&&(l.azimuth(g),l.elevation(c),l.orthogonalizeViewUp()),e.autoAdjustCameraClippingRange&&r.resetCameraClippingRange(),a.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}},t.handleMouseSpin=function(r,n){if(!!e.previousPosition){var a=e._interactor,i=r.getActiveCamera(),s=a.getView().getViewportCenter(r),f=va(Math.atan2(e.previousPosition.y-s[1],e.previousPosition.x-s[0])),o=va(Math.atan2(n.y-s[1],n.x-s[0]))-f;Number.isNaN(o)||(i.roll(o),i.orthogonalizeViewUp())}},t.handleMousePan=function(r,n){if(!!e.previousPosition){var a=r.getActiveCamera(),i=a.getFocalPoint();i=t.computeWorldToDisplay(r,i[0],i[1],i[2]);var s=i[2],f=t.computeDisplayToWorld(r,n.x,n.y,s),o=t.computeDisplayToWorld(r,e.previousPosition.x,e.previousPosition.y,s),u=[];u[0]=o[0]-f[0],u[1]=o[1]-f[1],u[2]=o[2]-f[2],i=a.getFocalPoint();var g=a.getPosition();a.setFocalPoint(u[0]+i[0],u[1]+i[1],u[2]+i[2]),a.setPosition(u[0]+g[0],u[1]+g[1],u[2]+g[2]),e._interactor.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}},t.handleMouseDolly=function(r,n){if(!!e.previousPosition){var a=n.y-e.previousPosition.y,i=e._interactor,s=i.getView().getViewportCenter(r),f=e.motionFactor*a/s[1];t.dollyByFactor(r,Math.pow(1.1,f))}},t.handleMouseWheel=function(r){var n=1-r.spinY/e.zoomFactor;t.dollyByFactor(r.pokedRenderer,n)},t.dollyByFactor=function(r,n){if(!Number.isNaN(n)){var a=r.getActiveCamera();a.getParallelProjection()?a.setParallelScale(a.getParallelScale()/n):(a.dolly(n),e.autoAdjustCameraClippingRange&&r.resetCameraClippingRange()),e._interactor.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}}}var wR={motionFactor:10,zoomFactor:10};function Jp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wR,r),CR.extend(t,e,r),L.setGet(t,e,["motionFactor","zoomFactor"]),ER(t,e)}var xR=L.newInstance(Jp,"vtkInteractorStyleTrackballCamera"),OR={newInstance:xR,extend:Jp};function MR(t,e){var r=t.invokeResize;delete t.invokeResize,e.renderWindow=LD.newInstance(),e.renderer=Jm.newInstance(),e.renderWindow.addRenderer(e.renderer),e.openGLRenderWindow=Fm.newInstance(),e.renderWindow.addView(e.openGLRenderWindow),e.interactor=Ip.newInstance(),e.interactor.setInteractorStyle(OR.newInstance()),e.interactor.setView(e.openGLRenderWindow),e.interactor.initialize(),t.setBackground=e.renderer.setBackground,t.setBackground.apply(t,Ce(e.background)),t.resize=function(){if(e.container){var n=e.container.getBoundingClientRect(),a=window.devicePixelRatio||1;e.openGLRenderWindow.setSize(Math.floor(n.width*a),Math.floor(n.height*a)),r(),e.renderWindow.render()}},t.setContainer=function(n){e.container&&e.interactor.unbindEvents(e.container),e.container=n,e.openGLRenderWindow.setContainer(e.container),e.container&&e.interactor.bindEvents(e.container)},t.delete=L.chain(t.setContainer,e.openGLRenderWindow.delete,t.delete),e.listenWindowResize&&window.addEventListener("resize",t.resize),t.resize()}var DR={background:[.32,.34,.43],listenWindowResize:!0,container:null};function e0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DR,r),L.obj(t,e),L.get(t,e,["renderWindow","renderer","openGLRenderWindow","interactor","container"]),L.event(t,e,"resize"),MR(t,e)}var mR=L.newInstance(e0),RR={newInstance:mR,extend:e0};function LR(t,e){e.classHierarchy.push("vtkAbstractPicker"),t.initialize=function(){e.renderer=null,e.selectionPoint[0]=0,e.selectionPoint[1]=0,e.selectionPoint[2]=0,e.pickPosition[0]=0,e.pickPosition[1]=0,e.pickPosition[2]=0},t.initializePickList=function(){e.pickList=[]},t.addPickList=function(r){e.pickList.push(r)},t.deletePickList=function(r){var n=e.pickList.indexOf(r);n!==-1&&e.pickList.splice(n,1)}}var VR={renderer:null,selectionPoint:[0,0,0],pickPosition:[0,0,0],pickFromList:0,pickList:[]};function t0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VR,r),L.obj(t,e),L.get(t,e,["renderer"]),L.getArray(t,e,["selectionPoint","pickPosition"]),L.setGet(t,e,["pickFromList","pickList"]),LR(t,e)}var _R=L.newInstance(t0,"vtkAbstractPicker"),bR={newInstance:_R,extend:t0};function Qc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function kR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var FR=L.vtkErrorMacro,Jc=L.vtkWarningMacro;function BR(t,e){e.classHierarchy.push("vtkPicker");var r=kR({},t);function n(){r.initialize(),e.actors=[],e.pickedPositions=[],e.mapperPosition[0]=0,e.mapperPosition[1]=0,e.mapperPosition[2]=0,e.mapper=null,e.dataSet=null,e.globalTMin=Number.MAX_VALUE}t.intersectWithLine=function(a,i,s,f){if(!f)return Number.MAX_VALUE;for(var o=f.getCenter(),u=[],g=0;g<3;g++)u[g]=i[g]-a[g];var c=Ee(u,u);if(c===0)return 2;var l=(u[0]*(o[0]-a[0])+u[1]*(o[1]-a[1])+u[2]*(o[2]-a[2]))/c;return l},t.pick=function(a,i){a.length!==3&&Jc("vtkPicker::pick: selectionPt needs three components");var s=a[0],f=a[1],o=a[2],u=[],g=[],c=[],l=[],h=[],y=[],S=[],T,E,x=[],w=[],C=[],m=[],D,b,F=[],U=[],O=0,A=[],W=!1,j=new Float64Array(4),N=new Float64Array(4),I=je.newInstance(),X=[],J=[],P=i.getRenderWindow().getViews()[0];if(n(),e.renderer=i,e.selectionPoint[0]=s,e.selectionPoint[1]=f,e.selectionPoint[2]=o,!i){FR("Picker::Pick Must specify renderer");return}var G=i.getActiveCamera();u=G.getPosition(),g=G.getFocalPoint();var K=P.getViewportSize(i),te=K[0]/K[1];c=i.worldToNormalizedDisplay(g[0],g[1],g[2],te),c=P.normalizedDisplayToDisplay(c[0],c[1],c[2]),o=c[2];var ee=P.displayToNormalizedDisplay(s,f,o);l=i.normalizedDisplayToWorld(ee[0],ee[1],ee[2],te);for(var fe=0;fe<3;fe++)e.pickPosition[fe]=l[fe];for(var ve=0;ve<3;ve++)h[ve]=e.pickPosition[ve]-u[ve];for(var ce=0;ce<3;ce++)y[ce]=g[ce]-u[ce];Mn(y);var pe=Ee(y,h);if(pe===0){Jc("Picker::Pick Cannot process points");return}if(S=G.getClippingRange(),G.getParallelProjection()){T=S[0]-pe,E=S[1]-pe;for(var Re=0;Re<3;Re++)x[Re]=e.pickPosition[Re]+T*y[Re],w[Re]=e.pickPosition[Re]+E*y[Re]}else{T=S[0]/pe,E=S[1]/pe;for(var qe=0;qe<3;qe++)x[qe]=u[qe]+T*h[qe],w[qe]=u[qe]+E*h[qe]}x[3]=1,w[3]=1,C=i.getViewport(),i.getRenderWindow()&&(m=i.getRenderWindow().getViews()[0].getSize()),D=m[0]*C[0],b=m[1]*C[1];var He=P.displayToNormalizedDisplay(D,b,o);F=i.normalizedDisplayToWorld(He[0],He[1],He[2],te),D=m[0]*C[2],b=m[1]*C[3];var We=P.displayToNormalizedDisplay(D,b,o);U=i.normalizedDisplayToWorld(We[0],We[1],We[2],te);for(var tt=0;tt<3;tt++)O+=(U[tt]-F[tt])*(U[tt]-F[tt]);O=Math.sqrt(O)*e.tolerance,e.pickFromList?A=e.pickList:A=i.getActors();var we=[];A.forEach(function(ne){var oe=ne.getMapper();if(W=ne.getNestedPickable()&&ne.getNestedVisibility(),ne.getProperty().getOpacity()<=0&&(W=!1),W){e.transformMatrix=ne.getMatrix().slice(0),ze(e.transformMatrix,e.transformMatrix),xt(e.transformMatrix,e.transformMatrix);var Te=[e.transformMatrix[0],e.transformMatrix[1],e.transformMatrix[2]],ue=[e.transformMatrix[4],e.transformMatrix[5],e.transformMatrix[6]],ie=[e.transformMatrix[8],e.transformMatrix[9],e.transformMatrix[10]];we[0]=ta(Te),we[1]=ta(ue),we[2]=ta(ie),yn(j,x,e.transformMatrix),yn(N,w,e.transformMatrix),j[0]/=j[3],j[1]/=j[3],j[2]/=j[3],N[0]/=N[3],N[1]/=N[3],N[2]/=N[3];for(var Se=0;Se<3;Se++)h[Se]=N[Se]-j[Se];if(oe?(I.setBounds(oe.getBounds()),I.inflate(O)):I.reset(),I.intersectBox(j,h,J,X)&&(X[0]=t.intersectWithLine(j,N,O*.333*(we[0]+we[1]+we[2]),oe),X[0]<Number.MAX_VALUE)){var vt=[];vt[0]=(1-X[0])*x[0]+X[0]*w[0],vt[1]=(1-X[0])*x[1]+X[0]*w[1],vt[2]=(1-X[0])*x[2]+X[0]*w[2];for(var Et=-1,Ft=0;Ft<e.actors.length;Ft++)if(e.actors[Ft]===ne){Et=Ft;break}if(Et===-1)e.actors.push(ne),e.pickedPositions.push(vt);else{var $t=e.pickedPositions[Et],bn=Gt(x,$t),Jr=Gt(x,vt);Jr<bn&&(e.pickedPositions[Et]=vt)}}}return t.invokePickChange(e.pickedPositions),1})}}var NR={tolerance:.025,mapperPosition:[0,0,0],mapper:null,dataSet:null,actors:[],pickedPositions:[],transformMatrix:null,globalTMin:Number.MAX_VALUE};function r0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NR,r),bR.extend(t,e,r),L.setGet(t,e,["tolerance"]),L.setGetArray(t,e,["mapperPosition"],3),L.get(t,e,["mapper","dataSet","actors","pickedPositions"]),L.event(t,e,"pickChange"),BR(t,e)}var UR=L.newInstance(r0,"vtkPicker"),GR={newInstance:UR,extend:r0},AR=L.vtkErrorMacro;function PR(t,e){e.classHierarchy.push("vtkPointPicker"),t.intersectWithLine=function(r,n,a,i){var s=Number.MAX_VALUE;if(i.isA("vtkImageMapper")){var f=i.intersectWithLineForPointPicking(r,n);f&&(s=f.t,e.pointIJK=f.ijk)}else i.isA("vtkMapper")&&(s=t.intersectActorWithLine(r,n,a,i));return s},t.intersectActorWithLine=function(r,n,a,i){var s=i.getInputData(),f=0,o=s.getPoints().getNumberOfPoints();if(o<=f)return 2;for(var u=[],g=0;g<3;g++)u[g]=n[g]-r[g];var c=Ee(u,u);if(c===0)return AR("Cannot process points"),2;var l,h=-1,y=Number.MAX_VALUE,S=Number.MAX_VALUE,T=[],E=[],x=s.getPoints();if(e.useCells)for(var w=s.getPolys().getData(),C=w[0],m=s.getPolys().getNumberOfCells(),D=0;D<m;D++)for(var b=D*C+1,F=b+C,U=b;U<F;U++){var O=w[U];if(x.getPoint(O,E),l=(u[0]*(E[0]-r[0])+u[1]*(E[1]-r[1])+u[2]*(E[2]-r[2]))/c,l>=0&&l<=1&&l<=y+e.tolerance){for(var A=0,W=0;W<3;W++){T[W]=r[W]+l*u[W];var j=Math.abs(E[W]-T[W]);j>A&&(A=j)}A<=a&&A<S&&(h=f,S=A,y=l)}}else for(f=0;f<o;f++)if(x.getPoint(f,E),l=(u[0]*(E[0]-r[0])+u[1]*(E[1]-r[1])+u[2]*(E[2]-r[2]))/c,l>=0&&l<=1&&l<=y+e.tolerance){for(var N=0,I=0;I<3;I++){T[I]=r[I]+l*u[I];var X=Math.abs(E[I]-T[I]);X>N&&(N=X)}N<=a&&N<S&&(h=f,S=N,y=l)}return e.pointId=h,y}}var zR={pointId:-1,pointIJK:[],useCells:!1};function n0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zR,r),GR.extend(t,e,r),L.getArray(t,e,["pointIJK"]),L.get(t,e,["pointId"]),L.setGet(t,e,["useCells"]),PR(t,e)}var WR=L.newInstance(n0,"vtkPointPicker"),eg={newInstance:WR,extend:n0},uf={};function a0(t){return!!uf[t]}function jR(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return uf[t](e)}function i0(t,e){uf[t]=e}var $R={get:jR,has:a0,registerType:i0};function s0(){var t=new ArrayBuffer(4),e=new Uint8Array(t),r=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,r[0]===3569595041?"LittleEndian":r[0]===2712847316?"BigEndian":null}var HR=s0();function KR(t,e){if(!(e<2))for(var r=new Int8Array(t),n=r.length,a=[],i=0;i<n;i+=e){for(var s=0;s<e;s++)a.push(r[i+s]);for(var f=0;f<e;f++)r[i+f]=a.pop()}}var Hs={ENDIANNESS:HR,getEndianness:s0,swapBytes:KR},o0=L.vtkErrorMacro,XR=L.vtkDebugMacro,cf=function(){return o0("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."))},mn=0;function Ki(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new XMLHttpRequest;return n.open(t,e,!0),r.headers&&Object.entries(r.headers).forEach(function(a){var i=Ct(a,2),s=i[0],f=i[1];return n.setRequestHeader(s,f)}),r.progressCallback&&n.addEventListener("progress",r.progressCallback),n}function YR(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,n){var a=Ki("GET",t,e);a.onreadystatechange=function(i){a.readyState===4&&(a.status===200||a.status===0?r(a.response):n({xhr:a,e:i}))},a.responseType="arraybuffer",a.send()})}function IR(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return n&&n.compression?cf():r.ref&&!r.ref.pending?new Promise(function(a,i){var s=[e,r.ref.basepath,r.ref.id].join("/"),f=Ki("GET",s,n);f.onreadystatechange=function(o){f.readyState===1&&(r.ref.pending=!0,++mn===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0)),f.readyState===4&&(r.ref.pending=!1,f.status===200||f.status===0?(r.buffer=f.response,r.ref.encode==="JSON"?r.values=JSON.parse(r.buffer):(Hs.ENDIANNESS!==r.ref.encode&&Hs.ENDIANNESS&&(XR("Swap bytes of ".concat(r.name)),Hs.swapBytes(r.buffer,Yv[r.dataType])),r.values=L.newTypedArray(r.dataType,r.buffer)),r.values.length!==r.size&&o0("Error in FetchArray: ".concat(r.name,", does not have the proper array size. Got ").concat(r.values.length,", instead of ").concat(r.size)),delete r.ref,--mn===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),t!=null&&t.modified&&t.modified(),a(r)):i({xhr:f,e:o}))},f.responseType=r.dataType!=="string"?"arraybuffer":"text",f.send()}):Promise.resolve(r)}function qR(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression?cf():new Promise(function(n,a){var i=Ki("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++mn===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--mn===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?n(JSON.parse(i.responseText)):a({xhr:i,e:s}))},i.responseType="text",i.send()})}function ZR(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression?cf():new Promise(function(n,a){var i=Ki("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++mn===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--mn===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?n(i.responseText):a({xhr:i,e:s}))},i.responseType="text",i.send()})}function QR(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(n,a){var i=new Image;r.crossOrigin&&(i.crossOrigin=r.crossOrigin),i.onload=function(){return n(i)},i.onerror=a,i.src=e})}var JR={fetchArray:IR,fetchJSON:qR,fetchText:ZR,fetchBinary:YR,fetchImage:QR};a0("http")||i0("http",function(t){return JR});function tg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function eL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tg(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ye={};function Ks(t,e,r,n,a){for(var i=0;i<a;i++)r[n+i]=t[e+i]}function tL(t){ye.splitOn=t,ye.pieces=[],ye.v=[],ye.vt=[],ye.vn=[],ye.f=[[]],ye.size=0}function rL(t){var e=t.split("/").map(function(i){return Number(i)}),r=e[0]-1,n=e[1]?e[1]-1:r,a=e[2]?e[2]-1:r;return[r,n,a]}function nL(t){if(t[0]!=="#"){var e=t.split(/[ \t]+/);if(e[0]===ye.splitOn)e.shift(),ye.pieces.push(e.join(" ").trim()),ye.f.push([]),ye.size++;else if(e[0]==="v")ye.v.push(Number(e[1])),ye.v.push(Number(e[2])),ye.v.push(Number(e[3]));else if(e[0]==="vt")ye.vt.push(Number(e[1])),ye.vt.push(Number(e[2]));else if(e[0]==="vn")ye.vn.push(Number(e[1])),ye.vn.push(Number(e[2])),ye.vn.push(Number(e[3]));else if(e[0]==="f"){ye.size===0&&ye.size++;var r=ye.f[ye.size-1];e.shift();var n=e.filter(function(s){return s.length>0&&s!=="\r"}),a=n.length;r.push(a);for(var i=0;i<a;i++)r.push(rL(n[i]))}}}function aL(t){var e=!!ye.vt.length,r=!!ye.vn.length;if(t.splitMode){t.numberOfOutputs=ye.size;for(var n=0;n<ye.size;n++){var a=ye.f[n],i=a.length,s=ye.v.length/3,f={},o=void 0;if(t.trackDuplicates){for(var u=[],g=0,c=0;c<i;)for(var l=a[c++],h=0;h<l;h++){var y=Ct(a[c++],3),S=y[0],T=y[1],E=y[2],x="".concat(S,"/").concat(T,"/").concat(E);f[x]===void 0&&(u[S]===void 0?u[S]=[x]:(u[S].push(x),++g),f[x]=S)}o=new Uint16Array(s+g);for(var w=0,C=0;C<u.length;++C){var m=u[C]?u[C].length:0;o[C]=m>1?s+w:C;for(var D=1;D<m;++D){var b=s+w++;o[b]=C,f[u[C][D]]=b}}}for(var F={},U=Rr.newInstance({name:ye.pieces[n]}),O=[],A=[],W=[],j=[],N=0;N<i;){var I=a[N];j.push(I);for(var X=0;X<I;X++){var J=Ct(a[N+X+1],3),P=J[0],G=J[1],K=J[2],te="".concat(P,"/").concat(G,"/").concat(K);if(F[te]===void 0){var ee=t.trackDuplicates?f[te]:O.length/3;F[te]=ee,Ks(ye.v,P*3,O,ee*3,3),e&&Ks(ye.vt,G*2,A,ee*2,2),r&&Ks(ye.vn,K*3,W,ee*3,3)}j.push(F[te])}N+=I+1}if(U.getPoints().setData(Float32Array.from(O),3),t.trackDuplicates){var fe=Ne.newInstance({name:"Duplicates",values:o});U.getPointData().addArray(fe)}if(U.getPolys().setData(Uint32Array.from(j)),e){var ve=Ne.newInstance({numberOfComponents:2,values:Float32Array.from(A),name:"TextureCoordinates"});U.getPointData().setTCoords(ve)}if(r){var ce=Ne.newInstance({numberOfComponents:3,values:Float32Array.from(W),name:"Normals"});U.getPointData().setNormals(ce)}t.output[n]=U}}else{t.numberOfOutputs=1;var pe=Rr.newInstance();if(pe.getPoints().setData(Float32Array.from(ye.v),3),e&&ye.v.length/3===ye.vt.length/2){var Re=Ne.newInstance({numberOfComponents:2,values:Float32Array.from(ye.vt),name:"TextureCoordinates"});pe.getPointData().setTCoords(Re)}if(r&&ye.v.length===ye.vn.length){var qe=Ne.newInstance({numberOfComponents:3,values:Float32Array.from(ye.vn),name:"Normals"});pe.getPointData().setNormals(qe)}for(var He=[],We=ye.f[0],tt=We.length,we=0;we<tt;){var ne=We[we];He.push(ne);for(var oe=0;oe<ne;oe++){var Te=Ct(We[we+oe+1],1),ue=Te[0];He.push(ue)}we+=ne+1}pe.getPolys().setData(Uint32Array.from(He)),t.output[0]=pe}}function iL(t,e){var r=[],n=t.getPointData().getArrayByName("Duplicates");if(n==null)return r;var a=n.getData(),i=Math.min(e,a[e]);r.push(i);var s=a[i];if(s!==i)for(;s<a.length&&a[s]===i;)r.push(s++);return r}var sL={getPointDuplicateIds:iL};function oL(t,e){e.classHierarchy.push("vtkOBJReader"),e.dataAccessHelper||(e.dataAccessHelper=$R.get("http"));function r(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchText(t,n,a)}t.setUrl=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n.indexOf(".obj")===-1&&!a.fullpath)e.baseURL=n,e.url="".concat(n,"/index.obj");else{e.url=n;var i=n.split("/");i.pop(),e.baseURL=i.join("/")}return t.loadData(a)},t.loadData=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r(e.url,n).then(t.parseAsText)},t.parseAsText=function(n){return n&&(n!==e.parseData&&t.modified(),e.parseData=n,e.numberOfOutputs=0,tL(e.splitMode),n.split(`
`).forEach(nL),aL(e)),!0},t.requestData=function(n,a){t.parseAsText(e.parseData)},t.isBusy=function(){return!!e.requestCount},t.getNumberOfOutputPorts=function(){return e.numberOfOutputs}}var fL={numberOfOutputs:1,requestCount:0,splitMode:null,trackDuplicates:!1};function f0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fL,r),L.obj(t,e),L.get(t,e,["url","baseURL"]),L.setGet(t,e,["dataAccessHelper","splitMode","trackDuplicates"]),L.algo(t,e,0,1),L.event(t,e,"busy"),oL(t,e)}var uL=L.newInstance(f0,"vtkOBJReader"),cL=eL({newInstance:uL,extend:f0},sL);const gL=async t=>{const e=cL.newInstance();if(typeof t=="string")await e.setUrl(t);else{const n=await vL(t);e.parseAsText(n)}return e.update(),e.getOutputData()},vL=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=a=>{e(n.result)},n.readAsText(t)}),lL=t=>{const e=mr.newInstance();e.setInputData(t);const r=Mr.newInstance();return r.setMapper(e),r};function pL(t,e){e.classHierarchy.push("vtkSphereMapper")}var hL={scaleArray:null,radius:.05};function u0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hL,r),mr.extend(t,e,r),L.setGet(t,e,["radius","scaleArray"]),pL(t,e)}var yL=L.newInstance(u0,"vtkSphereMapper"),dL={newInstance:yL,extend:u0},TL=(()=>{var t=import.meta.url;return function(r){r=r||{};var r=typeof r<"u"?r:{},n,a;r.ready=new Promise(function(v,p){n=v,a=p}),Object.getOwnPropertyDescriptor(r.ready,"_main")||(Object.defineProperty(r.ready,"_main",{configurable:!0,get:function(){_e("You are getting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"_main",{configurable:!0,set:function(){_e("You are setting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"___getTypeName")||(Object.defineProperty(r.ready,"___getTypeName",{configurable:!0,get:function(){_e("You are getting ___getTypeName on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"___getTypeName",{configurable:!0,set:function(){_e("You are setting ___getTypeName on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"___embind_register_native_and_builtin_types")||(Object.defineProperty(r.ready,"___embind_register_native_and_builtin_types",{configurable:!0,get:function(){_e("You are getting ___embind_register_native_and_builtin_types on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"___embind_register_native_and_builtin_types",{configurable:!0,set:function(){_e("You are setting ___embind_register_native_and_builtin_types on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"_fflush")||(Object.defineProperty(r.ready,"_fflush",{configurable:!0,get:function(){_e("You are getting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"_fflush",{configurable:!0,set:function(){_e("You are setting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"onRuntimeInitialized")||(Object.defineProperty(r.ready,"onRuntimeInitialized",{configurable:!0,get:function(){_e("You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"onRuntimeInitialized",{configurable:!0,set:function(){_e("You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}));var i=Object.assign({},r),s="./this.program",f=typeof window=="object",o=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g=!f&&!u&&!o;if(r.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");var c="";function l(v){return r.locateFile?r.locateFile(v,c):c+v}var h,y,S,T,E,x;if(u){if(!(typeof process=="object"&&typeof require=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");o?c=require("path").dirname(c)+"/":c=__dirname+"/",x=()=>{E||(T=require("fs"),E=require("path"))},h=function(p,d){return x(),p=E.normalize(p),T.readFileSync(p,d?void 0:"utf8")},S=v=>{var p=h(v,!0);return p.buffer||(p=new Uint8Array(p)),N(p.buffer),p},y=(v,p,d)=>{x(),v=E.normalize(v),T.readFile(v,function(M,V){M?d(M):p(V.buffer)})},process.argv.length>1&&(s=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(v){if(!(v instanceof iy))throw v}),process.on("unhandledRejection",function(v){throw v}),r.inspect=function(){return"[Emscripten Module object]"}}else if(g){if(typeof process=="object"&&typeof require=="function"||typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");typeof read<"u"&&(h=function(p){return read(p)}),S=function(p){let d;return typeof readbuffer=="function"?new Uint8Array(readbuffer(p)):(d=read(p,"binary"),N(typeof d=="object"),d)},y=function(p,d,M){setTimeout(()=>d(S(p)),0)},typeof scriptArgs<"u"&&scriptArgs,typeof print<"u"&&(typeof console>"u"&&(console={}),console.log=print,console.warn=console.error=typeof printErr<"u"?printErr:print)}else if(f||o){if(o?c=self.location.href:typeof document<"u"&&document.currentScript&&(c=document.currentScript.src),t&&(c=t),c.indexOf("blob:")!==0?c=c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):c="",!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");h=v=>{var p=new XMLHttpRequest;return p.open("GET",v,!1),p.send(null),p.responseText},o&&(S=v=>{var p=new XMLHttpRequest;return p.open("GET",v,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),y=(v,p,d)=>{var M=new XMLHttpRequest;M.open("GET",v,!0),M.responseType="arraybuffer",M.onload=()=>{if(M.status==200||M.status==0&&M.response){p(M.response);return}d()},M.onerror=d,M.send(null)}}else throw new Error("environment detection error");var w=r.print||console.log.bind(console),C=r.printErr||console.warn.bind(console);Object.assign(r,i),i=null,Jh(),r.arguments&&r.arguments,D("arguments","arguments_"),r.thisProgram&&(s=r.thisProgram),D("thisProgram","thisProgram"),r.quit&&r.quit,D("quit","quit_"),N(typeof r.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),N(typeof r.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),N(typeof r.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),N(typeof r.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),N(typeof r.read>"u","Module.read option was removed (modify read_ in JS)"),N(typeof r.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),N(typeof r.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),N(typeof r.setWindowTitle>"u","Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),N(typeof r.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),D("read","read_"),D("readAsync","readAsync"),D("readBinary","readBinary"),D("setWindowTitle","setWindowTitle"),N(!g,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable.");function m(v){m.shown||(m.shown={}),m.shown[v]||(m.shown[v]=1,C(v))}function D(v,p){Object.getOwnPropertyDescriptor(r,v)||Object.defineProperty(r,v,{configurable:!0,get:function(){_e("Module."+v+" has been replaced with plain "+p+" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}})}function b(v){Object.getOwnPropertyDescriptor(r,v)&&_e("`Module."+v+"` was supplied but `"+v+"` not included in INCOMING_MODULE_JS_API")}function F(v,p){var d="'"+v+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)";return p&&(d+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),d}function U(v,p){Object.getOwnPropertyDescriptor(r,v)||Object.defineProperty(r,v,{configurable:!0,get:function(){_e(F(v,p))}})}function O(v,p){Object.getOwnPropertyDescriptor(r,v)||(r[v]=()=>_e(F(v,p)))}var A;r.wasmBinary&&(A=r.wasmBinary),D("wasmBinary","wasmBinary"),r.noExitRuntime,D("noExitRuntime","noExitRuntime"),typeof WebAssembly!="object"&&_e("no native wasm support detected");var W,j=!1;function N(v,p){v||_e("Assertion failed"+(p?": "+p:""))}function I(v){var p=r["_"+v];return N(p,"Cannot call unknown function "+v+", make sure it is exported"),p}function X(v,p,d,M,V){var _={string:function(ae){var xe=0;if(ae!=null&&ae!==0){var Ae=(ae.length<<2)+1;xe=Pf(Ae),te(ae,xe,Ae)}return xe},array:function(ae){var xe=Pf(ae.length);return We(ae,xe),xe}};function B(ae){return p==="string"?G(ae):p==="boolean"?Boolean(ae):ae}var k=I(v),z=[],H=0;if(N(p!=="array",'Return type should not be "array".'),M)for(var Q=0;Q<M.length;Q++){var Z=_[d[Q]];Z?(H===0&&(H=ry()),z[Q]=Z(M[Q])):z[Q]=M[Q]}var q=k.apply(null,z);function re(ae){return H!==0&&ny(H),B(ae)}return q=re(q),q}var J=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function P(v,p,d){for(var M=p+d,V=p;v[V]&&!(V>=M);)++V;if(V-p>16&&v.buffer&&J)return J.decode(v.subarray(p,V));for(var _="";p<V;){var B=v[p++];if(!(B&128)){_+=String.fromCharCode(B);continue}var k=v[p++]&63;if((B&224)==192){_+=String.fromCharCode((B&31)<<6|k);continue}var z=v[p++]&63;if((B&240)==224?B=(B&15)<<12|k<<6|z:((B&248)!=240&&m("Invalid UTF-8 leading byte 0x"+B.toString(16)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),B=(B&7)<<18|k<<12|z<<6|v[p++]&63),B<65536)_+=String.fromCharCode(B);else{var H=B-65536;_+=String.fromCharCode(55296|H>>10,56320|H&1023)}}return _}function G(v,p){return v?P(oe,v,p):""}function K(v,p,d,M){if(!(M>0))return 0;for(var V=d,_=d+M-1,B=0;B<v.length;++B){var k=v.charCodeAt(B);if(k>=55296&&k<=57343){var z=v.charCodeAt(++B);k=65536+((k&1023)<<10)|z&1023}if(k<=127){if(d>=_)break;p[d++]=k}else if(k<=2047){if(d+1>=_)break;p[d++]=192|k>>6,p[d++]=128|k&63}else if(k<=65535){if(d+2>=_)break;p[d++]=224|k>>12,p[d++]=128|k>>6&63,p[d++]=128|k&63}else{if(d+3>=_)break;k>1114111&&m("Invalid Unicode code point 0x"+k.toString(16)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),p[d++]=240|k>>18,p[d++]=128|k>>12&63,p[d++]=128|k>>6&63,p[d++]=128|k&63}}return p[d]=0,d-V}function te(v,p,d){return N(typeof d=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),K(v,oe,p,d)}function ee(v){for(var p=0,d=0;d<v.length;++d){var M=v.charCodeAt(d);M>=55296&&M<=57343&&(M=65536+((M&1023)<<10)|v.charCodeAt(++d)&1023),M<=127?++p:M<=2047?p+=2:M<=65535?p+=3:p+=4}return p}var fe=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ve(v,p){N(v%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var d=v,M=d>>1,V=M+p/2;!(M>=V)&&ue[M];)++M;if(d=M<<1,d-v>32&&fe)return fe.decode(oe.subarray(v,d));for(var _="",B=0;!(B>=p/2);++B){var k=Te[v+B*2>>1];if(k==0)break;_+=String.fromCharCode(k)}return _}function ce(v,p,d){if(N(p%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),N(typeof d=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),d===void 0&&(d=2147483647),d<2)return 0;d-=2;for(var M=p,V=d<v.length*2?d/2:v.length,_=0;_<V;++_){var B=v.charCodeAt(_);Te[p>>1]=B,p+=2}return Te[p>>1]=0,p-M}function pe(v){return v.length*2}function Re(v,p){N(v%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");for(var d=0,M="";!(d>=p/4);){var V=ie[v+d*4>>2];if(V==0)break;if(++d,V>=65536){var _=V-65536;M+=String.fromCharCode(55296|_>>10,56320|_&1023)}else M+=String.fromCharCode(V)}return M}function qe(v,p,d){if(N(p%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!"),N(typeof d=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),d===void 0&&(d=2147483647),d<4)return 0;for(var M=p,V=M+d-4,_=0;_<v.length;++_){var B=v.charCodeAt(_);if(B>=55296&&B<=57343){var k=v.charCodeAt(++_);B=65536+((B&1023)<<10)|k&1023}if(ie[p>>2]=B,p+=4,p+4>V)break}return ie[p>>2]=0,p-M}function He(v){for(var p=0,d=0;d<v.length;++d){var M=v.charCodeAt(d);M>=55296&&M<=57343&&++d,p+=4}return p}function We(v,p){N(v.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),ne.set(v,p)}function tt(v,p,d){for(var M=0;M<v.length;++M)N(v.charCodeAt(M)===(v.charCodeAt(M)&255)),ne[p++>>0]=v.charCodeAt(M);d||(ne[p>>0]=0)}var we,ne,oe,Te,ue,ie,Se,vt,Et;function Ft(v){we=v,r.HEAP8=ne=new Int8Array(v),r.HEAP16=Te=new Int16Array(v),r.HEAP32=ie=new Int32Array(v),r.HEAPU8=oe=new Uint8Array(v),r.HEAPU16=ue=new Uint16Array(v),r.HEAPU32=Se=new Uint32Array(v),r.HEAPF32=vt=new Float32Array(v),r.HEAPF64=Et=new Float64Array(v)}var $t=5242880;r.TOTAL_STACK&&N($t===r.TOTAL_STACK,"the stack size can no longer be determined at runtime");var bn=r.INITIAL_MEMORY||16777216;D("INITIAL_MEMORY","INITIAL_MEMORY"),N(bn>=$t,"INITIAL_MEMORY should be larger than TOTAL_STACK, was "+bn+"! (TOTAL_STACK="+$t+")"),N(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support"),N(!r.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),N(bn==16777216,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var Jr;function gf(){var v=vs();N((v&3)==0),ie[v>>2]=34821223,ie[v+4>>2]=2310721022,Se[0]=1668509029}function Ea(){if(!j){var v=vs(),p=Se[v>>2],d=Se[v+4>>2];(p!=34821223||d!=2310721022)&&_e("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x"+d.toString(16)+" 0x"+p.toString(16)),Se[0]!==1668509029&&_e("Runtime error: The application has corrupted its heap memory area (address zero)!")}}(function(){var v=new Int16Array(1),p=new Int8Array(v.buffer);if(v[0]=25459,p[0]!==115||p[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})();var vf=[],lf=[],pf=[],Xi=!1;function c0(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)l0(r.preRun.shift());qi(vf)}function g0(){N(!Xi),Xi=!0,Ea(),!r.noFSInit&&!R.init.initialized&&R.init(),R.ignorePermissions=!1,qi(lf)}function v0(){if(Ea(),r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)h0(r.postRun.shift());qi(pf)}function l0(v){vf.unshift(v)}function p0(v){lf.unshift(v)}function h0(v){pf.unshift(v)}N(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),N(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),N(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),N(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var Vr=0,_r=null,kn=null,en={};function hf(v){for(var p=v;;){if(!en[v])return v;v=p+Math.random()}}function Yi(v){Vr++,r.monitorRunDependencies&&r.monitorRunDependencies(Vr),v?(N(!en[v]),en[v]=1,_r===null&&typeof setInterval<"u"&&(_r=setInterval(function(){if(j){clearInterval(_r),_r=null;return}var p=!1;for(var d in en)p||(p=!0,C("still waiting on run dependencies:")),C("dependency: "+d);p&&C("(end of list)")},1e4))):C("warning: run dependency added without ID")}function wa(v){if(Vr--,r.monitorRunDependencies&&r.monitorRunDependencies(Vr),v?(N(en[v]),delete en[v]):C("warning: run dependency removed without ID"),Vr==0&&(_r!==null&&(clearInterval(_r),_r=null),kn)){var p=kn;kn=null,p()}}function _e(v){r.onAbort&&r.onAbort(v),v="Aborted("+v+")",C(v),j=!0;var p=new WebAssembly.RuntimeError(v);throw a(p),p}var y0="data:application/octet-stream;base64,";function yf(v){return v.startsWith(y0)}function Ii(v){return v.startsWith("file://")}function ft(v,p){return function(){var d=v,M=p;return p||(M=r.asm),N(Xi,"native function `"+d+"` called before runtime initialization"),M[v]||N(M[v],"exported native function `"+d+"` not found"),M[v].apply(null,arguments)}}var it;r.locateFile?(it="utils.wasm",yf(it)||(it=l(it))):it=new URL("/assets/utils.a10d1552.wasm",self.location).toString();function df(v){try{if(v==it&&A)return new Uint8Array(A);if(S)return S(v);throw"both async and sync fetching of the wasm failed"}catch(p){_e(p)}}function d0(){if(!A&&(f||o)){if(typeof fetch=="function"&&!Ii(it))return fetch(it,{credentials:"same-origin"}).then(function(v){if(!v.ok)throw"failed to load wasm binary file at '"+it+"'";return v.arrayBuffer()}).catch(function(){return df(it)});if(y)return new Promise(function(v,p){y(it,function(d){v(new Uint8Array(d))},p)})}return Promise.resolve().then(function(){return df(it)})}function T0(){var v={env:Gf,wasi_snapshot_preview1:Gf};function p(k,z){var H=k.exports;r.asm=H,W=r.asm.memory,N(W,"memory not found in wasm exports"),Ft(W.buffer),Jr=r.asm.__indirect_function_table,N(Jr,"table not found in wasm exports"),p0(r.asm.__wasm_call_ctors),wa("wasm-instantiate")}Yi("wasm-instantiate");var d=r;function M(k){N(r===d,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),d=null,p(k.instance)}function V(k){return d0().then(function(z){return WebAssembly.instantiate(z,v)}).then(function(z){return z}).then(k,function(z){C("failed to asynchronously prepare wasm: "+z),Ii(it)&&C("warning: Loading from a file URI ("+it+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing"),_e(z)})}function _(){return!A&&typeof WebAssembly.instantiateStreaming=="function"&&!yf(it)&&!Ii(it)&&!u&&typeof fetch=="function"?fetch(it,{credentials:"same-origin"}).then(function(k){var z=WebAssembly.instantiateStreaming(k,v);return z.then(M,function(H){return C("wasm streaming compile failed: "+H),C("falling back to ArrayBuffer instantiation"),V(M)})}):V(M)}if(r.instantiateWasm)try{var B=r.instantiateWasm(v,p);return B}catch(k){return C("Module.instantiateWasm callback failed with error: "+k),!1}return _().catch(a),{}}var rt,Zt;function qi(v){for(;v.length>0;){var p=v.shift();if(typeof p=="function"){p(r);continue}var d=p.func;typeof d=="number"?p.arg===void 0?Fn(d)():Fn(d)(p.arg):d(p.arg===void 0?null:p.arg)}}function S0(v){return m("warning: build with -sDEMANGLE_SUPPORT to link in libcxxabi demangling"),v}function C0(v){var p=/\b_Z[\w\d_]+/g;return v.replace(p,function(d){var M=S0(d);return d===M?d:M+" ["+d+"]"})}var xa=[];function Fn(v){var p=xa[v];return p||(v>=xa.length&&(xa.length=v+1),xa[v]=p=Jr.get(v)),N(Jr.get(v)==p,"JavaScript-side Wasm function table mirror is out of date!"),p}function E0(v,p,d,M){_e("Assertion failed: "+G(v)+", at: "+[p?G(p):"unknown filename",d,M?G(M):"unknown function"])}function w0(v){return gs(v+24)+24}function x0(v){this.excPtr=v,this.ptr=v-24,this.set_type=function(p){Se[this.ptr+4>>2]=p},this.get_type=function(){return Se[this.ptr+4>>2]},this.set_destructor=function(p){Se[this.ptr+8>>2]=p},this.get_destructor=function(){return Se[this.ptr+8>>2]},this.set_refcount=function(p){ie[this.ptr>>2]=p},this.set_caught=function(p){p=p?1:0,ne[this.ptr+12>>0]=p},this.get_caught=function(){return ne[this.ptr+12>>0]!=0},this.set_rethrown=function(p){p=p?1:0,ne[this.ptr+13>>0]=p},this.get_rethrown=function(){return ne[this.ptr+13>>0]!=0},this.init=function(p,d){this.set_adjusted_ptr(0),this.set_type(p),this.set_destructor(d),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var p=ie[this.ptr>>2];ie[this.ptr>>2]=p+1},this.release_ref=function(){var p=ie[this.ptr>>2];return ie[this.ptr>>2]=p-1,N(p>0),p===1},this.set_adjusted_ptr=function(p){Se[this.ptr+16>>2]=p},this.get_adjusted_ptr=function(){return Se[this.ptr+16>>2]},this.get_exception_ptr=function(){var p=ay(this.get_type());if(p)return Se[this.excPtr>>2];var d=this.get_adjusted_ptr();return d!==0?d:this.excPtr}}function O0(v,p,d){var M=new x0(v);throw M.init(p,d),v+" - Exception catching is disabled, this exception cannot be caught. Compile with -sNO_DISABLE_EXCEPTION_CATCHING or -sEXCEPTION_CATCHING_ALLOWED=[..] to catch."}function M0(v,p,d,M,V){}function Zi(v){switch(v){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+v)}}function D0(){for(var v=new Array(256),p=0;p<256;++p)v[p]=String.fromCharCode(p);Tf=v}var Tf=void 0;function wt(v){for(var p="",d=v;oe[d];)p+=Tf[oe[d++]];return p}var tn={},br={},Oa={},m0=48,R0=57;function Ma(v){if(v===void 0)return"_unknown";v=v.replace(/[^a-zA-Z0-9_]/g,"$");var p=v.charCodeAt(0);return p>=m0&&p<=R0?"_"+v:v}function Qi(v,p){return v=Ma(v),new Function("body","return function "+v+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(p)}function Ji(v,p){var d=Qi(p,function(M){this.name=p,this.message=M;var V=new Error(M).stack;V!==void 0&&(this.stack=this.toString()+`
`+V.replace(/^Error(:[^\n]*)?\n/,""))});return d.prototype=Object.create(v.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},d}var rn=void 0;function Le(v){throw new rn(v)}var Sf=void 0;function Da(v){throw new Sf(v)}function Bn(v,p,d){v.forEach(function(k){Oa[k]=p});function M(k){var z=d(k);z.length!==v.length&&Da("Mismatched type converter count");for(var H=0;H<v.length;++H)Qt(v[H],z[H])}var V=new Array(p.length),_=[],B=0;p.forEach((k,z)=>{br.hasOwnProperty(k)?V[z]=br[k]:(_.push(k),tn.hasOwnProperty(k)||(tn[k]=[]),tn[k].push(()=>{V[z]=br[k],++B,B===_.length&&M(V)}))}),_.length===0&&M(V)}function Qt(v,p,d={}){if(!("argPackAdvance"in p))throw new TypeError("registerType registeredInstance requires argPackAdvance");var M=p.name;if(v||Le('type "'+M+'" must have a positive integer typeid pointer'),br.hasOwnProperty(v)){if(d.ignoreDuplicateRegistrations)return;Le("Cannot register type '"+M+"' twice")}if(br[v]=p,delete Oa[v],tn.hasOwnProperty(v)){var V=tn[v];delete tn[v],V.forEach(_=>_())}}function L0(v,p,d,M,V){var _=Zi(d);p=wt(p),Qt(v,{name:p,fromWireType:function(B){return!!B},toWireType:function(B,k){return k?M:V},argPackAdvance:8,readValueFromPointer:function(B){var k;if(d===1)k=ne;else if(d===2)k=Te;else if(d===4)k=ie;else throw new TypeError("Unknown boolean type size: "+p);return this.fromWireType(k[B>>_])},destructorFunction:null})}function V0(v){if(!(this instanceof ur)||!(v instanceof ur))return!1;for(var p=this.$$.ptrType.registeredClass,d=this.$$.ptr,M=v.$$.ptrType.registeredClass,V=v.$$.ptr;p.baseClass;)d=p.upcast(d),p=p.baseClass;for(;M.baseClass;)V=M.upcast(V),M=M.baseClass;return p===M&&d===V}function _0(v){return{count:v.count,deleteScheduled:v.deleteScheduled,preservePointerOnDelete:v.preservePointerOnDelete,ptr:v.ptr,ptrType:v.ptrType,smartPtr:v.smartPtr,smartPtrType:v.smartPtrType}}function es(v){function p(d){return d.$$.ptrType.registeredClass.name}Le(p(v)+" instance already deleted")}var ts=!1;function Cf(v){}function b0(v){v.smartPtr?v.smartPtrType.rawDestructor(v.smartPtr):v.ptrType.registeredClass.rawDestructor(v.ptr)}function Ef(v){v.count.value-=1;var p=v.count.value===0;p&&b0(v)}function wf(v,p,d){if(p===d)return v;if(d.baseClass===void 0)return null;var M=wf(v,p,d.baseClass);return M===null?null:d.downcast(M)}var xf={};function k0(){return Object.keys(Gn).length}function F0(){var v=[];for(var p in Gn)Gn.hasOwnProperty(p)&&v.push(Gn[p]);return v}var Nn=[];function rs(){for(;Nn.length;){var v=Nn.pop();v.$$.deleteScheduled=!1,v.delete()}}var Un=void 0;function B0(v){Un=v,Nn.length&&Un&&Un(rs)}function N0(){r.getInheritedInstanceCount=k0,r.getLiveInheritedInstances=F0,r.flushPendingDeletes=rs,r.setDelayFunction=B0}var Gn={};function U0(v,p){for(p===void 0&&Le("ptr should not be undefined");v.baseClass;)p=v.upcast(p),v=v.baseClass;return p}function G0(v,p){return p=U0(v,p),Gn[p]}function ma(v,p){(!p.ptrType||!p.ptr)&&Da("makeClassHandle requires ptr and ptrType");var d=!!p.smartPtrType,M=!!p.smartPtr;return d!==M&&Da("Both smartPtrType and smartPtr must be specified"),p.count={value:1},An(Object.create(v,{$$:{value:p}}))}function Of(v){var p=this.getPointee(v);if(!p)return this.destructor(v),null;var d=G0(this.registeredClass,p);if(d!==void 0){if(d.$$.count.value===0)return d.$$.ptr=p,d.$$.smartPtr=v,d.clone();var M=d.clone();return this.destructor(v),M}function V(){return this.isSmartPointer?ma(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:p,smartPtrType:this,smartPtr:v}):ma(this.registeredClass.instancePrototype,{ptrType:this,ptr:v})}var _=this.registeredClass.getActualType(p),B=xf[_];if(!B)return V.call(this);var k;this.isConst?k=B.constPointerType:k=B.pointerType;var z=wf(p,this.registeredClass,k.registeredClass);return z===null?V.call(this):this.isSmartPointer?ma(k.registeredClass.instancePrototype,{ptrType:k,ptr:z,smartPtrType:this,smartPtr:v}):ma(k.registeredClass.instancePrototype,{ptrType:k,ptr:z})}function An(v){return typeof FinalizationRegistry>"u"?(An=p=>p,v):(ts=new FinalizationRegistry(p=>{console.warn(p.leakWarning.stack.replace(/^Error: /,"")),Ef(p.$$)}),An=p=>{var d=p.$$,M=!!d.smartPtr;if(M){var V={$$:d},_=d.ptrType.registeredClass;V.leakWarning=new Error("Embind found a leaked C++ instance "+_.name+" <0x"+d.ptr.toString(16)+`>.
We'll free it automatically in this case, but this functionality is not reliable across various environments.
Make sure to invoke .delete() manually once you're done with the instance instead.
Originally allocated`),"captureStackTrace"in Error&&Error.captureStackTrace(V.leakWarning,Of),ts.register(p,V,p)}return p},Cf=p=>ts.unregister(p),An(v))}function A0(){if(this.$$.ptr||es(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var v=An(Object.create(Object.getPrototypeOf(this),{$$:{value:_0(this.$$)}}));return v.$$.count.value+=1,v.$$.deleteScheduled=!1,v}function P0(){this.$$.ptr||es(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Le("Object already scheduled for deletion"),Cf(this),Ef(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function z0(){return!this.$$.ptr}function W0(){return this.$$.ptr||es(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Le("Object already scheduled for deletion"),Nn.push(this),Nn.length===1&&Un&&Un(rs),this.$$.deleteScheduled=!0,this}function j0(){ur.prototype.isAliasOf=V0,ur.prototype.clone=A0,ur.prototype.delete=P0,ur.prototype.isDeleted=z0,ur.prototype.deleteLater=W0}function ur(){}function Mf(v,p,d){if(v[p].overloadTable===void 0){var M=v[p];v[p]=function(){return v[p].overloadTable.hasOwnProperty(arguments.length)||Le("Function '"+d+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+v[p].overloadTable+")!"),v[p].overloadTable[arguments.length].apply(this,arguments)},v[p].overloadTable=[],v[p].overloadTable[M.argCount]=M}}function $0(v,p,d){r.hasOwnProperty(v)?((d===void 0||r[v].overloadTable!==void 0&&r[v].overloadTable[d]!==void 0)&&Le("Cannot register public name '"+v+"' twice"),Mf(r,v,v),r.hasOwnProperty(d)&&Le("Cannot register multiple overloads of a function with the same number of arguments ("+d+")!"),r[v].overloadTable[d]=p):(r[v]=p,d!==void 0&&(r[v].numArguments=d))}function H0(v,p,d,M,V,_,B,k){this.name=v,this.constructor=p,this.instancePrototype=d,this.rawDestructor=M,this.baseClass=V,this.getActualType=_,this.upcast=B,this.downcast=k,this.pureVirtualFunctions=[]}function ns(v,p,d){for(;p!==d;)p.upcast||Le("Expected null or instance of "+d.name+", got an instance of "+p.name),v=p.upcast(v),p=p.baseClass;return v}function K0(v,p){if(p===null)return this.isReference&&Le("null is not a valid "+this.name),0;p.$$||Le('Cannot pass "'+an(p)+'" as a '+this.name),p.$$.ptr||Le("Cannot pass deleted object as a pointer of type "+this.name);var d=p.$$.ptrType.registeredClass,M=ns(p.$$.ptr,d,this.registeredClass);return M}function X0(v,p){var d;if(p===null)return this.isReference&&Le("null is not a valid "+this.name),this.isSmartPointer?(d=this.rawConstructor(),v!==null&&v.push(this.rawDestructor,d),d):0;p.$$||Le('Cannot pass "'+an(p)+'" as a '+this.name),p.$$.ptr||Le("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&p.$$.ptrType.isConst&&Le("Cannot convert argument of type "+(p.$$.smartPtrType?p.$$.smartPtrType.name:p.$$.ptrType.name)+" to parameter type "+this.name);var M=p.$$.ptrType.registeredClass;if(d=ns(p.$$.ptr,M,this.registeredClass),this.isSmartPointer)switch(p.$$.smartPtr===void 0&&Le("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:p.$$.smartPtrType===this?d=p.$$.smartPtr:Le("Cannot convert argument of type "+(p.$$.smartPtrType?p.$$.smartPtrType.name:p.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:d=p.$$.smartPtr;break;case 2:if(p.$$.smartPtrType===this)d=p.$$.smartPtr;else{var V=p.clone();d=this.rawShare(d,Dt.toHandle(function(){V.delete()})),v!==null&&v.push(this.rawDestructor,d)}break;default:Le("Unsupporting sharing policy")}return d}function Y0(v,p){if(p===null)return this.isReference&&Le("null is not a valid "+this.name),0;p.$$||Le('Cannot pass "'+an(p)+'" as a '+this.name),p.$$.ptr||Le("Cannot pass deleted object as a pointer of type "+this.name),p.$$.ptrType.isConst&&Le("Cannot convert argument of type "+p.$$.ptrType.name+" to parameter type "+this.name);var d=p.$$.ptrType.registeredClass,M=ns(p.$$.ptr,d,this.registeredClass);return M}function Ra(v){return this.fromWireType(Se[v>>2])}function I0(v){return this.rawGetPointee&&(v=this.rawGetPointee(v)),v}function q0(v){this.rawDestructor&&this.rawDestructor(v)}function Z0(v){v!==null&&v.delete()}function Q0(){Jt.prototype.getPointee=I0,Jt.prototype.destructor=q0,Jt.prototype.argPackAdvance=8,Jt.prototype.readValueFromPointer=Ra,Jt.prototype.deleteObject=Z0,Jt.prototype.fromWireType=Of}function Jt(v,p,d,M,V,_,B,k,z,H,Q){this.name=v,this.registeredClass=p,this.isReference=d,this.isConst=M,this.isSmartPointer=V,this.pointeeType=_,this.sharingPolicy=B,this.rawGetPointee=k,this.rawConstructor=z,this.rawShare=H,this.rawDestructor=Q,!V&&p.baseClass===void 0?M?(this.toWireType=K0,this.destructorFunction=null):(this.toWireType=Y0,this.destructorFunction=null):this.toWireType=X0}function J0(v,p,d){r.hasOwnProperty(v)||Da("Replacing nonexistant public symbol"),r[v].overloadTable!==void 0&&d!==void 0?r[v].overloadTable[d]=p:(r[v]=p,r[v].argCount=d)}function eh(v,p,d){N("dynCall_"+v in r,"bad function pointer type - no table for sig '"+v+"'"),d&&d.length?N(d.length===v.substring(1).replace(/j/g,"--").length):N(v.length==1);var M=r["dynCall_"+v];return d&&d.length?M.apply(null,[p].concat(d)):M.call(null,p)}function th(v,p,d){return v.includes("j")?eh(v,p,d):(N(Fn(p),"missing table entry in dynCall: "+p),Fn(p).apply(null,d))}function rh(v,p){N(v.includes("j"),"getDynCaller should only be called with i64 sigs");var d=[];return function(){return d.length=0,Object.assign(d,arguments),th(v,p,d)}}function nn(v,p){v=wt(v);function d(){return v.includes("j")?rh(v,p):Fn(p)}var M=d();return typeof M!="function"&&Le("unknown function pointer with signature "+v+": "+p),M}var Df=void 0;function mf(v){var p=ey(v),d=wt(p);return cr(p),d}function as(v,p){var d=[],M={};function V(_){if(!M[_]&&!br[_]){if(Oa[_]){Oa[_].forEach(V);return}d.push(_),M[_]=!0}}throw p.forEach(V),new Df(v+": "+d.map(mf).join([", "]))}function nh(v,p,d,M,V,_,B,k,z,H,Q,Z,q){Q=wt(Q),_=nn(V,_),k&&(k=nn(B,k)),H&&(H=nn(z,H)),q=nn(Z,q);var re=Ma(Q);$0(re,function(){as("Cannot construct "+Q+" due to unbound types",[M])}),Bn([v,p,d],M?[M]:[],function(ae){ae=ae[0];var xe,Ae;M?(xe=ae.registeredClass,Ae=xe.instancePrototype):Ae=ur.prototype;var Xe=Qi(re,function(){if(Object.getPrototypeOf(this)!==Y)throw new rn("Use 'new' to construct "+Q);if(se.constructor_body===void 0)throw new rn(Q+" has no accessible constructor");var Ye=se.constructor_body[arguments.length];if(Ye===void 0)throw new rn("Tried to invoke ctor of "+Q+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(se.constructor_body).toString()+") parameters instead!");return Ye.apply(this,arguments)}),Y=Object.create(Ae,{constructor:{value:Xe}});Xe.prototype=Y;var se=new H0(Q,Xe,Y,q,xe,_,k,H),Ze=new Jt(Q,se,!0,!1,!1),Fe=new Jt(Q+"*",se,!1,!1,!1),dt=new Jt(Q+" const*",se,!1,!0,!1);return xf[v]={pointerType:Fe,constPointerType:dt},J0(re,Xe),[Ze,Fe,dt]})}function Rf(v,p){for(var d=[],M=0;M<v;M++)d.push(ie[(p>>2)+M]);return d}function Lf(v){for(;v.length;){var p=v.pop(),d=v.pop();d(p)}}function ah(v,p,d,M,V,_){N(p>0);var B=Rf(p,d);V=nn(M,V),Bn([],[v],function(k){k=k[0];var z="constructor "+k.name;if(k.registeredClass.constructor_body===void 0&&(k.registeredClass.constructor_body=[]),k.registeredClass.constructor_body[p-1]!==void 0)throw new rn("Cannot register multiple constructors with identical number of parameters ("+(p-1)+") for class '"+k.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return k.registeredClass.constructor_body[p-1]=()=>{as("Cannot construct "+k.name+" due to unbound types",B)},Bn([],B,function(H){return H.splice(1,0,null),k.registeredClass.constructor_body[p-1]=_f(z,H,null,V,_),[]}),[]})}function Vf(v,p){if(!(v instanceof Function))throw new TypeError("new_ called with constructor type "+typeof v+" which is not a function");var d=Qi(v.name||"unknownFunctionName",function(){});d.prototype=v.prototype;var M=new d,V=v.apply(M,p);return V instanceof Object?V:M}function _f(v,p,d,M,V){var _=p.length;_<2&&Le("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var B=p[1]!==null&&d!==null,k=!1,z=1;z<p.length;++z)if(p[z]!==null&&p[z].destructorFunction===void 0){k=!0;break}for(var H=p[0].name!=="void",Q="",Z="",z=0;z<_-2;++z)Q+=(z!==0?", ":"")+"arg"+z,Z+=(z!==0?", ":"")+"arg"+z+"Wired";var q="return function "+Ma(v)+"("+Q+`) {
if (arguments.length !== `+(_-2)+`) {
throwBindingError('function `+v+" called with ' + arguments.length + ' arguments, expected "+(_-2)+` args!');
}
`;k&&(q+=`var destructors = [];
`);var re=k?"destructors":"null",ae=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],xe=[Le,M,V,Lf,p[0],p[1]];B&&(q+="var thisWired = classParam.toWireType("+re+`, this);
`);for(var z=0;z<_-2;++z)q+="var arg"+z+"Wired = argType"+z+".toWireType("+re+", arg"+z+"); // "+p[z+2].name+`
`,ae.push("argType"+z),xe.push(p[z+2]);if(B&&(Z="thisWired"+(Z.length>0?", ":"")+Z),q+=(H?"var rv = ":"")+"invoker(fn"+(Z.length>0?", ":"")+Z+`);
`,k)q+=`runDestructors(destructors);
`;else for(var z=B?1:2;z<p.length;++z){var Ae=z===1?"thisWired":"arg"+(z-2)+"Wired";p[z].destructorFunction!==null&&(q+=Ae+"_dtor("+Ae+"); // "+p[z].name+`
`,ae.push(Ae+"_dtor"),xe.push(p[z].destructorFunction))}H&&(q+=`var ret = retType.fromWireType(rv);
return ret;
`),q+=`}
`,ae.push(q);var Xe=Vf(Function,ae).apply(null,xe);return Xe}function ih(v,p,d,M,V,_,B,k){var z=Rf(d,M);p=wt(p),_=nn(V,_),Bn([],[v],function(H){H=H[0];var Q=H.name+"."+p;p.startsWith("@@")&&(p=Symbol[p.substring(2)]),k&&H.registeredClass.pureVirtualFunctions.push(p);function Z(){as("Cannot call "+Q+" due to unbound types",z)}var q=H.registeredClass.instancePrototype,re=q[p];return re===void 0||re.overloadTable===void 0&&re.className!==H.name&&re.argCount===d-2?(Z.argCount=d-2,Z.className=H.name,q[p]=Z):(Mf(q,p,Q),q[p].overloadTable[d-2]=Z),Bn([],z,function(ae){var xe=_f(Q,ae,H,_,B);return q[p].overloadTable===void 0?(xe.argCount=d-2,q[p]=xe):q[p].overloadTable[d-2]=xe,[]}),[]})}var is=[],Bt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ss(v){v>4&&--Bt[v].refcount===0&&(Bt[v]=void 0,is.push(v))}function sh(){for(var v=0,p=5;p<Bt.length;++p)Bt[p]!==void 0&&++v;return v}function oh(){for(var v=5;v<Bt.length;++v)if(Bt[v]!==void 0)return Bt[v];return null}function fh(){r.count_emval_handles=sh,r.get_first_emval=oh}var Dt={toValue:v=>(v||Le("Cannot use deleted val. handle = "+v),Bt[v].value),toHandle:v=>{switch(v){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var p=is.length?is.pop():Bt.length;return Bt[p]={refcount:1,value:v},p}}}};function uh(v,p){p=wt(p),Qt(v,{name:p,fromWireType:function(d){var M=Dt.toValue(d);return ss(d),M},toWireType:function(d,M){return Dt.toHandle(M)},argPackAdvance:8,readValueFromPointer:Ra,destructorFunction:null})}function an(v){if(v===null)return"null";var p=typeof v;return p==="object"||p==="array"||p==="function"?v.toString():""+v}function ch(v,p){switch(p){case 2:return function(d){return this.fromWireType(vt[d>>2])};case 3:return function(d){return this.fromWireType(Et[d>>3])};default:throw new TypeError("Unknown float type: "+v)}}function gh(v,p,d){var M=Zi(d);p=wt(p),Qt(v,{name:p,fromWireType:function(V){return V},toWireType:function(V,_){if(typeof _!="number"&&typeof _!="boolean")throw new TypeError('Cannot convert "'+an(_)+'" to '+this.name);return _},argPackAdvance:8,readValueFromPointer:ch(p,M),destructorFunction:null})}function vh(v,p,d){switch(p){case 0:return d?function(V){return ne[V]}:function(V){return oe[V]};case 1:return d?function(V){return Te[V>>1]}:function(V){return ue[V>>1]};case 2:return d?function(V){return ie[V>>2]}:function(V){return Se[V>>2]};default:throw new TypeError("Unknown integer type: "+v)}}function lh(v,p,d,M,V){p=wt(p),V===-1&&(V=4294967295);var _=Zi(d),B=Z=>Z;if(M===0){var k=32-8*d;B=Z=>Z<<k>>>k}var z=p.includes("unsigned"),H=(Z,q)=>{if(typeof Z!="number"&&typeof Z!="boolean")throw new TypeError('Cannot convert "'+an(Z)+'" to '+q);if(Z<M||Z>V)throw new TypeError('Passing a number "'+an(Z)+'" from JS side to C/C++ side to an argument of type "'+p+'", which is outside the valid range ['+M+", "+V+"]!")},Q;z?Q=function(Z,q){return H(q,this.name),q>>>0}:Q=function(Z,q){return H(q,this.name),q},Qt(v,{name:p,fromWireType:B,toWireType:Q,argPackAdvance:8,readValueFromPointer:vh(p,_,M!==0),destructorFunction:null})}function ph(v,p,d){var M=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],V=M[p];function _(B){B=B>>2;var k=Se,z=k[B],H=k[B+1];return new V(we,H,z)}d=wt(d),Qt(v,{name:d,fromWireType:_,argPackAdvance:8,readValueFromPointer:_},{ignoreDuplicateRegistrations:!0})}function hh(v,p){p=wt(p);var d=p==="std::string";Qt(v,{name:p,fromWireType:function(M){var V=Se[M>>2],_;if(d)for(var B=M+4,k=0;k<=V;++k){var z=M+4+k;if(k==V||oe[z]==0){var H=z-B,Q=G(B,H);_===void 0?_=Q:(_+=String.fromCharCode(0),_+=Q),B=z+1}}else{for(var Z=new Array(V),k=0;k<V;++k)Z[k]=String.fromCharCode(oe[M+4+k]);_=Z.join("")}return cr(M),_},toWireType:function(M,V){V instanceof ArrayBuffer&&(V=new Uint8Array(V));var _,B=typeof V=="string";B||V instanceof Uint8Array||V instanceof Uint8ClampedArray||V instanceof Int8Array||Le("Cannot pass non-string to std::string"),d&&B?_=()=>ee(V):_=()=>V.length;var k=_(),z=gs(4+k+1);if(Se[z>>2]=k,d&&B)te(V,z+4,k+1);else if(B)for(var H=0;H<k;++H){var Q=V.charCodeAt(H);Q>255&&(cr(z),Le("String has UTF-16 code units that do not fit in 8 bits")),oe[z+4+H]=Q}else for(var H=0;H<k;++H)oe[z+4+H]=V[H];return M!==null&&M.push(cr,z),z},argPackAdvance:8,readValueFromPointer:Ra,destructorFunction:function(M){cr(M)}})}function yh(v,p,d){d=wt(d);var M,V,_,B,k;p===2?(M=ve,V=ce,B=pe,_=()=>ue,k=1):p===4&&(M=Re,V=qe,B=He,_=()=>Se,k=2),Qt(v,{name:d,fromWireType:function(z){for(var H=Se[z>>2],Q=_(),Z,q=z+4,re=0;re<=H;++re){var ae=z+4+re*p;if(re==H||Q[ae>>k]==0){var xe=ae-q,Ae=M(q,xe);Z===void 0?Z=Ae:(Z+=String.fromCharCode(0),Z+=Ae),q=ae+p}}return cr(z),Z},toWireType:function(z,H){typeof H!="string"&&Le("Cannot pass non-string to C++ string type "+d);var Q=B(H),Z=gs(4+Q+p);return Se[Z>>2]=Q>>k,V(H,Z+4,Q+p),z!==null&&z.push(cr,Z),Z},argPackAdvance:8,readValueFromPointer:Ra,destructorFunction:function(z){cr(z)}})}function dh(v,p){p=wt(p),Qt(v,{isVoid:!0,name:p,argPackAdvance:0,fromWireType:function(){},toWireType:function(d,M){}})}function os(v,p){var d=br[v];return d===void 0&&Le(p+" has unknown type "+mf(v)),d}function Th(v,p,d){v=Dt.toValue(v),p=os(p,"emval::as");var M=[],V=Dt.toHandle(M);return ie[d>>2]=V,p.toWireType(M,v)}var Sh={};function bf(v){var p=Sh[v];return p===void 0?wt(v):p}var fs=[];function Ch(v,p,d,M){v=fs[v],p=Dt.toValue(p),d=bf(d),v(p,d,null,M)}function Eh(v){var p=fs.length;return fs.push(v),p}function wh(v,p){for(var d=new Array(v),M=0;M<v;++M)d[M]=os(ie[(p>>2)+M],"parameter "+M);return d}var kf=[];function xh(v,p){var d=wh(v,p),M=d[0],V=M.name+"_$"+d.slice(1).map(function(ae){return ae.name}).join("_")+"$",_=kf[V];if(_!==void 0)return _;for(var B=["retType"],k=[M],z="",H=0;H<v-1;++H)z+=(H!==0?", ":"")+"arg"+H,B.push("argType"+H),k.push(d[1+H]);for(var Q=Ma("methodCaller_"+V),Z="return function "+Q+`(handle, name, destructors, args) {
`,q=0,H=0;H<v-1;++H)Z+="    var arg"+H+" = argType"+H+".readValueFromPointer(args"+(q?"+"+q:"")+`);
`,q+=d[H+1].argPackAdvance;Z+="    var rv = handle[name]("+z+`);
`;for(var H=0;H<v-1;++H)d[H+1].deleteObject&&(Z+="    argType"+H+".deleteObject(arg"+H+`);
`);M.isVoid||(Z+=`    return retType.toWireType(destructors, rv);
`),Z+=`};
`,B.push(Z);var re=Vf(Function,B).apply(null,k);return _=Eh(re),kf[V]=_,_}function Oh(v,p){return v=Dt.toValue(v),p=Dt.toValue(p),Dt.toHandle(v[p])}function Mh(v){v>4&&(Bt[v].refcount+=1)}function Dh(v){return Dt.toHandle(bf(v))}function mh(v){var p=Dt.toValue(v);Lf(p),ss(v)}function Rh(v,p){v=os(v,"_emval_take_value");var d=v.readValueFromPointer(p);return Dt.toHandle(d)}function Lh(){_e("native code called abort()")}function Vh(){return oe.length}function _h(){return Vh()}function bh(v,p,d){oe.copyWithin(v,p,p+d)}function kh(v){_e("Cannot enlarge memory arrays to size "+v+" bytes (OOM). Either (1) compile with -sINITIAL_MEMORY=X with X higher than the current value "+ne.length+", (2) compile with -sALLOW_MEMORY_GROWTH which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with -sABORTING_MALLOC=0")}function Fh(v){oe.length,v=v>>>0,kh(v)}var us={};function Bh(){return s||"./this.program"}function Pn(){if(!Pn.strings){var v=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",p={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:v,_:Bh()};for(var d in us)us[d]===void 0?delete p[d]:p[d]=us[d];var M=[];for(var d in p)M.push(d+"="+p[d]);Pn.strings=M}return Pn.strings}var Ve={isAbs:v=>v.charAt(0)==="/",splitPath:v=>{var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return p.exec(v).slice(1)},normalizeArray:(v,p)=>{for(var d=0,M=v.length-1;M>=0;M--){var V=v[M];V==="."?v.splice(M,1):V===".."?(v.splice(M,1),d++):d&&(v.splice(M,1),d--)}if(p)for(;d;d--)v.unshift("..");return v},normalize:v=>{var p=Ve.isAbs(v),d=v.substr(-1)==="/";return v=Ve.normalizeArray(v.split("/").filter(M=>!!M),!p).join("/"),!v&&!p&&(v="."),v&&d&&(v+="/"),(p?"/":"")+v},dirname:v=>{var p=Ve.splitPath(v),d=p[0],M=p[1];return!d&&!M?".":(M&&(M=M.substr(0,M.length-1)),d+M)},basename:v=>{if(v==="/")return"/";v=Ve.normalize(v),v=v.replace(/\/$/,"");var p=v.lastIndexOf("/");return p===-1?v:v.substr(p+1)},join:function(){var v=Array.prototype.slice.call(arguments,0);return Ve.normalize(v.join("/"))},join2:(v,p)=>Ve.normalize(v+"/"+p)};function Nh(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var v=new Uint8Array(1);return function(){return crypto.getRandomValues(v),v[0]}}else if(u)try{var p=require("crypto");return function(){return p.randomBytes(1)[0]}}catch{}return function(){_e("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: function(array) { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")}}var er={resolve:function(){for(var v="",p=!1,d=arguments.length-1;d>=-1&&!p;d--){var M=d>=0?arguments[d]:R.cwd();if(typeof M!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!M)return"";v=M+"/"+v,p=Ve.isAbs(M)}return v=Ve.normalizeArray(v.split("/").filter(V=>!!V),!p).join("/"),(p?"/":"")+v||"."},relative:(v,p)=>{v=er.resolve(v).substr(1),p=er.resolve(p).substr(1);function d(H){for(var Q=0;Q<H.length&&H[Q]==="";Q++);for(var Z=H.length-1;Z>=0&&H[Z]==="";Z--);return Q>Z?[]:H.slice(Q,Z-Q+1)}for(var M=d(v.split("/")),V=d(p.split("/")),_=Math.min(M.length,V.length),B=_,k=0;k<_;k++)if(M[k]!==V[k]){B=k;break}for(var z=[],k=B;k<M.length;k++)z.push("..");return z=z.concat(V.slice(B)),z.join("/")}},kr={ttys:[],init:function(){},shutdown:function(){},register:function(v,p){kr.ttys[v]={input:[],output:[],ops:p},R.registerDevice(v,kr.stream_ops)},stream_ops:{open:function(v){var p=kr.ttys[v.node.rdev];if(!p)throw new R.ErrnoError(43);v.tty=p,v.seekable=!1},close:function(v){v.tty.ops.flush(v.tty)},flush:function(v){v.tty.ops.flush(v.tty)},read:function(v,p,d,M,V){if(!v.tty||!v.tty.ops.get_char)throw new R.ErrnoError(60);for(var _=0,B=0;B<M;B++){var k;try{k=v.tty.ops.get_char(v.tty)}catch{throw new R.ErrnoError(29)}if(k===void 0&&_===0)throw new R.ErrnoError(6);if(k==null)break;_++,p[d+B]=k}return _&&(v.node.timestamp=Date.now()),_},write:function(v,p,d,M,V){if(!v.tty||!v.tty.ops.put_char)throw new R.ErrnoError(60);try{for(var _=0;_<M;_++)v.tty.ops.put_char(v.tty,p[d+_])}catch{throw new R.ErrnoError(29)}return M&&(v.node.timestamp=Date.now()),_}},default_tty_ops:{get_char:function(v){if(!v.input.length){var p=null;if(u){var d=256,M=Buffer.alloc(d),V=0;try{V=T.readSync(process.stdin.fd,M,0,d,-1)}catch(_){if(_.toString().includes("EOF"))V=0;else throw _}V>0?p=M.slice(0,V).toString("utf-8"):p=null}else typeof window<"u"&&typeof window.prompt=="function"?(p=window.prompt("Input: "),p!==null&&(p+=`
`)):typeof readline=="function"&&(p=readline(),p!==null&&(p+=`
`));if(!p)return null;v.input=ba(p,!0)}return v.input.shift()},put_char:function(v,p){p===null||p===10?(w(P(v.output,0)),v.output=[]):p!=0&&v.output.push(p)},flush:function(v){v.output&&v.output.length>0&&(w(P(v.output,0)),v.output=[])}},default_tty1_ops:{put_char:function(v,p){p===null||p===10?(C(P(v.output,0)),v.output=[]):p!=0&&v.output.push(p)},flush:function(v){v.output&&v.output.length>0&&(C(P(v.output,0)),v.output=[])}}};function Ff(v){_e("internal error: mmapAlloc called but `emscripten_builtin_memalign` native symbol not exported")}var he={ops_table:null,mount:function(v){return he.createNode(null,"/",16895,0)},createNode:function(v,p,d,M){if(R.isBlkdev(d)||R.isFIFO(d))throw new R.ErrnoError(63);he.ops_table||(he.ops_table={dir:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr,lookup:he.node_ops.lookup,mknod:he.node_ops.mknod,rename:he.node_ops.rename,unlink:he.node_ops.unlink,rmdir:he.node_ops.rmdir,readdir:he.node_ops.readdir,symlink:he.node_ops.symlink},stream:{llseek:he.stream_ops.llseek}},file:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr},stream:{llseek:he.stream_ops.llseek,read:he.stream_ops.read,write:he.stream_ops.write,allocate:he.stream_ops.allocate,mmap:he.stream_ops.mmap,msync:he.stream_ops.msync}},link:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr,readlink:he.node_ops.readlink},stream:{}},chrdev:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr},stream:R.chrdev_stream_ops}});var V=R.createNode(v,p,d,M);return R.isDir(V.mode)?(V.node_ops=he.ops_table.dir.node,V.stream_ops=he.ops_table.dir.stream,V.contents={}):R.isFile(V.mode)?(V.node_ops=he.ops_table.file.node,V.stream_ops=he.ops_table.file.stream,V.usedBytes=0,V.contents=null):R.isLink(V.mode)?(V.node_ops=he.ops_table.link.node,V.stream_ops=he.ops_table.link.stream):R.isChrdev(V.mode)&&(V.node_ops=he.ops_table.chrdev.node,V.stream_ops=he.ops_table.chrdev.stream),V.timestamp=Date.now(),v&&(v.contents[p]=V,v.timestamp=V.timestamp),V},getFileDataAsTypedArray:function(v){return v.contents?v.contents.subarray?v.contents.subarray(0,v.usedBytes):new Uint8Array(v.contents):new Uint8Array(0)},expandFileStorage:function(v,p){var d=v.contents?v.contents.length:0;if(!(d>=p)){var M=1024*1024;p=Math.max(p,d*(d<M?2:1.125)>>>0),d!=0&&(p=Math.max(p,256));var V=v.contents;v.contents=new Uint8Array(p),v.usedBytes>0&&v.contents.set(V.subarray(0,v.usedBytes),0)}},resizeFileStorage:function(v,p){if(v.usedBytes!=p)if(p==0)v.contents=null,v.usedBytes=0;else{var d=v.contents;v.contents=new Uint8Array(p),d&&v.contents.set(d.subarray(0,Math.min(p,v.usedBytes))),v.usedBytes=p}},node_ops:{getattr:function(v){var p={};return p.dev=R.isChrdev(v.mode)?v.id:1,p.ino=v.id,p.mode=v.mode,p.nlink=1,p.uid=0,p.gid=0,p.rdev=v.rdev,R.isDir(v.mode)?p.size=4096:R.isFile(v.mode)?p.size=v.usedBytes:R.isLink(v.mode)?p.size=v.link.length:p.size=0,p.atime=new Date(v.timestamp),p.mtime=new Date(v.timestamp),p.ctime=new Date(v.timestamp),p.blksize=4096,p.blocks=Math.ceil(p.size/p.blksize),p},setattr:function(v,p){p.mode!==void 0&&(v.mode=p.mode),p.timestamp!==void 0&&(v.timestamp=p.timestamp),p.size!==void 0&&he.resizeFileStorage(v,p.size)},lookup:function(v,p){throw R.genericErrors[44]},mknod:function(v,p,d,M){return he.createNode(v,p,d,M)},rename:function(v,p,d){if(R.isDir(v.mode)){var M;try{M=R.lookupNode(p,d)}catch{}if(M)for(var V in M.contents)throw new R.ErrnoError(55)}delete v.parent.contents[v.name],v.parent.timestamp=Date.now(),v.name=d,p.contents[d]=v,p.timestamp=v.parent.timestamp,v.parent=p},unlink:function(v,p){delete v.contents[p],v.timestamp=Date.now()},rmdir:function(v,p){var d=R.lookupNode(v,p);for(var M in d.contents)throw new R.ErrnoError(55);delete v.contents[p],v.timestamp=Date.now()},readdir:function(v){var p=[".",".."];for(var d in v.contents)!v.contents.hasOwnProperty(d)||p.push(d);return p},symlink:function(v,p,d){var M=he.createNode(v,p,41471,0);return M.link=d,M},readlink:function(v){if(!R.isLink(v.mode))throw new R.ErrnoError(28);return v.link}},stream_ops:{read:function(v,p,d,M,V){var _=v.node.contents;if(V>=v.node.usedBytes)return 0;var B=Math.min(v.node.usedBytes-V,M);if(N(B>=0),B>8&&_.subarray)p.set(_.subarray(V,V+B),d);else for(var k=0;k<B;k++)p[d+k]=_[V+k];return B},write:function(v,p,d,M,V,_){if(N(!(p instanceof ArrayBuffer)),!M)return 0;var B=v.node;if(B.timestamp=Date.now(),p.subarray&&(!B.contents||B.contents.subarray)){if(_)return N(V===0,"canOwn must imply no weird position inside the file"),B.contents=p.subarray(d,d+M),B.usedBytes=M,M;if(B.usedBytes===0&&V===0)return B.contents=p.slice(d,d+M),B.usedBytes=M,M;if(V+M<=B.usedBytes)return B.contents.set(p.subarray(d,d+M),V),M}if(he.expandFileStorage(B,V+M),B.contents.subarray&&p.subarray)B.contents.set(p.subarray(d,d+M),V);else for(var k=0;k<M;k++)B.contents[V+k]=p[d+k];return B.usedBytes=Math.max(B.usedBytes,V+M),M},llseek:function(v,p,d){var M=p;if(d===1?M+=v.position:d===2&&R.isFile(v.node.mode)&&(M+=v.node.usedBytes),M<0)throw new R.ErrnoError(28);return M},allocate:function(v,p,d){he.expandFileStorage(v.node,p+d),v.node.usedBytes=Math.max(v.node.usedBytes,p+d)},mmap:function(v,p,d,M,V){if(!R.isFile(v.node.mode))throw new R.ErrnoError(43);var _,B,k=v.node.contents;if(!(V&2)&&k.buffer===we)B=!1,_=k.byteOffset;else{if((d>0||d+p<k.length)&&(k.subarray?k=k.subarray(d,d+p):k=Array.prototype.slice.call(k,d,d+p)),B=!0,_=Ff(),!_)throw new R.ErrnoError(48);ne.set(k,_)}return{ptr:_,allocated:B}},msync:function(v,p,d,M,V){if(!R.isFile(v.node.mode))throw new R.ErrnoError(43);return V&2||he.stream_ops.write(v,p,0,M,d,!1),0}}};function Uh(v,p,d,M){var V=M?"":hf("al "+v);y(v,function(_){N(_,'Loading data file "'+v+'" failed (no arrayBuffer).'),p(new Uint8Array(_)),V&&wa(V)},function(_){if(d)d();else throw'Loading data file "'+v+'" failed.'}),V&&Yi(V)}var Gh={0:"Success",1:"Arg list too long",2:"Permission denied",3:"Address already in use",4:"Address not available",5:"Address family not supported by protocol family",6:"No more processes",7:"Socket already connected",8:"Bad file number",9:"Trying to read unreadable message",10:"Mount device busy",11:"Operation canceled",12:"No children",13:"Connection aborted",14:"Connection refused",15:"Connection reset by peer",16:"File locking deadlock error",17:"Destination address required",18:"Math arg out of domain of func",19:"Quota exceeded",20:"File exists",21:"Bad address",22:"File too large",23:"Host is unreachable",24:"Identifier removed",25:"Illegal byte sequence",26:"Connection already in progress",27:"Interrupted system call",28:"Invalid argument",29:"I/O error",30:"Socket is already connected",31:"Is a directory",32:"Too many symbolic links",33:"Too many open files",34:"Too many links",35:"Message too long",36:"Multihop attempted",37:"File or path name too long",38:"Network interface is not configured",39:"Connection reset by network",40:"Network is unreachable",41:"Too many open files in system",42:"No buffer space available",43:"No such device",44:"No such file or directory",45:"Exec format error",46:"No record locks available",47:"The link has been severed",48:"Not enough core",49:"No message of desired type",50:"Protocol not available",51:"No space left on device",52:"Function not implemented",53:"Socket is not connected",54:"Not a directory",55:"Directory not empty",56:"State not recoverable",57:"Socket operation on non-socket",59:"Not a typewriter",60:"No such device or address",61:"Value too large for defined data type",62:"Previous owner died",63:"Not super-user",64:"Broken pipe",65:"Protocol error",66:"Unknown protocol",67:"Protocol wrong type for socket",68:"Math result not representable",69:"Read only file system",70:"Illegal seek",71:"No such process",72:"Stale file handle",73:"Connection timed out",74:"Text file busy",75:"Cross-device link",100:"Device not a stream",101:"Bad font file fmt",102:"Invalid slot",103:"Invalid request code",104:"No anode",105:"Block device required",106:"Channel number out of range",107:"Level 3 halted",108:"Level 3 reset",109:"Link number out of range",110:"Protocol driver not attached",111:"No CSI structure available",112:"Level 2 halted",113:"Invalid exchange",114:"Invalid request descriptor",115:"Exchange full",116:"No data (for no delay io)",117:"Timer expired",118:"Out of streams resources",119:"Machine is not on the network",120:"Package not installed",121:"The object is remote",122:"Advertise error",123:"Srmount error",124:"Communication error on send",125:"Cross mount point (not really error)",126:"Given log. name not unique",127:"f.d. invalid for this operation",128:"Remote address changed",129:"Can   access a needed shared lib",130:"Accessing a corrupted shared lib",131:".lib section in a.out corrupted",132:"Attempting to link in too many libs",133:"Attempting to exec a shared library",135:"Streams pipe error",136:"Too many users",137:"Socket type not supported",138:"Not supported",139:"Protocol family not supported",140:"Can't send after socket shutdown",141:"Too many references",142:"Host is down",148:"No medium (in tape drive)",156:"Level 2 not synchronized"},cs={},R={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(v,p={})=>{if(v=er.resolve(R.cwd(),v),!v)return{path:"",node:null};var d={follow_mount:!0,recurse_count:0};if(p=Object.assign(d,p),p.recurse_count>8)throw new R.ErrnoError(32);for(var M=Ve.normalizeArray(v.split("/").filter(Z=>!!Z),!1),V=R.root,_="/",B=0;B<M.length;B++){var k=B===M.length-1;if(k&&p.parent)break;if(V=R.lookupNode(V,M[B]),_=Ve.join2(_,M[B]),R.isMountpoint(V)&&(!k||k&&p.follow_mount)&&(V=V.mounted.root),!k||p.follow)for(var z=0;R.isLink(V.mode);){var H=R.readlink(_);_=er.resolve(Ve.dirname(_),H);var Q=R.lookupPath(_,{recurse_count:p.recurse_count+1});if(V=Q.node,z++>40)throw new R.ErrnoError(32)}}return{path:_,node:V}},getPath:v=>{for(var p;;){if(R.isRoot(v)){var d=v.mount.mountpoint;return p?d[d.length-1]!=="/"?d+"/"+p:d+p:d}p=p?v.name+"/"+p:v.name,v=v.parent}},hashName:(v,p)=>{for(var d=0,M=0;M<p.length;M++)d=(d<<5)-d+p.charCodeAt(M)|0;return(v+d>>>0)%R.nameTable.length},hashAddNode:v=>{var p=R.hashName(v.parent.id,v.name);v.name_next=R.nameTable[p],R.nameTable[p]=v},hashRemoveNode:v=>{var p=R.hashName(v.parent.id,v.name);if(R.nameTable[p]===v)R.nameTable[p]=v.name_next;else for(var d=R.nameTable[p];d;){if(d.name_next===v){d.name_next=v.name_next;break}d=d.name_next}},lookupNode:(v,p)=>{var d=R.mayLookup(v);if(d)throw new R.ErrnoError(d,v);for(var M=R.hashName(v.id,p),V=R.nameTable[M];V;V=V.name_next){var _=V.name;if(V.parent.id===v.id&&_===p)return V}return R.lookup(v,p)},createNode:(v,p,d,M)=>{N(typeof v=="object");var V=new R.FSNode(v,p,d,M);return R.hashAddNode(V),V},destroyNode:v=>{R.hashRemoveNode(v)},isRoot:v=>v===v.parent,isMountpoint:v=>!!v.mounted,isFile:v=>(v&61440)===32768,isDir:v=>(v&61440)===16384,isLink:v=>(v&61440)===40960,isChrdev:v=>(v&61440)===8192,isBlkdev:v=>(v&61440)===24576,isFIFO:v=>(v&61440)===4096,isSocket:v=>(v&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:v=>{var p=R.flagModes[v];if(typeof p>"u")throw new Error("Unknown file open mode: "+v);return p},flagsToPermissionString:v=>{var p=["r","w","rw"][v&3];return v&512&&(p+="w"),p},nodePermissions:(v,p)=>R.ignorePermissions?0:p.includes("r")&&!(v.mode&292)||p.includes("w")&&!(v.mode&146)||p.includes("x")&&!(v.mode&73)?2:0,mayLookup:v=>{var p=R.nodePermissions(v,"x");return p||(v.node_ops.lookup?0:2)},mayCreate:(v,p)=>{try{var d=R.lookupNode(v,p);return 20}catch{}return R.nodePermissions(v,"wx")},mayDelete:(v,p,d)=>{var M;try{M=R.lookupNode(v,p)}catch(_){return _.errno}var V=R.nodePermissions(v,"wx");if(V)return V;if(d){if(!R.isDir(M.mode))return 54;if(R.isRoot(M)||R.getPath(M)===R.cwd())return 10}else if(R.isDir(M.mode))return 31;return 0},mayOpen:(v,p)=>v?R.isLink(v.mode)?32:R.isDir(v.mode)&&(R.flagsToPermissionString(p)!=="r"||p&512)?31:R.nodePermissions(v,R.flagsToPermissionString(p)):44,MAX_OPEN_FDS:4096,nextfd:(v=0,p=R.MAX_OPEN_FDS)=>{for(var d=v;d<=p;d++)if(!R.streams[d])return d;throw new R.ErrnoError(33)},getStream:v=>R.streams[v],createStream:(v,p,d)=>{R.FSStream||(R.FSStream=function(){this.shared={}},R.FSStream.prototype={object:{get:function(){return this.node},set:function(V){this.node=V}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(V){this.shared.flags=V}},position:{get function(){return this.shared.position},set:function(V){this.shared.position=V}}}),v=Object.assign(new R.FSStream,v);var M=R.nextfd(p,d);return v.fd=M,R.streams[M]=v,v},closeStream:v=>{R.streams[v]=null},chrdev_stream_ops:{open:v=>{var p=R.getDevice(v.node.rdev);v.stream_ops=p.stream_ops,v.stream_ops.open&&v.stream_ops.open(v)},llseek:()=>{throw new R.ErrnoError(70)}},major:v=>v>>8,minor:v=>v&255,makedev:(v,p)=>v<<8|p,registerDevice:(v,p)=>{R.devices[v]={stream_ops:p}},getDevice:v=>R.devices[v],getMounts:v=>{for(var p=[],d=[v];d.length;){var M=d.pop();p.push(M),d.push.apply(d,M.mounts)}return p},syncfs:(v,p)=>{typeof v=="function"&&(p=v,v=!1),R.syncFSRequests++,R.syncFSRequests>1&&C("warning: "+R.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var d=R.getMounts(R.root.mount),M=0;function V(B){return N(R.syncFSRequests>0),R.syncFSRequests--,p(B)}function _(B){if(B)return _.errored?void 0:(_.errored=!0,V(B));++M>=d.length&&V(null)}d.forEach(B=>{if(!B.type.syncfs)return _(null);B.type.syncfs(B,v,_)})},mount:(v,p,d)=>{if(typeof v=="string")throw v;var M=d==="/",V=!d,_;if(M&&R.root)throw new R.ErrnoError(10);if(!M&&!V){var B=R.lookupPath(d,{follow_mount:!1});if(d=B.path,_=B.node,R.isMountpoint(_))throw new R.ErrnoError(10);if(!R.isDir(_.mode))throw new R.ErrnoError(54)}var k={type:v,opts:p,mountpoint:d,mounts:[]},z=v.mount(k);return z.mount=k,k.root=z,M?R.root=z:_&&(_.mounted=k,_.mount&&_.mount.mounts.push(k)),z},unmount:v=>{var p=R.lookupPath(v,{follow_mount:!1});if(!R.isMountpoint(p.node))throw new R.ErrnoError(28);var d=p.node,M=d.mounted,V=R.getMounts(M);Object.keys(R.nameTable).forEach(B=>{for(var k=R.nameTable[B];k;){var z=k.name_next;V.includes(k.mount)&&R.destroyNode(k),k=z}}),d.mounted=null;var _=d.mount.mounts.indexOf(M);N(_!==-1),d.mount.mounts.splice(_,1)},lookup:(v,p)=>v.node_ops.lookup(v,p),mknod:(v,p,d)=>{var M=R.lookupPath(v,{parent:!0}),V=M.node,_=Ve.basename(v);if(!_||_==="."||_==="..")throw new R.ErrnoError(28);var B=R.mayCreate(V,_);if(B)throw new R.ErrnoError(B);if(!V.node_ops.mknod)throw new R.ErrnoError(63);return V.node_ops.mknod(V,_,p,d)},create:(v,p)=>(p=p!==void 0?p:438,p&=4095,p|=32768,R.mknod(v,p,0)),mkdir:(v,p)=>(p=p!==void 0?p:511,p&=1023,p|=16384,R.mknod(v,p,0)),mkdirTree:(v,p)=>{for(var d=v.split("/"),M="",V=0;V<d.length;++V)if(!!d[V]){M+="/"+d[V];try{R.mkdir(M,p)}catch(_){if(_.errno!=20)throw _}}},mkdev:(v,p,d)=>(typeof d>"u"&&(d=p,p=438),p|=8192,R.mknod(v,p,d)),symlink:(v,p)=>{if(!er.resolve(v))throw new R.ErrnoError(44);var d=R.lookupPath(p,{parent:!0}),M=d.node;if(!M)throw new R.ErrnoError(44);var V=Ve.basename(p),_=R.mayCreate(M,V);if(_)throw new R.ErrnoError(_);if(!M.node_ops.symlink)throw new R.ErrnoError(63);return M.node_ops.symlink(M,V,v)},rename:(v,p)=>{var d=Ve.dirname(v),M=Ve.dirname(p),V=Ve.basename(v),_=Ve.basename(p),B,k,z;if(B=R.lookupPath(v,{parent:!0}),k=B.node,B=R.lookupPath(p,{parent:!0}),z=B.node,!k||!z)throw new R.ErrnoError(44);if(k.mount!==z.mount)throw new R.ErrnoError(75);var H=R.lookupNode(k,V),Q=er.relative(v,M);if(Q.charAt(0)!==".")throw new R.ErrnoError(28);if(Q=er.relative(p,d),Q.charAt(0)!==".")throw new R.ErrnoError(55);var Z;try{Z=R.lookupNode(z,_)}catch{}if(H!==Z){var q=R.isDir(H.mode),re=R.mayDelete(k,V,q);if(re)throw new R.ErrnoError(re);if(re=Z?R.mayDelete(z,_,q):R.mayCreate(z,_),re)throw new R.ErrnoError(re);if(!k.node_ops.rename)throw new R.ErrnoError(63);if(R.isMountpoint(H)||Z&&R.isMountpoint(Z))throw new R.ErrnoError(10);if(z!==k&&(re=R.nodePermissions(k,"w"),re))throw new R.ErrnoError(re);R.hashRemoveNode(H);try{k.node_ops.rename(H,z,_)}catch(ae){throw ae}finally{R.hashAddNode(H)}}},rmdir:v=>{var p=R.lookupPath(v,{parent:!0}),d=p.node,M=Ve.basename(v),V=R.lookupNode(d,M),_=R.mayDelete(d,M,!0);if(_)throw new R.ErrnoError(_);if(!d.node_ops.rmdir)throw new R.ErrnoError(63);if(R.isMountpoint(V))throw new R.ErrnoError(10);d.node_ops.rmdir(d,M),R.destroyNode(V)},readdir:v=>{var p=R.lookupPath(v,{follow:!0}),d=p.node;if(!d.node_ops.readdir)throw new R.ErrnoError(54);return d.node_ops.readdir(d)},unlink:v=>{var p=R.lookupPath(v,{parent:!0}),d=p.node;if(!d)throw new R.ErrnoError(44);var M=Ve.basename(v),V=R.lookupNode(d,M),_=R.mayDelete(d,M,!1);if(_)throw new R.ErrnoError(_);if(!d.node_ops.unlink)throw new R.ErrnoError(63);if(R.isMountpoint(V))throw new R.ErrnoError(10);d.node_ops.unlink(d,M),R.destroyNode(V)},readlink:v=>{var p=R.lookupPath(v),d=p.node;if(!d)throw new R.ErrnoError(44);if(!d.node_ops.readlink)throw new R.ErrnoError(28);return er.resolve(R.getPath(d.parent),d.node_ops.readlink(d))},stat:(v,p)=>{var d=R.lookupPath(v,{follow:!p}),M=d.node;if(!M)throw new R.ErrnoError(44);if(!M.node_ops.getattr)throw new R.ErrnoError(63);return M.node_ops.getattr(M)},lstat:v=>R.stat(v,!0),chmod:(v,p,d)=>{var M;if(typeof v=="string"){var V=R.lookupPath(v,{follow:!d});M=V.node}else M=v;if(!M.node_ops.setattr)throw new R.ErrnoError(63);M.node_ops.setattr(M,{mode:p&4095|M.mode&-4096,timestamp:Date.now()})},lchmod:(v,p)=>{R.chmod(v,p,!0)},fchmod:(v,p)=>{var d=R.getStream(v);if(!d)throw new R.ErrnoError(8);R.chmod(d.node,p)},chown:(v,p,d,M)=>{var V;if(typeof v=="string"){var _=R.lookupPath(v,{follow:!M});V=_.node}else V=v;if(!V.node_ops.setattr)throw new R.ErrnoError(63);V.node_ops.setattr(V,{timestamp:Date.now()})},lchown:(v,p,d)=>{R.chown(v,p,d,!0)},fchown:(v,p,d)=>{var M=R.getStream(v);if(!M)throw new R.ErrnoError(8);R.chown(M.node,p,d)},truncate:(v,p)=>{if(p<0)throw new R.ErrnoError(28);var d;if(typeof v=="string"){var M=R.lookupPath(v,{follow:!0});d=M.node}else d=v;if(!d.node_ops.setattr)throw new R.ErrnoError(63);if(R.isDir(d.mode))throw new R.ErrnoError(31);if(!R.isFile(d.mode))throw new R.ErrnoError(28);var V=R.nodePermissions(d,"w");if(V)throw new R.ErrnoError(V);d.node_ops.setattr(d,{size:p,timestamp:Date.now()})},ftruncate:(v,p)=>{var d=R.getStream(v);if(!d)throw new R.ErrnoError(8);if((d.flags&2097155)===0)throw new R.ErrnoError(28);R.truncate(d.node,p)},utime:(v,p,d)=>{var M=R.lookupPath(v,{follow:!0}),V=M.node;V.node_ops.setattr(V,{timestamp:Math.max(p,d)})},open:(v,p,d)=>{if(v==="")throw new R.ErrnoError(44);p=typeof p=="string"?R.modeStringToFlags(p):p,d=typeof d>"u"?438:d,p&64?d=d&4095|32768:d=0;var M;if(typeof v=="object")M=v;else{v=Ve.normalize(v);try{var V=R.lookupPath(v,{follow:!(p&131072)});M=V.node}catch{}}var _=!1;if(p&64)if(M){if(p&128)throw new R.ErrnoError(20)}else M=R.mknod(v,d,0),_=!0;if(!M)throw new R.ErrnoError(44);if(R.isChrdev(M.mode)&&(p&=-513),p&65536&&!R.isDir(M.mode))throw new R.ErrnoError(54);if(!_){var B=R.mayOpen(M,p);if(B)throw new R.ErrnoError(B)}p&512&&!_&&R.truncate(M,0),p&=-131713;var k=R.createStream({node:M,path:R.getPath(M),flags:p,seekable:!0,position:0,stream_ops:M.stream_ops,ungotten:[],error:!1});return k.stream_ops.open&&k.stream_ops.open(k),r.logReadFiles&&!(p&1)&&(R.readFiles||(R.readFiles={}),v in R.readFiles||(R.readFiles[v]=1)),k},close:v=>{if(R.isClosed(v))throw new R.ErrnoError(8);v.getdents&&(v.getdents=null);try{v.stream_ops.close&&v.stream_ops.close(v)}catch(p){throw p}finally{R.closeStream(v.fd)}v.fd=null},isClosed:v=>v.fd===null,llseek:(v,p,d)=>{if(R.isClosed(v))throw new R.ErrnoError(8);if(!v.seekable||!v.stream_ops.llseek)throw new R.ErrnoError(70);if(d!=0&&d!=1&&d!=2)throw new R.ErrnoError(28);return v.position=v.stream_ops.llseek(v,p,d),v.ungotten=[],v.position},read:(v,p,d,M,V)=>{if(M<0||V<0)throw new R.ErrnoError(28);if(R.isClosed(v))throw new R.ErrnoError(8);if((v.flags&2097155)===1)throw new R.ErrnoError(8);if(R.isDir(v.node.mode))throw new R.ErrnoError(31);if(!v.stream_ops.read)throw new R.ErrnoError(28);var _=typeof V<"u";if(!_)V=v.position;else if(!v.seekable)throw new R.ErrnoError(70);var B=v.stream_ops.read(v,p,d,M,V);return _||(v.position+=B),B},write:(v,p,d,M,V,_)=>{if(M<0||V<0)throw new R.ErrnoError(28);if(R.isClosed(v))throw new R.ErrnoError(8);if((v.flags&2097155)===0)throw new R.ErrnoError(8);if(R.isDir(v.node.mode))throw new R.ErrnoError(31);if(!v.stream_ops.write)throw new R.ErrnoError(28);v.seekable&&v.flags&1024&&R.llseek(v,0,2);var B=typeof V<"u";if(!B)V=v.position;else if(!v.seekable)throw new R.ErrnoError(70);var k=v.stream_ops.write(v,p,d,M,V,_);return B||(v.position+=k),k},allocate:(v,p,d)=>{if(R.isClosed(v))throw new R.ErrnoError(8);if(p<0||d<=0)throw new R.ErrnoError(28);if((v.flags&2097155)===0)throw new R.ErrnoError(8);if(!R.isFile(v.node.mode)&&!R.isDir(v.node.mode))throw new R.ErrnoError(43);if(!v.stream_ops.allocate)throw new R.ErrnoError(138);v.stream_ops.allocate(v,p,d)},mmap:(v,p,d,M,V)=>{if((M&2)!==0&&(V&2)===0&&(v.flags&2097155)!==2)throw new R.ErrnoError(2);if((v.flags&2097155)===1)throw new R.ErrnoError(2);if(!v.stream_ops.mmap)throw new R.ErrnoError(43);return v.stream_ops.mmap(v,p,d,M,V)},msync:(v,p,d,M,V)=>!v||!v.stream_ops.msync?0:v.stream_ops.msync(v,p,d,M,V),munmap:v=>0,ioctl:(v,p,d)=>{if(!v.stream_ops.ioctl)throw new R.ErrnoError(59);return v.stream_ops.ioctl(v,p,d)},readFile:(v,p={})=>{if(p.flags=p.flags||0,p.encoding=p.encoding||"binary",p.encoding!=="utf8"&&p.encoding!=="binary")throw new Error('Invalid encoding type "'+p.encoding+'"');var d,M=R.open(v,p.flags),V=R.stat(v),_=V.size,B=new Uint8Array(_);return R.read(M,B,0,_,0),p.encoding==="utf8"?d=P(B,0):p.encoding==="binary"&&(d=B),R.close(M),d},writeFile:(v,p,d={})=>{d.flags=d.flags||577;var M=R.open(v,d.flags,d.mode);if(typeof p=="string"){var V=new Uint8Array(ee(p)+1),_=K(p,V,0,V.length);R.write(M,V,0,_,void 0,d.canOwn)}else if(ArrayBuffer.isView(p))R.write(M,p,0,p.byteLength,void 0,d.canOwn);else throw new Error("Unsupported data type");R.close(M)},cwd:()=>R.currentPath,chdir:v=>{var p=R.lookupPath(v,{follow:!0});if(p.node===null)throw new R.ErrnoError(44);if(!R.isDir(p.node.mode))throw new R.ErrnoError(54);var d=R.nodePermissions(p.node,"x");if(d)throw new R.ErrnoError(d);R.currentPath=p.path},createDefaultDirectories:()=>{R.mkdir("/tmp"),R.mkdir("/home"),R.mkdir("/home/web_user")},createDefaultDevices:()=>{R.mkdir("/dev"),R.registerDevice(R.makedev(1,3),{read:()=>0,write:(p,d,M,V,_)=>V}),R.mkdev("/dev/null",R.makedev(1,3)),kr.register(R.makedev(5,0),kr.default_tty_ops),kr.register(R.makedev(6,0),kr.default_tty1_ops),R.mkdev("/dev/tty",R.makedev(5,0)),R.mkdev("/dev/tty1",R.makedev(6,0));var v=Nh();R.createDevice("/dev","random",v),R.createDevice("/dev","urandom",v),R.mkdir("/dev/shm"),R.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{R.mkdir("/proc");var v=R.mkdir("/proc/self");R.mkdir("/proc/self/fd"),R.mount({mount:()=>{var p=R.createNode(v,"fd",16895,73);return p.node_ops={lookup:(d,M)=>{var V=+M,_=R.getStream(V);if(!_)throw new R.ErrnoError(8);var B={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>_.path}};return B.parent=B,B}},p}},{},"/proc/self/fd")},createStandardStreams:()=>{r.stdin?R.createDevice("/dev","stdin",r.stdin):R.symlink("/dev/tty","/dev/stdin"),r.stdout?R.createDevice("/dev","stdout",null,r.stdout):R.symlink("/dev/tty","/dev/stdout"),r.stderr?R.createDevice("/dev","stderr",null,r.stderr):R.symlink("/dev/tty1","/dev/stderr");var v=R.open("/dev/stdin",0),p=R.open("/dev/stdout",1),d=R.open("/dev/stderr",1);N(v.fd===0,"invalid handle for stdin ("+v.fd+")"),N(p.fd===1,"invalid handle for stdout ("+p.fd+")"),N(d.fd===2,"invalid handle for stderr ("+d.fd+")")},ensureErrnoError:()=>{R.ErrnoError||(R.ErrnoError=function(p,d){this.node=d,this.setErrno=function(M){this.errno=M;for(var V in cs)if(cs[V]===M){this.code=V;break}},this.setErrno(p),this.message=Gh[p],this.stack&&(Object.defineProperty(this,"stack",{value:new Error().stack,writable:!0}),this.stack=C0(this.stack))},R.ErrnoError.prototype=new Error,R.ErrnoError.prototype.constructor=R.ErrnoError,[44].forEach(v=>{R.genericErrors[v]=new R.ErrnoError(v),R.genericErrors[v].stack="<generic error, no stack>"}))},staticInit:()=>{R.ensureErrnoError(),R.nameTable=new Array(4096),R.mount(he,{},"/"),R.createDefaultDirectories(),R.createDefaultDevices(),R.createSpecialDirectories(),R.filesystems={MEMFS:he}},init:(v,p,d)=>{N(!R.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),R.init.initialized=!0,R.ensureErrnoError(),r.stdin=v||r.stdin,r.stdout=p||r.stdout,r.stderr=d||r.stderr,R.createStandardStreams()},quit:()=>{R.init.initialized=!1,ty(0);for(var v=0;v<R.streams.length;v++){var p=R.streams[v];!p||R.close(p)}},getMode:(v,p)=>{var d=0;return v&&(d|=365),p&&(d|=146),d},findObject:(v,p)=>{var d=R.analyzePath(v,p);return d.exists?d.object:null},analyzePath:(v,p)=>{try{var d=R.lookupPath(v,{follow:!p});v=d.path}catch{}var M={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var d=R.lookupPath(v,{parent:!0});M.parentExists=!0,M.parentPath=d.path,M.parentObject=d.node,M.name=Ve.basename(v),d=R.lookupPath(v,{follow:!p}),M.exists=!0,M.path=d.path,M.object=d.node,M.name=d.node.name,M.isRoot=d.path==="/"}catch(V){M.error=V.errno}return M},createPath:(v,p,d,M)=>{v=typeof v=="string"?v:R.getPath(v);for(var V=p.split("/").reverse();V.length;){var _=V.pop();if(!!_){var B=Ve.join2(v,_);try{R.mkdir(B)}catch{}v=B}}return B},createFile:(v,p,d,M,V)=>{var _=Ve.join2(typeof v=="string"?v:R.getPath(v),p),B=R.getMode(M,V);return R.create(_,B)},createDataFile:(v,p,d,M,V,_)=>{var B=p;v&&(v=typeof v=="string"?v:R.getPath(v),B=p?Ve.join2(v,p):v);var k=R.getMode(M,V),z=R.create(B,k);if(d){if(typeof d=="string"){for(var H=new Array(d.length),Q=0,Z=d.length;Q<Z;++Q)H[Q]=d.charCodeAt(Q);d=H}R.chmod(z,k|146);var q=R.open(z,577);R.write(q,d,0,d.length,0,_),R.close(q),R.chmod(z,k)}return z},createDevice:(v,p,d,M)=>{var V=Ve.join2(typeof v=="string"?v:R.getPath(v),p),_=R.getMode(!!d,!!M);R.createDevice.major||(R.createDevice.major=64);var B=R.makedev(R.createDevice.major++,0);return R.registerDevice(B,{open:k=>{k.seekable=!1},close:k=>{M&&M.buffer&&M.buffer.length&&M(10)},read:(k,z,H,Q,Z)=>{for(var q=0,re=0;re<Q;re++){var ae;try{ae=d()}catch{throw new R.ErrnoError(29)}if(ae===void 0&&q===0)throw new R.ErrnoError(6);if(ae==null)break;q++,z[H+re]=ae}return q&&(k.node.timestamp=Date.now()),q},write:(k,z,H,Q,Z)=>{for(var q=0;q<Q;q++)try{M(z[H+q])}catch{throw new R.ErrnoError(29)}return Q&&(k.node.timestamp=Date.now()),q}}),R.mkdev(V,_,B)},forceLoadFile:v=>{if(v.isDevice||v.isFolder||v.link||v.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(h)try{v.contents=ba(h(v.url),!0),v.usedBytes=v.contents.length}catch{throw new R.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(v,p,d,M,V)=>{function _(){this.lengthKnown=!1,this.chunks=[]}if(_.prototype.get=function(re){if(!(re>this.length-1||re<0)){var ae=re%this.chunkSize,xe=re/this.chunkSize|0;return this.getter(xe)[ae]}},_.prototype.setDataGetter=function(re){this.getter=re},_.prototype.cacheLength=function(){var re=new XMLHttpRequest;if(re.open("HEAD",d,!1),re.send(null),!(re.status>=200&&re.status<300||re.status===304))throw new Error("Couldn't load "+d+". Status: "+re.status);var ae=Number(re.getResponseHeader("Content-length")),xe,Ae=(xe=re.getResponseHeader("Accept-Ranges"))&&xe==="bytes",Xe=(xe=re.getResponseHeader("Content-Encoding"))&&xe==="gzip",Y=1024*1024;Ae||(Y=ae);var se=(Fe,dt)=>{if(Fe>dt)throw new Error("invalid range ("+Fe+", "+dt+") or no bytes requested!");if(dt>ae-1)throw new Error("only "+ae+" bytes available! programmer error!");var Ye=new XMLHttpRequest;if(Ye.open("GET",d,!1),ae!==Y&&Ye.setRequestHeader("Range","bytes="+Fe+"-"+dt),Ye.responseType="arraybuffer",Ye.overrideMimeType&&Ye.overrideMimeType("text/plain; charset=x-user-defined"),Ye.send(null),!(Ye.status>=200&&Ye.status<300||Ye.status===304))throw new Error("Couldn't load "+d+". Status: "+Ye.status);return Ye.response!==void 0?new Uint8Array(Ye.response||[]):ba(Ye.responseText||"",!0)},Ze=this;Ze.setDataGetter(Fe=>{var dt=Fe*Y,Ye=(Fe+1)*Y-1;if(Ye=Math.min(Ye,ae-1),typeof Ze.chunks[Fe]>"u"&&(Ze.chunks[Fe]=se(dt,Ye)),typeof Ze.chunks[Fe]>"u")throw new Error("doXHR failed!");return Ze.chunks[Fe]}),(Xe||!ae)&&(Y=ae=1,ae=this.getter(0).length,Y=ae,w("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=ae,this._chunkSize=Y,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!o)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var B=new _;Object.defineProperties(B,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var k={isDevice:!1,contents:B}}else var k={isDevice:!1,url:d};var z=R.createFile(v,p,k,M,V);k.contents?z.contents=k.contents:k.url&&(z.contents=null,z.url=k.url),Object.defineProperties(z,{usedBytes:{get:function(){return this.contents.length}}});var H={},Q=Object.keys(z.stream_ops);Q.forEach(q=>{var re=z.stream_ops[q];H[q]=function(){return R.forceLoadFile(z),re.apply(null,arguments)}});function Z(q,re,ae,xe,Ae){var Xe=q.node.contents;if(Ae>=Xe.length)return 0;var Y=Math.min(Xe.length-Ae,xe);if(N(Y>=0),Xe.slice)for(var se=0;se<Y;se++)re[ae+se]=Xe[Ae+se];else for(var se=0;se<Y;se++)re[ae+se]=Xe.get(Ae+se);return Y}return H.read=(q,re,ae,xe,Ae)=>(R.forceLoadFile(z),Z(q,re,ae,xe,Ae)),H.mmap=(q,re,ae,xe,Ae)=>{R.forceLoadFile(z);var Xe=Ff();if(!Xe)throw new R.ErrnoError(48);return Z(q,ne,Xe,re,ae),{ptr:Xe,allocated:!0}},z.stream_ops=H,z},createPreloadedFile:(v,p,d,M,V,_,B,k,z,H)=>{var Q=p?er.resolve(Ve.join2(v,p)):v,Z=hf("cp "+Q);function q(re){function ae(xe){H&&H(),k||R.createDataFile(v,p,xe,M,V,z),_&&_(),wa(Z)}Browser.handledByPreloadPlugin(re,Q,ae,()=>{B&&B(),wa(Z)})||ae(re)}Yi(Z),typeof d=="string"?Uh(d,re=>q(re),B):q(d)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(v,p,d)=>{p=p||(()=>{}),d=d||(()=>{});var M=R.indexedDB();try{var V=M.open(R.DB_NAME(),R.DB_VERSION)}catch(_){return d(_)}V.onupgradeneeded=()=>{w("creating db");var _=V.result;_.createObjectStore(R.DB_STORE_NAME)},V.onsuccess=()=>{var _=V.result,B=_.transaction([R.DB_STORE_NAME],"readwrite"),k=B.objectStore(R.DB_STORE_NAME),z=0,H=0,Q=v.length;function Z(){H==0?p():d()}v.forEach(q=>{var re=k.put(R.analyzePath(q).object.contents,q);re.onsuccess=()=>{z++,z+H==Q&&Z()},re.onerror=()=>{H++,z+H==Q&&Z()}}),B.onerror=d},V.onerror=d},loadFilesFromDB:(v,p,d)=>{p=p||(()=>{}),d=d||(()=>{});var M=R.indexedDB();try{var V=M.open(R.DB_NAME(),R.DB_VERSION)}catch(_){return d(_)}V.onupgradeneeded=d,V.onsuccess=()=>{var _=V.result;try{var B=_.transaction([R.DB_STORE_NAME],"readonly")}catch(q){d(q);return}var k=B.objectStore(R.DB_STORE_NAME),z=0,H=0,Q=v.length;function Z(){H==0?p():d()}v.forEach(q=>{var re=k.get(q);re.onsuccess=()=>{R.analyzePath(q).exists&&R.unlink(q),R.createDataFile(Ve.dirname(q),Ve.basename(q),re.result,!0,!0,!0),z++,z+H==Q&&Z()},re.onerror=()=>{H++,z+H==Q&&Z()}}),B.onerror=d},V.onerror=d},absolutePath:()=>{_e("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder:()=>{_e("FS.createFolder has been removed; use FS.mkdir instead")},createLink:()=>{_e("FS.createLink has been removed; use FS.symlink instead")},joinPath:()=>{_e("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc:()=>{_e("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath:()=>{_e("FS.standardizePath has been removed; use PATH.normalize instead")}},Fr={DEFAULT_POLLMASK:5,calculateAt:function(v,p,d){if(Ve.isAbs(p))return p;var M;if(v===-100)M=R.cwd();else{var V=R.getStream(v);if(!V)throw new R.ErrnoError(8);M=V.path}if(p.length==0){if(!d)throw new R.ErrnoError(44);return M}return Ve.join2(M,p)},doStat:function(v,p,d){try{var M=v(p)}catch(V){if(V&&V.node&&Ve.normalize(p)!==Ve.normalize(R.getPath(V.node)))return-54;throw V}return ie[d>>2]=M.dev,ie[d+4>>2]=0,ie[d+8>>2]=M.ino,ie[d+12>>2]=M.mode,ie[d+16>>2]=M.nlink,ie[d+20>>2]=M.uid,ie[d+24>>2]=M.gid,ie[d+28>>2]=M.rdev,ie[d+32>>2]=0,Zt=[M.size>>>0,(rt=M.size,+Math.abs(rt)>=1?rt>0?(Math.min(+Math.floor(rt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((rt-+(~~rt>>>0))/4294967296)>>>0:0)],ie[d+40>>2]=Zt[0],ie[d+44>>2]=Zt[1],ie[d+48>>2]=4096,ie[d+52>>2]=M.blocks,ie[d+56>>2]=M.atime.getTime()/1e3|0,ie[d+60>>2]=0,ie[d+64>>2]=M.mtime.getTime()/1e3|0,ie[d+68>>2]=0,ie[d+72>>2]=M.ctime.getTime()/1e3|0,ie[d+76>>2]=0,Zt=[M.ino>>>0,(rt=M.ino,+Math.abs(rt)>=1?rt>0?(Math.min(+Math.floor(rt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((rt-+(~~rt>>>0))/4294967296)>>>0:0)],ie[d+80>>2]=Zt[0],ie[d+84>>2]=Zt[1],0},doMsync:function(v,p,d,M,V){var _=oe.slice(v,v+d);R.msync(p,_,V,d,M)},varargs:void 0,get:function(){N(Fr.varargs!=null),Fr.varargs+=4;var v=ie[Fr.varargs-4>>2];return v},getStr:function(v){var p=G(v);return p},getStreamFromFD:function(v){var p=R.getStream(v);if(!p)throw new R.ErrnoError(8);return p}};function Ah(v,p){var d=0;return Pn().forEach(function(M,V){var _=p+d;Se[v+V*4>>2]=_,tt(M,_),d+=M.length+1}),0}function Ph(v,p){var d=Pn();Se[v>>2]=d.length;var M=0;return d.forEach(function(V){M+=V.length+1}),Se[p>>2]=M,0}function zh(v){try{var p=Fr.getStreamFromFD(v);return R.close(p),0}catch(d){if(typeof R>"u"||!(d instanceof R.ErrnoError))throw d;return d.errno}}function Wh(v,p,d,M){for(var V=0,_=0;_<d;_++){var B=Se[p>>2],k=Se[p+4>>2];p+=8;var z=R.read(v,ne,B,k,M);if(z<0)return-1;if(V+=z,z<k)break}return V}function jh(v,p,d,M){try{var V=Fr.getStreamFromFD(v),_=Wh(V,p,d);return ie[M>>2]=_,0}catch(B){if(typeof R>"u"||!(B instanceof R.ErrnoError))throw B;return B.errno}}function $h(v,p){return N(v==v>>>0||v==(v|0)),N(p===(p|0)),p+2097152>>>0<4194305-!!v?(v>>>0)+p*4294967296:NaN}function Hh(v,p,d,M,V){try{var _=$h(p,d);if(isNaN(_))return 61;var B=Fr.getStreamFromFD(v);return R.llseek(B,_,M),Zt=[B.position>>>0,(rt=B.position,+Math.abs(rt)>=1?rt>0?(Math.min(+Math.floor(rt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((rt-+(~~rt>>>0))/4294967296)>>>0:0)],ie[V>>2]=Zt[0],ie[V+4>>2]=Zt[1],B.getdents&&_===0&&M===0&&(B.getdents=null),0}catch(k){if(typeof R>"u"||!(k instanceof R.ErrnoError))throw k;return k.errno}}function Kh(v,p,d,M){for(var V=0,_=0;_<d;_++){var B=Se[p>>2],k=Se[p+4>>2];p+=8;var z=R.write(v,ne,B,k,M);if(z<0)return-1;V+=z}return V}function Xh(v,p,d,M){try{var V=Fr.getStreamFromFD(v),_=Kh(V,p,d);return Se[M>>2]=_,0}catch(B){if(typeof R>"u"||!(B instanceof R.ErrnoError))throw B;return B.errno}}function Yh(v){}function La(v){return v%4===0&&(v%100!==0||v%400===0)}function Ih(v,p){for(var d=0,M=0;M<=p;d+=v[M++]);return d}var Bf=[31,29,31,30,31,30,31,31,30,31,30,31],Nf=[31,28,31,30,31,30,31,31,30,31,30,31];function qh(v,p){for(var d=new Date(v.getTime());p>0;){var M=La(d.getFullYear()),V=d.getMonth(),_=(M?Bf:Nf)[V];if(p>_-d.getDate())p-=_-d.getDate()+1,d.setDate(1),V<11?d.setMonth(V+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else return d.setDate(d.getDate()+p),d}return d}function Zh(v,p,d,M){var V=ie[M+40>>2],_={tm_sec:ie[M>>2],tm_min:ie[M+4>>2],tm_hour:ie[M+8>>2],tm_mday:ie[M+12>>2],tm_mon:ie[M+16>>2],tm_year:ie[M+20>>2],tm_wday:ie[M+24>>2],tm_yday:ie[M+28>>2],tm_isdst:ie[M+32>>2],tm_gmtoff:ie[M+36>>2],tm_zone:V?G(V):""},B=G(d),k={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var z in k)B=B.replace(new RegExp(z,"g"),k[z]);var H=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Q=["January","February","March","April","May","June","July","August","September","October","November","December"];function Z(Y,se,Ze){for(var Fe=typeof Y=="number"?Y.toString():Y||"";Fe.length<se;)Fe=Ze[0]+Fe;return Fe}function q(Y,se){return Z(Y,se,"0")}function re(Y,se){function Ze(dt){return dt<0?-1:dt>0?1:0}var Fe;return(Fe=Ze(Y.getFullYear()-se.getFullYear()))===0&&(Fe=Ze(Y.getMonth()-se.getMonth()))===0&&(Fe=Ze(Y.getDate()-se.getDate())),Fe}function ae(Y){switch(Y.getDay()){case 0:return new Date(Y.getFullYear()-1,11,29);case 1:return Y;case 2:return new Date(Y.getFullYear(),0,3);case 3:return new Date(Y.getFullYear(),0,2);case 4:return new Date(Y.getFullYear(),0,1);case 5:return new Date(Y.getFullYear()-1,11,31);case 6:return new Date(Y.getFullYear()-1,11,30)}}function xe(Y){var se=qh(new Date(Y.tm_year+1900,0,1),Y.tm_yday),Ze=new Date(se.getFullYear(),0,4),Fe=new Date(se.getFullYear()+1,0,4),dt=ae(Ze),Ye=ae(Fe);return re(dt,se)<=0?re(Ye,se)<=0?se.getFullYear()+1:se.getFullYear():se.getFullYear()-1}var Ae={"%a":function(Y){return H[Y.tm_wday].substring(0,3)},"%A":function(Y){return H[Y.tm_wday]},"%b":function(Y){return Q[Y.tm_mon].substring(0,3)},"%B":function(Y){return Q[Y.tm_mon]},"%C":function(Y){var se=Y.tm_year+1900;return q(se/100|0,2)},"%d":function(Y){return q(Y.tm_mday,2)},"%e":function(Y){return Z(Y.tm_mday,2," ")},"%g":function(Y){return xe(Y).toString().substring(2)},"%G":function(Y){return xe(Y)},"%H":function(Y){return q(Y.tm_hour,2)},"%I":function(Y){var se=Y.tm_hour;return se==0?se=12:se>12&&(se-=12),q(se,2)},"%j":function(Y){return q(Y.tm_mday+Ih(La(Y.tm_year+1900)?Bf:Nf,Y.tm_mon-1),3)},"%m":function(Y){return q(Y.tm_mon+1,2)},"%M":function(Y){return q(Y.tm_min,2)},"%n":function(){return`
`},"%p":function(Y){return Y.tm_hour>=0&&Y.tm_hour<12?"AM":"PM"},"%S":function(Y){return q(Y.tm_sec,2)},"%t":function(){return"	"},"%u":function(Y){return Y.tm_wday||7},"%U":function(Y){var se=Y.tm_yday+7-Y.tm_wday;return q(Math.floor(se/7),2)},"%V":function(Y){var se=Math.floor((Y.tm_yday+7-(Y.tm_wday+6)%7)/7);if((Y.tm_wday+371-Y.tm_yday-2)%7<=2&&se++,se){if(se==53){var Fe=(Y.tm_wday+371-Y.tm_yday)%7;Fe!=4&&(Fe!=3||!La(Y.tm_year))&&(se=1)}}else{se=52;var Ze=(Y.tm_wday+7-Y.tm_yday-1)%7;(Ze==4||Ze==5&&La(Y.tm_year%400-1))&&se++}return q(se,2)},"%w":function(Y){return Y.tm_wday},"%W":function(Y){var se=Y.tm_yday+7-(Y.tm_wday+6)%7;return q(Math.floor(se/7),2)},"%y":function(Y){return(Y.tm_year+1900).toString().substring(2)},"%Y":function(Y){return Y.tm_year+1900},"%z":function(Y){var se=Y.tm_gmtoff,Ze=se>=0;return se=Math.abs(se)/60,se=se/60*100+se%60,(Ze?"+":"-")+String("0000"+se).slice(-4)},"%Z":function(Y){return Y.tm_zone},"%%":function(){return"%"}};B=B.replace(/%%/g,"\0\0");for(var z in Ae)B.includes(z)&&(B=B.replace(new RegExp(z,"g"),Ae[z](_)));B=B.replace(/\0\0/g,"%");var Xe=ba(B,!1);return Xe.length>p?0:(We(Xe,v),Xe.length-1)}function Qh(v,p,d,M){return Zh(v,p,d,M)}D0(),rn=r.BindingError=Ji(Error,"BindingError"),Sf=r.InternalError=Ji(Error,"InternalError"),j0(),N0(),Q0(),Df=r.UnboundTypeError=Ji(Error,"UnboundTypeError"),fh();var Uf=function(v,p,d,M){v||(v=this),this.parent=v,this.mount=v.mount,this.mounted=null,this.id=R.nextInode++,this.name=p,this.mode=d,this.node_ops={},this.stream_ops={},this.rdev=M},Va=365,_a=146;Object.defineProperties(Uf.prototype,{read:{get:function(){return(this.mode&Va)===Va},set:function(v){v?this.mode|=Va:this.mode&=~Va}},write:{get:function(){return(this.mode&_a)===_a},set:function(v){v?this.mode|=_a:this.mode&=~_a}},isFolder:{get:function(){return R.isDir(this.mode)}},isDevice:{get:function(){return R.isChrdev(this.mode)}}}),R.FSNode=Uf,R.staticInit(),cs={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};function ba(v,p,d){var M=d>0?d:ee(v)+1,V=new Array(M),_=K(v,V,0,V.length);return p&&(V.length=_),V}function Jh(){b("fetchSettings")}var Gf={__assert_fail:E0,__cxa_allocate_exception:w0,__cxa_throw:O0,_embind_register_bigint:M0,_embind_register_bool:L0,_embind_register_class:nh,_embind_register_class_constructor:ah,_embind_register_class_function:ih,_embind_register_emval:uh,_embind_register_float:gh,_embind_register_integer:lh,_embind_register_memory_view:ph,_embind_register_std_string:hh,_embind_register_std_wstring:yh,_embind_register_void:dh,_emval_as:Th,_emval_call_void_method:Ch,_emval_decref:ss,_emval_get_method_caller:xh,_emval_get_property:Oh,_emval_incref:Mh,_emval_new_cstring:Dh,_emval_run_destructors:mh,_emval_take_value:Rh,abort:Lh,emscripten_get_heap_max:_h,emscripten_memcpy_big:bh,emscripten_resize_heap:Fh,environ_get:Ah,environ_sizes_get:Ph,fd_close:zh,fd_read:jh,fd_seek:Hh,fd_write:Xh,setTempRet0:Yh,strftime_l:Qh};T0(),r.___wasm_call_ctors=ft("__wasm_call_ctors");var cr=r._free=ft("free"),gs=r._malloc=ft("malloc"),ey=r.___getTypeName=ft("__getTypeName");r.___embind_register_native_and_builtin_types=ft("__embind_register_native_and_builtin_types"),r.___errno_location=ft("__errno_location");var ty=r._fflush=ft("fflush"),Af=r._emscripten_stack_init=function(){return(Af=r._emscripten_stack_init=r.asm.emscripten_stack_init).apply(null,arguments)};r._emscripten_stack_get_free=function(){return(r._emscripten_stack_get_free=r.asm.emscripten_stack_get_free).apply(null,arguments)},r._emscripten_stack_get_base=function(){return(r._emscripten_stack_get_base=r.asm.emscripten_stack_get_base).apply(null,arguments)};var vs=r._emscripten_stack_get_end=function(){return(vs=r._emscripten_stack_get_end=r.asm.emscripten_stack_get_end).apply(null,arguments)},ry=r.stackSave=ft("stackSave"),ny=r.stackRestore=ft("stackRestore"),Pf=r.stackAlloc=ft("stackAlloc"),ay=r.___cxa_is_pointer_type=ft("__cxa_is_pointer_type");r.dynCall_jiji=ft("dynCall_jiji"),r.dynCall_viijii=ft("dynCall_viijii"),r.dynCall_iiiiij=ft("dynCall_iiiiij"),r.dynCall_iiiiijj=ft("dynCall_iiiiijj"),r.dynCall_iiiiiijj=ft("dynCall_iiiiiijj"),r.ccall=X,O("cwrap",!1),O("allocate",!1),O("UTF8ArrayToString",!1),O("UTF8ToString",!1),O("stringToUTF8Array",!1),O("stringToUTF8",!1),O("lengthBytesUTF8",!1),O("addOnPreRun",!1),O("addOnInit",!1),O("addOnPreMain",!1),O("addOnExit",!1),O("addOnPostRun",!1),O("addRunDependency",!0),O("removeRunDependency",!0),O("FS_createFolder",!1),O("FS_createPath",!0),O("FS_createDataFile",!0),O("FS_createPreloadedFile",!0),O("FS_createLazyFile",!0),O("FS_createLink",!1),O("FS_createDevice",!0),O("FS_unlink",!0),O("getLEB",!1),O("getFunctionTables",!1),O("alignFunctionTables",!1),O("registerFunctions",!1),O("addFunction",!1),O("removeFunction",!1),O("prettyPrint",!1),O("getCompilerSetting",!1),O("print",!1),O("printErr",!1),O("getTempRet0",!1),O("setTempRet0",!1),O("callMain",!1),O("abort",!1),O("keepRuntimeAlive",!1),O("wasmMemory",!1),O("warnOnce",!1),O("stackSave",!1),O("stackRestore",!1),O("stackAlloc",!1),O("AsciiToString",!1),O("stringToAscii",!1),O("UTF16ToString",!1),O("stringToUTF16",!1),O("lengthBytesUTF16",!1),O("UTF32ToString",!1),O("stringToUTF32",!1),O("lengthBytesUTF32",!1),O("allocateUTF8",!1),O("allocateUTF8OnStack",!1),O("ExitStatus",!1),O("intArrayFromString",!1),O("intArrayToString",!1),O("writeStringToMemory",!1),O("writeArrayToMemory",!1),O("writeAsciiToMemory",!1),r.writeStackCookie=gf,r.checkStackCookie=Ea,O("ptrToString",!1),O("zeroMemory",!1),O("stringToNewUTF8",!1),O("getHeapMax",!1),O("abortOnCannotGrowMemory",!1),O("emscripten_realloc_buffer",!1),O("ENV",!1),O("ERRNO_CODES",!1),O("ERRNO_MESSAGES",!1),O("setErrNo",!1),O("inetPton4",!1),O("inetNtop4",!1),O("inetPton6",!1),O("inetNtop6",!1),O("readSockaddr",!1),O("writeSockaddr",!1),O("DNS",!1),O("getHostByName",!1),O("Protocols",!1),O("Sockets",!1),O("getRandomDevice",!1),O("traverseStack",!1),O("UNWIND_CACHE",!1),O("convertPCtoSourceLocation",!1),O("readAsmConstArgsArray",!1),O("readAsmConstArgs",!1),O("mainThreadEM_ASM",!1),O("jstoi_q",!1),O("jstoi_s",!1),O("getExecutableName",!1),O("listenOnce",!1),O("autoResumeAudioContext",!1),O("dynCallLegacy",!1),O("getDynCaller",!1),O("dynCall",!1),O("handleException",!1),O("runtimeKeepalivePush",!1),O("runtimeKeepalivePop",!1),O("callUserCallback",!1),O("maybeExit",!1),O("safeSetTimeout",!1),O("asmjsMangle",!1),O("asyncLoad",!1),O("alignMemory",!1),O("mmapAlloc",!1),O("writeI53ToI64",!1),O("writeI53ToI64Clamped",!1),O("writeI53ToI64Signaling",!1),O("writeI53ToU64Clamped",!1),O("writeI53ToU64Signaling",!1),O("readI53FromI64",!1),O("readI53FromU64",!1),O("convertI32PairToI53",!1),O("convertI32PairToI53Checked",!1),O("convertU32PairToI53",!1),O("reallyNegative",!1),O("unSign",!1),O("strLen",!1),O("reSign",!1),O("formatString",!1),O("setValue",!1),O("getValue",!1),O("PATH",!1),O("PATH_FS",!1),O("SYSCALLS",!1),O("getSocketFromFD",!1),O("getSocketAddress",!1),O("JSEvents",!1),O("registerKeyEventCallback",!1),O("specialHTMLTargets",!1),O("maybeCStringToJsString",!1),O("findEventTarget",!1),O("findCanvasEventTarget",!1),O("getBoundingClientRect",!1),O("fillMouseEventData",!1),O("registerMouseEventCallback",!1),O("registerWheelEventCallback",!1),O("registerUiEventCallback",!1),O("registerFocusEventCallback",!1),O("fillDeviceOrientationEventData",!1),O("registerDeviceOrientationEventCallback",!1),O("fillDeviceMotionEventData",!1),O("registerDeviceMotionEventCallback",!1),O("screenOrientation",!1),O("fillOrientationChangeEventData",!1),O("registerOrientationChangeEventCallback",!1),O("fillFullscreenChangeEventData",!1),O("registerFullscreenChangeEventCallback",!1),O("JSEvents_requestFullscreen",!1),O("JSEvents_resizeCanvasForFullscreen",!1),O("registerRestoreOldStyle",!1),O("hideEverythingExceptGivenElement",!1),O("restoreHiddenElements",!1),O("setLetterbox",!1),O("currentFullscreenStrategy",!1),O("restoreOldWindowedStyle",!1),O("softFullscreenResizeWebGLRenderTarget",!1),O("doRequestFullscreen",!1),O("fillPointerlockChangeEventData",!1),O("registerPointerlockChangeEventCallback",!1),O("registerPointerlockErrorEventCallback",!1),O("requestPointerLock",!1),O("fillVisibilityChangeEventData",!1),O("registerVisibilityChangeEventCallback",!1),O("registerTouchEventCallback",!1),O("fillGamepadEventData",!1),O("registerGamepadEventCallback",!1),O("registerBeforeUnloadEventCallback",!1),O("fillBatteryEventData",!1),O("battery",!1),O("registerBatteryEventCallback",!1),O("setCanvasElementSize",!1),O("getCanvasElementSize",!1),O("demangle",!1),O("demangleAll",!1),O("jsStackTrace",!1),O("stackTrace",!1),O("getEnvStrings",!1),O("checkWasiClock",!1),O("doReadv",!1),O("doWritev",!1),O("dlopenMissingError",!1),O("setImmediateWrapped",!1),O("clearImmediateWrapped",!1),O("polyfillSetImmediate",!1),O("uncaughtExceptionCount",!1),O("exceptionLast",!1),O("exceptionCaught",!1),O("ExceptionInfo",!1),O("exception_addRef",!1),O("exception_decRef",!1),O("Browser",!1),O("setMainLoop",!1),O("wget",!1),O("FS",!1),O("MEMFS",!1),O("TTY",!1),O("PIPEFS",!1),O("SOCKFS",!1),O("_setNetworkCallback",!1),O("tempFixedLengthArray",!1),O("miniTempWebGLFloatBuffers",!1),O("heapObjectForWebGLType",!1),O("heapAccessShiftForWebGLHeap",!1),O("GL",!1),O("emscriptenWebGLGet",!1),O("computeUnpackAlignedImageSize",!1),O("emscriptenWebGLGetTexPixelData",!1),O("emscriptenWebGLGetUniform",!1),O("webglGetUniformLocation",!1),O("webglPrepareUniformLocationsBeforeFirstUse",!1),O("webglGetLeftBracePos",!1),O("emscriptenWebGLGetVertexAttrib",!1),O("writeGLArray",!1),O("AL",!1),O("SDL_unicode",!1),O("SDL_ttfContext",!1),O("SDL_audio",!1),O("SDL",!1),O("SDL_gfx",!1),O("GLUT",!1),O("EGL",!1),O("GLFW_Window",!1),O("GLFW",!1),O("GLEW",!1),O("IDBStore",!1),O("runAndAbortIfError",!1),O("InternalError",!1),O("BindingError",!1),O("UnboundTypeError",!1),O("PureVirtualError",!1),O("init_embind",!1),O("throwInternalError",!1),O("throwBindingError",!1),O("throwUnboundTypeError",!1),O("ensureOverloadTable",!1),O("exposePublicSymbol",!1),O("replacePublicSymbol",!1),O("extendError",!1),O("createNamedFunction",!1),O("registeredInstances",!1),O("getBasestPointer",!1),O("registerInheritedInstance",!1),O("unregisterInheritedInstance",!1),O("getInheritedInstance",!1),O("getInheritedInstanceCount",!1),O("getLiveInheritedInstances",!1),O("registeredTypes",!1),O("awaitingDependencies",!1),O("typeDependencies",!1),O("registeredPointers",!1),O("registerType",!1),O("whenDependentTypesAreResolved",!1),O("embind_charCodes",!1),O("embind_init_charCodes",!1),O("readLatin1String",!1),O("getTypeName",!1),O("heap32VectorToArray",!1),O("requireRegisteredType",!1),O("getShiftFromSize",!1),O("integerReadValueFromPointer",!1),O("enumReadValueFromPointer",!1),O("floatReadValueFromPointer",!1),O("simpleReadValueFromPointer",!1),O("runDestructors",!1),O("new_",!1),O("craftInvokerFunction",!1),O("embind__requireFunction",!1),O("tupleRegistrations",!1),O("structRegistrations",!1),O("genericPointerToWireType",!1),O("constNoSmartPtrRawPointerToWireType",!1),O("nonConstNoSmartPtrRawPointerToWireType",!1),O("init_RegisteredPointer",!1),O("RegisteredPointer",!1),O("RegisteredPointer_getPointee",!1),O("RegisteredPointer_destructor",!1),O("RegisteredPointer_deleteObject",!1),O("RegisteredPointer_fromWireType",!1),O("runDestructor",!1),O("releaseClassHandle",!1),O("finalizationRegistry",!1),O("detachFinalizer_deps",!1),O("detachFinalizer",!1),O("attachFinalizer",!1),O("makeClassHandle",!1),O("init_ClassHandle",!1),O("ClassHandle",!1),O("ClassHandle_isAliasOf",!1),O("throwInstanceAlreadyDeleted",!1),O("ClassHandle_clone",!1),O("ClassHandle_delete",!1),O("deletionQueue",!1),O("ClassHandle_isDeleted",!1),O("ClassHandle_deleteLater",!1),O("flushPendingDeletes",!1),O("delayFunction",!1),O("setDelayFunction",!1),O("RegisteredClass",!1),O("shallowCopyInternalPointer",!1),O("downcastPointer",!1),O("upcastPointer",!1),O("validateThis",!1),O("char_0",!1),O("char_9",!1),O("makeLegalFunctionName",!1),O("emval_handle_array",!1),O("emval_free_list",!1),O("emval_symbols",!1),O("init_emval",!1),O("count_emval_handles",!1),O("get_first_emval",!1),O("getStringOrSymbol",!1),O("Emval",!1),O("emval_newers",!1),O("craftEmvalAllocator",!1),O("emval_get_global",!1),O("emval_methodCallers",!1),O("emval_registeredMethods",!1),U("ALLOC_NORMAL",!1),U("ALLOC_STACK",!1);var ka;function iy(v){this.name="ExitStatus",this.message="Program terminated with exit("+v+")",this.status=v}kn=function v(){ka||ls(),ka||(kn=v)};function sy(){Af(),gf()}function ls(v){if(Vr>0||(sy(),c0(),Vr>0))return;function p(){ka||(ka=!0,r.calledRun=!0,!j&&(g0(),n(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),N(!r._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),v0()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),p()},1)):p(),Ea()}if(r.run=ls,r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return ls(),r.ready}})();const SL="/assets/utils.a10d1552.wasm";let CL=async()=>{const t={locateFile:(e,r)=>SL};return new Promise((e,r)=>{TL(t).then(n=>{e(n)})})};function EL(t){let e,r,n,a,i,s=t[2]?"drag control point ":"add control point",f,o;return{c(){e=ti("main"),r=ti("div"),n=ti("div"),n.textContent="Press 'space' to change mode",a=uD(),i=ti("div"),f=Sp(s),gn(n,"class","svelte-1739nio"),gn(i,"class","svelte-1739nio"),gn(r,"class","message svelte-1739nio"),gn(e,"style",o="--theme-background1: rgb("+t[1][0]+", "+t[1][1]+", "+t[1][2]+" ); --theme-background2 : rgb("+t[3][0]+", "+t[3][1]+", "+t[3][2]+");"),gn(e,"class","svelte-1739nio")},m(u,g){fD(u,e,g),jn(e,r),jn(r,n),jn(r,a),jn(r,i),jn(i,f),t[4](e)},p(u,[g]){g&4&&s!==(s=u[2]?"drag control point ":"add control point")&&gD(f,s),g&2&&o!==(o="--theme-background1: rgb("+u[1][0]+", "+u[1][1]+", "+u[1][2]+" ); --theme-background2 : rgb("+u[3][0]+", "+u[3][1]+", "+u[3][2]+");")&&gn(e,"style",o)},i:_i,o:_i,d(u){u&&Tp(e),t[4](null)}}}function wL(t,e,r){let n,a=RR.newInstance({background:[1,0,0,0]}),i=[100,100,100],s=[200,200,200],f,o,u,g,c,l=1e3/60,h,y,S=!1,T=.5,E,x;lD(async()=>{r(1,i=[100,100,100]),a.setContainer(n),a.getRenderWindow().render(),a.resize();const F=a.getRenderer(),U=a.getRenderWindow();f=await gL("resources/decimated-knight.obj"),o=lL(f),o.getProperty().setColor(1,1,0),F.addActor(o),u=Rr.newInstance(),u.getPointData().addArray(Ne.newInstance({values:new Int32Array,name:"Reference"}));const O=dL.newInstance();O.setInputData(u),O.setRadius(.01),g=Mr.newInstance(),g.setMapper(O),g.getProperty().setColor(1,0,0),F.addActor(g);const A=a.getInteractor().getInteractorStyle();F.resetCamera(),U.render(),w(),a.getInteractor().onLeftButtonPress(W=>{c.pick([W.position.x,W.position.y,W.position.z],F);const j=c.getPointId();if(c.getActors().length!==0){if(A.endRotate(),A.endPan(),!S){const N=f.getPoints().getPoint(j);T=F.worldToNormalizedDisplay(...N)[2];let X=u.getPoints().getData();X=new Float32Array([...X,...N]),u.getPoints().setData(X,3),u.getPointData().getArray("Reference").insertNextTuple([j]),u.modified()}U.render()}}),a.getInteractor().onMouseMove(W=>{if(!S||c.getActors().length===0)return;const j=a.getRenderer(),N=c.getPointId(),I=[W.position.x,W.position.y,W.position.z],X=a.getInteractor().getView(),J=X.displayToNormalizedDisplay(...I),P=X.getViewportSize(j),G=j.normalizedDisplayToWorld(J[0],J[1],T,P[0]/P[1]);u.getPoints().setTuple(N,G),u.getPoints().setData(u.getPoints().getData(),3),u.modified(),j.resetCameraClippingRange()}),a.getInteractor().onLeftButtonRelease(W=>{!S||c.getActors().length!==0&&(c=eg.newInstance(),c.setPickFromList(!0),c.initializePickList(),c.addPickList(g))}),a.getInteractor().onKeyDown(W=>{W.key===" "&&r(2,S=!S),w()}),E=await CL(),x=new E.Simulator});const w=()=>{if(c=eg.newInstance(),c.setPickFromList(!0),c.initializePickList(),S){m(),console.log("Initialize Simulator here");const F=f.getPoints().getData(),U=f.getPolys().getData(),O=u.getPointData().getArray("Reference").getData();x.Initialize(F,U,O),c.addPickList(g),r(1,i=[100,100,255])}else cancelAnimationFrame(y),c.addPickList(o),r(1,i=[100,100,100]);a.resize()},C=()=>{const F=u.getPoints().getData(),U=f.getPoints().getData();let O=x.SingleIteration(F,U);f.getPoints().setData(O),f.modified()},m=()=>{h=Date.now(),y=requestAnimationFrame(D)},D=()=>{y=requestAnimationFrame(D);let F=Date.now(),U=F-h;U>l&&(h=F-U%l,C(),a.getRenderWindow().render())};function b(F){wo[F?"unshift":"push"](()=>{n=F,r(0,n)})}return[n,i,S,s,b]}class xL extends xD{constructor(e){super(),wD(this,e,wL,EL,sD,{})}}new xL({target:document.getElementById("app")});
