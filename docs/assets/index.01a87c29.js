(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Oe=1e-6,at=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function yg(){var t=new at(9);return at!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Vo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Oy(t){var e=new at(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function My(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Dy(t,e,r,n,a,i,s,f,o){var u=new at(9);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=i,u[6]=s,u[7]=f,u[8]=o,u}function my(t,e,r,n,a,i,s,f,o,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=f,t[7]=o,t[8]=u,t}function Jr(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function dg(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function _o(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=g*s-f*u,l=-g*i+f*o,h=u*i-s*o,y=r*c+n*l+a*h;return y?(y=1/y,t[0]=c*y,t[1]=(-g*n+a*u)*y,t[2]=(f*n-a*s)*y,t[3]=l*y,t[4]=(g*r-a*o)*y,t[5]=(-f*r+a*i)*y,t[6]=h*y,t[7]=(-u*r+n*o)*y,t[8]=(s*r-n*i)*y,t):null}function Ry(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8];return t[0]=s*g-f*u,t[1]=a*u-n*g,t[2]=n*f-a*s,t[3]=f*o-i*g,t[4]=r*g-a*o,t[5]=a*i-r*f,t[6]=i*u-s*o,t[7]=n*o-r*u,t[8]=r*s-n*i,t}function Ly(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],f=t[6],o=t[7],u=t[8];return e*(u*i-s*o)+r*(-u*a+s*f)+n*(o*a-i*f)}function bo(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=r[0],h=r[1],y=r[2],C=r[3],T=r[4],E=r[5],w=r[6],x=r[7],S=r[8];return t[0]=l*n+h*s+y*u,t[1]=l*a+h*f+y*g,t[2]=l*i+h*o+y*c,t[3]=C*n+T*s+E*u,t[4]=C*a+T*f+E*g,t[5]=C*i+T*o+E*c,t[6]=w*n+x*s+S*u,t[7]=w*a+x*f+S*g,t[8]=w*i+x*o+S*c,t}function Vy(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=r[0],h=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=s,t[4]=f,t[5]=o,t[6]=l*n+h*s+u,t[7]=l*a+h*f+g,t[8]=l*i+h*o+c,t}function _y(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=Math.sin(r),h=Math.cos(r);return t[0]=h*n+l*s,t[1]=h*a+l*f,t[2]=h*i+l*o,t[3]=h*s-l*n,t[4]=h*f-l*a,t[5]=h*o-l*i,t[6]=u,t[7]=g,t[8]=c,t}function by(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ky(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Fy(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function By(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ny(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Uy(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,f=n+n,o=a+a,u=r*s,g=n*s,c=n*f,l=a*s,h=a*f,y=a*o,C=i*s,T=i*f,E=i*o;return t[0]=1-c-y,t[3]=g-E,t[6]=l+T,t[1]=g+E,t[4]=1-u-y,t[7]=h-C,t[2]=l-T,t[5]=h+C,t[8]=1-u-c,t}function Gy(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=e[9],l=e[10],h=e[11],y=e[12],C=e[13],T=e[14],E=e[15],w=r*f-n*s,x=r*o-a*s,S=r*u-i*s,m=n*o-a*f,D=n*u-i*f,b=a*u-i*o,N=g*C-c*y,P=g*T-l*y,O=g*E-h*y,A=c*T-l*C,z=c*E-h*C,j=l*E-h*T,B=w*j-x*z+S*A+m*O-D*P+b*N;return B?(B=1/B,t[0]=(f*j-o*z+u*A)*B,t[1]=(o*O-s*j-u*P)*B,t[2]=(s*z-f*O+u*N)*B,t[3]=(a*z-n*j-i*A)*B,t[4]=(r*j-a*O+i*P)*B,t[5]=(n*O-r*z-i*N)*B,t[6]=(C*b-T*D+E*m)*B,t[7]=(T*S-y*b-E*x)*B,t[8]=(y*D-C*S+E*w)*B,t):null}function Ay(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Py(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Wy(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function zy(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function Tg(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function jy(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function $y(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Hy(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Ky(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],f=t[5],o=t[6],u=t[7],g=t[8],c=e[0],l=e[1],h=e[2],y=e[3],C=e[4],T=e[5],E=e[6],w=e[7],x=e[8];return Math.abs(r-c)<=Oe*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=Oe*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-h)<=Oe*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-y)<=Oe*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-C)<=Oe*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(f-T)<=Oe*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(o-E)<=Oe*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(u-w)<=Oe*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(g-x)<=Oe*Math.max(1,Math.abs(g),Math.abs(x))}var Xy=bo,Yy=Tg;const Iy=Object.freeze(Object.defineProperty({__proto__:null,create:yg,fromMat4:Vo,clone:Oy,copy:My,fromValues:Dy,set:my,identity:Jr,transpose:dg,invert:_o,adjoint:Ry,determinant:Ly,multiply:bo,translate:Vy,rotate:_y,scale:by,fromTranslation:ky,fromRotation:Fy,fromScaling:By,fromMat2d:Ny,fromQuat:Uy,normalFromMat4:Gy,projection:Ay,str:Py,frob:Wy,add:zy,subtract:Tg,multiplyScalar:jy,multiplyScalarAndAdd:$y,exactEquals:Hy,equals:Ky,mul:Xy,sub:Yy},Symbol.toStringTag,{value:"Module"}));function ko(){var t=new at(16);return at!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function qy(t){var e=new at(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ut(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Zy(t,e,r,n,a,i,s,f,o,u,g,c,l,h,y,C){var T=new at(16);return T[0]=t,T[1]=e,T[2]=r,T[3]=n,T[4]=a,T[5]=i,T[6]=s,T[7]=f,T[8]=o,T[9]=u,T[10]=g,T[11]=c,T[12]=l,T[13]=h,T[14]=y,T[15]=C,T}function Qy(t,e,r,n,a,i,s,f,o,u,g,c,l,h,y,C,T){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=s,t[6]=f,t[7]=o,t[8]=u,t[9]=g,t[10]=c,t[11]=l,t[12]=h,t[13]=y,t[14]=C,t[15]=T,t}function De(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function We(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],i=e[6],s=e[7],f=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=s,t[14]=f}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function wt(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=e[9],l=e[10],h=e[11],y=e[12],C=e[13],T=e[14],E=e[15],w=r*f-n*s,x=r*o-a*s,S=r*u-i*s,m=n*o-a*f,D=n*u-i*f,b=a*u-i*o,N=g*C-c*y,P=g*T-l*y,O=g*E-h*y,A=c*T-l*C,z=c*E-h*C,j=l*E-h*T,B=w*j-x*z+S*A+m*O-D*P+b*N;return B?(B=1/B,t[0]=(f*j-o*z+u*A)*B,t[1]=(a*z-n*j-i*A)*B,t[2]=(C*b-T*D+E*m)*B,t[3]=(l*D-c*b-h*m)*B,t[4]=(o*O-s*j-u*P)*B,t[5]=(r*j-a*O+i*P)*B,t[6]=(T*S-y*b-E*x)*B,t[7]=(g*b-l*S+h*x)*B,t[8]=(s*z-f*O+u*N)*B,t[9]=(n*O-r*z-i*N)*B,t[10]=(y*D-C*S+E*w)*B,t[11]=(c*S-g*D-h*w)*B,t[12]=(f*P-s*A-o*N)*B,t[13]=(r*A-n*P+a*N)*B,t[14]=(C*x-y*m-T*w)*B,t[15]=(g*m-c*x+l*w)*B,t):null}function Jy(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5],o=e[6],u=e[7],g=e[8],c=e[9],l=e[10],h=e[11],y=e[12],C=e[13],T=e[14],E=e[15];return t[0]=f*(l*E-h*T)-c*(o*E-u*T)+C*(o*h-u*l),t[1]=-(n*(l*E-h*T)-c*(a*E-i*T)+C*(a*h-i*l)),t[2]=n*(o*E-u*T)-f*(a*E-i*T)+C*(a*u-i*o),t[3]=-(n*(o*h-u*l)-f*(a*h-i*l)+c*(a*u-i*o)),t[4]=-(s*(l*E-h*T)-g*(o*E-u*T)+y*(o*h-u*l)),t[5]=r*(l*E-h*T)-g*(a*E-i*T)+y*(a*h-i*l),t[6]=-(r*(o*E-u*T)-s*(a*E-i*T)+y*(a*u-i*o)),t[7]=r*(o*h-u*l)-s*(a*h-i*l)+g*(a*u-i*o),t[8]=s*(c*E-h*C)-g*(f*E-u*C)+y*(f*h-u*c),t[9]=-(r*(c*E-h*C)-g*(n*E-i*C)+y*(n*h-i*c)),t[10]=r*(f*E-u*C)-s*(n*E-i*C)+y*(n*u-i*f),t[11]=-(r*(f*h-u*c)-s*(n*h-i*c)+g*(n*u-i*f)),t[12]=-(s*(c*T-l*C)-g*(f*T-o*C)+y*(f*l-o*c)),t[13]=r*(c*T-l*C)-g*(n*T-a*C)+y*(n*l-a*c),t[14]=-(r*(f*T-o*C)-s*(n*T-a*C)+y*(n*o-a*f)),t[15]=r*(f*l-o*c)-s*(n*l-a*c)+g*(n*o-a*f),t}function ed(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],s=t[5],f=t[6],o=t[7],u=t[8],g=t[9],c=t[10],l=t[11],h=t[12],y=t[13],C=t[14],T=t[15],E=e*s-r*i,w=e*f-n*i,x=e*o-a*i,S=r*f-n*s,m=r*o-a*s,D=n*o-a*f,b=u*y-g*h,N=u*C-c*h,P=u*T-l*h,O=g*C-c*y,A=g*T-l*y,z=c*T-l*C;return E*z-w*A+x*O+S*P-m*N+D*b}function Ct(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=e[8],l=e[9],h=e[10],y=e[11],C=e[12],T=e[13],E=e[14],w=e[15],x=r[0],S=r[1],m=r[2],D=r[3];return t[0]=x*n+S*f+m*c+D*C,t[1]=x*a+S*o+m*l+D*T,t[2]=x*i+S*u+m*h+D*E,t[3]=x*s+S*g+m*y+D*w,x=r[4],S=r[5],m=r[6],D=r[7],t[4]=x*n+S*f+m*c+D*C,t[5]=x*a+S*o+m*l+D*T,t[6]=x*i+S*u+m*h+D*E,t[7]=x*s+S*g+m*y+D*w,x=r[8],S=r[9],m=r[10],D=r[11],t[8]=x*n+S*f+m*c+D*C,t[9]=x*a+S*o+m*l+D*T,t[10]=x*i+S*u+m*h+D*E,t[11]=x*s+S*g+m*y+D*w,x=r[12],S=r[13],m=r[14],D=r[15],t[12]=x*n+S*f+m*c+D*C,t[13]=x*a+S*o+m*l+D*T,t[14]=x*i+S*u+m*h+D*E,t[15]=x*s+S*g+m*y+D*w,t}function et(t,e,r){var n=r[0],a=r[1],i=r[2],s,f,o,u,g,c,l,h,y,C,T,E;return e===t?(t[12]=e[0]*n+e[4]*a+e[8]*i+e[12],t[13]=e[1]*n+e[5]*a+e[9]*i+e[13],t[14]=e[2]*n+e[6]*a+e[10]*i+e[14],t[15]=e[3]*n+e[7]*a+e[11]*i+e[15]):(s=e[0],f=e[1],o=e[2],u=e[3],g=e[4],c=e[5],l=e[6],h=e[7],y=e[8],C=e[9],T=e[10],E=e[11],t[0]=s,t[1]=f,t[2]=o,t[3]=u,t[4]=g,t[5]=c,t[6]=l,t[7]=h,t[8]=y,t[9]=C,t[10]=T,t[11]=E,t[12]=s*n+g*a+y*i+e[12],t[13]=f*n+c*a+C*i+e[13],t[14]=o*n+l*a+T*i+e[14],t[15]=u*n+h*a+E*i+e[15]),t}function oa(t,e,r){var n=r[0],a=r[1],i=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Xt(t,e,r,n){var a=n[0],i=n[1],s=n[2],f=Math.hypot(a,i,s),o,u,g,c,l,h,y,C,T,E,w,x,S,m,D,b,N,P,O,A,z,j,B,Y;return f<Oe?null:(f=1/f,a*=f,i*=f,s*=f,o=Math.sin(r),u=Math.cos(r),g=1-u,c=e[0],l=e[1],h=e[2],y=e[3],C=e[4],T=e[5],E=e[6],w=e[7],x=e[8],S=e[9],m=e[10],D=e[11],b=a*a*g+u,N=i*a*g+s*o,P=s*a*g-i*o,O=a*i*g-s*o,A=i*i*g+u,z=s*i*g+a*o,j=a*s*g+i*o,B=i*s*g-a*o,Y=s*s*g+u,t[0]=c*b+C*N+x*P,t[1]=l*b+T*N+S*P,t[2]=h*b+E*N+m*P,t[3]=y*b+w*N+D*P,t[4]=c*O+C*A+x*z,t[5]=l*O+T*A+S*z,t[6]=h*O+E*A+m*z,t[7]=y*O+w*A+D*z,t[8]=c*j+C*B+x*Y,t[9]=l*j+T*B+S*Y,t[10]=h*j+E*B+m*Y,t[11]=y*j+w*B+D*Y,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Cg(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],s=e[5],f=e[6],o=e[7],u=e[8],g=e[9],c=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+u*n,t[5]=s*a+g*n,t[6]=f*a+c*n,t[7]=o*a+l*n,t[8]=u*a-i*n,t[9]=g*a-s*n,t[10]=c*a-f*n,t[11]=l*a-o*n,t}function Sg(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],f=e[2],o=e[3],u=e[8],g=e[9],c=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-u*n,t[1]=s*a-g*n,t[2]=f*a-c*n,t[3]=o*a-l*n,t[8]=i*n+u*a,t[9]=s*n+g*a,t[10]=f*n+c*a,t[11]=o*n+l*a,t}function Eg(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],s=e[1],f=e[2],o=e[3],u=e[4],g=e[5],c=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+u*n,t[1]=s*a+g*n,t[2]=f*a+c*n,t[3]=o*a+l*n,t[4]=u*a-i*n,t[5]=g*a-s*n,t[6]=c*a-f*n,t[7]=l*a-o*n,t}function xg(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function wg(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function td(t,e,r){var n=r[0],a=r[1],i=r[2],s=Math.hypot(n,a,i),f,o,u;return s<Oe?null:(s=1/s,n*=s,a*=s,i*=s,f=Math.sin(e),o=Math.cos(e),u=1-o,t[0]=n*n*u+o,t[1]=a*n*u+i*f,t[2]=i*n*u-a*f,t[3]=0,t[4]=n*a*u-i*f,t[5]=a*a*u+o,t[6]=i*a*u+n*f,t[7]=0,t[8]=n*i*u+a*f,t[9]=a*i*u-n*f,t[10]=i*i*u+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function rd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nd(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ad(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Og(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=n+n,o=a+a,u=i+i,g=n*f,c=n*o,l=n*u,h=a*o,y=a*u,C=i*u,T=s*f,E=s*o,w=s*u;return t[0]=1-(h+C),t[1]=c+w,t[2]=l-E,t[3]=0,t[4]=c-w,t[5]=1-(g+C),t[6]=y+T,t[7]=0,t[8]=l+E,t[9]=y-T,t[10]=1-(g+h),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function id(t,e){var r=new at(3),n=-e[0],a=-e[1],i=-e[2],s=e[3],f=e[4],o=e[5],u=e[6],g=e[7],c=n*n+a*a+i*i+s*s;return c>0?(r[0]=(f*s+g*n+o*i-u*a)*2/c,r[1]=(o*s+g*a+u*n-f*i)*2/c,r[2]=(u*s+g*i+f*a-o*n)*2/c):(r[0]=(f*s+g*n+o*i-u*a)*2,r[1]=(o*s+g*a+u*n-f*i)*2,r[2]=(u*s+g*i+f*a-o*n)*2),Og(t,e,r),t}function sd(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Mg(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],s=e[5],f=e[6],o=e[8],u=e[9],g=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(i,s,f),t[2]=Math.hypot(o,u,g),t}function Dg(t,e){var r=new at(3);Mg(r,e);var n=1/r[0],a=1/r[1],i=1/r[2],s=e[0]*n,f=e[1]*a,o=e[2]*i,u=e[4]*n,g=e[5]*a,c=e[6]*i,l=e[8]*n,h=e[9]*a,y=e[10]*i,C=s+g+y,T=0;return C>0?(T=Math.sqrt(C+1)*2,t[3]=.25*T,t[0]=(c-h)/T,t[1]=(l-o)/T,t[2]=(f-u)/T):s>g&&s>y?(T=Math.sqrt(1+s-g-y)*2,t[3]=(c-h)/T,t[0]=.25*T,t[1]=(f+u)/T,t[2]=(l+o)/T):g>y?(T=Math.sqrt(1+g-s-y)*2,t[3]=(l-o)/T,t[0]=(f+u)/T,t[1]=.25*T,t[2]=(c+h)/T):(T=Math.sqrt(1+y-s-g)*2,t[3]=(f-u)/T,t[0]=(l+o)/T,t[1]=(c+h)/T,t[2]=.25*T),t}function mg(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=e[3],o=a+a,u=i+i,g=s+s,c=a*o,l=a*u,h=a*g,y=i*u,C=i*g,T=s*g,E=f*o,w=f*u,x=f*g,S=n[0],m=n[1],D=n[2];return t[0]=(1-(y+T))*S,t[1]=(l+x)*S,t[2]=(h-w)*S,t[3]=0,t[4]=(l-x)*m,t[5]=(1-(c+T))*m,t[6]=(C+E)*m,t[7]=0,t[8]=(h+w)*D,t[9]=(C-E)*D,t[10]=(1-(c+y))*D,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function od(t,e,r,n,a){var i=e[0],s=e[1],f=e[2],o=e[3],u=i+i,g=s+s,c=f+f,l=i*u,h=i*g,y=i*c,C=s*g,T=s*c,E=f*c,w=o*u,x=o*g,S=o*c,m=n[0],D=n[1],b=n[2],N=a[0],P=a[1],O=a[2],A=(1-(C+E))*m,z=(h+S)*m,j=(y-x)*m,B=(h-S)*D,Y=(1-(l+E))*D,I=(T+w)*D,te=(y+x)*b,U=(T-w)*b,G=(1-(l+C))*b;return t[0]=A,t[1]=z,t[2]=j,t[3]=0,t[4]=B,t[5]=Y,t[6]=I,t[7]=0,t[8]=te,t[9]=U,t[10]=G,t[11]=0,t[12]=r[0]+N-(A*N+B*P+te*O),t[13]=r[1]+P-(z*N+Y*P+U*O),t[14]=r[2]+O-(j*N+I*P+G*O),t[15]=1,t}function Fo(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r+r,f=n+n,o=a+a,u=r*s,g=n*s,c=n*f,l=a*s,h=a*f,y=a*o,C=i*s,T=i*f,E=i*o;return t[0]=1-c-y,t[1]=g+E,t[2]=l-T,t[3]=0,t[4]=g-E,t[5]=1-u-y,t[6]=h+C,t[7]=0,t[8]=l+T,t[9]=h-C,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fd(t,e,r,n,a,i,s){var f=1/(r-e),o=1/(a-n),u=1/(i-s);return t[0]=i*2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i*2*o,t[6]=0,t[7]=0,t[8]=(r+e)*f,t[9]=(a+n)*o,t[10]=(s+i)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i*2*u,t[15]=0,t}function Rg(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=(a+n)*s,t[14]=2*a*n*s):(t[10]=-1,t[14]=-2*n),t}var ud=Rg;function cd(t,e,r,n,a){var i=1/Math.tan(e/2),s;return t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=a*s,t[14]=a*n*s):(t[10]=-1,t[14]=-n),t}function gd(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),f=Math.tan(e.rightDegrees*Math.PI/180),o=2/(s+f),u=2/(a+i);return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((s-f)*o*.5),t[9]=(a-i)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Lg(t,e,r,n,a,i,s){var f=1/(e-r),o=1/(n-a),u=1/(i-s);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*f,t[13]=(a+n)*o,t[14]=(s+i)*u,t[15]=1,t}var Vg=Lg;function vd(t,e,r,n,a,i,s){var f=1/(e-r),o=1/(n-a),u=1/(i-s);return t[0]=-2*f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+r)*f,t[13]=(a+n)*o,t[14]=i*u,t[15]=1,t}function _g(t,e,r,n){var a,i,s,f,o,u,g,c,l,h,y=e[0],C=e[1],T=e[2],E=n[0],w=n[1],x=n[2],S=r[0],m=r[1],D=r[2];return Math.abs(y-S)<Oe&&Math.abs(C-m)<Oe&&Math.abs(T-D)<Oe?De(t):(g=y-S,c=C-m,l=T-D,h=1/Math.hypot(g,c,l),g*=h,c*=h,l*=h,a=w*l-x*c,i=x*g-E*l,s=E*c-w*g,h=Math.hypot(a,i,s),h?(h=1/h,a*=h,i*=h,s*=h):(a=0,i=0,s=0),f=c*s-l*i,o=l*a-g*s,u=g*i-c*a,h=Math.hypot(f,o,u),h?(h=1/h,f*=h,o*=h,u*=h):(f=0,o=0,u=0),t[0]=a,t[1]=f,t[2]=g,t[3]=0,t[4]=i,t[5]=o,t[6]=c,t[7]=0,t[8]=s,t[9]=u,t[10]=l,t[11]=0,t[12]=-(a*y+i*C+s*T),t[13]=-(f*y+o*C+u*T),t[14]=-(g*y+c*C+l*T),t[15]=1,t)}function ld(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=n[0],o=n[1],u=n[2],g=a-r[0],c=i-r[1],l=s-r[2],h=g*g+c*c+l*l;h>0&&(h=1/Math.sqrt(h),g*=h,c*=h,l*=h);var y=o*l-u*c,C=u*g-f*l,T=f*c-o*g;return h=y*y+C*C+T*T,h>0&&(h=1/Math.sqrt(h),y*=h,C*=h,T*=h),t[0]=y,t[1]=C,t[2]=T,t[3]=0,t[4]=c*T-l*C,t[5]=l*y-g*T,t[6]=g*C-c*y,t[7]=0,t[8]=g,t[9]=c,t[10]=l,t[11]=0,t[12]=a,t[13]=i,t[14]=s,t[15]=1,t}function pd(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function hd(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function yd(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function bg(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function dd(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Td(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function Cd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Sd(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],s=t[4],f=t[5],o=t[6],u=t[7],g=t[8],c=t[9],l=t[10],h=t[11],y=t[12],C=t[13],T=t[14],E=t[15],w=e[0],x=e[1],S=e[2],m=e[3],D=e[4],b=e[5],N=e[6],P=e[7],O=e[8],A=e[9],z=e[10],j=e[11],B=e[12],Y=e[13],I=e[14],te=e[15];return Math.abs(r-w)<=Oe*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(n-x)<=Oe*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(a-S)<=Oe*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(i-m)<=Oe*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-D)<=Oe*Math.max(1,Math.abs(s),Math.abs(D))&&Math.abs(f-b)<=Oe*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(o-N)<=Oe*Math.max(1,Math.abs(o),Math.abs(N))&&Math.abs(u-P)<=Oe*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(g-O)<=Oe*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(c-A)<=Oe*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(l-z)<=Oe*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(h-j)<=Oe*Math.max(1,Math.abs(h),Math.abs(j))&&Math.abs(y-B)<=Oe*Math.max(1,Math.abs(y),Math.abs(B))&&Math.abs(C-Y)<=Oe*Math.max(1,Math.abs(C),Math.abs(Y))&&Math.abs(T-I)<=Oe*Math.max(1,Math.abs(T),Math.abs(I))&&Math.abs(E-te)<=Oe*Math.max(1,Math.abs(E),Math.abs(te))}var qs=Ct,Ed=bg;const Zs=Object.freeze(Object.defineProperty({__proto__:null,create:ko,clone:qy,copy:ut,fromValues:Zy,set:Qy,identity:De,transpose:We,invert:wt,adjoint:Jy,determinant:ed,multiply:Ct,translate:et,scale:oa,rotate:Xt,rotateX:Cg,rotateY:Sg,rotateZ:Eg,fromTranslation:xg,fromScaling:wg,fromRotation:td,fromXRotation:rd,fromYRotation:nd,fromZRotation:ad,fromRotationTranslation:Og,fromQuat2:id,getTranslation:sd,getScaling:Mg,getRotation:Dg,fromRotationTranslationScale:mg,fromRotationTranslationScaleOrigin:od,fromQuat:Fo,frustum:fd,perspectiveNO:Rg,perspective:ud,perspectiveZO:cd,perspectiveFromFieldOfView:gd,orthoNO:Lg,ortho:Vg,orthoZO:vd,lookAt:_g,targetTo:ld,str:pd,frob:hd,add:yd,subtract:bg,multiplyScalar:dd,multiplyScalarAndAdd:Td,exactEquals:Cd,equals:Sd,mul:qs,sub:Ed},Symbol.toStringTag,{value:"Module"}));function kg(){var t=new at(3);return at!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xd(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function Xf(t,e,r){var n=new at(3);return n[0]=t,n[1]=e,n[2]=r,n}function Ti(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Kn(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function xr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function yr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function wd(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function fa(t,e){var r=e[0],n=e[1],a=e[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Fg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function ps(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[0],f=r[1],o=r[2];return t[0]=a*o-i*f,t[1]=i*s-n*o,t[2]=n*f-a*s,t}function me(t,e,r){var n=e[0],a=e[1],i=e[2],s=r[3]*n+r[7]*a+r[11]*i+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/s,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/s,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/s,t}function Yf(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function If(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],s=e[1],f=e[2];return Math.abs(r-i)<=Oe*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=Oe*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-f)<=Oe*Math.max(1,Math.abs(a),Math.abs(f))}var Qs=xr,Bg=xd;(function(){var t=kg();return function(e,r,n,a,i,s){var f,o;for(r||(r=3),n||(n=0),a?o=Math.min(a*r+n,e.length):o=e.length,f=n;f<o;f+=r)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],i(t,t,s),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2];return e}})();function Od(){var t=new at(4);return at!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Md(t,e,r,n){var a=new at(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a}function Dd(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],s=r*r+n*n+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=i*s,t}function dn(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*s,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*s,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*s,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*s,t}(function(){var t=Od();return function(e,r,n,a,i,s){var f,o;for(r||(r=4),n||(n=0),a?o=Math.min(a*r+n,e.length):o=e.length,f=n;f<o;f+=r)t[0]=e[f],t[1]=e[f+1],t[2]=e[f+2],t[3]=e[f+3],i(t,t,s),e[f]=t[0],e[f+1]=t[1],e[f+2]=t[2],e[f+3]=t[3];return e}})();function qr(){var t=new at(4);return at!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Bo(t,e,r){r=r*.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function md(t,e){var r=Math.acos(e[3])*2,n=Math.sin(r/2);return n>Oe?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function qf(t,e,r){var n=e[0],a=e[1],i=e[2],s=e[3],f=r[0],o=r[1],u=r[2],g=r[3];return t[0]=n*g+s*f+a*u-i*o,t[1]=a*g+s*o+i*f-n*u,t[2]=i*g+s*u+n*o-a*f,t[3]=s*g-n*f-a*o-i*u,t}function hs(t,e,r,n){var a=e[0],i=e[1],s=e[2],f=e[3],o=r[0],u=r[1],g=r[2],c=r[3],l,h,y,C,T;return h=a*o+i*u+s*g+f*c,h<0&&(h=-h,o=-o,u=-u,g=-g,c=-c),1-h>Oe?(l=Math.acos(h),y=Math.sin(l),C=Math.sin((1-n)*l)/y,T=Math.sin(n*l)/y):(C=1-n,T=n),t[0]=C*a+T*o,t[1]=C*i+T*u,t[2]=C*s+T*g,t[3]=C*f+T*c,t}function Rd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ld(t,e){var r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var i=(a+1)%3,s=(a+2)%3;n=Math.sqrt(e[a*3+a]-e[i*3+i]-e[s*3+s]+1),t[a]=.5*n,n=.5/n,t[3]=(e[i*3+s]-e[s*3+i])*n,t[i]=(e[i*3+a]+e[a*3+i])*n,t[s]=(e[s*3+a]+e[a*3+s])*n}return t}var Zf=Md,Ng=Dd;(function(){var t=kg(),e=Xf(1,0,0),r=Xf(0,1,0);return function(n,a,i){var s=Fg(a,i);return s<-.999999?(ps(t,e,a),Bg(t)<1e-6&&ps(t,r,a),fa(t,t),Bo(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ps(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,Ng(n,n))}})();(function(){var t=qr(),e=qr();return function(r,n,a,i,s,f){return hs(t,n,s,f),hs(e,a,i,f),hs(r,t,e,2*f*(1-f)),r}})();(function(){var t=yg();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Ng(e,Ld(e,t))}})();function Vd(t){if(Array.isArray(t))return t}function _d(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],a=!0,i=!1,s,f;try{for(r=r.call(t);!(a=(s=r.next()).done)&&(n.push(s.value),!(e&&n.length===e));a=!0);}catch(o){i=!0,f=o}finally{try{!a&&r.return!=null&&r.return()}finally{if(i)throw f}}return n}}function Js(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ug(t,e){if(!!t){if(typeof t=="string")return Js(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Js(t,e)}}function bd(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function St(t,e){return Vd(t)||_d(t,e)||Ug(t,e)||bd()}function Zr(t){return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(t)}function de(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kd(t){if(Array.isArray(t))return Js(t)}function Fd(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bd(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(t){return kd(t)||Fd(t)||Ug(t)||Bd()}function ua(t,e){return ua=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},ua(t,e)}function Nd(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ea(t,e,r){return Nd()?ea=Reflect.construct:ea=function(a,i,s){var f=[null];f.push.apply(f,i);var o=Function.bind.apply(a,f),u=new o;return s&&ua(u,s.prototype),u},ea.apply(null,arguments)}var _t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ud(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Gd(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}),r}var Qf=Object.prototype.toString,Gg=function(e){var r=Qf.call(e),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Qf.call(e.callee)==="[object Function]"),n},ys,Jf;function Ad(){if(Jf)return ys;Jf=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=Gg,a=Object.prototype.propertyIsEnumerable,i=!a.call({toString:null},"toString"),s=a.call(function(){},"prototype"),f=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=function(l){var h=l.constructor;return h&&h.prototype===l},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},g=function(){if(typeof window>"u")return!1;for(var l in window)try{if(!u["$"+l]&&e.call(window,l)&&window[l]!==null&&typeof window[l]=="object")try{o(window[l])}catch{return!0}}catch{return!0}return!1}(),c=function(l){if(typeof window>"u"||!g)return o(l);try{return o(l)}catch{return!1}};t=function(h){var y=h!==null&&typeof h=="object",C=r.call(h)==="[object Function]",T=n(h),E=y&&r.call(h)==="[object String]",w=[];if(!y&&!C&&!T)throw new TypeError("Object.keys called on a non-object");var x=s&&C;if(E&&h.length>0&&!e.call(h,0))for(var S=0;S<h.length;++S)w.push(String(S));if(T&&h.length>0)for(var m=0;m<h.length;++m)w.push(String(m));else for(var D in h)!(x&&D==="prototype")&&e.call(h,D)&&w.push(String(D));if(i)for(var b=c(h),N=0;N<f.length;++N)!(b&&f[N]==="constructor")&&e.call(h,f[N])&&w.push(f[N]);return w}}return ys=t,ys}var Pd=Array.prototype.slice,Wd=Gg,eu=Object.keys,ci=eu?function(e){return eu(e)}:Ad(),tu=Object.keys;ci.shim=function(){if(Object.keys){var e=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);e||(Object.keys=function(n){return Wd(n)?tu(Pd.call(n)):tu(n)})}else Object.keys=ci;return Object.keys||ci};var zd=ci,jd=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[r]=a;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==a||s.enumerable!==!0)return!1}return!0},ru=typeof Symbol<"u"&&Symbol,$d=jd,Hd=function(){return typeof ru!="function"||typeof Symbol!="function"||typeof ru("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:$d()},Kd="Function.prototype.bind called on incompatible ",ds=Array.prototype.slice,Xd=Object.prototype.toString,Yd="[object Function]",Id=function(e){var r=this;if(typeof r!="function"||Xd.call(r)!==Yd)throw new TypeError(Kd+r);for(var n=ds.call(arguments,1),a,i=function(){if(this instanceof a){var g=r.apply(this,n.concat(ds.call(arguments)));return Object(g)===g?g:this}else return r.apply(e,n.concat(ds.call(arguments)))},s=Math.max(0,r.length-n.length),f=[],o=0;o<s;o++)f.push("$"+o);if(a=Function("binder","return function ("+f.join(",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var u=function(){};u.prototype=r.prototype,a.prototype=new u,u.prototype=null}return a},qd=Id,Ag=Function.prototype.bind||qd,Zd=Ag,Qd=Zd.call(Function.call,Object.prototype.hasOwnProperty),Me,On=SyntaxError,Pg=Function,Sn=TypeError,Ts=function(t){try{return Pg('"use strict"; return ('+t+").constructor;")()}catch{}},Yr=Object.getOwnPropertyDescriptor;if(Yr)try{Yr({},"")}catch{Yr=null}var Cs=function(){throw new Sn},Jd=Yr?function(){try{return arguments.callee,Cs}catch{try{return Yr(arguments,"callee").get}catch{return Cs}}}():Cs,on=Hd(),Cr=Object.getPrototypeOf||function(t){return t.__proto__},hn={},e1=typeof Uint8Array>"u"?Me:Cr(Uint8Array),En={"%AggregateError%":typeof AggregateError>"u"?Me:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Me:ArrayBuffer,"%ArrayIteratorPrototype%":on?Cr([][Symbol.iterator]()):Me,"%AsyncFromSyncIteratorPrototype%":Me,"%AsyncFunction%":hn,"%AsyncGenerator%":hn,"%AsyncGeneratorFunction%":hn,"%AsyncIteratorPrototype%":hn,"%Atomics%":typeof Atomics>"u"?Me:Atomics,"%BigInt%":typeof BigInt>"u"?Me:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Me:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?Me:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Me:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Me:FinalizationRegistry,"%Function%":Pg,"%GeneratorFunction%":hn,"%Int8Array%":typeof Int8Array>"u"?Me:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Me:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Me:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":on?Cr(Cr([][Symbol.iterator]())):Me,"%JSON%":typeof JSON=="object"?JSON:Me,"%Map%":typeof Map>"u"?Me:Map,"%MapIteratorPrototype%":typeof Map>"u"||!on?Me:Cr(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Me:Promise,"%Proxy%":typeof Proxy>"u"?Me:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?Me:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Me:Set,"%SetIteratorPrototype%":typeof Set>"u"||!on?Me:Cr(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Me:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":on?Cr(""[Symbol.iterator]()):Me,"%Symbol%":on?Symbol:Me,"%SyntaxError%":On,"%ThrowTypeError%":Jd,"%TypedArray%":e1,"%TypeError%":Sn,"%Uint8Array%":typeof Uint8Array>"u"?Me:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Me:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Me:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Me:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?Me:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Me:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Me:WeakSet},t1=function t(e){var r;if(e==="%AsyncFunction%")r=Ts("async function () {}");else if(e==="%GeneratorFunction%")r=Ts("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Ts("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=t("%AsyncGenerator%");a&&(r=Cr(a.prototype))}return En[e]=r,r},nu={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},da=Ag,Ci=Qd,r1=da.call(Function.call,Array.prototype.concat),n1=da.call(Function.apply,Array.prototype.splice),au=da.call(Function.call,String.prototype.replace),Si=da.call(Function.call,String.prototype.slice),a1=da.call(Function.call,RegExp.prototype.exec),i1=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,s1=/\\(\\)?/g,o1=function(e){var r=Si(e,0,1),n=Si(e,-1);if(r==="%"&&n!=="%")throw new On("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new On("invalid intrinsic syntax, expected opening `%`");var a=[];return au(e,i1,function(i,s,f,o){a[a.length]=f?au(o,s1,"$1"):s||i}),a},f1=function(e,r){var n=e,a;if(Ci(nu,n)&&(a=nu[n],n="%"+a[0]+"%"),Ci(En,n)){var i=En[n];if(i===hn&&(i=t1(n)),typeof i>"u"&&!r)throw new Sn("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:i}}throw new On("intrinsic "+e+" does not exist!")},u1=function(e,r){if(typeof e!="string"||e.length===0)throw new Sn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Sn('"allowMissing" argument must be a boolean');if(a1(/^%?[^%]*%?$/,e)===null)throw new On("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=o1(e),a=n.length>0?n[0]:"",i=f1("%"+a+"%",r),s=i.name,f=i.value,o=!1,u=i.alias;u&&(a=u[0],n1(n,r1([0,1],u)));for(var g=1,c=!0;g<n.length;g+=1){var l=n[g],h=Si(l,0,1),y=Si(l,-1);if((h==='"'||h==="'"||h==="`"||y==='"'||y==="'"||y==="`")&&h!==y)throw new On("property names with quotes must have matching quotes");if((l==="constructor"||!c)&&(o=!0),a+="."+l,s="%"+a+"%",Ci(En,s))f=En[s];else if(f!=null){if(!(l in f)){if(!r)throw new Sn("base intrinsic for "+e+" exists, but the property is not available.");return}if(Yr&&g+1>=n.length){var C=Yr(f,l);c=!!C,c&&"get"in C&&!("originalValue"in C.get)?f=C.get:f=f[l]}else c=Ci(f,l),f=f[l];c&&!o&&(En[s]=f)}}return f},c1=u1,eo=c1("%Object.defineProperty%",!0),to=function(){if(eo)try{return eo({},"a",{value:1}),!0}catch{return!1}return!1};to.hasArrayLengthDefineBug=function(){if(!to())return null;try{return eo([],"length",{value:1}).length!==1}catch{return!0}};var g1=to,v1=zd,l1=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",p1=Object.prototype.toString,h1=Array.prototype.concat,Wg=Object.defineProperty,y1=function(t){return typeof t=="function"&&p1.call(t)==="[object Function]"},d1=g1(),zg=Wg&&d1,T1=function(t,e,r,n){e in t&&(!y1(n)||!n())||(zg?Wg(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},jg=function(t,e){var r=arguments.length>2?arguments[2]:{},n=v1(e);l1&&(n=h1.call(n,Object.getOwnPropertySymbols(e)));for(var a=0;a<n.length;a+=1)T1(t,n[a],e[n[a]],r[n[a]])};jg.supportsDescriptors=!!zg;var $g=jg,ta={exports:{}};typeof self<"u"?ta.exports=self:typeof window<"u"?ta.exports=window:ta.exports=Function("return this")();var C1=ta.exports,Hg=function(){return typeof _t!="object"||!_t||_t.Math!==Math||_t.Array!==Array?C1:_t},S1=$g,E1=Hg,x1=function(){var e=E1();if(S1.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(e,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==e))&&Object.defineProperty(e,"globalThis",{configurable:!0,enumerable:!1,value:e,writable:!0})}else(typeof globalThis!="object"||globalThis!==e)&&(e.globalThis=e);return e},w1=$g,O1=ta.exports,Kg=Hg,M1=x1,D1=Kg(),Xg=function(){return D1};w1(Xg,{getPolyfill:Kg,implementation:O1,shim:M1});var m1=Xg;function iu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function R1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var At=m1(),Yg={vtkObject:function(){return null}};function zt(t){if(t==null||t.isA)return t;if(!t.vtkClass)return At.console&&At.console.error&&At.console.error("Invalid VTK object"),null;var e=Yg[t.vtkClass];if(!e)return At.console&&At.console.error&&At.console.error("No vtk class found for Object of type ".concat(t.vtkClass)),null;var r=R1({},t);Object.keys(r).forEach(function(a){r[a]&&Zr(r[a])==="object"&&r[a].vtkClass&&(r[a]=zt(r[a]))});var n=e(r);return n&&n.modified&&n.modified(),n}function L1(t,e){Yg[t]=e}zt.register=L1;function No(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function su(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Uo(t,e,r){return e&&su(t.prototype,e),r&&su(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qr(t){return Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Qr(t)}function V1(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Qr(t),t!==null););return t}function gi(){return typeof Reflect<"u"&&Reflect.get?gi=Reflect.get:gi=function(e,r,n){var a=V1(e,r);if(!!a){var i=Object.getOwnPropertyDescriptor(a,r);return i.get?i.get.call(arguments.length<3?e:n):i.value}},gi.apply(this,arguments)}function _1(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ua(t,e)}function b1(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k1(t,e){if(e&&(Zr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b1(t)}function F1(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function ro(t){var e=typeof Map=="function"?new Map:void 0;return ro=function(n){if(n===null||!F1(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,a)}function a(){return ea(n,arguments,Qr(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),ua(a,n)},ro(t)}function B1(t){var e=N1();return function(){var n=Qr(t),a;if(e){var i=Qr(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return k1(this,a)}}function N1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ss=function(t){_1(r,t);var e=B1(r);function r(){return No(this,r),e.apply(this,arguments)}return Uo(r,[{key:"push",value:function(){for(var a=this,i,s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];var u=f.filter(function(g){return!a.includes(g)});return(i=gi(Qr(r.prototype),"push",this)).call.apply(i,[this].concat(Ee(u)))}}]),r}(ro(Array));function ou(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function no(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ou(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ou(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ao=0,U1=Symbol("void");function G1(){return ao}var Ig={};function $r(){}var A1=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];A1.forEach(function(t){Ig[t]=$r});At.console=console.hasOwnProperty("log")?console:Ig;var Ot={debug:$r,error:At.console.error||$r,info:At.console.info||$r,log:At.console.log||$r,warn:At.console.warn||$r};function P1(t,e){Ot[t]&&(Ot[t]=e||$r)}function W1(){Ot.log.apply(Ot,arguments)}function z1(){Ot.info.apply(Ot,arguments)}function Mr(){Ot.debug.apply(Ot,arguments)}function ve(){Ot.error.apply(Ot,arguments)}function Bi(){Ot.warn.apply(Ot,arguments)}var fu={};function j1(t){fu[t]||(Ot.error(t),fu[t]=!0)}var kt=Object.create(null);kt.Float32Array=Float32Array;kt.Float64Array=Float64Array;kt.Uint8Array=Uint8Array;kt.Int8Array=Int8Array;kt.Uint16Array=Uint16Array;kt.Int16Array=Int16Array;kt.Uint32Array=Uint32Array;kt.Int32Array=Int32Array;kt.Uint8ClampedArray=Uint8ClampedArray;function Ta(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return ea(kt[t]||Float64Array,r)}function qg(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return(e=kt[t]||Float64Array).from.apply(e,n)}function Go(t){return t.charAt(0).toUpperCase()+t.slice(1)}function ct(t){return Go(t[0]==="_"?t.slice(1):t)}function $1(t){return t.charAt(0).toLowerCase()+t.slice(1)}function H1(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,n=["TB","GB","MB","KB"],a=Number(t),i="B";a>r;)a/=r,i=n.pop();return"".concat(a.toFixed(e)," ").concat(i)}function K1(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ",r=[],n=t;n>1e3;)r.push("000".concat(n%1e3).slice(-3)),n=Math.floor(n/1e3);return n>0&&r.push(n),r.reverse(),r.join(e)}function Zg(t){Object.keys(t).forEach(function(e){Array.isArray(t[e])&&(t[e]=[].concat(t[e]))})}function X1(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Y1(t,e){return Object.keys(t).find(function(r){return t[r]===e})}function Qg(t){return t&&t.isA?t.getState():t}function Jg(t){setTimeout(t,0)}function I1(t,e){var r=performance.now();t.finally(function(){var n=performance.now()-r;e(n)})}function yt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Zg(e);var r=[];Number.isInteger(e.mtime)||(e.mtime=++ao),"classHierarchy"in e?e.classHierarchy instanceof Ss||(e.classHierarchy=Ss.from(e.classHierarchy)):e.classHierarchy=new Ss("vtkObject");function n(i){r[i]=null}function a(i){function s(){n(i)}return Object.freeze({unsubscribe:s})}return t.isDeleted=function(){return!!e.deleted},t.modified=function(i){if(e.deleted){ve("instance deleted - cannot call any method");return}i&&i<t.getMTime()||(e.mtime=++ao,r.forEach(function(s){return s&&s(t)}))},t.onModified=function(i){if(e.deleted)return ve("instance deleted - cannot call any method"),null;var s=r.length;return r.push(i),a(s)},t.getMTime=function(){return e.mtime},t.isA=function(i){for(var s=e.classHierarchy.length;s--;)if(e.classHierarchy[s]===i)return!0;return!1},t.getClassName=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.classHierarchy[e.classHierarchy.length-1-i]},t.set=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1;return Object.keys(i).forEach(function(u){var g=f?null:t["set".concat(Go(u))];g&&Array.isArray(i[u])&&g.length>1?o=g.apply(void 0,Ee(i[u]))||o:g?o=g(i[u])||o:(["mtime"].indexOf(u)===-1&&!s&&Bi("Warning: Set value to model directly ".concat(u,", ").concat(i[u])),o=e[u]!==i[u]||o,e[u]=i[u])}),o},t.get=function(){for(var i=arguments.length,s=new Array(i),f=0;f<i;f++)s[f]=arguments[f];if(!s.length)return e;var o={};return s.forEach(function(u){o[u]=e[u]}),o},t.getReferenceByName=function(i){return e[i]},t.delete=function(){Object.keys(e).forEach(function(i){return delete e[i]}),r.forEach(function(i,s){return n(s)}),e.deleted=!0},t.getState=function(){if(e.deleted)return null;var i=no(no({},e),{},{vtkClass:t.getClassName()});Object.keys(i).forEach(function(f){i[f]===null||i[f]===void 0||f[0]==="_"?delete i[f]:i[f].isA?i[f]=i[f].getState():Array.isArray(i[f])&&(i[f]=i[f].map(Qg))});var s={};return Object.keys(i).sort().forEach(function(f){s[f]=i[f]}),s.mtime&&delete s.mtime,s},t.shallowCopy=function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i.getClassName()!==t.getClassName())throw new Error("Cannot ShallowCopy ".concat(i.getClassName()," into ").concat(t.getClassName()));var f=i.get(),o=Object.keys(e).sort(),u=Object.keys(f).sort();u.forEach(function(g){var c=o.indexOf(g);c===-1?s&&Mr("add ".concat(g," in shallowCopy")):o.splice(c,1),e[g]=f[g]}),o.length&&s&&Mr("Untouched keys: ".concat(o.join(", "))),t.modified()},t.toJSON=function(){return t.getState()},t}function Ft(t,e,r){r.forEach(function(n){Zr(n)==="object"?t["get".concat(ct(n.name))]=function(){return e[n.name]}:t["get".concat(ct(n))]=function(){return e[n]}})}var q1={enum:function(e,r,n){return function(a){if(typeof a=="string"){if(n.enum[a]!==void 0)return r[n.name]!==n.enum[a]?(r[n.name]=n.enum[a],e.modified(),!0):!1;throw ve("Set Enum with invalid argument ".concat(n,", ").concat(a)),new RangeError("Set Enum with invalid string argument")}if(typeof a=="number"){if(r[n.name]!==a){if(Object.keys(n.enum).map(function(i){return n.enum[i]}).indexOf(a)!==-1)return r[n.name]=a,e.modified(),!0;throw ve("Set Enum outside numeric range ".concat(n,", ").concat(a)),new RangeError("Set Enum outside numeric range")}return!1}throw ve("Set Enum with invalid argument (String/Number) ".concat(n,", ").concat(a)),new TypeError("Set Enum with invalid argument (String/Number)")}}};function uu(t){if(Zr(t)==="object"){var e=q1[t.type];if(e)return function(r,n){return e(r,n,t)};throw ve("No setter for field ".concat(t)),new TypeError("No setter for field")}return function(n,a){return function(s){return a.deleted?(ve("instance deleted - cannot call any method"),!1):a[t]!==s?(a[t]=s,n.modified(),!0):!1}}}function Ni(t,e,r){r.forEach(function(n){Zr(n)==="object"?t["set".concat(ct(n.name))]=uu(n)(t,e):t["set".concat(ct(n))]=uu(n)(t,e)})}function gt(t,e,r){Ft(t,e,r),Ni(t,e,r)}function Ca(t,e,r){r.forEach(function(n){t["get".concat(ct(n))]=function(){return e[n]?[].concat(e[n]):e[n]},t["get".concat(ct(n),"ByReference")]=function(){return e[n]}})}function ev(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;r.forEach(function(i){if(e[i]&&n&&e[i].length!==n)throw new RangeError("Invalid initial number of values for array (".concat(i,")"));t["set".concat(ct(i))]=function(){if(e.deleted)return ve("instance deleted - cannot call any method"),!1;for(var s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];var u=f,g,c=!1;if(u.length===1&&(u[0]==null||u[0].length>=0)&&(u=u[0],c=!0),u==null)g=e[i]!==u;else{if(n&&u.length!==n)if(u.length<n&&a!==void 0)for(u=Array.from(u),c=!1;u.length<n;)u.push(a);else throw new RangeError("Invalid number of values for array setter (".concat(i,")"));g=e[i]==null||e[i].some(function(l,h){return l!==u[h]})||e[i].length!==u.length,g&&c&&(u=Array.from(u))}return g&&(e[i]=u,t.modified()),g},t["set".concat(ct(i),"From")]=function(s){var f=e[i];s.forEach(function(o,u){f[u]=o})}})}function tv(t,e,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Ca(t,e,r),ev(t,e,r,n,a)}function Ao(t,e,r){for(var n=0;n<r.length;n++){var a=r[n];e[a]!==void 0&&(e["_".concat(a)]=e[a],delete e[a])}}function Z1(t,e,r,n){e.inputData?e.inputData=e.inputData.map(zt):e.inputData=[],e.inputConnection?e.inputConnection=e.inputConnection.map(zt):e.inputConnection=[],e.output?e.output=e.output.map(zt):e.output=[],e.inputArrayToProcess?e.inputArrayToProcess=e.inputArrayToProcess.map(zt):e.inputArrayToProcess=[],e.numberOfInputs=r;function a(y){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ve("instance deleted - cannot call any method");return}if(C>=e.numberOfInputs){ve("algorithm ".concat(t.getClassName()," only has ").concat(e.numberOfInputs," input ports. To add more input ports, use addInputData()"));return}(e.inputData[C]!==y||e.inputConnection[C])&&(e.inputData[C]=y,e.inputConnection[C]=null,t.modified&&t.modified())}function i(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[y]&&(e.inputData[y]=e.inputConnection[y]()),e.inputData[y]}function s(y){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(e.deleted){ve("instance deleted - cannot call any method");return}if(C>=e.numberOfInputs){var T="algorithm ".concat(t.getClassName()," only has ");T+="".concat(e.numberOfInputs),T+=" input ports. To add more input ports, use addInputConnection()",ve(T);return}e.inputData[C]=null,e.inputConnection[C]=y}function f(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.inputConnection[y]}function o(){for(var y=e.numberOfInputs;y&&!e.inputData[y-1]&&!e.inputConnection[y-1];)y--;return y===e.numberOfInputs&&e.numberOfInputs++,y}function u(y){if(e.deleted){ve("instance deleted - cannot call any method");return}s(y,o())}function g(y){if(e.deleted){ve("instance deleted - cannot call any method");return}a(y,o())}function c(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e.deleted?(ve("instance deleted - cannot call any method"),null):(t.shouldUpdate()&&t.update(),e.output[y])}t.shouldUpdate=function(){for(var y=t.getMTime(),C=1/0,T=n;T--;){if(!e.output[T]||e.output[T].isDeleted())return!0;var E=e.output[T].getMTime();if(E<y)return!0;E<C&&(C=E)}for(T=e.numberOfInputs;T--;){var w,x;if((w=e.inputConnection[T])!==null&&w!==void 0&&w.filter.shouldUpdate()||((x=t.getInputData(T))===null||x===void 0?void 0:x.getMTime())>C)return!0}return!1};function l(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,C=function(){return c(y)};return C.filter=t,C}if(e.numberOfInputs){for(var h=e.numberOfInputs;h--;)e.inputData.push(null),e.inputConnection.push(null);t.setInputData=a,t.setInputConnection=s,t.addInputData=g,t.addInputConnection=u,t.getInputData=i,t.getInputConnection=f}n&&(t.getOutputData=c,t.getOutputPort=l),t.update=function(){var y=[];if(e.numberOfInputs)for(var C=0;C<e.numberOfInputs;)y[C]=t.getInputData(C),C++;t.shouldUpdate()&&t.requestData&&t.requestData(y,e.output)},t.getNumberOfInputPorts=function(){return e.numberOfInputs},t.getNumberOfOutputPorts=function(){return n||e.output.length},t.getInputArrayToProcess=function(y){var C=e.inputArrayToProcess[y],T=e.inputData[y];return C&&T?T["get".concat(C.fieldAssociation)]().getArray(C.arrayName):null},t.setInputArrayToProcess=function(y,C,T){for(var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";e.inputArrayToProcess.length<y;)e.inputArrayToProcess.push(null);e.inputArrayToProcess[y]={arrayName:C,fieldAssociation:T,attributeType:E}}}var rv=Symbol("Event abort");function Q1(t,e,r){var n=[],a=t.delete,i=1;function s(u){for(var g=0;g<n.length;++g){var c=St(n[g],1),l=c[0];if(l===u){n.splice(g,1);return}}}function f(u){function g(){s(u)}return Object.freeze({unsubscribe:g})}function o(){var u=arguments;if(e.deleted){ve("instance deleted - cannot call any method");return}for(var g=n.slice(),c=function(C){var T=St(g[C],3),E=T[1],w=T[2];if(!E)return"continue";if(w<0)setTimeout(function(){return E.apply(t,u)},1-w);else{var x=E.apply(t,u);if(x===rv)return"break"}},l=0;l<g.length;++l){var h=c(l);if(h!=="continue"&&h==="break")break}}t["invoke".concat(ct(r))]=o,t["on".concat(ct(r))]=function(u){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error("Invalid callback for event ".concat(r)),null;if(e.deleted)return ve("instance deleted - cannot call any method"),null;var c=i++;return n.push([c,u,g]),n.sort(function(l,h){return h[2]-l[2]}),f(c)},t.delete=function(){a(),n.forEach(function(u){var g=St(u,1),c=g[0];return s(c)})}}function Ue(t,e){var r=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={},s={};return t(s,i,a),Object.freeze(s)};return e&&zt.register(e,r),r}function J1(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e.filter(function(s){return!!s}).map(function(s){return s.apply(void 0,a)})}}function nv(t){return t&&t.isA&&t.isA("vtkObject")}function io(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(nv(t)){if(n.indexOf(t)>=0)return r;n.push(t);var a=e(t);a!==void 0&&r.push(a);var i=t.get();Object.keys(i).forEach(function(s){var f=i[s];Array.isArray(f)?f.forEach(function(o){io(o,e,r,n)}):io(f,e,r,n)})}return r}function eT(t,e,r){var n=this,a,i=function(){for(var f=arguments.length,o=new Array(f),u=0;u<f;u++)o[u]=arguments[u];var g=n,c=function(){a=null,r||t.apply(g,o)},l=r&&!a;clearTimeout(a),a=setTimeout(c,e),l&&t.apply(g,o)};return i.cancel=function(){return clearTimeout(a)},i}function tT(t,e){var r=!1,n=null;function a(){r=!1,n!==null&&(i.apply(void 0,Ee(n)),n=null)}function i(){for(var s=arguments.length,f=new Array(s),o=0;o<s;o++)f[o]=arguments[o];if(r){n=f;return}r=!0,t.apply(void 0,f),setTimeout(a,e)}return i}function av(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};e.keystore=Object.assign(e.keystore||{},r),t.setKey=function(n,a){e.keystore[n]=a},t.getKey=function(n){return e.keystore[n]},t.getAllKeys=function(){return Object.keys(e.keystore)},t.deleteKey=function(n){return delete e.keystore[n]},t.clearKeystore=function(){return t.getAllKeys().forEach(function(n){return delete e.keystore[n]})}}var rT=1,Ua="__root__";function nT(t,e){av(t,e);var r=t.delete;e.proxyId="".concat(rT++),e.ui=JSON.parse(JSON.stringify(e.ui||[])),Ft(t,e,["proxyId","proxyGroup","proxyName"]),gt(t,e,["proxyManager"]);var n={},a={};function i(u,g){a[g]||(a[g]=[]);for(var c=a[g],l=0;l<u.length;l++)c.push(u[l].name),n[u[l].name]=u[l],u[l].children&&u[l].children.length&&i(u[l].children,u[l].name)}i(e.ui,Ua),t.updateUI=function(u){e.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(n).forEach(function(g){return delete n[g]}),Object.keys(a).forEach(function(g){return delete a[g]}),i(e.ui,Ua),t.modified()};function s(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ua;return a[u]}t.updateProxyProperty=function(u,g){var c=n[u];c?Object.assign(c,g):n[u]=no({},g)},t.activate=function(){if(e.proxyManager){var u="setActive".concat(ct(t.getProxyGroup().slice(0,-1)));e.proxyManager[u]&&e.proxyManager[u](t)}},e.propertyLinkSubscribers={},t.registerPropertyLinkForGC=function(u,g){g in e.propertyLinkSubscribers||(e.propertyLinkSubscribers[g]=[]),e.propertyLinkSubscribers[g].push(u)},t.gcPropertyLinks=function(u){for(var g=e.propertyLinkSubscribers[u]||[];g.length;)g.pop().unbind(t)},e.propertyLinkMap={},t.getPropertyLink=function(u){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.propertyLinkMap[u])return e.propertyLinkMap[u];var c=null,l=[],h=0,y=!1;function C(S){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(y)return null;var D=[],b=null;for(h=l.length;h--;){var N=l[h];N.instance===S?b=N:D.push(N)}if(!b)return null;var P=b.instance["get".concat(ct(b.propertyName))]();if(!X1(P,c)||m){for(c=P,y=!0;D.length;){var O=D.pop();O.instance.set(de({},O.propertyName,c))}y=!1}return e.propertyLinkMap[u].persistent&&(e.propertyLinkMap[u].value=P),P}function T(S,m){var D=[];for(h=l.length;h--;){var b=l[h];b.instance===S&&(b.propertyName===m||m===void 0)&&(b.subscription.unsubscribe(),D.push(h))}for(;D.length;)l.splice(D.pop(),1)}function E(S,m){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,b=S.onModified(C),N=l[0];return l.push({instance:S,propertyName:m,subscription:b}),D&&(e.propertyLinkMap[u].persistent&&e.propertyLinkMap[u].value!==void 0?S.set(de({},m,e.propertyLinkMap[u].value)):N&&C(N.instance,!0)),{unsubscribe:function(){return T(S,m)}}}function w(){for(;l.length;)l.pop().subscription.unsubscribe()}var x={bind:E,unbind:T,unsubscribe:w,persistent:g};return e.propertyLinkMap[u]=x,x};function f(){for(var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ua,g=[],c=e.proxyId,l=s(u)||[],h=0;h<l.length;h++){var y=l[h],C=t["get".concat(ct(y))],T=C?C():void 0,E={id:c,name:y,value:T},w=f(y);w.length&&(E.children=w),g.push(E)}return g}t.listPropertyNames=function(){return f().map(function(u){return u.name})},t.getPropertyByName=function(u){return f().find(function(g){return g.name===u})},t.getPropertyDomainByName=function(u){return(n[u]||{}).domain},t.getProxySection=function(){return{id:e.proxyId,name:e.proxyGroup,ui:e.ui,properties:f()}},t.delete=function(){for(var u=Object.keys(e.propertyLinkMap),g=u.length;g--;)e.propertyLinkMap[u[g]].unsubscribe();Object.keys(e.propertyLinkSubscribers).forEach(t.gcPropertyLinks),r()},t.getState=function(){return null};function o(){if(e.links)for(var u=0;u<e.links.length;u++){var g=e.links[u],c=g.link,l=g.property,h=g.persistent,y=g.updateOnBind,C=g.type;if(C==="application"){var T=e.proxyManager.getPropertyLink(c,h);t.registerPropertyLinkForGC(T,"application"),T.bind(t,l,y)}}}Jg(o)}function aT(t,e,r){for(var n=t.delete,a=[],i=Object.keys(r),s=i.length;s--;){var f=i[s],o=r[f],u=o.modelKey,g=o.property,c=o.modified,l=c===void 0?!0:c,h=ct(g),y=ct(f);t["get".concat(y)]=e[u]["get".concat(h)],t["set".concat(y)]=e[u]["set".concat(h)],l&&a.push(e[u].onModified(t.modified))}t.delete=function(){for(;a.length;)a.pop().unsubscribe();n()}}function iT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e.this=t;function a(o){for(var u=Object.keys(o),g=u.length;g--;){var c=u[g];e[c].set(o[c])}}for(var i=Object.keys(n),s=i.length,f=function(){var u=i[s];e[u]=n[u];var g=r[u];t["set".concat(ct(u))]=function(c){if(c!==e[u]){e[u]=c;var l=g[c];a(l),t.modified()}}};s--;)f();i.length&&Ft(t,e,i)}var cu=10,gu=40,vu=800;function sT(t){var e=0,r=0,n=0,a=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=r,r=0),n=e*cu,a=r*cu,"deltaY"in t&&(a=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||a)&&t.deltaMode&&(t.deltaMode===1?(n*=gu,a*=gu):(n*=vu,a*=vu)),n&&!e&&(e=n<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:e,spinY:r,pixelX:n,pixelY:a}}var L={algo:Z1,capitalize:Go,chain:J1,debounce:eT,enumToString:Y1,event:Q1,EVENT_ABORT:rv,formatBytesToProperUnit:H1,formatNumbersWithThousandSeparator:K1,get:Ft,getArray:Ca,getCurrentGlobalMTime:G1,getStateArrayMapFunc:Qg,isVtkObject:nv,keystore:av,measurePromiseExecution:I1,moveToProtected:Ao,newInstance:Ue,newTypedArray:Ta,newTypedArrayFrom:qg,normalizeWheel:sT,obj:yt,proxy:nT,proxyPropertyMapping:aT,proxyPropertyState:iT,safeArrays:Zg,set:Ni,setArray:ev,setGet:gt,setGetArray:tv,setImmediate:Jg,setLoggerFunction:P1,throttle:tT,traverseInstanceTree:io,TYPED_ARRAYS:kt,uncapitalize:$1,VOID:U1,vtkDebugMacro:Mr,vtkErrorMacro:ve,vtkInfoMacro:z1,vtkLogMacro:W1,vtkOnceErrorMacro:j1,vtkWarningMacro:Bi},oT=L.vtkErrorMacro,fT=["Build","Render"];function uT(t,e){e.classHierarchy.push("vtkViewNode"),t.build=function(r){},t.render=function(r){},t.traverse=function(r){var n=r.getTraverseOperation(),a=t[n];if(a){a(r);return}t.apply(r,!0);for(var i=0;i<e.children.length;i++)e.children[i].traverse(r);t.apply(r,!1)},t.apply=function(r,n){var a=t[r.getOperation()];a&&a(n,r)},t.getViewNodeFor=function(r){if(e.renderable===r)return t;for(var n=0;n<e.children.length;++n){var a=e.children[n],i=a.getViewNodeFor(r);if(i)return i}},t.getFirstAncestorOfType=function(r){return e._parent?e._parent.isA(r)?e._parent:e._parent.getFirstAncestorOfType(r):null},t.addMissingNode=function(r){if(!!r){var n=e._renderableChildMap.get(r);if(n!==void 0)n.setVisited(!0);else{var a=t.createViewNode(r);a&&(a.setParent(t),a.setVisited(!0),e._renderableChildMap.set(r,a),e.children.push(a))}}},t.addMissingNodes=function(r){if(!(!r||!r.length))for(var n=0;n<r.length;++n){var a=r[n],i=e._renderableChildMap.get(a);if(i!==void 0)i.setVisited(!0);else{var s=t.createViewNode(a);s&&(s.setParent(t),s.setVisited(!0),e._renderableChildMap.set(a,s),e.children.push(s))}}},t.addMissingChildren=function(r){if(!(!r||!r.length))for(var n=0;n<r.length;++n){var a=r[n],i=e.children.indexOf(a);i===-1&&(a.setParent(t),e.children.push(a)),a.setVisited(!0)}},t.prepareNodes=function(){for(var r=0;r<e.children.length;++r)e.children[r].setVisited(!1)},t.setVisited=function(r){e.visited=r},t.removeUnusedNodes=function(){for(var r=null,n=0;n<e.children.length;++n){var a=e.children[n],i=a.getVisited();if(i)a.setVisited(!1);else{var s=a.getRenderable();s&&e._renderableChildMap.delete(s),r||(r=[]),r.push(a)}}r&&(e.children=e.children.filter(function(f){return!r.includes(f)}))},t.createViewNode=function(r){if(!e.myFactory)return oT("Cannot create view nodes without my own factory"),null;var n=e.myFactory.createNode(r);return n&&n.setRenderable(r),n}}var cT={renderable:null,myFactory:null,children:[],visited:!1};function iv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cT,r),L.obj(t,e),L.event(t,e,"event"),e._renderableChildMap=new Map,L.get(t,e,["visited"]),L.setGet(t,e,["_parent","renderable","myFactory"]),L.getArray(t,e,["children"]),L.moveToProtected(t,e,["parent"]),uT(t,e)}var gT=L.newInstance(iv,"vtkViewNode"),Ie={newInstance:gT,extend:iv,PASS_TYPES:fT};function vT(t,e){e.overrides||(e.overrides={}),e.classHierarchy.push("vtkViewNodeFactory"),t.createNode=function(r){if(r.isDeleted())return null;for(var n=0,a=r.getClassName(n++),i=!1,s=Object.keys(e.overrides);a&&!i;)s.indexOf(a)!==-1?i=!0:a=r.getClassName(n++);if(!i)return null;var f=e.overrides[a]();return f.setMyFactory(t),f},t.registerOverride=function(r,n){e.overrides[r]=n}}var lT={};function sv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,lT,r),L.obj(t,e),vT(t,e)}var pT=L.newInstance(sv,"vtkViewNodeFactory"),ov={newInstance:pT,extend:sv},fv=Object.create(null);function Mt(t,e){fv[t]=e}function hT(t,e){e.classHierarchy.push("vtkOpenGLViewNodeFactory")}var yT={};function uv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,yT,r),e.overrides=fv,ov.extend(t,e,r),hT(t,e)}var dT=L.newInstance(uv,"vtkOpenGLViewNodeFactory"),TT={newInstance:dT,extend:uv};function CT(t,e){e.classHierarchy.push("vtkOpenGLCamera"),t.buildPass=function(r){r&&(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext())},t.opaquePass=function(r){if(r){var n=e.openGLRenderer.getTiledSizeAndOrigin();e.context.viewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize),e.context.scissor(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)}},t.translucentPass=t.opaquePass,t.opaqueZBufferPass=t.opaquePass,t.volumePass=t.opaquePass,t.getKeyMatrices=function(r){if(r!==e.lastRenderer||e._openGLRenderWindow.getMTime()>e.keyMatrixTime.getMTime()||t.getMTime()>e.keyMatrixTime.getMTime()||r.getMTime()>e.keyMatrixTime.getMTime()||e.renderable.getMTime()>e.keyMatrixTime.getMTime()){ut(e.keyMatrices.wcvc,e.renderable.getViewMatrix()),Vo(e.keyMatrices.normalMatrix,e.keyMatrices.wcvc),_o(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),We(e.keyMatrices.wcvc,e.keyMatrices.wcvc);var n=e.openGLRenderer.getAspectRatio();ut(e.keyMatrices.vcpc,e.renderable.getProjectionMatrix(n,-1,1)),We(e.keyMatrices.vcpc,e.keyMatrices.vcpc),Ct(e.keyMatrices.wcpc,e.keyMatrices.vcpc,e.keyMatrices.wcvc),e.keyMatrixTime.modified(),e.lastRenderer=r}return e.keyMatrices}}var ST={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function ET(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ST,r),Ie.extend(t,e,r),e.keyMatrixTime={},yt(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},gt(t,e,["context","keyMatrixTime"]),CT(t,e)}var xT=Ue(ET);Mt("vtkCamera",xT);var wT=Mr;function OT(t,e){e.classHierarchy.push("vtkOpenGLRenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;t.updateLights(),t.prepareNodes(),t.addMissingNode(e.renderable.getActiveCamera()),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes()}},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(wT("No lights are on, creating one."),e.renderable.createLight()),r},t.opaqueZBufferPass=function(r){if(r){var n=0,a=e.context;e.renderable.getTransparent()||(e.context.clearColor(1,0,0,1),n|=a.COLOR_BUFFER_BIT),e.renderable.getPreserveDepthBuffer()||(a.clearDepth(1),n|=a.DEPTH_BUFFER_BIT,e.context.depthMask(!0));var i=t.getTiledSizeAndOrigin();a.enable(a.SCISSOR_TEST),a.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),a.colorMask(!0,!0,!0,!0),n&&a.clear(n),a.enable(a.DEPTH_TEST)}},t.cameraPass=function(r){r&&t.clear()},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),f=Math.round(s[0]),o=Math.round(s[1]),u=r[2]-n[0],g=r[3]-n[1],c=e._parent.normalizedDisplayToDisplay(u,g),l=Math.round(c[0])-f,h=Math.round(c[1])-o;return l<0&&(l=0),h<0&&(h=0),{usize:l,vsize:h,lowerLeftU:f,lowerLeftV:o}},t.clear=function(){var r=0,n=e.context;if(!e.renderable.getTransparent()){var a=e.renderable.getBackgroundByReference();e.context.clearColor(a[0],a[1],a[2],a[3]),r|=n.COLOR_BUFFER_BIT}e.renderable.getPreserveDepthBuffer()||(n.clearDepth(1),r|=n.DEPTH_BUFFER_BIT,e.context.depthMask(!0)),n.colorMask(!0,!0,!0,!0);var i=t.getTiledSizeAndOrigin();n.enable(n.SCISSOR_TEST),n.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r&&n.clear(r),n.enable(n.DEPTH_TEST)},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var MT={context:null,selector:null};function DT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MT,r),Ie.extend(t,e,r),Ft(t,e,["shaderCache"]),gt(t,e,["selector"]),Ao(t,e,["openGLRenderWindow"]),OT(t,e)}var mT=Ue(DT,"vtkOpenGLRenderer");Mt("vtkRenderer",mT);function RT(t,e){e.classHierarchy.push("vtkOpenGLActor"),t.buildPass=function(r){if(r){e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.traverseOpaqueZBufferPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(!!e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.opaqueZBufferPass=function(r,n){return t.opaquePass(r,n)},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.getKeyMatrices=function(){return e.renderable.getMTime()>e.keyMatrixTime.getMTime()&&(e.renderable.computeMatrix(),ut(e.keyMatrices.mcwc,e.renderable.getMatrix()),We(e.keyMatrices.mcwc,e.keyMatrices.mcwc),e.renderable.getIsIdentity()?Jr(e.keyMatrices.normalMatrix):(Vo(e.keyMatrices.normalMatrix,e.keyMatrices.mcwc),_o(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),dg(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),e.keyMatrixTime.modified()),e.keyMatrices}}var LT={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function VT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LT,r),Ie.extend(t,e,r),e.keyMatrixTime={},yt(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Jr(new Float64Array(9)),mcwc:De(new Float64Array(16))},gt(t,e,["context"]),Ft(t,e,["activeTextures"]),RT(t,e)}var _T=Ue(VT);Mt("vtkActor",_T);function bT(t,e){e.classHierarchy.push("vtkOpenGLActor2D"),t.buildPass=function(r){if(r){if(!e.renderable)return;e._openGLRenderWindow=t.getFirstAncestorOfType("vtkOpenGLRenderWindow"),e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.context=e._openGLRenderWindow.getContext(),t.prepareNodes(),t.addMissingNodes(e.renderable.getTextures()),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes(),e.ogltextures=null,e.activeTextures=null;for(var n=0;n<e.children.length;n++){var a=e.children[n];a.isA("vtkOpenGLTexture")?(e.ogltextures||(e.ogltextures=[]),e.ogltextures.push(a)):e.oglmapper=a}}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOverlayActorCount()}},t.traverseOpaquePass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.traverseOverlayPass=function(r){!e.oglmapper||!e.renderable||!e.renderable.getNestedVisibility()||e.openGLRenderer.getSelector()&&!e.renderable.getNestedPickable||(t.apply(r,!0),e.oglmapper.traverse(r),t.apply(r,!1))},t.activateTextures=function(){if(!!e.ogltextures){e.activeTextures=[];for(var r=0;r<e.ogltextures.length;r++){var n=e.ogltextures[r];n.render(),n.getHandle()&&e.activeTextures.push(n)}}},t.opaquePass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.translucentPass=function(r,n){if(r)e.context.depthMask(!1),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()},t.overlayPass=function(r,n){if(r)e.context.depthMask(!0),t.activateTextures();else if(e.activeTextures)for(var a=0;a<e.activeTextures.length;a++)e.activeTextures[a].deactivate()}}var kT={context:null,activeTextures:null};function FT(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kT,r),Ie.extend(t,e,r),gt(t,e,["context"]),Ft(t,e,["activeTextures"]),bT(t,e)}var BT=Ue(FT);Mt("vtkActor2D",BT);function vi(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function NT(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function cv(t){let e,r,n;t.length!==2?(e=vi,r=(f,o)=>vi(t(f),o),n=(f,o)=>t(f)-o):(e=t===vi||t===NT?t:UT,r=t,n=t);function a(f,o,u=0,g=f.length){if(u<g){if(e(o,o)!==0)return g;do{const c=u+g>>>1;r(f[c],o)<0?u=c+1:g=c}while(u<g)}return u}function i(f,o,u=0,g=f.length){if(u<g){if(e(o,o)!==0)return g;do{const c=u+g>>>1;r(f[c],o)<=0?u=c+1:g=c}while(u<g)}return u}function s(f,o,u=0,g=f.length){const c=a(f,o,u,g-1);return c>u&&n(f[c-1],o)>-n(f[c],o)?c-1:c}return{left:a,center:s,right:i}}function UT(){return 0}function GT(t){return t===null?NaN:+t}const AT=cv(vi),PT=AT.right;cv(GT).center;const WT=PT;var so=Math.sqrt(50),oo=Math.sqrt(10),fo=Math.sqrt(2);function zT(t,e,r){var n,a=-1,i,s,f;if(e=+e,t=+t,r=+r,t===e&&r>0)return[t];if((n=e<t)&&(i=t,t=e,e=i),(f=gv(t,e,r))===0||!isFinite(f))return[];if(f>0){let o=Math.round(t/f),u=Math.round(e/f);for(o*f<t&&++o,u*f>e&&--u,s=new Array(i=u-o+1);++a<i;)s[a]=(o+a)*f}else{f=-f;let o=Math.round(t*f),u=Math.round(e*f);for(o/f<t&&++o,u/f>e&&--u,s=new Array(i=u-o+1);++a<i;)s[a]=(o+a)/f}return n&&s.reverse(),s}function gv(t,e,r){var n=(e-t)/Math.max(0,r),a=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,a);return a>=0?(i>=so?10:i>=oo?5:i>=fo?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=so?10:i>=oo?5:i>=fo?2:1)}function jT(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),a=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/a;return i>=so?a*=10:i>=oo?a*=5:i>=fo&&(a*=2),e<t?-a:a}function $T(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Po(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function vv(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Sa(){}var ca=.7,Ei=1/ca,xn="\\s*([+-]?\\d+)\\s*",ga="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",HT=/^#([0-9a-f]{3,8})$/,KT=new RegExp(`^rgb\\(${xn},${xn},${xn}\\)$`),XT=new RegExp(`^rgb\\(${qt},${qt},${qt}\\)$`),YT=new RegExp(`^rgba\\(${xn},${xn},${xn},${ga}\\)$`),IT=new RegExp(`^rgba\\(${qt},${qt},${qt},${ga}\\)$`),qT=new RegExp(`^hsl\\(${ga},${qt},${qt}\\)$`),ZT=new RegExp(`^hsla\\(${ga},${qt},${qt},${ga}\\)$`),lu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Po(Sa,va,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:pu,formatHex:pu,formatHex8:QT,formatHsl:JT,formatRgb:hu,toString:hu});function pu(){return this.rgb().formatHex()}function QT(){return this.rgb().formatHex8()}function JT(){return lv(this).formatHsl()}function hu(){return this.rgb().formatRgb()}function va(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=HT.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?yu(e):r===3?new Tt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Ga(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Ga(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=KT.exec(t))?new Tt(e[1],e[2],e[3],1):(e=XT.exec(t))?new Tt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=YT.exec(t))?Ga(e[1],e[2],e[3],e[4]):(e=IT.exec(t))?Ga(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=qT.exec(t))?Cu(e[1],e[2]/100,e[3]/100,1):(e=ZT.exec(t))?Cu(e[1],e[2]/100,e[3]/100,e[4]):lu.hasOwnProperty(t)?yu(lu[t]):t==="transparent"?new Tt(NaN,NaN,NaN,0):null}function yu(t){return new Tt(t>>16&255,t>>8&255,t&255,1)}function Ga(t,e,r,n){return n<=0&&(t=e=r=NaN),new Tt(t,e,r,n)}function e2(t){return t instanceof Sa||(t=va(t)),t?(t=t.rgb(),new Tt(t.r,t.g,t.b,t.opacity)):new Tt}function uo(t,e,r,n){return arguments.length===1?e2(t):new Tt(t,e,r,n==null?1:n)}function Tt(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Po(Tt,uo,vv(Sa,{brighter(t){return t=t==null?Ei:Math.pow(Ei,t),new Tt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ca:Math.pow(ca,t),new Tt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Tt(Ir(this.r),Ir(this.g),Ir(this.b),xi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:du,formatHex:du,formatHex8:t2,formatRgb:Tu,toString:Tu}));function du(){return`#${Xr(this.r)}${Xr(this.g)}${Xr(this.b)}`}function t2(){return`#${Xr(this.r)}${Xr(this.g)}${Xr(this.b)}${Xr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Tu(){const t=xi(this.opacity);return`${t===1?"rgb(":"rgba("}${Ir(this.r)}, ${Ir(this.g)}, ${Ir(this.b)}${t===1?")":`, ${t})`}`}function xi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ir(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xr(t){return t=Ir(t),(t<16?"0":"")+t.toString(16)}function Cu(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Wt(t,e,r,n)}function lv(t){if(t instanceof Wt)return new Wt(t.h,t.s,t.l,t.opacity);if(t instanceof Sa||(t=va(t)),!t)return new Wt;if(t instanceof Wt)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,f=i-a,o=(i+a)/2;return f?(e===i?s=(r-n)/f+(r<n)*6:r===i?s=(n-e)/f+2:s=(e-r)/f+4,f/=o<.5?i+a:2-i-a,s*=60):f=o>0&&o<1?0:s,new Wt(s,f,o,t.opacity)}function r2(t,e,r,n){return arguments.length===1?lv(t):new Wt(t,e,r,n==null?1:n)}function Wt(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Po(Wt,r2,vv(Sa,{brighter(t){return t=t==null?Ei:Math.pow(Ei,t),new Wt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ca:Math.pow(ca,t),new Wt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new Tt(Es(t>=240?t-240:t+120,a,n),Es(t,a,n),Es(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new Wt(Su(this.h),Aa(this.s),Aa(this.l),xi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=xi(this.opacity);return`${t===1?"hsl(":"hsla("}${Su(this.h)}, ${Aa(this.s)*100}%, ${Aa(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Su(t){return t=(t||0)%360,t<0?t+360:t}function Aa(t){return Math.max(0,Math.min(1,t||0))}function Es(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Wo=t=>()=>t;function n2(t,e){return function(r){return t+r*e}}function a2(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function i2(t){return(t=+t)==1?pv:function(e,r){return r-e?a2(e,r,t):Wo(isNaN(e)?r:e)}}function pv(t,e){var r=e-t;return r?n2(t,r):Wo(isNaN(t)?e:t)}const Eu=function t(e){var r=i2(e);function n(a,i){var s=r((a=uo(a)).r,(i=uo(i)).r),f=r(a.g,i.g),o=r(a.b,i.b),u=pv(a.opacity,i.opacity);return function(g){return a.r=s(g),a.g=f(g),a.b=o(g),a.opacity=u(g),a+""}}return n.gamma=t,n}(1);function s2(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=t[a]*(1-i)+e[a]*i;return n}}function o2(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function f2(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=zo(t[s],e[s]);for(;s<r;++s)i[s]=e[s];return function(f){for(s=0;s<n;++s)i[s]=a[s](f);return i}}function u2(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function wi(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function c2(t,e){var r={},n={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?r[a]=zo(t[a],e[a]):n[a]=e[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var co=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xs=new RegExp(co.source,"g");function g2(t){return function(){return t}}function v2(t){return function(e){return t(e)+""}}function l2(t,e){var r=co.lastIndex=xs.lastIndex=0,n,a,i,s=-1,f=[],o=[];for(t=t+"",e=e+"";(n=co.exec(t))&&(a=xs.exec(e));)(i=a.index)>r&&(i=e.slice(r,i),f[s]?f[s]+=i:f[++s]=i),(n=n[0])===(a=a[0])?f[s]?f[s]+=a:f[++s]=a:(f[++s]=null,o.push({i:s,x:wi(n,a)})),r=xs.lastIndex;return r<e.length&&(i=e.slice(r),f[s]?f[s]+=i:f[++s]=i),f.length<2?o[0]?v2(o[0].x):g2(e):(e=o.length,function(u){for(var g=0,c;g<e;++g)f[(c=o[g]).i]=c.x(u);return f.join("")})}function zo(t,e){var r=typeof e,n;return e==null||r==="boolean"?Wo(e):(r==="number"?wi:r==="string"?(n=va(e))?(e=n,Eu):l2:e instanceof va?Eu:e instanceof Date?u2:o2(e)?s2:Array.isArray(e)?f2:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?c2:wi)(t,e)}function p2(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function h2(t){return function(){return t}}function y2(t){return+t}var xu=[0,1];function Tn(t){return t}function go(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:h2(isNaN(e)?NaN:.5)}function d2(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function T2(t,e,r){var n=t[0],a=t[1],i=e[0],s=e[1];return a<n?(n=go(a,n),i=r(s,i)):(n=go(n,a),i=r(i,s)),function(f){return i(n(f))}}function C2(t,e,r){var n=Math.min(t.length,e.length)-1,a=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)a[s]=go(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(f){var o=WT(t,f,1,n)-1;return i[o](a[o](f))}}function S2(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function E2(){var t=xu,e=xu,r=zo,n,a,i,s=Tn,f,o,u;function g(){var l=Math.min(t.length,e.length);return s!==Tn&&(s=d2(t[0],t[l-1])),f=l>2?C2:T2,o=u=null,c}function c(l){return l==null||isNaN(l=+l)?i:(o||(o=f(t.map(n),e,r)))(n(s(l)))}return c.invert=function(l){return s(a((u||(u=f(e,t.map(n),wi)))(l)))},c.domain=function(l){return arguments.length?(t=Array.from(l,y2),g()):t.slice()},c.range=function(l){return arguments.length?(e=Array.from(l),g()):e.slice()},c.rangeRound=function(l){return e=Array.from(l),r=p2,g()},c.clamp=function(l){return arguments.length?(s=l?!0:Tn,g()):s!==Tn},c.interpolate=function(l){return arguments.length?(r=l,g()):r},c.unknown=function(l){return arguments.length?(i=l,c):i},function(l,h){return n=l,a=h,g()}}function x2(){return E2()(Tn,Tn)}function w2(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Oi(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Mn(t){return t=Oi(Math.abs(t)),t?t[1]:NaN}function O2(t,e){return function(r,n){for(var a=r.length,i=[],s=0,f=t[0],o=0;a>0&&f>0&&(o+f+1>n&&(f=Math.max(1,n-o)),i.push(r.substring(a-=f,a+f)),!((o+=f+1)>n));)f=t[s=(s+1)%t.length];return i.reverse().join(e)}}function M2(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var D2=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mi(t){if(!(e=D2.exec(t)))throw new Error("invalid format: "+t);var e;return new jo({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Mi.prototype=jo.prototype;function jo(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}jo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function m2(t){e:for(var e=t.length,r=1,n=-1,a;r<e;++r)switch(t[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(a+1):t}var hv;function R2(t,e){var r=Oi(t,e);if(!r)return t+"";var n=r[0],a=r[1],i=a-(hv=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Oi(t,Math.max(0,e+i-1))[0]}function wu(t,e){var r=Oi(t,e);if(!r)return t+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Ou={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:w2,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>wu(t*100,e),r:wu,s:R2,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Mu(t){return t}var Du=Array.prototype.map,mu=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function L2(t){var e=t.grouping===void 0||t.thousands===void 0?Mu:O2(Du.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",i=t.numerals===void 0?Mu:M2(Du.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",f=t.minus===void 0?"\u2212":t.minus+"",o=t.nan===void 0?"NaN":t.nan+"";function u(c){c=Mi(c);var l=c.fill,h=c.align,y=c.sign,C=c.symbol,T=c.zero,E=c.width,w=c.comma,x=c.precision,S=c.trim,m=c.type;m==="n"?(w=!0,m="g"):Ou[m]||(x===void 0&&(x=12),S=!0,m="g"),(T||l==="0"&&h==="=")&&(T=!0,l="0",h="=");var D=C==="$"?r:C==="#"&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",b=C==="$"?n:/[%p]/.test(m)?s:"",N=Ou[m],P=/[defgprs%]/.test(m);x=x===void 0?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function O(A){var z=D,j=b,B,Y,I;if(m==="c")j=N(A)+j,A="";else{A=+A;var te=A<0||1/A<0;if(A=isNaN(A)?o:N(Math.abs(A),x),S&&(A=m2(A)),te&&+A==0&&y!=="+"&&(te=!1),z=(te?y==="("?y:f:y==="-"||y==="("?"":y)+z,j=(m==="s"?mu[8+hv/3]:"")+j+(te&&y==="("?")":""),P){for(B=-1,Y=A.length;++B<Y;)if(I=A.charCodeAt(B),48>I||I>57){j=(I===46?a+A.slice(B+1):A.slice(B))+j,A=A.slice(0,B);break}}}w&&!T&&(A=e(A,1/0));var U=z.length+A.length+j.length,G=U<E?new Array(E-U+1).join(l):"";switch(w&&T&&(A=e(G+A,G.length?E-j.length:1/0),G=""),h){case"<":A=z+A+j+G;break;case"=":A=z+G+A+j;break;case"^":A=G.slice(0,U=G.length>>1)+z+A+j+G.slice(U);break;default:A=G+z+A+j;break}return i(A)}return O.toString=function(){return c+""},O}function g(c,l){var h=u((c=Mi(c),c.type="f",c)),y=Math.max(-8,Math.min(8,Math.floor(Mn(l)/3)))*3,C=Math.pow(10,-y),T=mu[8+y/3];return function(E){return h(C*E)+T}}return{format:u,formatPrefix:g}}var Pa,yv,dv;V2({thousands:",",grouping:[3],currency:["$",""]});function V2(t){return Pa=L2(t),yv=Pa.format,dv=Pa.formatPrefix,Pa}function _2(t){return Math.max(0,-Mn(Math.abs(t)))}function b2(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Mn(e)/3)))*3-Mn(Math.abs(t)))}function k2(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Mn(e)-Mn(t))+1}function F2(t,e,r,n){var a=jT(t,e,r),i;switch(n=Mi(n==null?",f":n),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(i=b2(a,s))&&(n.precision=i),dv(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=k2(a,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=_2(a))&&(n.precision=i-(n.type==="%")*2);break}}return yv(n)}function B2(t){var e=t.domain;return t.ticks=function(r){var n=e();return zT(n[0],n[n.length-1],r==null?10:r)},t.tickFormat=function(r,n){var a=e();return F2(a[0],a[a.length-1],r==null?10:r,n)},t.nice=function(r){r==null&&(r=10);var n=e(),a=0,i=n.length-1,s=n[a],f=n[i],o,u,g=10;for(f<s&&(u=s,s=f,f=u,u=a,a=i,i=u);g-- >0;){if(u=gv(s,f,r),u===o)return n[a]=s,n[i]=f,e(n);if(u>0)s=Math.floor(s/u)*u,f=Math.ceil(f/u)*u;else if(u<0)s=Math.ceil(s*u)/u,f=Math.floor(f*u)/u;else break;o=u}return t},t}function $o(){var t=x2();return t.copy=function(){return S2(t,$o())},$T.apply(t,arguments),B2(t)}var Tv={exports:{}};(function(t){(function(e,r,n){function a(o){var u=this,g=f();u.next=function(){var c=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=c-(u.c=c|0)},u.c=1,u.s0=g(" "),u.s1=g(" "),u.s2=g(" "),u.s0-=g(o),u.s0<0&&(u.s0+=1),u.s1-=g(o),u.s1<0&&(u.s1+=1),u.s2-=g(o),u.s2<0&&(u.s2+=1),g=null}function i(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function s(o,u){var g=new a(o),c=u&&u.state,l=g.next;return l.int32=function(){return g.next()*4294967296|0},l.double=function(){return l()+(l()*2097152|0)*11102230246251565e-32},l.quick=l,c&&(typeof c=="object"&&i(c,g),l.state=function(){return i(g,{})}),l}function f(){var o=4022871197,u=function(g){g=String(g);for(var c=0;c<g.length;c++){o+=g.charCodeAt(c);var l=.02519603282416938*o;o=l>>>0,l-=o,l*=o,o=l>>>0,l-=o,o+=l*4294967296}return(o>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.alea=s})(_t,t,!1)})(Tv);var Cv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var c=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^c^c>>>8},f===(f|0)?o.x=f:u+=f;for(var g=0;g<u.length+64;g++)o.x^=u.charCodeAt(g)|0,o.next()}function i(f,o){return o.x=f.x,o.y=f.y,o.z=f.z,o.w=f.w,o}function s(f,o){var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(typeof g=="object"&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor128=s})(_t,t,!1)})(Cv);var Sv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.next=function(){var c=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(c^c<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,f===(f|0)?o.x=f:u+=f;for(var g=0;g<u.length+64;g++)o.x^=u.charCodeAt(g)|0,g==u.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function i(f,o){return o.x=f.x,o.y=f.y,o.z=f.z,o.w=f.w,o.v=f.v,o.d=f.d,o}function s(f,o){var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(typeof g=="object"&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorwow=s})(_t,t,!1)})(Sv);var Ev={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this;o.next=function(){var g=o.x,c=o.i,l,h;return l=g[c],l^=l>>>7,h=l^l<<24,l=g[c+1&7],h^=l^l>>>10,l=g[c+3&7],h^=l^l>>>3,l=g[c+4&7],h^=l^l<<7,l=g[c+7&7],l=l^l<<13,h^=l^l<<9,g[c]=h,o.i=c+1&7,h};function u(g,c){var l,h=[];if(c===(c|0))h[0]=c;else for(c=""+c,l=0;l<c.length;++l)h[l&7]=h[l&7]<<15^c.charCodeAt(l)+h[l+1&7]<<13;for(;h.length<8;)h.push(0);for(l=0;l<8&&h[l]===0;++l);for(l==8?h[7]=-1:h[l],g.x=h,g.i=0,l=256;l>0;--l)g.next()}u(o,f)}function i(f,o){return o.x=f.x.slice(),o.i=f.i,o}function s(f,o){f==null&&(f=+new Date);var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(g.x&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xorshift7=s})(_t,t,!1)})(Ev);var xv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this;o.next=function(){var g=o.w,c=o.X,l=o.i,h,y;return o.w=g=g+1640531527|0,y=c[l+34&127],h=c[l=l+1&127],y^=y<<13,h^=h<<17,y^=y>>>15,h^=h>>>12,y=c[l]=y^h,o.i=l,y+(g^g>>>16)|0};function u(g,c){var l,h,y,C,T,E=[],w=128;for(c===(c|0)?(h=c,c=null):(c=c+"\0",h=0,w=Math.max(w,c.length)),y=0,C=-32;C<w;++C)c&&(h^=c.charCodeAt((C+32)%c.length)),C===0&&(T=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,C>=0&&(T=T+1640531527|0,l=E[C&127]^=h+T,y=l==0?y+1:0);for(y>=128&&(E[(c&&c.length||0)&127]=-1),y=127,C=4*128;C>0;--C)h=E[y+34&127],l=E[y=y+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,E[y]=h^l;g.w=T,g.X=E,g.i=y}u(o,f)}function i(f,o){return o.i=f.i,o.w=f.w,o.X=f.X.slice(),o}function s(f,o){f==null&&(f=+new Date);var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(g.X&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.xor4096=s})(_t,t,!1)})(xv);var wv={exports:{}};(function(t){(function(e,r,n){function a(f){var o=this,u="";o.next=function(){var c=o.b,l=o.c,h=o.d,y=o.a;return c=c<<25^c>>>7^l,l=l-h|0,h=h<<24^h>>>8^y,y=y-c|0,o.b=c=c<<20^c>>>12^l,o.c=l=l-h|0,o.d=h<<16^l>>>16^y,o.a=y-c|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,f===Math.floor(f)?(o.a=f/4294967296|0,o.b=f|0):u+=f;for(var g=0;g<u.length+20;g++)o.b^=u.charCodeAt(g)|0,o.next()}function i(f,o){return o.a=f.a,o.b=f.b,o.c=f.c,o.d=f.d,o}function s(f,o){var u=new a(f),g=o&&o.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},c.int32=u.next,c.quick=c,g&&(typeof g=="object"&&i(g,u),c.state=function(){return i(u,{})}),c}r&&r.exports?r.exports=s:n&&n.amd?n(function(){return s}):this.tychei=s})(_t,t,!1)})(wv);var Ov={exports:{}};const N2={},U2=Object.freeze(Object.defineProperty({__proto__:null,default:N2},Symbol.toStringTag,{value:"Module"})),G2=Gd(U2);(function(t){(function(e,r,n){var a=256,i=6,s=52,f="random",o=n.pow(a,i),u=n.pow(2,s),g=u*2,c=a-1,l;function h(S,m,D){var b=[];m=m==!0?{entropy:!0}:m||{};var N=E(T(m.entropy?[S,x(r)]:S==null?w():S,3),b),P=new y(b),O=function(){for(var A=P.g(i),z=o,j=0;A<u;)A=(A+j)*a,z*=a,j=P.g(1);for(;A>=g;)A/=2,z/=2,j>>>=1;return(A+j)/z};return O.int32=function(){return P.g(4)|0},O.quick=function(){return P.g(4)/4294967296},O.double=O,E(x(P.S),r),(m.pass||D||function(A,z,j,B){return B&&(B.S&&C(B,P),A.state=function(){return C(P,{})}),j?(n[f]=A,z):A})(O,N,"global"in m?m.global:this==n,m.state)}function y(S){var m,D=S.length,b=this,N=0,P=b.i=b.j=0,O=b.S=[];for(D||(S=[D++]);N<a;)O[N]=N++;for(N=0;N<a;N++)O[N]=O[P=c&P+S[N%D]+(m=O[N])],O[P]=m;(b.g=function(A){for(var z,j=0,B=b.i,Y=b.j,I=b.S;A--;)z=I[B=c&B+1],j=j*a+I[c&(I[B]=I[Y=c&Y+z])+(I[Y]=z)];return b.i=B,b.j=Y,j})(a)}function C(S,m){return m.i=S.i,m.j=S.j,m.S=S.S.slice(),m}function T(S,m){var D=[],b=typeof S,N;if(m&&b=="object")for(N in S)try{D.push(T(S[N],m-1))}catch{}return D.length?D:b=="string"?S:S+"\0"}function E(S,m){for(var D=S+"",b,N=0;N<D.length;)m[c&N]=c&(b^=m[c&N]*19)+D.charCodeAt(N++);return x(m)}function w(){try{var S;return l&&(S=l.randomBytes)?S=S(a):(S=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(S)),x(S)}catch{var m=e.navigator,D=m&&m.plugins;return[+new Date,e,D,e.screen,x(r)]}}function x(S){return String.fromCharCode.apply(0,S)}if(E(n.random(),r),t.exports){t.exports=h;try{l=G2}catch{}}else n["seed"+f]=h})(typeof self<"u"?self:_t,[],Math)})(Ov);var A2=Tv.exports,P2=Cv.exports,W2=Sv.exports,z2=Ev.exports,j2=xv.exports,$2=wv.exports,Ln=Ov.exports;Ln.alea=A2;Ln.xor128=P2;Ln.xorwow=W2;Ln.xorshift7=z2;Ln.xor4096=j2;Ln.tychei=$2;var Ru=L.vtkWarningMacro,H2=1e-12;function vo(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;return Array(t).fill(0)}function Ke(t){return t/180*Math.PI}function la(t){return t*180/Math.PI}var Wa=Math.round;function Pt(t){for(var e=1;e<t;)e*=2;return e}function za(t){return t===Pt(t)}function lo(t,e,r){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function wr(t,e,r){return r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r}function Lu(t,e,r,n){return n[0]=t[0]+e[0]*r,n[1]=t[1]+e[1]*r,n[2]=t[2]+e[2]*r,n}function xe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function pa(t,e,r){var n=t[1]*e[2]-t[2]*e[1],a=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return r[0]=n,r[1]=a,r[2]=i,r}function ra(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(e){case 1:return Math.abs(t);case 2:return Math.sqrt(t[0]*t[0]+t[1]*t[1]);case 3:return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);default:{for(var r=0,n=0;n<e;n++)r+=t[n]*t[n];return Math.sqrt(r)}}}function Dn(t){var e=ra(t);return e!==0&&(t[0]/=e,t[1]/=e,t[2]/=e),e}function Gt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])+(t[2]-e[2])*(t[2]-e[2])}function K2(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function X2(t){var e=K2(t);return e!==0&&(t[0]/=e,t[1]/=e),e}function li(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===2?e[0][0]*e[1][1]-e[1][0]*e[0][1]:e.length===4?e[0]*e[3]-e[1]*e[2]:Number.NaN}function ws(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!"".concat(t).includes("e"))return+"".concat(Math.round("".concat(t,"e+").concat(e)),"e-").concat(e);var r="".concat(t).split("e"),n="";return+r[1]+e>0&&(n="+"),+"".concat(Math.round("".concat(+r[0],"e").concat(n).concat(+r[1]+e)),"e-").concat(e)}function Vu(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e[0]=ws(t[0],r),e[1]=ws(t[1],r),e[2]=ws(t[2],r),e}function Y2(t,e,r){var n,a,i,s,f=0,o,u,g,c=vo(r);for(n=0;n<r;n++){for(s=0,a=0;a<r;a++)(g=Math.abs(t[n*r+a]))>s&&(s=g);if(s===0)return Ru("Unable to factor linear system"),0;c[n]=1/s}for(a=0;a<r;a++){for(n=0;n<a;n++){for(o=t[n*r+a],i=0;i<n;i++)o-=t[n*r+i]*t[i*r+a];t[n*r+a]=o}for(s=0,n=a;n<r;n++){for(o=t[n*r+a],i=0;i<a;i++)o-=t[n*r+i]*t[i*r+a];t[n*r+a]=o,(u=c[n]*Math.abs(o))>=s&&(s=u,f=n)}if(a!==f){for(i=0;i<r;i++)u=t[f*r+i],t[f*r+i]=t[a*r+i],t[a*r+i]=u;c[f]=c[a]}if(e[a]=f,Math.abs(t[a*r+a])<=H2)return Ru("Unable to factor linear system"),0;if(a!==r-1)for(u=1/t[a*r+a],n=a+1;n<r;n++)t[n*r+a]*=u}return 1}function I2(t,e,r,n){var a,i,s,f,o;for(s=-1,a=0;a<n;a++){if(f=e[a],o=r[f],r[f]=r[a],s>=0)for(i=s;i<=a-1;i++)o-=t[a*n+i]*r[i];else o!==0&&(s=a);r[a]=o}for(a=n-1;a>=0;a--){for(o=r[a],i=a+1;i<n;i++)o-=t[a*n+i]*r[i];r[a]=o/t[a*n+a]}}function q2(t,e,r){if(r===2){var n=vo(2),a=li(t[0],t[1],t[2],t[3]);return a===0?0:(n[0]=(t[3]*e[0]-t[1]*e[1])/a,n[1]=(-(t[2]*e[0])+t[0]*e[1])/a,e[0]=n[0],e[1]=n[1],1)}if(r===1)return t[0]===0?0:(e[0]/=t[0],1);var i=vo(r);return Y2(t,i,r)===0?0:(I2(t,i,e,r),1)}function Z2(t,e){var r=St(t,3),n=r[0],a=r[1],i=r[2],s=1/3,f=1/6,o=2/3,u=5/6,g,c,l;n>f&&n<=s?(c=1,g=(s-n)/f,l=0):n>s&&n<=.5?(c=1,l=(n-s)/f,g=0):n>.5&&n<=o?(l=1,c=(o-n)/f,g=0):n>o&&n<=u?(l=1,g=(n-o)/f,c=0):n>u&&n<=1?(g=1,l=(1-n)/f,c=0):(g=1,c=n/f,l=0),g=a*g+(1-a),c=a*c+(1-a),l=a*l+(1-a),g*=i,c*=i,l*=i,e[0]=g,e[1]=c,e[2]=l}function Ui(t){return t[0]=1,t[1]=-1,t[2]=1,t[3]=-1,t[4]=1,t[5]=-1,t}function Os(t){return!(t[1]-t[0]<0)}function _u(t,e,r){return r[0]=Math.min(t[0],e[0]),r[1]=Math.max(t[0],e[0]),r[2]=Math.min(t[1],e[1]),r[3]=Math.max(t[1],e[1]),r[4]=Math.min(t[2],e[2]),r[5]=Math.max(t[2],e[2]),r}function Ms(t,e,r){return t<e?e:t>r?r:t}function bu(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return n[0]=Ms(t[0],e[0],r[0]),n[1]=Ms(t[1],e[1],r[1]),n[2]=Ms(t[2],e[2],r[2]),n}var Q2=Number.isNaN,Mv=Q2;function Dv(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function ku(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function J2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ku(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ku(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var po=1e-6,mv="coincide",Rv="disjoint";function eC(t,e,r){return t[0]*(r[0]-e[0])+t[1]*(r[1]-e[1])+t[2]*(r[2]-e[2])}function Lv(t,e,r){var n=r[0]*(t[0]-e[0])+r[1]*(t[1]-e[1])+r[2]*(t[2]-e[2]);return Math.abs(n)}function Vv(t,e,r,n){var a=[];wr(t,e,a);var i=xe(r,a);n[0]=t[0]-i*r[0],n[1]=t[1]-i*r[1],n[2]=t[2]-i*r[2]}function _v(t,e,r){var n=xe(t,e),a=xe(e,e);return a===0&&(a=1),r[0]=t[0]-n*e[0]/a,r[1]=t[1]-n*e[1]/a,r[2]=t[2]-n*e[2]/a,r}function bv(t,e,r,n){var a=[];wr(t,e,a);var i=xe(r,a),s=xe(r,r);s!==0?(n[0]=t[0]-i*r[0]/s,n[1]=t[1]-i*r[1]/s,n[2]=t[2]-i*r[2]/s):(n[0]=t[0],n[1]=t[1],n[2]=t[2])}function kv(t,e,r,n){var a={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},i=[],s=[];wr(e,t,i),wr(r,t,s);var f=xe(n,s),o=xe(n,i),u,g;return o<0?u=-o:u=o,f<0?g=-f*po:g=f*po,u<=g||(a.t=f/o,a.x[0]=t[0]+a.t*i[0],a.x[1]=t[1]+a.t*i[1],a.x[2]=t[2]+a.t*i[2],a.intersection=!0,a.betweenPoints=a.t>=0&&a.t<=1),a}function Fv(t,e,r,n){var a={intersection:!1,l0:[],l1:[],error:null},i=[];pa(e,n,i);var s=i.map(function(l){return Math.abs(l)});if(s[0]+s[1]+s[2]<po){var f=[];return wr(t,r,f),xe(e,f)===0?a.error=mv:a.error=Rv,a}var o;s[0]>s[1]&&s[0]>s[2]?o="x":s[1]>s[2]?o="y":o="z";var u=[],g=-xe(e,t),c=-xe(n,r);switch(o){case"x":u[0]=0,u[1]=(c*e[2]-g*n[2])/i[0],u[2]=(g*n[1]-c*e[1])/i[0];break;case"y":u[0]=(g*n[2]-c*e[2])/i[1],u[1]=0,u[2]=(c*e[0]-g*n[0])/i[1];break;case"z":u[0]=(c*e[1]-g*n[1])/i[2],u[1]=(g*n[0]-c*e[0])/i[2],u[2]=0;break}return a.l0=u,lo(u,i,a.l1),a.intersection=!0,a}var tC={evaluate:eC,distanceToPlane:Lv,projectPoint:Vv,projectVector:_v,generalizedProjectPoint:bv,intersectWithLine:kv,intersectWithPlane:Fv,DISJOINT:Rv,COINCIDE:mv};function rC(t,e){e.classHierarchy.push("vtkPlane"),t.distanceToPlane=function(r){return Lv(r,e.origin,e.normal)},t.projectPoint=function(r,n){Vv(r,e.origin,e.normal,n)},t.projectVector=function(r,n){return _v(r,e.normal,n)},t.push=function(r){if(r!==0)for(var n=0;n<3;n++)e.origin[n]+=r*e.normal[n]},t.generalizedProjectPoint=function(r,n){bv(r,e.origin,e.normal,n)},t.evaluateFunction=function(r,n,a){return Array.isArray(r)?e.normal[0]*(r[0]-e.origin[0])+e.normal[1]*(r[1]-e.origin[1])+e.normal[2]*(r[2]-e.origin[2]):e.normal[0]*(r-e.origin[0])+e.normal[1]*(n-e.origin[1])+e.normal[2]*(a-e.origin[2])},t.evaluateGradient=function(r){var n=[e.normal[0],e.normal[1],e.normal[2]];return n},t.intersectWithLine=function(r,n){return kv(r,n,e.origin,e.normal)},t.intersectWithPlane=function(r,n){return Fv(r,n,e.origin,e.normal)}}var nC={normal:[0,0,1],origin:[0,0,0]};function Bv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nC,r),L.obj(t,e),L.setGetArray(t,e,["normal","origin"],3),rC(t,e)}var aC=L.newInstance(Bv,"vtkPlane"),mn=J2({newInstance:aC,extend:Bv},tC);function Fu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function iC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Gi=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function Nv(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function or(t){return t[0]<=t[1]&&t[2]<=t[3]&&t[4]<=t[5]}function Ho(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Uv(t){return Ho(t,Gi)}function Di(t){var e=St(t,6),r=e[0],n=e[1],a=e[2],i=e[3],s=e[4],f=e[5];return t[0]=r<(arguments.length<=1?void 0:arguments[1])?r:arguments.length<=1?void 0:arguments[1],t[1]=n>(arguments.length<=1?void 0:arguments[1])?n:arguments.length<=1?void 0:arguments[1],t[2]=a<(arguments.length<=2?void 0:arguments[2])?a:arguments.length<=2?void 0:arguments[2],t[3]=i>(arguments.length<=2?void 0:arguments[2])?i:arguments.length<=2?void 0:arguments[2],t[4]=s<(arguments.length<=3?void 0:arguments[3])?s:arguments.length<=3?void 0:arguments[3],t[5]=f>(arguments.length<=3?void 0:arguments[3])?f:arguments.length<=3?void 0:arguments[3],t}function Gv(t,e){if(e.length===0)return t;if(Array.isArray(e[0]))for(var r=0;r<e.length;++r)Di(t,e[r]);else for(var n=0;n<e.length;n+=3)Di(t,e.slice(n,n+3));return t}function Av(t,e,r,n,a,i,s){var f=St(t,6),o=f[0],u=f[1],g=f[2],c=f[3],l=f[4],h=f[5];return s===void 0?(t[0]=Math.min(e[0],o),t[1]=Math.max(e[1],u),t[2]=Math.min(e[2],g),t[3]=Math.max(e[3],c),t[4]=Math.min(e[4],l),t[5]=Math.max(e[5],h)):(t[0]=Math.min(e,o),t[1]=Math.max(r,u),t[2]=Math.min(n,g),t[3]=Math.max(a,c),t[4]=Math.min(i,l),t[5]=Math.max(s,h)),t}function Pv(t,e,r,n){var a=St(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],g=a[5];return t[0]=e,t[1]=e>s?e:s,t[2]=r,t[3]=r>o?r:o,t[4]=n,t[5]=n>g?n:g,i!==e||f!==r||u!==n}function Wv(t,e,r,n){var a=St(t,6),i=a[0],s=a[1],f=a[2],o=a[3],u=a[4],g=a[5];return t[0]=e<i?e:i,t[1]=e,t[2]=r<f?r:f,t[3]=r,t[4]=n<u?n:u,t[5]=n,s!==e||o!==r||g!==n}function zv(t,e){return t[0]-=e,t[1]+=e,t[2]-=e,t[3]+=e,t[4]-=e,t[5]+=e,t}function Ko(t,e,r,n){return or(t)?(e>=0?(t[0]*=e,t[1]*=e):(t[0]=e*t[1],t[1]=e*t[0]),r>=0?(t[2]*=r,t[3]*=r):(t[2]=r*t[3],t[3]=r*t[2]),n>=0?(t[4]*=n,t[5]*=n):(t[4]=n*t[5],t[5]=n*t[4]),!0):!1}function Xo(t){return[.5*(t[0]+t[1]),.5*(t[2]+t[3]),.5*(t[4]+t[5])]}function sC(t,e,r,n){if(!or(t))return!1;var a=Xo(t);return t[0]-=a[0],t[1]-=a[0],t[2]-=a[1],t[3]-=a[1],t[4]-=a[2],t[5]-=a[2],Ko(t,e,r,n),t[0]+=a[0],t[1]+=a[0],t[2]+=a[1],t[3]+=a[1],t[4]+=a[2],t[5]+=a[2],!0}function na(t,e){return t[e*2+1]-t[e*2]}function Ai(t){return[na(t,0),na(t,1),na(t,2)]}function jv(t){return t.slice(0,2)}function $v(t){return t.slice(2,4)}function Hv(t){return t.slice(4,6)}function Kv(t){var e=Ai(t);return e[0]>e[1]?e[0]>e[2]?e[0]:e[2]:e[1]>e[2]?e[1]:e[2]}function Xv(t){if(or(t)){var e=Ai(t);return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}return null}function Yo(t){return[t[0],t[2],t[4]]}function Io(t){return[t[1],t[3],t[5]]}function ja(t,e){return t<=0&&e>=0||t>=0&&e<=0}function Yv(t,e){for(var r=0,n=0;n<2;n++)for(var a=2;a<4;a++)for(var i=4;i<6;i++)e[r]=[t[n],t[a],t[i]],r++;return e}function Iv(t,e,r){return e[0]=t[0],e[1]=t[2],e[2]=t[4],r[0]=t[1],r[1]=t[3],r[2]=t[5],e}function qv(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e[0]=.5*(t[1]-t[0]),e[1]=.5*(t[3]-t[2]),e[2]=.5*(t[5]-t[4]),e}function Zv(t,e,r,n){for(var a=[].concat(Gi),i=t.getData(),s=0;s<i.length;s+=3){var f=[i[s],i[s+1],i[s+2]],o=xe(f,e);a[0]=Math.min(o,a[0]),a[1]=Math.max(o,a[1]);var u=xe(f,r);a[2]=Math.min(u,a[2]),a[3]=Math.max(u,a[3]);var g=xe(f,n);a[4]=Math.min(g,a[4]),a[5]=Math.max(g,a[5])}return a}function Qv(t,e,r,n,a){for(var i=!0,s=[],f=0,o=[],u=[0,0,0],g=0,c=1,l=2,h=0;h<3;h++)e[h]<t[2*h]?(s[h]=c,u[h]=t[2*h],i=!1):e[h]>t[2*h+1]?(s[h]=g,u[h]=t[2*h+1],i=!1):s[h]=l;if(i)return n[0]=e[0],n[1]=e[1],n[2]=e[2],a[0]=0,1;for(var y=0;y<3;y++)s[y]!==l&&r[y]!==0?o[y]=(u[y]-e[y])/r[y]:o[y]=-1;for(var C=0;C<3;C++)o[f]<o[C]&&(f=C);if(o[f]>1||o[f]<0)return 0;a[0]=o[f];for(var T=0;T<3;T++)if(f!==T){if(n[T]=e[T]+o[f]*r[T],n[T]<t[2*T]||n[T]>t[2*T+1])return 0}else n[T]=u[T];return 1}function Jv(t,e,r){for(var n=[],a=0,i=1,s=1,f=4;f<=5;++f){n[2]=t[f];for(var o=2;o<=3;++o){n[1]=t[o];for(var u=0;u<=1;++u)if(n[0]=t[u],a=mn.evaluate(r,e,n),s&&(i=a>=0?1:-1,s=0),a===0||i>0&&a<0||i<0&&a>0)return 1}}return 0}function el(t,e){if(!(or(t)&&or(e)))return!1;for(var r=[0,0,0,0,0,0],n,a=0;a<3;a++)if(n=!1,e[a*2]>=t[a*2]&&e[a*2]<=t[a*2+1]?(n=!0,r[a*2]=e[a*2]):t[a*2]>=e[a*2]&&t[a*2]<=e[a*2+1]&&(n=!0,r[a*2]=t[a*2]),e[a*2+1]>=t[a*2]&&e[a*2+1]<=t[a*2+1]?(n=!0,r[a*2+1]=e[2*a+1]):t[a*2+1]>=e[a*2]&&t[a*2+1]<=e[a*2+1]&&(n=!0,r[a*2+1]=t[a*2+1]),!n)return!1;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],!0}function mi(t,e){if(!(or(t)&&or(e)))return!1;for(var r=0;r<3;r++)if(!(e[r*2]>=t[r*2]&&e[r*2]<=t[r*2+1])&&!(t[r*2]>=e[r*2]&&t[r*2]<=e[r*2+1])&&!(e[r*2+1]>=t[r*2]&&e[r*2+1]<=t[r*2+1])&&!(t[r*2+1]>=e[r*2]&&t[r*2+1]<=e[r*2+1]))return!1;return!0}function Ri(t,e,r,n){return!(e<t[0]||e>t[1]||r<t[2]||r>t[3]||n<t[4]||n>t[5])}function oC(t,e){return!(!mi(t,e)||!Ri.apply(void 0,[t].concat(Ee(Yo(e))))||!Ri.apply(void 0,[t].concat(Ee(Io(e)))))}function tl(t,e,r){for(var n=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],a=[0,0,0,0,0,0,0,0],i=0,s=0;s<2;s++)for(var f=2;f<4;f++)for(var o=4;o<6;o++){var u=[t[s],t[f],t[o]];a[i++]=mn.evaluate(r,e,u)}for(var g=2;g--&&!(ja(a[n[g][0]],a[n[g][4]])&&ja(a[n[g][1]],a[n[g][5]])&&ja(a[n[g][2]],a[n[g][6]])&&ja(a[n[g][3]],a[n[g][7]])););if(g<0)return!1;for(var c=Math.sign(r[g]),l=Math.abs((t[g*2+1]-t[g*2])*r[g]),h=c>0?1:0,y=0;y<4;y++)if(l!==0){var C=Math.abs(a[n[g][y]])/l;c>0&&C<h&&(h=C),c<0&&C>h&&(h=C)}var T=(1-h)*t[g*2]+h*t[g*2+1];return c>0?t[g*2]=T:t[g*2+1]=T,!0}var fC=function(){function t(e){No(this,t),this.bounds=e,this.bounds||(this.bounds=new Float64Array(Gi))}return Uo(t,[{key:"getBounds",value:function(){return this.bounds}},{key:"equals",value:function(r){return Nv(this.bounds,r)}},{key:"isValid",value:function(){return or(this.bounds)}},{key:"setBounds",value:function(r){return Ho(this.bounds,r)}},{key:"reset",value:function(){return Uv(this.bounds)}},{key:"addPoint",value:function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return Di(this.bounds,n)}},{key:"addPoints",value:function(r){return Gv(this.bounds,r)}},{key:"addBounds",value:function(r,n,a,i,s,f){return Av(this.bounds,r,n,a,i,s,f)}},{key:"setMinPoint",value:function(r,n,a){return Pv(this.bounds,r,n,a)}},{key:"setMaxPoint",value:function(r,n,a){return Wv(this.bounds,r,n,a)}},{key:"inflate",value:function(r){return zv(this.bounds,r)}},{key:"scale",value:function(r,n,a){return Ko(this.bounds,r,n,a)}},{key:"getCenter",value:function(){return Xo(this.bounds)}},{key:"getLength",value:function(r){return na(this.bounds,r)}},{key:"getLengths",value:function(){return Ai(this.bounds)}},{key:"getMaxLength",value:function(){return Kv(this.bounds)}},{key:"getDiagonalLength",value:function(){return Xv(this.bounds)}},{key:"getMinPoint",value:function(){return Yo(this.bounds)}},{key:"getMaxPoint",value:function(){return Io(this.bounds)}},{key:"getXRange",value:function(){return jv(this.bounds)}},{key:"getYRange",value:function(){return $v(this.bounds)}},{key:"getZRange",value:function(){return Hv(this.bounds)}},{key:"getCorners",value:function(r){return Yv(this.bounds,r)}},{key:"computeCornerPoints",value:function(r,n){return Iv(this.bounds,r,n)}},{key:"computeLocalBounds",value:function(r,n,a){return Zv(this.bounds,r,n,a)}},{key:"computeScale3",value:function(r){return qv(this.bounds,r)}},{key:"cutWithPlane",value:function(r,n){return tl(this.bounds,r,n)}},{key:"intersectBox",value:function(r,n,a,i){return Qv(this.bounds,r,n,a,i)}},{key:"intersectPlane",value:function(r,n){return Jv(this.bounds,r,n)}},{key:"intersect",value:function(r){return el(this.bounds,r)}},{key:"intersects",value:function(r){return mi(this.bounds,r)}},{key:"containsPoint",value:function(r,n,a){return Ri(this.bounds,r,n,a)}},{key:"contains",value:function(r){return mi(this.bounds,r)}}]),t}();function uC(t){var e=t&&t.bounds;return new fC(e)}var cC={equals:Nv,isValid:or,setBounds:Ho,reset:Uv,addPoint:Di,addPoints:Gv,addBounds:Av,setMinPoint:Pv,setMaxPoint:Wv,inflate:zv,scale:Ko,scaleAboutCenter:sC,getCenter:Xo,getLength:na,getLengths:Ai,getMaxLength:Kv,getDiagonalLength:Xv,getMinPoint:Yo,getMaxPoint:Io,getXRange:jv,getYRange:$v,getZRange:Hv,getCorners:Yv,computeCornerPoints:Iv,computeLocalBounds:Zv,computeScale3:qv,cutWithPlane:tl,intersectBox:Qv,intersectPlane:Jv,intersect:el,intersects:mi,containsPoint:Ri,contains:oC,INIT_BOUNDS:Gi},je=iC({newInstance:uC},cC),gC={DISPLAY:0,WORLD:1},rl={CoordinateSystem:gC};function Bu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ho=rl.CoordinateSystem;function Nu(t){return function(){return L.vtkErrorMacro("vtkProp::".concat(t," - NOT IMPLEMENTED"))}}function lC(t,e){e.classHierarchy.push("vtkProp"),t.getMTime=function(){for(var r=e.mtime,n=0;n<e.textures.length;++n){var a=e.textures[n].getMTime();a>r&&(r=a)}return r},t.processSelectorPixelBuffers=function(r,n){},t.getNestedProps=function(){return null},t.getActors=function(){return[]},t.getActors2D=function(){return[]},t.getVolumes=function(){return[]},t.pick=Nu("pick"),t.hasKey=Nu("hasKey"),t.getNestedVisibility=function(){return e.visibility&&(!e._parentProp||e._parentProp.getNestedVisibility())},t.getNestedPickable=function(){return e.pickable&&(!e._parentProp||e._parentProp.getNestedPickable())},t.getNestedDragable=function(){return e.dragable&&(!e._parentProp||e._parentProp.getNestedDragable())},t.getRedrawMTime=function(){return e.mtime},t.setEstimatedRenderTime=function(r){e.estimatedRenderTime=r,e.savedEstimatedRenderTime=r},t.restoreEstimatedRenderTime=function(){e.estimatedRenderTime=e.savedEstimatedRenderTime},t.addEstimatedRenderTime=function(r){e.estimatedRenderTime+=r},t.setAllocatedRenderTime=function(r){e.allocatedRenderTime=r,e.savedEstimatedRenderTime=e.estimatedRenderTime,e.estimatedRenderTime=0},t.getSupportsSelection=function(){return!1},t.getTextures=function(){return e.textures},t.hasTexture=function(r){return e.textures.indexOf(r)!==-1},t.addTexture=function(r){r&&!t.hasTexture(r)&&(e.textures=e.textures.concat(r),t.modified())},t.removeTexture=function(r){var n=e.textures.filter(function(a){return a!==r});e.textures.length!==n.length&&(e.textures=n,t.modified())},t.removeAllTextures=function(){e.textures=[],t.modified()},t.setCoordinateSystemToWorld=function(){return t.setCoordinateSystem(ho.WORLD)},t.setCoordinateSystemToDisplay=function(){return t.setCoordinateSystem(ho.DISPLAY)}}var pC={allocatedRenderTime:10,coordinateSystem:ho.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function nl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pC,r),L.obj(t,e),L.get(t,e,["estimatedRenderTime","allocatedRenderTime"]),L.setGet(t,e,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),L.moveToProtected(t,e,["parentProp"]),lC(t,e)}var hC=L.newInstance(nl,"vtkProp"),Ea=vC({newInstance:hC,extend:nl},rl);function yC(t,e){e.classHierarchy.push("vtkProp3D"),t.addPosition=function(n){e.position=e.position.map(function(a,i){return a+n[i]}),t.modified()},t.getOrientationWXYZ=function(){var n=qr();Dg(n,e.rotation);var a=new Float64Array(3),i=md(a,n);return[la(i),a[0],a[1],a[2]]},t.rotateX=function(n){n!==0&&(Cg(e.rotation,e.rotation,Ke(n)),t.modified())},t.rotateY=function(n){n!==0&&(Sg(e.rotation,e.rotation,Ke(n)),t.modified())},t.rotateZ=function(n){n!==0&&(Eg(e.rotation,e.rotation,Ke(n)),t.modified())},t.rotateWXYZ=function(n,a,i,s){if(!(n===0||a===0&&i===0&&s===0)){var f=Ke(n),o=qr();Bo(o,[a,i,s],f);var u=new Float64Array(16);Fo(u,o),Ct(e.rotation,e.rotation,u),t.modified()}},t.setOrientation=function(n,a,i){return n===e.orientation[0]&&a===e.orientation[1]&&i===e.orientation[2]?!1:(e.orientation=[n,a,i],De(e.rotation),t.rotateZ(i),t.rotateX(n),t.rotateY(a),t.modified(),!0)},t.setUserMatrix=function(n){ut(e.userMatrix,n),t.modified()},t.getMatrix=function(){return t.computeMatrix(),e.matrix},t.computeMatrix=function(){if(t.getMTime()>e.matrixMTime.getMTime()){De(e.matrix),e.userMatrix&&Ct(e.matrix,e.matrix,e.userMatrix),et(e.matrix,e.matrix,e.origin),et(e.matrix,e.matrix,e.position),Ct(e.matrix,e.matrix,e.rotation),oa(e.matrix,e.matrix,e.scale),et(e.matrix,e.matrix,[-e.origin[0],-e.origin[1],-e.origin[2]]),We(e.matrix,e.matrix),e.isIdentity=!0;for(var n=0;n<4;++n)for(var a=0;a<4;++a)(n===a?1:0)!==e.matrix[n+a*4]&&(e.isIdentity=!1);e.matrixMTime.modified()}},t.getCenter=function(){return je.getCenter(e.bounds)},t.getLength=function(){return je.getLength(e.bounds)},t.getXRange=function(){return je.getXRange(e.bounds)},t.getYRange=function(){return je.getYRange(e.bounds)},t.getZRange=function(){return je.getZRange(e.bounds)},t.getUserMatrix=function(){return e.userMatrix};function r(){t.computeMatrix()}t.onModified(r)}var dC={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function al(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dC,r),Ea.extend(t,e,r),e.matrixMTime={},L.obj(e.matrixMTime),L.get(t,e,["bounds","isIdentity"]),L.getArray(t,e,["orientation"]),L.setGetArray(t,e,["origin","position","scale"],3),e.matrix=De(new Float64Array(16)),e.rotation=De(new Float64Array(16)),e.userMatrix=De(new Float64Array(16)),e.transform=null,yC(t,e)}var TC=L.newInstance(al,"vtkProp3D"),CC={newInstance:TC,extend:al},il={FLAT:0,GOURAUD:1,PHONG:2},bt={POINTS:0,WIREFRAME:1,SURFACE:2},SC=il,qo={Shading:il,Representation:bt,Interpolation:SC};function Uu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function EC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Xn=qo.Representation,Yn=qo.Interpolation;function Gu(t){return function(){return L.vtkErrorMacro("vtkProperty::".concat(t," - NOT IMPLEMENTED"))}}function xC(t,e){e.classHierarchy.push("vtkProperty"),t.setColor=function(r,n,a){Array.isArray(r)?(e.color[0]!==r[0]||e.color[1]!==r[1]||e.color[2]!==r[2])&&(e.color[0]=r[0],e.color[1]=r[1],e.color[2]=r[2],t.modified()):(e.color[0]!==r||e.color[1]!==n||e.color[2]!==a)&&(e.color[0]=r,e.color[1]=n,e.color[2]=a,t.modified()),t.setDiffuseColor(e.color),t.setAmbientColor(e.color),t.setSpecularColor(e.color)},t.computeCompositeColor=Gu("ComputeCompositeColor"),t.getColor=function(){var r=0;e.ambient+e.diffuse+e.specular>0&&(r=1/(e.ambient+e.diffuse+e.specular));for(var n=0;n<3;n++)e.color[n]=r*(e.ambient*e.ambientColor[n]+e.diffuse*e.diffuseColor[n]+e.specular*e.specularColor[n]);return[].concat(e.color)},t.setSpecularPower=function(r){var n=1/Math.max(1,r);(e.roughness!==n||e.specularPower!==r)&&(e.specularPower=r,e.roughness=n,t.modified())},t.addShaderVariable=Gu("AddShaderVariable"),t.setInterpolationToFlat=function(){return t.setInterpolation(Yn.FLAT)},t.setInterpolationToGouraud=function(){return t.setInterpolation(Yn.GOURAUD)},t.setInterpolationToPhong=function(){return t.setInterpolation(Yn.PHONG)},t.getInterpolationAsString=function(){return L.enumToString(Yn,e.interpolation)},t.setRepresentationToWireframe=function(){return t.setRepresentation(Xn.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(Xn.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(Xn.POINTS)},t.getRepresentationAsString=function(){return L.enumToString(Xn,e.representation)}}var wC={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:Yn.GOURAUD,representation:Xn.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function sl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,wC,r),L.obj(t,e),L.setGet(t,e,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),L.setGetArray(t,e,["ambientColor","specularColor","diffuseColor","edgeColor"],3),xC(t,e)}var OC=L.newInstance(sl,"vtkProperty"),Vn=EC({newInstance:OC,extend:sl},qo);function Au(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Au(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Au(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var DC=L.vtkDebugMacro;function mC(t,e){e.classHierarchy.push("vtkActor");var r=MC({},t);t.getActors=function(){return[t]},t.getIsOpaque=function(){if(e.forceOpaque)return!0;if(e.forceTranslucent)return!1;e.property||t.getProperty();var n=e.property.getOpacity()>=1;return n=n&&(!e.texture||!e.texture.isTranslucent()),n=n&&(!e.mapper||e.mapper.getIsOpaque()),n},t.hasTranslucentPolygonalGeometry=function(){return e.mapper===null?!1:(e.property===null&&t.setProperty(t.makeProperty()),!t.getIsOpaque())},t.makeProperty=Vn.newInstance,t.getProperty=function(){return e.property===null&&(e.property=t.makeProperty()),e.property},t.getBounds=function(){if(e.mapper===null)return e.bounds;var n=e.mapper.getBounds();if(!n||n.length!==6)return n;if(n[0]>n[1])return e.mapperBounds=n.concat(),e.bounds=[1,-1,1,-1,1,-1],e.boundsMTime.modified(),n;if(!e.mapperBounds||n[0]!==e.mapperBounds[0]||n[1]!==e.mapperBounds[1]||n[2]!==e.mapperBounds[2]||n[3]!==e.mapperBounds[3]||n[4]!==e.mapperBounds[4]||n[5]!==e.mapperBounds[5]||t.getMTime()>e.boundsMTime.getMTime()){DC("Recomputing bounds..."),e.mapperBounds=n.concat();var a=[];je.getCorners(n,a),t.computeMatrix();var i=new Float64Array(16);We(i,e.matrix),a.forEach(function(s){return me(s,s,i)}),e.bounds[0]=e.bounds[2]=e.bounds[4]=Number.MAX_VALUE,e.bounds[1]=e.bounds[3]=e.bounds[5]=-Number.MAX_VALUE,e.bounds=e.bounds.map(function(s,f){return f%2===0?a.reduce(function(o,u){return o>u[f/2]?u[f/2]:o},s):a.reduce(function(o,u){return o<u[(f-1)/2]?u[(f-1)/2]:o},s)}),e.boundsMTime.modified()}return e.bounds},t.getMTime=function(){var n=r.getMTime();if(e.property!==null){var a=e.property.getMTime();n=a>n?a:n}if(e.backfaceProperty!==null){var i=e.backfaceProperty.getMTime();n=i>n?i:n}return n},t.getRedrawMTime=function(){var n=e.mtime;if(e.mapper!==null){var a=e.mapper.getMTime();n=a>n?a:n,e.mapper.getInput()!==null&&(e.mapper.getInputAlgorithm().update(),a=e.mapper.getInput().getMTime(),n=a>n?a:n)}return n},t.getSupportsSelection=function(){return e.mapper?e.mapper.getSupportsSelection():!1},t.processSelectorPixelBuffers=function(n,a){e.mapper&&e.mapper.processSelectorPixelBuffers&&e.mapper.processSelectorPixelBuffers(n,a)}}var RC={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function ol(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RC,r),CC.extend(t,e,r),e.boundsMTime={},L.obj(e.boundsMTime),L.set(t,e,["property"]),L.setGet(t,e,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),mC(t,e)}var LC=L.newInstance(ol,"vtkActor"),Dr={newInstance:LC,extend:ol},fl={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},mr={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},VC=mr.FLOAT,ul={DefaultDataType:VC,DataTypeByteSize:fl,VtkDataTypes:mr};function Pu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Li(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var _C=ve,bC=ul.DefaultDataType;function yo(t,e,r){var n=t.length,a,i,s,f;if(n===0)return{min:Number.MAX_VALUE,max:-Number.MAX_VALUE};for(a=t[e],i=a,f=e;f<n;f+=r)s=t[f],s<a?a=s:s>i&&(i=s);return{min:a,max:i}}function kC(){var t=Number.MAX_VALUE,e=-Number.MAX_VALUE,r=0,n=0;return{add:function(i){t>i&&(t=i),e<i&&(e=i),r++,n+=i},get:function(){return{min:t,max:e,count:r,sum:n,mean:n/r}},getRange:function(){return{min:t,max:e}}}}function cl(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(e<0&&r>1){for(var n=t.length,a=n/r,i=new Float64Array(a),s=0,f=0;s<a;++s){for(var o,u=f+r;f<u;++f)i[s]+=t[f]*t[f];o=s,i[o]=Math.pow(i[o],.5)}return yo(i,0,1)}return yo(t,e<0?0:e,r)}function Wu(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t||[];r.length<=e;)r.push(null);return r}function Zo(t){return Object.prototype.toString.call(t).slice(8,-1)}function FC(t){for(var e=t.getNumberOfComponents(),r=0,n=new Array(e),a=0;a<t.getNumberOfTuples();++a){t.getTuple(a,n);var i=ra(n,e);i>r&&(r=i)}return r}var BC={computeRange:cl,createRangeHelper:kC,fastComputeRange:yo,getDataType:Zo,getMaxNorm:FC};function NC(t,e){e.classHierarchy.push("vtkDataArray");function r(){e.ranges=null,t.modified()}function n(a){if(a<0)return!1;var i=t.getNumberOfComponents(),s=e.values.length/(i>0?i:1);if(a===s)return!0;if(a>s){var f=e.values;return e.values=Ta(e.dataType,(a+s)*i),e.values.set(f),!0}return e.size=a*i,r(),!0}t.initialize=function(){n(0)},t.getElementComponentSize=function(){return e.values.BYTES_PER_ELEMENT},t.getComponent=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.values[a*e.numberOfComponents+i]},t.setComponent=function(a,i,s){s!==e.values[a*e.numberOfComponents+i]&&(e.values[a*e.numberOfComponents+i]=s,r())},t.getValue=function(a){var i=a/e.numberOfComponents,s=a%e.numberOfComponents;return t.getComponent(i,s)},t.setValue=function(a,i){var s=a/e.numberOfComponents,f=a%e.numberOfComponents;t.setComponent(s,f,i)},t.getData=function(){return e.size===e.values.length?e.values:e.values.subarray(0,e.size)},t.getRange=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=a<0?e.numberOfComponents:a,s=null;return e.ranges||(e.ranges=Wu(e.ranges,e.numberOfComponents)),s=e.ranges[i],s?(e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple):(s=cl(t.getData(),a,e.numberOfComponents),e.ranges[i]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple)},t.setRange=function(a,i){e.ranges||(e.ranges=Wu(e.ranges,e.numberOfComponents));var s={min:a.min,max:a.max};return e.ranges[i]=s,e.rangeTuple[0]=s.min,e.rangeTuple[1]=s.max,e.rangeTuple},t.setTuple=function(a,i){for(var s=a*e.numberOfComponents,f=0;f<e.numberOfComponents;f++)e.values[s+f]=i[f]},t.setTuples=function(a,i){for(var s=a*e.numberOfComponents,f=Math.min(i.length,e.size-s),o=0;o<f;)e.values[s++]=i[o++]},t.insertTuple=function(a,i){return e.size<=a*e.numberOfComponents&&(e.size=(a+1)*e.numberOfComponents,n(a+1)),t.setTuple(a,i),a},t.insertTuples=function(a,i){var s=a+i.length/e.numberOfComponents;return e.size<s*e.numberOfComponents&&(e.size=s*e.numberOfComponents,n(s)),t.setTuples(a,i),s},t.insertNextTuple=function(a){var i=e.size/e.numberOfComponents;return t.insertTuple(i,a)},t.insertNextTuples=function(a){var i=e.size/e.numberOfComponents;return t.insertTuples(i,a)},t.getTuple=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=e.numberOfComponents||1,f=a*s;switch(s){case 4:i[3]=e.values[f+3];case 3:i[2]=e.values[f+2];case 2:i[1]=e.values[f+1];case 1:i[0]=e.values[f];break;default:for(var o=s-1;o>=0;--o)i[o]=e.values[f+o]}return i},t.getTuples=function(a,i){var s=(a!=null?a:0)*e.numberOfComponents,f=(i!=null?i:t.getNumberOfTuples())*e.numberOfComponents,o=t.getData().subarray(s,f);return o.length>0?o:null},t.getTupleLocation=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return a*e.numberOfComponents},t.getNumberOfComponents=function(){return e.numberOfComponents},t.getNumberOfValues=function(){return e.size},t.getNumberOfTuples=function(){return e.size/e.numberOfComponents},t.getDataType=function(){return e.dataType},t.newClone=function(){return vl({empty:!0,name:e.name,dataType:e.dataType,numberOfComponents:e.numberOfComponents})},t.getName=function(){return e.name||(t.modified(),e.name="vtkDataArray".concat(t.getMTime())),e.name},t.setData=function(a,i){e.values=a,e.size=a.length,e.dataType=Zo(a),i&&(e.numberOfComponents=i),e.size%e.numberOfComponents!==0&&(e.numberOfComponents=1),r()},t.getState=function(){if(e.deleted)return null;var a=Li(Li({},e),{},{vtkClass:t.getClassName()});a.values=Array.from(a.values),delete a.buffer,Object.keys(a).forEach(function(s){a[s]||delete a[s]});var i={};return Object.keys(a).sort().forEach(function(s){i[s]=a[s]}),i.mtime&&delete i.mtime,i},t.deepCopy=function(a){t.shallowCopy(a),t.setData(a.getData().slice())},t.interpolateTuple=function(a,i,s,f,o,u){var g=e.numberOfComponents||1;(g!==i.getNumberOfComponents()||g!==f.getNumberOfComponents())&&_C("numberOfComponents must match");var c=i.getTuple(s),l=f.getTuple(o),h=[];switch(h.length=g,g){case 4:h[3]=c[3]+(l[3]-c[3])*u;case 3:h[2]=c[2]+(l[2]-c[2])*u;case 2:h[1]=c[1]+(l[1]-c[1])*u;case 1:h[0]=c[0]+(l[0]-c[0])*u;break;default:for(var y=0;y<g;y++)h[y]=c[y]+(l[y]-c[y])*u}return t.insertTuple(a,h)}}var UC={name:"",numberOfComponents:1,dataType:bC,rangeTuple:[0,0]};function gl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(e,UC,r),!e.empty&&!e.values&&!e.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(e.values?Array.isArray(e.values)&&(e.values=qg(e.dataType,e.values)):e.values=Ta(e.dataType,e.size),e.values){var n;e.size=(n=e.size)!==null&&n!==void 0?n:e.values.length,e.dataType=Zo(e.values)}yt(t,e),Ni(t,e,["name","numberOfComponents"]),NC(t,e)}var vl=Ue(gl,"vtkDataArray"),_e=Li(Li({newInstance:vl,extend:gl},BC),ul);function GC(t,e){e.classHierarchy.push("vtkAbstractMapper"),t.update=function(){t.getInputData()},t.addClippingPlane=function(r){return r.isA("vtkPlane")?e.clippingPlanes.includes(r)?!1:(e.clippingPlanes.push(r),t.modified(),!0):!1},t.getNumberOfClippingPlanes=function(){return e.clippingPlanes.length},t.removeAllClippingPlanes=function(){return e.clippingPlanes.length===0?!1:(e.clippingPlanes.length=0,t.modified(),!0)},t.removeClippingPlane=function(r){var n=e.clippingPlanes.indexOf(r);return n===-1?!1:(e.clippingPlanes.splice(n,1),t.modified(),!0)},t.getClippingPlanes=function(){return e.clippingPlanes},t.setClippingPlanes=function(r){if(!!r)if(!Array.isArray(r))t.addClippingPlane(r);else for(var n=r.length,a=0;a<n&&a<6;a++)t.addClippingPlane(r[a])},t.getClippingPlaneInDataCoords=function(r,n,a){var i=e.clippingPlanes,s=r;if(i){var f=i.length;if(n>=0&&n<f){var o=i[n],u=o.getNormal(),g=o.getOrigin(),c=u[0],l=u[1],h=u[2],y=-(c*g[0]+l*g[1]+h*g[2]);a[0]=c*s[0]+l*s[4]+h*s[8]+y*s[12],a[1]=c*s[1]+l*s[5]+h*s[9]+y*s[13],a[2]=c*s[2]+l*s[6]+h*s[10]+y*s[14],a[3]=c*s[3]+l*s[7]+h*s[11]+y*s[15];return}}L.vtkErrorMacro("Clipping plane index ".concat(n," is out of range."))}}var AC={clippingPlanes:[]};function PC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,AC,r),L.obj(t,e),L.algo(t,e,1,0),e.clippingPlanes||(e.clippingPlanes=[]),GC(t,e)}var ll={extend:PC};function WC(t,e){t.getBounds=function(){return 0},t.getBounds=function(r){t.getBounds();for(var n=0;n<6;n++)r[n]=e.bounds[n]},t.getCenter=function(){t.getBounds();for(var r=0;r<3;r++)e.center[r]=(e.bounds[2*r+1]+e.bounds[2*r])/2;return e.center.slice()},t.getLength=function(){var r=0,n=0;t.getBounds();for(var a=0;a<3;a++)r=e.bounds[2*a+1]-e.bounds[2*a],n+=r*r;return Math.sqrt(n)}}var zC={bounds:[1,-1,1,-1,1,-1],center:[0,0,0]};function jC(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zC,r),ll.extend(t,e,r),e.bounds||Ui(e.bounds),e.center||(e.center=[0,0,0]),WC(t,e)}var $C={extend:jC},zu=L.vtkErrorMacro,HC=L.vtkWarningMacro;function KC(t,e){e.classHierarchy.push("vtkFieldData");var r=t.getState;e.arrays&&(e.arrays=e.arrays.map(function(n){return{data:zt(n.data)}})),t.initialize=function(){t.initializeFields(),t.copyAllOn(),t.clearFieldFlags()},t.initializeFields=function(){e.arrays=[],e.copyFieldFlags={},t.modified()},t.copyStructure=function(n){t.initializeFields(),e.copyFieldFlags=n.getCopyFieldFlags().map(function(a){return a}),e.arrays=n.arrays().map(function(a){return{array:a}})},t.getNumberOfArrays=function(){return e.arrays.length},t.getNumberOfActiveArrays=function(){return e.arrays.length},t.addArray=function(n){var a=n.getName(),i=t.getArrayWithIndex(a),s=i.array,f=i.index;return s!=null?(e.arrays[f]={data:n},f):(e.arrays=[].concat(e.arrays,{data:n}),e.arrays.length-1)},t.removeAllArrays=function(){e.arrays=[]},t.removeArray=function(n){e.arrays=e.arrays.filter(function(a){return n!==a.data.getName()})},t.removeArrayByIndex=function(n){e.arrays=e.arrays.filter(function(a,i){return i!==n})},t.getArrays=function(){return e.arrays.map(function(n){return n.data})},t.getArray=function(n){return typeof n=="number"?t.getArrayByIndex(n):t.getArrayByName(n)},t.getArrayByName=function(n){return e.arrays.reduce(function(a,i,s){return i.data.getName()===n?i.data:a},null)},t.getArrayWithIndex=function(n){return e.arrays.reduce(function(a,i,s){return i.data&&i.data.getName()===n?{array:i.data,index:s}:a},{array:null,index:-1})},t.getArrayByIndex=function(n){return n>=0&&n<e.arrays.length?e.arrays[n].data:null},t.hasArray=function(n){return t.getArrayWithIndex(n).index>=0},t.getArrayName=function(n){var a=e.arrays[n];return a?a.data.getName():""},t.getCopyFieldFlags=function(){return e.copyFieldFlags},t.getFlag=function(n){return e.copyFieldFlags[n]},t.passData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;n.getArrays().forEach(function(s){var f=t.getFlag(s.getName());if(f!==!1&&!(e.doCopyAllOff&&f!==!0)&&s){var o=t.getArrayByName(s.getName());if(o)if(s.getNumberOfComponents()===o.getNumberOfComponents())if(a>-1&&a<s.getNumberOfTuples()){var l=i>-1?i:a;o.insertTuple(l,s.getTuple(a))}else o.insertTuples(0,s.getTuples());else zu("Unhandled case in passData");else if(a<0||a>s.getNumberOfTuples())t.addArray(s),n.getAttributes(s).forEach(function(h){t.setAttribute(s,h)});else{var u=s.getNumberOfComponents(),g=s.getNumberOfValues(),c=i>-1?i:a;g<=c*u&&(g=(c+1)*u),o=_e.newInstance({name:s.getName(),dataType:s.getDataType(),numberOfComponents:u,values:L.newTypedArray(s.getDataType(),g),size:0}),o.insertTuple(c,s.getTuple(a)),t.addArray(o),n.getAttributes(s).forEach(function(h){t.setAttribute(o,h)})}}})},t.interpolateData=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;n.getArrays().forEach(function(o){var u=t.getFlag(o.getName());if(u!==!1&&!(e.doCopyAllOff&&u!==!0)&&o){var g=t.getArrayByName(o.getName());if(g)if(o.getNumberOfComponents()===g.getNumberOfComponents())if(a>-1&&a<o.getNumberOfTuples()){var y=s>-1?s:a;g.interpolateTuple(y,o,a,o,i,f),HC("Unexpected case in interpolateData")}else g.insertTuples(o.getTuples());else zu("Unhandled case in interpolateData");else if(a<0||i<0||a>o.getNumberOfTuples())t.addArray(o),n.getAttributes(o).forEach(function(C){t.setAttribute(o,C)});else{var c=o.getNumberOfComponents(),l=o.getNumberOfValues(),h=s>-1?s:a;l<=h*c&&(l=(h+1)*c),g=_e.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:c,values:L.newTypedArray(o.getDataType(),l),size:0}),g.interpolateTuple(h,o,a,o,i,f),t.addArray(g),n.getAttributes(o).forEach(function(C){t.setAttribute(g,C)})}}})},t.copyFieldOn=function(n){e.copyFieldFlags[n]=!0},t.copyFieldOff=function(n){e.copyFieldFlags[n]=!1},t.copyAllOn=function(){(!e.doCopyAllOn||e.doCopyAllOff)&&(e.doCopyAllOn=!0,e.doCopyAllOff=!1,t.modified())},t.copyAllOff=function(){(e.doCopyAllOn||!e.doCopyAllOff)&&(e.doCopyAllOn=!1,e.doCopyAllOff=!0,t.modified())},t.clearFieldFlags=function(){e.copyFieldFlags={}},t.deepCopy=function(n){e.arrays=n.getArrays().map(function(a){var i=a.newClone();return i.deepCopy(a),{data:i}})},t.copyFlags=function(n){return n.getCopyFieldFlags().map(function(a){return a})},t.reset=function(){return e.arrays.forEach(function(n){return n.data.reset()})},t.getMTime=function(){return e.arrays.reduce(function(n,a){return a.data.getMTime()>n?a.data.getMTime():n},e.mtime)},t.getNumberOfComponents=function(){return e.arrays.reduce(function(n,a){return n+a.data.getNumberOfComponents()},0)},t.getNumberOfTuples=function(){return e.arrays.length>0?e.arrays[0].getNumberOfTuples():0},t.getState=function(){var n=r();return n&&(n.arrays=e.arrays.map(function(a){return{data:a.data.getState()}})),n}}var XC={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function pl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,XC,r),L.obj(t,e),KC(t,e)}var YC=L.newInstance(pl,"vtkFieldData"),IC={newInstance:YC,extend:pl},qC={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},ZC={MAX:0,EXACT:1,NOLIMIT:2},QC={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},JC={DUPLICATEPOINT:1,HIDDENPOINT:2},eS={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},tS="vtkGhostType",rS={DEFAULT:0,SINGLE:1,DOUBLE:2},Qo={AttributeCopyOperations:eS,AttributeLimitTypes:ZC,AttributeTypes:qC,CellGhostTypes:QC,DesiredOutputPrecision:rS,PointGhostTypes:JC,ghostArrayName:tS};function ju(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function nS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ju(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ju(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var vr=Qo.AttributeTypes,Br=Qo.AttributeCopyOperations,$a=L.vtkWarningMacro;function aS(t,e){var r=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function n(i){var s=r.find(function(f){return vr[f.toUpperCase()]===i||typeof i!="number"&&f.toLowerCase()===i.toLowerCase()});return typeof s>"u"&&(s=null),s}e.classHierarchy.push("vtkDataSetAttributes"),t.checkNumberOfComponents=function(i){return!0},t.setAttribute=function(i,s){var f=n(s);if(i&&f.toUpperCase()==="PEDIGREEIDS"&&!i.isA("vtkDataArray"))return $a("Cannot set attribute ".concat(f,". The attribute must be a vtkDataArray.")),-1;if(i&&!t.checkNumberOfComponents(i,f))return $a("Cannot set attribute ".concat(f,". Incorrect number of components.")),-1;var o=e["active".concat(f)];if(o>=0&&o<e.arrays.length){if(e.arrays[o]===i)return o;t.removeArrayByIndex(o)}return i?(o=t.addArray(i),e["active".concat(f)]=o):e["active".concat(f)]=-1,t.modified(),e["active".concat(f)]},t.getAttributes=function(i){return r.filter(function(s){return t["get".concat(s)]()===i})},t.setActiveAttributeByName=function(i,s){return t.setActiveAttributeByIndex(t.getArrayWithIndex(i).index,s)},t.setActiveAttributeByIndex=function(i,s){var f=n(s);if(i>=0&&i<e.arrays.length){if(f.toUpperCase()!=="PEDIGREEIDS"){var o=t.getArrayByIndex(i);if(!o.isA("vtkDataArray"))return $a("Cannot set attribute ".concat(f,". Only vtkDataArray subclasses can be set as active attributes.")),-1;if(!t.checkNumberOfComponents(o,f))return $a("Cannot set attribute ".concat(f,". Incorrect number of components.")),-1}return e["active".concat(f)]=i,t.modified(),i}return i===-1&&(e["active".concat(f)]=i,t.modified()),-1},t.getActiveAttribute=function(i){var s=n(i);return t["get".concat(s)]()},t.removeAllArrays=function(){e.arrays=[],r.forEach(function(i){e["active".concat(i)]=-1})},t.removeArray=function(i){e.arrays=e.arrays.filter(function(s,f){return i===s.data.getName()?(r.forEach(function(o){f===e["active".concat(o)]&&(e["active".concat(o)]=-1)}),!1):!0})},t.removeArrayByIndex=function(i){e.arrays=e.arrays.filter(function(s,f){return f!==i}),r.forEach(function(s){i===e["active".concat(s)]&&(e["active".concat(s)]=-1)})},r.forEach(function(i){var s="active".concat(i);t["get".concat(i)]=function(){return t.getArrayByIndex(e[s])},t["set".concat(i)]=function(f){return t.setAttribute(f,i)},t["setActive".concat(i)]=function(f){return t.setActiveAttributeByIndex(t.getArrayWithIndex(f).index,i)},t["copy".concat(i,"Off")]=function(){var f=i.toUpperCase();e.copyAttributeFlags[Br.PASSDATA][vr[f]]=!1},t["copy".concat(i,"On")]=function(){var f=i.toUpperCase();e.copyAttributeFlags[Br.PASSDATA][vr[f]]=!0}}),t.initializeAttributeCopyFlags=function(){e.copyAttributeFlags=[],Object.keys(Br).filter(function(i){return i!=="ALLCOPY"}).forEach(function(i){e.copyAttributeFlags[Br[i]]=Object.keys(vr).filter(function(s){return s!=="NUM_ATTRIBUTES"}).reduce(function(s,f){return s[vr[f]]=!0,s},[])}),e.copyAttributeFlags[Br.COPYTUPLE][vr.GLOBALIDS]=!1,e.copyAttributeFlags[Br.INTERPOLATE][vr.GLOBALIDS]=!1,e.copyAttributeFlags[Br.COPYTUPLE][vr.PEDIGREEIDS]=!1},t.initialize=L.chain(t.initialize,t.initializeAttributeCopyFlags),e.dataArrays&&Object.keys(e.dataArrays).length&&Object.keys(e.dataArrays).forEach(function(i){!e.dataArrays[i].ref&&e.dataArrays[i].type==="vtkDataArray"&&t.addArray(_e.newInstance(e.dataArrays[i]))});var a=t.shallowCopy;t.shallowCopy=function(i,s){a(i,s),e.arrays=i.getArrays().map(function(f){var o=f.newClone();return o.shallowCopy(f,s),{data:o}})},t.initializeAttributeCopyFlags()}var iS={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function hl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iS,r),IC.extend(t,e,r),L.setGet(t,e,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),e.arrays||(e.arrays={}),aS(t,e)}var sS=L.newInstance(hl,"vtkDataSetAttributes"),$u=nS({newInstance:sS,extend:hl},Qo),oS={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},fS={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7},uS={FieldDataTypes:oS,FieldAssociations:fS};function Hu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function cS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Hu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var To=["pointData","cellData","fieldData"];function gS(t,e){e.classHierarchy.push("vtkDataSet"),To.forEach(function(n){e[n]?e[n]=zt(e[n]):e[n]=$u.newInstance()});var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),To.forEach(function(i){e[i]=$u.newInstance(),e[i].shallowCopy(n.getReferenceByName(i))})}}var vS={};function yl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vS,r),L.obj(t,e),L.setGet(t,e,To),gS(t,e)}var lS=L.newInstance(yl,"vtkDataSet"),_n=cS({newInstance:lS,extend:yl},uS),Nt={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9},dl={StructuredType:Nt};function Ku(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function pS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ku(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ku(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var tr=dl.StructuredType;function hS(t){for(var e=0,r=0;r<3;++r)t[r*2]<t[r*2+1]&&e++;return t[0]>t[1]||t[2]>t[3]||t[4]>t[5]?tr.EMPTY:e===3?tr.XYZ_GRID:e===2?t[0]===t[1]?tr.YZ_PLANE:t[2]===t[3]?tr.XZ_PLANE:tr.XY_PLANE:e===1?t[0]<t[1]?tr.X_LINE:t[2]<t[3]?tr.Y_LINE:tr.Z_LINE:tr.SINGLE_POINT}var yS=pS({getDataDescriptionFromExtent:hS},dl),lr=L.vtkErrorMacro;function dS(t,e){e.classHierarchy.push("vtkImageData"),t.setExtent=function(){if(e.deleted)return lr("instance deleted - cannot call any method"),!1;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.length===1?n[0]:n;if(i.length!==6)return!1;var s=e.extent.some(function(f,o){return f!==i[o]});return s&&(e.extent=i.slice(),e.dataDescription=yS.getDataDescriptionFromExtent(e.extent),t.modified()),s},t.setDimensions=function(){var r,n,a;if(e.deleted){lr("instance deleted - cannot call any method");return}if(arguments.length===1){var i=arguments.length<=0?void 0:arguments[0];r=i[0],n=i[1],a=i[2]}else if(arguments.length===3)r=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],a=arguments.length<=2?void 0:arguments[2];else{lr("Bad dimension specification");return}t.setExtent(0,r-1,0,n-1,0,a-1)},t.getDimensions=function(){return[e.extent[1]-e.extent[0]+1,e.extent[3]-e.extent[2]+1,e.extent[5]-e.extent[4]+1]},t.getNumberOfCells=function(){for(var r=t.getDimensions(),n=1,a=0;a<3;a++){if(r[a]===0)return 0;r[a]>1&&(n*=r[a]-1)}return n},t.getNumberOfPoints=function(){var r=t.getDimensions();return r[0]*r[1]*r[2]},t.getPoint=function(r){var n=t.getDimensions();if(n[0]===0||n[1]===0||n[2]===0)return lr("Requesting a point from an empty image."),null;var a=new Float64Array(3);switch(e.dataDescription){case Nt.EMPTY:return null;case Nt.SINGLE_POINT:break;case Nt.X_LINE:a[0]=r;break;case Nt.Y_LINE:a[1]=r;break;case Nt.Z_LINE:a[2]=r;break;case Nt.XY_PLANE:a[0]=r%n[0],a[1]=r/n[0];break;case Nt.YZ_PLANE:a[1]=r%n[1],a[2]=r/n[1];break;case Nt.XZ_PLANE:a[0]=r%n[0],a[2]=r/n[0];break;case Nt.XYZ_GRID:a[0]=r%n[0],a[1]=r/n[0]%n[1],a[2]=r/(n[0]*n[1]);break;default:lr("Invalid dataDescription");break}var i=[0,0,0];return t.indexToWorld(a,i),i},t.getBounds=function(){return t.extentToBounds(t.getSpatialExtent())},t.extentToBounds=function(r){for(var n=[[r[0],r[2],r[4]],[r[1],r[2],r[4]],[r[0],r[3],r[4]],[r[1],r[3],r[4]],[r[0],r[2],r[5]],[r[1],r[2],r[5]],[r[0],r[3],r[5]],[r[1],r[3],r[5]]],a=Ee(je.INIT_BOUNDS),i=[],s=0;s<8;++s)t.indexToWorld(n[s],i),je.addPoint.apply(je,[a].concat(i));return a},t.getSpatialExtent=function(){return je.inflate(Ee(e.extent),.5)},t.computeTransforms=function(){xg(e.indexToWorld,e.origin),e.indexToWorld[0]=e.direction[0],e.indexToWorld[1]=e.direction[1],e.indexToWorld[2]=e.direction[2],e.indexToWorld[4]=e.direction[3],e.indexToWorld[5]=e.direction[4],e.indexToWorld[6]=e.direction[5],e.indexToWorld[8]=e.direction[6],e.indexToWorld[9]=e.direction[7],e.indexToWorld[10]=e.direction[8],oa(e.indexToWorld,e.indexToWorld,e.spacing),wt(e.worldToIndex,e.indexToWorld)},t.setDirection=function(){if(e.deleted)return lr("instance deleted - cannot call any method"),!1;for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n;if(i.length===1&&(Array.isArray(i[0])||i[0].constructor===Float32Array||i[0].constructor===Float64Array)&&(i=i[0]),i.length!==9)throw new RangeError("Invalid number of values for array setter");var s=!1;if(e.direction.forEach(function(o,u){if(o!==i[u]){if(s)return;s=!0}}),s){for(var f=0;f<9;++f)e.direction[f]=i[f];t.modified()}return!0},t.indexToWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return me(n,r,e.indexToWorld),n},t.indexToWorldVec3=t.indexToWorld,t.worldToIndex=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return me(n,r,e.worldToIndex),n},t.worldToIndexVec3=t.worldToIndex,t.indexToWorldBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[0,0,0],i=[0,0,0];je.computeCornerPoints(r,a,i);var s=[0,0,0],f=[0,0,0];return me(s,a,e.indexToWorld),me(f,i,e.indexToWorld),_u(s,f,n)},t.worldToIndexBounds=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[0,0,0],i=[0,0,0];je.computeCornerPoints(r,a,i);var s=[0,0,0],f=[0,0,0];return me(s,a,e.worldToIndex),me(f,i,e.worldToIndex),_u(s,f,n)},t.onModified(t.computeTransforms),t.computeTransforms(),t.getCenter=function(){return je.getCenter(t.getBounds())},t.computeHistogram=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=[0,0,0,0,0,0];t.worldToIndexBounds(r,a);var i=[0,0,0],s=[0,0,0];je.computeCornerPoints(a,i,s),Vu(i,i),Vu(s,s);var f=t.getDimensions();bu(i,[0,0,0],[f[0]-1,f[1]-1,f[2]-1],i),bu(s,[0,0,0],[f[0]-1,f[1]-1,f[2]-1],s);for(var o=f[0],u=f[0]*f[1],g=t.getPointData().getScalars().getData(),c=-1/0,l=1/0,h=0,y=0,C=0,T=i[2];T<=s[2];T++)for(var E=i[1];E<=s[1];E++)for(var w=i[0]+E*o+T*u,x=i[0];x<=s[0];x++){if(!n||n([x,E,T],a)){var S=g[w];S>c&&(c=S),S<l&&(l=S),h+=S*S,y+=S,C+=1}++w}var m=C>0?y/C:0,D=C?Math.abs(h/C-m*m):0,b=Math.sqrt(D);return{minimum:l,maximum:c,average:m,variance:D,sigma:b,count:C}},t.computeIncrements=function(r){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,a=[],i=n,s=0;s<3;++s)a[s]=i,i*=r[s*2+1]-r[s*2]+1;return a},t.computeOffsetIndex=function(r){var n=St(r,3),a=n[0],i=n[1],s=n[2],f=t.getExtent(),o=t.getPointData().getScalars().getNumberOfComponents(),u=t.computeIncrements(f,o);return Math.floor((Math.round(a)-f[0])*u[0]+(Math.round(i)-f[2])*u[1]+(Math.round(s)-f[4])*u[2])},t.getOffsetIndexFromWorld=function(r){for(var n=t.getExtent(),a=t.worldToIndex(r),i=0;i<3;++i)if(a[i]<n[i*2]||a[i]>n[i*2+1])return lr("GetScalarPointer: Pixel ".concat(a," is not in memory. Current extent = ").concat(n)),NaN;return t.computeOffsetIndex(a)},t.getScalarValueFromWorld=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=t.getPointData().getScalars().getNumberOfComponents();if(n<0||n>=a)return lr("GetScalarPointer: Scalar Component ".concat(n," is not within bounds. Current Scalar numberOfComponents: ").concat(a)),NaN;var i=t.getOffsetIndexFromWorld(r);return Number.isNaN(i)?i:t.getPointData().getScalars().getComponent(i,n)}}var TS={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:Nt.EMPTY};function Tl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,TS,r),_n.extend(t,e,r),e.direction?Array.isArray(e.direction)&&(e.direction=new Float64Array(e.direction.slice(0,9))):e.direction=Jr(new Float64Array(9)),e.indexToWorld=new Float64Array(16),e.worldToIndex=new Float64Array(16),L.get(t,e,["direction","indexToWorld","worldToIndex"]),L.setGetArray(t,e,["origin","spacing"],3),L.getArray(t,e,["extent"],6),dS(t,e)}var CS=L.newInstance(Tl,"vtkImageData"),SS={newInstance:CS,extend:Tl},ES={MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},Co={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4},Pi={VectorMode:ES,ScalarMappingTarget:Co},xS={DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},wS={DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5},OS={BY_ID:0,BY_NAME:1},Lr={ColorMode:xS,GetArray:OS,ScalarMode:wS};function Xu(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function MS(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xu(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xu(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Yu=Pi.ScalarMappingTarget,Yt=Pi.VectorMode,fn=_e.VtkDataTypes,Iu=Lr.ColorMode,qu=L.vtkErrorMacro;function DS(t){return t}function Zu(t){return Math.floor(t*255+.5)}function mS(t,e){e.classHierarchy.push("vtkScalarsToColors"),t.setVectorModeToMagnitude=function(){return t.setVectorMode(Yt.MAGNITUDE)},t.setVectorModeToComponent=function(){return t.setVectorMode(Yt.COMPONENT)},t.setVectorModeToRGBColors=function(){return t.setVectorMode(Yt.RGBCOLORS)},t.build=function(){},t.isOpaque=function(){return!0},t.setAnnotations=function(r,n){if(!(r&&!n||!r&&n)){if(r&&n&&r.length!==n.length){qu("Values and annotations do not have the same number of tuples so ignoring");return}if(e.annotationArray=[],n&&r)for(var a=n.length,i=0;i<a;i++)e.annotationArray.push({value:r[i],annotation:String(n[i])});t.updateAnnotatedValueMap(),t.modified()}},t.setAnnotation=function(r,n){var a=t.checkForAnnotatedValue(r),i=!1;return a>=0?e.annotationArray[a].annotation!==n&&(e.annotationArray[a].annotation=n,i=!0):(e.annotationArray.push({value:r,annotation:n}),a=e.annotationArray.length-1,i=!0),i&&(t.updateAnnotatedValueMap(),t.modified()),a},t.getNumberOfAnnotatedValues=function(){return e.annotationArray.length},t.getAnnotatedValue=function(r){return r<0||r>=e.annotationArray.length?null:e.annotationArray[r].value},t.getAnnotation=function(r){return e.annotationArray[r]===void 0?null:e.annotationArray[r].annotation},t.getAnnotatedValueIndex=function(r){return e.annotationArray.length?t.checkForAnnotatedValue(r):-1},t.removeAnnotation=function(r){var n=t.checkForAnnotatedValue(r),a=n>=0;return a&&(e.annotationArray.splice(n,1),t.updateAnnotatedValueMap(),t.modified()),a},t.resetAnnotations=function(){e.annotationArray=[],e.annotatedValueMap=[],t.modified()},t.getAnnotationColor=function(r,n){if(e.indexedLookup){var a=t.getAnnotatedValueIndex(r);t.getIndexedColor(a,n)}else t.getColor(parseFloat(r),n),n[3]=1},t.checkForAnnotatedValue=function(r){return t.getAnnotatedValueIndexInternal(r)},t.getAnnotatedValueIndexInternal=function(r){if(e.annotatedValueMap[r]!==void 0){var n=e.annotationArray.length;return e.annotatedValueMap[r]%n}return-1},t.getIndexedColor=function(r,n){n[0]=0,n[1]=0,n[2]=0,n[3]=0},t.updateAnnotatedValueMap=function(){e.annotatedValueMap=[];for(var r=e.annotationArray.length,n=0;n<r;n++)e.annotatedValueMap[e.annotationArray[n].value]=n},t.mapScalars=function(r,n,a){var i=r.getNumberOfComponents(),s=null;if(n===Iu.DEFAULT&&r.getDataType()===fn.UNSIGNED_CHAR||n===Iu.DIRECT_SCALARS&&r)s=t.convertToRGBA(r,i,r.getNumberOfTuples());else{var f={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:fn.UNSIGNED_CHAR},o=L.newTypedArray(f.dataType,4*r.getNumberOfTuples());f.values=o,f.size=o.length,s=_e.newInstance(f);var u=a;u<0&&i>1?t.mapVectorsThroughTable(r,s,Yu.RGBA,-1,-1):(u<0&&(u=0),u>=i&&(u=i-1),t.mapScalarsThroughTable(r,s,Yu.RGBA,u))}return s},t.mapVectorsToMagnitude=function(r,n,a){for(var i=r.getNumberOfTuples(),s=r.getNumberOfComponents(),f=n.getData(),o=r.getData(),u=0;u<i;u++){for(var g=0,c=0;c<a;c++)g+=o[u*s+c]*o[u*s+c];f[u]=Math.sqrt(g)}},t.mapVectorsThroughTable=function(r,n,a,i,s){var f=t.getVectorMode(),o=s,u=i,g=r.getNumberOfComponents();f===Yt.COMPONENT?(u===-1&&(u=t.getVectorComponent()),u<0&&(u=0),u>=g&&(u=g-1)):(o===-1&&(o=t.getVectorSize()),o<=0?(u=0,o=g):(u<0&&(u=0),u>=g&&(u=g-1),u+o>g&&(o=g-u)),f===Yt.MAGNITUDE&&(g===1||o===1)&&(f=Yt.COMPONENT));var c=0;switch(u>0&&(c=u),f){case Yt.COMPONENT:{t.mapScalarsThroughTable(r,n,a,c);break}case Yt.RGBCOLORS:break;case Yt.MAGNITUDE:default:{var l=_e.newInstance({numberOfComponents:1,values:new Float32Array(r.getNumberOfTuples())});t.mapVectorsToMagnitude(r,l,o),t.mapScalarsThroughTable(l,n,a,0);break}}},t.luminanceToRGBA=function(r,n,a,i){for(var s=i(a),f=n.getData(),o=r.getData(),u=f.length,g=0,c=1,l=0,h=g;h<u;h+=c){var y=i(f[h]);o[l*4]=y,o[l*4+1]=y,o[l*4+2]=y,o[l*4+3]=s,l++}},t.luminanceAlphaToRGBA=function(r,n,a,i){for(var s=n.getData(),f=r.getData(),o=s.length,u=0,g=2,c=0,l=u;l<o;l+=g){var h=i(s[l]);f[c]=h,f[c+1]=h,f[c+2]=h,f[c+3]=i(s[l+1])*a,c+=4}},t.rGBToRGBA=function(r,n,a,i){for(var s=Zu(a),f=n.getData(),o=r.getData(),u=f.length,g=0,c=3,l=0,h=g;h<u;h+=c)o[l*4]=i(f[h]),o[l*4+1]=i(f[h+1]),o[l*4+2]=i(f[h+2]),o[l*4+3]=s,l++},t.rGBAToRGBA=function(r,n,a,i){for(var s=n.getData(),f=r.getData(),o=s.length,u=0,g=4,c=0,l=u;l<o;l+=g)f[c*4]=i(s[l]),f[c*4+1]=i(s[l+1]),f[c*4+2]=i(s[l+2]),f[c*4+3]=i(s[l+3])*a,c++},t.convertToRGBA=function(r,n,a){var i=e.alpha;if(n===4&&i>=1&&r.getDataType()===fn.UNSIGNED_CHAR)return r;var s=_e.newInstance({numberOfComponents:4,empty:!0,size:4*a,dataType:fn.UNSIGNED_CHAR});if(a<=0)return s;i=i>0?i:0,i=i<1?i:1;var f=DS;switch((r.getDataType()===fn.FLOAT||r.getDataType()===fn.DOUBLE)&&(f=Zu),n){case 1:t.luminanceToRGBA(s,r,i,f);break;case 2:t.luminanceAlphaToRGBA(s,r,f);break;case 3:t.rGBToRGBA(s,r,i,f);break;case 4:t.rGBAToRGBA(s,r,i,f);break;default:return qu("Cannot convert colors"),null}return s},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return 256*256*256},t.setRange=function(r,n){return t.setMappingRange(r,n)},t.getRange=function(r,n){return t.getMappingRange()}}var RS={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:Yt.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function Cl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,RS,r),L.obj(t,e),e.mappingRange=[0,255],e.annotationArray=[],e.annotatedValueMap=[],L.setGet(t,e,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),L.setArray(t,e,["mappingRange"],2),L.getArray(t,e,["mappingRange"]),mS(t,e)}var LS=L.newInstance(Cl,"vtkScalarsToColors"),Sl=MS({newInstance:LS,extend:Cl},Pi),Qu=L.vtkErrorMacro,Ju=0,ec=1,Ds=2;function VS(t,e){e.classHierarchy.push("vtkLookupTable"),t.isOpaque=function(){if(e.opaqueFlagBuildTime.getMTime()<t.getMTime()){var r=!0;e.nanColor[3]<1&&(r=0),e.useBelowRangeColor&&e.belowRangeColor[3]<1&&(r=0),e.useAboveRangeColor&&e.aboveRangeColor[3]<1&&(r=0);for(var n=3;n<e.table.length&&r;n+=4)e.table[n]<255&&(r=!1);e.opaqueFlag=r,e.opaqueFlagBuildTime.modified()}return e.opaqueFlag},t.usingLogScale=function(){return!1},t.getNumberOfAvailableColors=function(){return e.table.length},t.linearIndexLookup=function(r,n){var a=0;return r<n.range[0]?a=n.maxIndex+Ju+1.5:r>n.range[1]?a=n.maxIndex+ec+1.5:(a=(r+n.shift)*n.scale,a=a<n.maxIndex?a:n.maxIndex),Math.floor(a)},t.linearLookup=function(r,n,a){var i=0;Mv(r)?i=Math.floor(a.maxIndex+1.5+Ds):i=t.linearIndexLookup(r,a);var s=4*i;return[n[s],n[s+1],n[s+2],n[s+3]]},t.indexedLookupFunction=function(r,n,a){var i=t.getAnnotatedValueIndexInternal(r);i===-1&&(i=e.numberOfColors+Ds);var s=4*i;return[n[s],n[s+1],n[s+2],n[s+3]]},t.lookupShiftAndScale=function(r,n){n.shift=-r[0],n.scale=Number.MAX_VALUE,r[1]>r[0]&&(n.scale=(n.maxIndex+1)/(r[1]-r[0]))},t.mapScalarsThroughTable=function(r,n,a,i){var s=t.linearLookup;e.indexedLookup&&(s=t.indexedLookupFunction);var f=t.getMappingRange(),o={maxIndex:t.getNumberOfColors()-1,range:f,shift:0,scale:0};t.lookupShiftAndScale(f,o);var u=t.getAlpha(),g=r.getNumberOfTuples(),c=r.getNumberOfComponents(),l=n.getData(),h=r.getData();if(u>=1){if(a===Co.RGBA)for(var y=0;y<g;y++){var C=s(h[y*c+i],e.table,o);l[y*4]=C[0],l[y*4+1]=C[1],l[y*4+2]=C[2],l[y*4+3]=C[3]}}else if(a===Co.RGBA)for(var T=0;T<g;T++){var E=s(h[T*c+i],e.table,o);l[T*4]=E[0],l[T*4+1]=E[1],l[T*4+2]=E[2],l[T*4+3]=Math.floor(E[3]*u+.5)}},t.forceBuild=function(){var r=0,n=0,a=0,i=0,s=e.numberOfColors-1;s&&(r=(e.hueRange[1]-e.hueRange[0])/s,n=(e.saturationRange[1]-e.saturationRange[0])/s,a=(e.valueRange[1]-e.valueRange[0])/s,i=(e.alphaRange[1]-e.alphaRange[0])/s);for(var f=[],o=[],u=0;u<=s;u++)f[0]=e.hueRange[0]+u*r,f[1]=e.saturationRange[0]+u*n,f[2]=e.valueRange[0]+u*a,Z2(f,o),o[3]=e.alphaRange[0]+u*i,e.table[u*4]=o[0]*255+.5,e.table[u*4+1]=o[1]*255+.5,e.table[u*4+2]=o[2]*255+.5,e.table[u*4+3]=o[3]*255+.5;t.buildSpecialColors(),e.buildTime.modified()},t.setTable=function(r){if(r.getNumberOfComponents()!==4){Qu("Expected 4 components for RGBA colors");return}if(r.getDataType()!==mr.UNSIGNED_CHAR){Qu("Expected unsigned char values for RGBA colors");return}e.numberOfColors=r.getNumberOfTuples();for(var n=r.getData(),a=0;a<n.length;a++)e.table[a]=n[a];t.buildSpecialColors(),e.insertTime.modified(),t.modified()},t.buildSpecialColors=function(){var r=e.numberOfColors,n=e.table,a=(r+Ju)*4;e.useBelowRangeColor||r===0?(n[a]=e.belowRangeColor[0]*255+.5,n[a+1]=e.belowRangeColor[1]*255+.5,n[a+2]=e.belowRangeColor[2]*255+.5,n[a+3]=e.belowRangeColor[3]*255+.5):(n[a]=n[0],n[a+1]=n[1],n[a+2]=n[2],n[a+3]=n[3]),a=(r+ec)*4,e.useAboveRangeColor||r===0?(n[a]=e.aboveRangeColor[0]*255+.5,n[a+1]=e.aboveRangeColor[1]*255+.5,n[a+2]=e.aboveRangeColor[2]*255+.5,n[a+3]=e.aboveRangeColor[3]*255+.5):(n[a]=n[4*(r-1)+0],n[a+1]=n[4*(r-1)+1],n[a+2]=n[4*(r-1)+2],n[a+3]=n[4*(r-1)+3]),a=(r+Ds)*4,n[a]=e.nanColor[0]*255+.5,n[a+1]=e.nanColor[1]*255+.5,n[a+2]=e.nanColor[2]*255+.5,n[a+3]=e.nanColor[3]*255+.5},t.build=function(){(e.table.length<1||t.getMTime()>e.buildTime.getMTime()&&e.insertTime.getMTime()<=e.buildTime.getMTime())&&t.forceBuild()},e.table.length>0&&e.insertTime.modified()}var _S={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function El(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_S,r),Sl.extend(t,e,r),e.table||(e.table=[]),e.buildTime={},L.obj(e.buildTime),e.opaqueFlagBuildTime={},L.obj(e.opaqueFlagBuildTime,{mtime:0}),e.insertTime={},L.obj(e.insertTime,{mtime:0}),L.get(t,e,["buildTime"]),L.setGet(t,e,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),L.setArray(t,e,["alphaRange","hueRange","saturationRange","valueRange"],2),L.setArray(t,e,["nanColor","belowRangeColor","aboveRangeColor"],4),L.getArray(t,e,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),VS(t,e)}var bS=L.newInstance(El,"vtkLookupTable"),In={newInstance:bS,extend:El},xl=1,Jo=0,kS=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function FS(){return xl}function BS(t){xl=t}function NS(){return Jo}function Wi(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;Jo=t}function US(){Wi(0)}function GS(){Wi(0)}function AS(){Wi(1)}function PS(){return kS[Jo]}var So={getResolveCoincidentTopologyAsString:PS,getResolveCoincidentTopologyPolygonOffsetFaces:FS,getResolveCoincidentTopology:NS,setResolveCoincidentTopology:Wi,setResolveCoincidentTopologyPolygonOffsetFaces:BS,setResolveCoincidentTopologyToDefault:US,setResolveCoincidentTopologyToOff:GS,setResolveCoincidentTopologyToPolygonOffset:AS};function wl(t,e,r){r.forEach(function(n){t["get".concat(n.method)]=function(){return e[n.key]},t["set".concat(n.method)]=function(a,i){e[n.key]={factor:a,offset:i}}})}var ef=["Polygon","Line","Point"],WS={Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},Hr={};wl(Hr,WS,ef.map(function(t){return{key:t,method:"ResolveCoincidentTopology".concat(t,"OffsetParameters")}}));function zS(t,e){e.resolveCoincidentTopology===void 0&&(e.resolveCoincidentTopology=!1),L.setGet(t,e,["resolveCoincidentTopology"]),e.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(So).forEach(function(r){t[r]=So[r]}),Object.keys(Hr).forEach(function(r){t[r]=Hr[r]}),wl(t,e.topologyOffset,ef.map(function(r){return{key:r,method:"RelativeCoincidentTopology".concat(r,"OffsetParameters")}})),t.getCoincidentTopologyPolygonOffsetParameters=function(){var r=Hr.getResolveCoincidentTopologyPolygonOffsetParameters(),n=t.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyLineOffsetParameters=function(){var r=Hr.getResolveCoincidentTopologyLineOffsetParameters(),n=t.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}},t.getCoincidentTopologyPointOffsetParameter=function(){var r=Hr.getResolveCoincidentTopologyPointOffsetParameters(),n=t.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:r.factor+n.factor,offset:r.offset+n.offset}}}var tf={implementCoincidentTopologyMethods:zS,staticOffsetAPI:Hr,otherStaticMethods:So,CATEGORIES:ef},ht={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3},Ol={PassTypes:ht};function tc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ms(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var rc=_n.FieldAssociations,jS=tf.staticOffsetAPI,$S=tf.otherStaticMethods,Rs=Lr.ColorMode,Nr=Lr.ScalarMode,Ls=Lr.GetArray,HS=Pi.VectorMode,KS=_e.VtkDataTypes;function zn(t){return function(){return L.vtkErrorMacro("vtkMapper::".concat(t," - NOT IMPLEMENTED"))}}function XS(t,e){e.classHierarchy.push("vtkMapper"),t.getBounds=function(){var r=t.getInputData();return r?(e.static||t.update(),e.bounds=r.getBounds()):e.bounds=Dv(),e.bounds},t.setForceCompileOnly=function(r){e.forceCompileOnly=r},t.createDefaultLookupTable=function(){e.lookupTable=In.newInstance()},t.getColorModeAsString=function(){return L.enumToString(Rs,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return L.enumToString(Nr,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var f=null,o=!1;if(n===Nr.DEFAULT)f=r.getPointData().getScalars(),f||(f=r.getCellData().getScalars(),o=!0);else if(n===Nr.USE_POINT_DATA)f=r.getPointData().getScalars();else if(n===Nr.USE_CELL_DATA)f=r.getCellData().getScalars(),o=!0;else if(n===Nr.USE_POINT_FIELD_DATA){var u=r.getPointData();a===Ls.BY_ID?f=u.getArrayByIndex(i):f=u.getArrayByName(s)}else if(n===Nr.USE_CELL_FIELD_DATA){var g=r.getCellData();o=!0,a===Ls.BY_ID?f=g.getArrayByIndex(i):f=g.getArrayByName(s)}else if(n===Nr.USE_FIELD_DATA){var c=r.getFieldData();a===Ls.BY_ID?f=c.getArrayByIndex(i):f=c.getArrayByName(s)}return{scalars:f,cellFlag:o}},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorCoordinates=null,e.colorTextureMap=null,e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){if(e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]),t.canUseTextureMapForColoring(r))t.mapScalarsToTexture(a,n);else{e.colorCoordinates=null,e.colorTextureMap=null;var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId))}e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}},t.scalarToTextureCoordinate=function(r,n,a){var i=.5,s=1;return Mv(r)||(s=.49,i=(r-n)*a,i>1e3?i=1e3:i<-1e3&&(i=-1e3)),{texCoordS:i,texCoordT:s}},t.createColorTextureCoordinates=function(r,n,a,i,s,f,o,u,g){var c=(f[1]-f[0])/u,l=[];l[0]=f[0]-c,l[1]=f[1]+c;var h=1/(l[1]-l[0]),y=n.getData(),C=r.getData(),T=0,E=0;if(s<0||s>=i)for(var w=0;w<a;++w){for(var x=0,S=0;S<i;++S)x+=C[T]*C[T],T++;var m=Math.sqrt(x);g&&(m=In.applyLogScale(m,o,f));var D=t.scalarToTextureCoordinate(m,l[0],h);y[E]=D.texCoordS,y[E+1]=D.texCoordT,E+=2}else{T+=s;for(var b=0;b<a;++b){var N=C[T];g&&(N=In.applyLogScale(N,o,f));var P=t.scalarToTextureCoordinate(N,l[0],h);y[E]=P.texCoordS,y[E+1]=P.texCoordT,E+=2,T+=i}}},t.mapScalarsToTexture=function(r,n){var a=e.lookupTable.getRange(),i=e.lookupTable.usingLogScale();i&&In.getLogRange(a,a);var s=e.lookupTable.getAlpha();if(e.colorMapColors=null,e.colorTextureMap==null||t.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getMTime()>e.colorTextureMap.getMTime()||e.lookupTable.getAlpha()!==n){e.lookupTable.setAlpha(n),e.colorTextureMap=null,e.lookupTable.build();var f=e.lookupTable.getNumberOfAvailableColors();f>4094&&(f=4094),f+=2;for(var o=(a[1]-a[0])/(f-1-2),u=new Float64Array(f*2),g=0;g<f;++g)u[g]=a[0]+g*o-o,i&&(u[g]=Math.pow(10,u[g]));for(var c=0;c<f;++c)u[c+f]=NaN;e.colorTextureMap=SS.newInstance(),e.colorTextureMap.setExtent(0,f-1,0,1,0,0);var l=_e.newInstance({numberOfComponents:1,values:u});e.colorTextureMap.getPointData().setScalars(e.lookupTable.mapScalars(l,e.colorMode,0)),e.lookupTable.setAlpha(s)}if(!e.colorCoordinates||t.getMTime()>e.colorCoordinates.getMTime()||t.getInputData(0).getMTime()>e.colorCoordinates.getMTime()||e.lookupTable.getMTime()>e.colorCoordinates.getMTime()){e.colorCoordinates=null;var h=r.getNumberOfComponents(),y=r.getNumberOfTuples();e.colorCoordinates=_e.newInstance({numberOfComponents:2,values:new Float32Array(y*2)});var C=e.lookupTable.getVectorComponent();e.lookupTable.getVectorMode()===HS.MAGNITUDE&&r.getNumberOfComponents()>1&&(C=-1),t.createColorTextureCoordinates(r,e.colorCoordinates,y,h,C,a,e.lookupTable.getRange(),e.colorTextureMap.getPointData().getScalars().getNumberOfTuples()/2-2,i)}},t.getIsOpaque=function(){var r=t.getLookupTable();return r?(r.build(),r.isOpaque()):!0},t.canUseTextureMapForColoring=function(r){if(!e.interpolateScalarsBeforeMapping||e.lookupTable&&e.lookupTable.getIndexedLookup())return!1;var n=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName),a=n.scalars;return!(!a||n.cellFlag||e.colorMode===Rs.DEFAULT&&a.getDataType()===KS.UNSIGNED_CHAR||e.colorMode===Rs.DIRECT_SCALARS)},t.clearColorArrays=function(){e.colorMapColors=null,e.colorCoordinates=null,e.colorTextureMap=null},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.getPrimitiveCount=function(){var r=t.getInputData(),n={points:r.getPoints().getNumberOfValues()/3,verts:r.getVerts().getNumberOfValues()-r.getVerts().getNumberOfCells(),lines:r.getLines().getNumberOfValues()-2*r.getLines().getNumberOfCells(),triangles:r.getPolys().getNumberOfValues()-3*r.getPolys().getNumberOfCells()};return n},t.acquireInvertibleLookupTable=zn("AcquireInvertibleLookupTable"),t.valueToColor=zn("ValueToColor"),t.colorToValue=zn("ColorToValue"),t.useInvertibleColorFor=zn("UseInvertibleColorFor"),t.clearInvertibleColor=zn("ClearInvertibleColor"),t.processSelectorPixelBuffers=function(r,n){if(!(!r||!e.selectionWebGLIdsToVTKIds||!e.populateSelectionSettings)){var a=r.getRawPixelBuffer(ht.ID_LOW24),i=r.getRawPixelBuffer(ht.ID_HIGH24),s=r.getCurrentPass(),f=r.getFieldAssociation(),o=null;f===rc.FIELD_ASSOCIATION_POINTS?o=e.selectionWebGLIdsToVTKIds.points:f===rc.FIELD_ASSOCIATION_CELLS&&(o=e.selectionWebGLIdsToVTKIds.cells),o&&n.forEach(function(u){if(s===ht.ID_LOW24){var g=0;i&&(g+=i[u],g*=256),g+=a[u+2],g*=256,g+=a[u+1],g*=256,g+=a[u];var c=o[g],l=r.getPixelBuffer(ht.ID_LOW24);l[u]=c&255,l[u+1]=(c&65280)>>8,l[u+2]=(c&16711680)>>16}else if(s===ht.ID_HIGH24&&i){var h=0;h+=i[u],h*=256,h+=a[u],h*=256,h+=a[u+1],h*=256,h+=a[u+2];var y=o[h],C=r.getPixelBuffer(ht.ID_HIGH24);C[u]=(y&4278190080)>>24}})}}}var YS={colorMapColors:null,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,viewSpecificProperties:null,customShaderAttributes:[]};function Ml(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,YS,r),$C.extend(t,e,r),L.get(t,e,["colorCoordinates","colorMapColors","colorTextureMap"]),L.setGet(t,e,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","selectionWebGLIdsToVTKIds","static","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),L.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),tf.implementCoincidentTopologyMethods(t,e),XS(t,e)}var IS=L.newInstance(Ml,"vtkMapper"),Rr=ms(ms(ms({newInstance:IS,extend:Ml},jS),$S),Lr);function nc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Dl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ml(t){var e=0;return t.filter(function(r,n){return n===e?(e+=r+1,!0):!1})}function Rl(t){for(var e=0,r=0;r<t.length;)r+=t[r]+1,e++;return e}var qS={extractCellSizes:ml,getNumberOfCells:Rl};function ZS(t,e){e.classHierarchy.push("vtkCellArray"),t.getNumberOfCells=function(a){return e.numberOfCells!==void 0&&!a||(e.cellSizes?e.numberOfCells=e.cellSizes.length:e.numberOfCells=Rl(t.getData())),e.numberOfCells},t.getCellSizes=function(a){return e.cellSizes!==void 0&&!a||(e.cellSizes=ml(t.getData())),e.cellSizes};var r=t.setData;t.setData=function(a){r(a,1),e.numberOfCells=void 0,e.cellSizes=void 0},t.getCell=function(a){var i=a,s=e.values[i++];return e.values.subarray(i,i+s)};var n=t.initialize;t.initialize=function(){n(),e.numberOfCells=void 0,e.cellSizes=void 0},t.insertNextCell=function(a){var i=t.getNumberOfCells();return t.insertNextTuples([a.length].concat(Ee(a))),++e.numberOfCells,e.cellSizes!=null&&e.cellSizes.push(a.length),i}}function QS(t){return Dl({empty:!0,numberOfComponents:1,dataType:mr.UNSIGNED_INT},t)}function Ll(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_e.extend(t,e,QS(r)),ZS(t,e)}var JS=L.newInstance(Ll,"vtkCellArray"),ac=Dl({newInstance:JS,extend:Ll},qS),eE=L.vtkErrorMacro,tE=[1,-1,1,-1,1,-1];function rE(t,e){e.classHierarchy.push("vtkPoints"),t.getNumberOfPoints=t.getNumberOfTuples,t.setNumberOfPoints=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;t.getNumberOfPoints()!==r&&(e.size=r*n,e.values=L.newTypedArray(e.dataType,e.size),t.setNumberOfComponents(n),t.modified())},t.setPoint=function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];t.setTuple(r,a)},t.getPoint=t.getTuple,t.insertNextPoint=function(r,n,a){return t.insertNextTuple([r,n,a])},t.getBounds=function(){if(t.getNumberOfComponents()===3){var r=t.getRange(0);e.bounds[0]=r[0],e.bounds[1]=r[1];var n=t.getRange(1);e.bounds[2]=n[0],e.bounds[3]=n[1];var a=t.getRange(2);return e.bounds[4]=a[0],e.bounds[5]=a[1],e.bounds}if(t.getNumberOfComponents()!==2)return eE(`getBounds called on an array with components of
        `.concat(t.getNumberOfComponents())),tE;var i=t.getRange(0);e.bounds[0]=i[0],e.bounds[1]=i[1];var s=t.getRange(1);return e.bounds[2]=s[0],e.bounds[3]=s[1],e.bounds[4]=0,e.bounds[5]=0,e.bounds},t.computeBounds=t.getBounds,t.setNumberOfComponents(e.numberOfComponents<2?3:e.numberOfComponents)}var nE={empty:!0,numberOfComponents:3,dataType:mr.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Vl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nE,r),_e.extend(t,e,r),rE(t,e)}var aE=L.newInstance(Vl,"vtkPoints"),Vi={newInstance:aE,extend:Vl};function iE(t,e){e.classHierarchy.push("vtkCell"),t.initialize=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(n){e.pointsIds=n;var i=e.points.getData();i.length!==3*e.pointsIds.length&&(i=L.newTypedArray(r.getDataType(),3*e.pointsIds.length));var s=r.getData();e.pointsIds.forEach(function(f,o){var u=3*f,g=3*o;i[g]=s[u],i[++g]=s[++u],i[++g]=s[++u]}),e.points.setData(i)}else{e.points=r,e.pointsIds=new Array(r.getNumberOfPoints());for(var a=r.getNumberOfPoints()-1;a>=0;--a)e.pointsIds[a]=a}},t.getBounds=function(){var r=e.points.getNumberOfPoints(),n=[];if(r){e.points.getPoint(0,n),e.bounds[0]=n[0],e.bounds[1]=n[0],e.bounds[2]=n[1],e.bounds[3]=n[1],e.bounds[4]=n[2],e.bounds[5]=n[2];for(var a=1;a<r;a++)e.points.getPoint(a,n),e.bounds[0]=n[0]<e.bounds[0]?n[0]:e.bounds[0],e.bounds[1]=n[0]>e.bounds[1]?n[0]:e.bounds[1],e.bounds[2]=n[1]<e.bounds[2]?n[1]:e.bounds[2],e.bounds[3]=n[1]>e.bounds[3]?n[1]:e.bounds[3],e.bounds[4]=n[2]<e.bounds[4]?n[2]:e.bounds[4],e.bounds[5]=n[2]>e.bounds[5]?n[2]:e.bounds[5]}else Ui(e.bounds);return e.bounds},t.getLength2=function(){t.getBounds();for(var r=0,n=0,a=0;a<3;a++)n=e.bounds[2*a+1]-e.bounds[2*a],r+=n*n;return r},t.getParametricDistance=function(r){for(var n,a=0,i=0;i<3;i++)r[i]<0?n=-r[i]:r[i]>1?n=r[i]-1:n=0,n>a&&(a=n);return a},t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.deepCopy=function(r){r.initialize(e.points,e.pointsIds)},t.getCellDimension=function(){},t.intersectWithLine=function(r,n,a,i,s,f,o){},t.evaluatePosition=function(r,n,a,i,s,f){L.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}var sE={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function _l(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,sE,r),L.obj(t,e),e.points||(e.points=Vi.newInstance()),L.get(t,e,["points","pointsIds"]),iE(t,e)}var oE=L.newInstance(_l,"vtkCell"),_i={newInstance:oE,extend:_l};function fE(t,e){var r=e;for(e>=t.array.length&&(r+=t.array.length);r>t.array.length;)t.array.push({ncells:0,cells:null});t.array.length=r}function uE(t,e){e.classHierarchy.push("vtkCellLinks"),t.buildLinks=function(r){var n=r.getPoints().getNumberOfPoints(),a=r.getNumberOfCells(),i=new Uint32Array(n);if(r.isA("vtkPolyData")){for(var s=0;s<a;++s){var f=r.getCellPoints(s),o=f.cellPointIds;o.forEach(function(C){t.incrementLinkCount(C)})}t.allocateLinks(n),e.maxId=n-1;for(var u=function(T){var E=r.getCellPoints(T),w=E.cellPointIds;w.forEach(function(x){t.insertCellReference(x,i[x]++,T)})},g=0;g<a;++g)u(g)}else{for(var c=0;c<a;c++){var l=_i.newInstance();l.getPointsIds().forEach(function(C){t.incrementLinkCount(C)})}t.allocateLinks(n),e.maxId=n-1;for(var h=function(T){var E=_i.newInstance();E.getPointsIds().forEach(function(w){t.insertCellReference(w,i[w]++,T)})},y=0;y<a;++y)h(y)}},t.allocate=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.array=Array(r).fill().map(function(){return{ncells:0,cells:null}}),e.extend=n,e.maxId=-1},t.initialize=function(){e.array=null},t.getLink=function(r){return e.array[r]},t.getNcells=function(r){return e.array[r].ncells},t.getCells=function(r){return e.array[r].cells},t.insertNextPoint=function(r){e.array.push({ncells:r,cells:Array(r)}),++e.maxId},t.insertNextCellReference=function(r,n){e.array[r].cells[e.array[r].ncells++]=n},t.deletePoint=function(r){e.array[r].ncells=0,e.array[r].cells=null},t.removeCellReference=function(r,n){e.array[n].cells=e.array[n].cells.filter(function(a){return a!==r}),e.array[n].ncells=e.array[n].cells.length},t.addCellReference=function(r,n){e.array[n].cells[e.array[n].ncells++]=r},t.resizeCellList=function(r,n){e.array[r].cells.length=n},t.squeeze=function(){fE(e,e.maxId+1)},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){e.array=Ee(r.array),e.extend=r.extend,e.maxId=r.maxId},t.incrementLinkCount=function(r){++e.array[r].ncells},t.allocateLinks=function(r){for(var n=0;n<r;++n)e.array[n].cells=new Array(e.array[n].ncells)},t.insertCellReference=function(r,n,a){e.array[r].cells[n]=a}}var cE={array:null,maxId:0,extend:0};function bl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cE,r),L.obj(t,e),uE(t,e)}var gE=L.newInstance(bl,"vtkCellLinks"),vE={newInstance:gE,extend:bl},Pe={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},Eo=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function ic(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function lE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ic(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ic(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pE(t){return t<Eo.length?Eo[t]:"UnknownClass"}function hE(t){return Eo.findIndex(t)}function yE(t){return t<Pe.VTK_QUADRATIC_EDGE||t===Pe.VTK_CONVEX_POINT_SET||t===Pe.VTK_POLYHEDRON}function dE(t){return t===Pe.VTK_TRIANGLE_STRIP||t===Pe.VTK_POLY_LINE||t===Pe.VTK_POLY_VERTEX}var TE={getClassNameFromTypeId:pE,getTypeIdFromClassName:hE,isLinear:yE,hasSubCells:dE};function CE(t,e){e.classHierarchy.push("vtkCellTypes"),t.allocate=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;e.size=r>0?r:1,e.extend=n>0?n:1,e.maxId=-1,e.typeArray=new Uint8Array(r),e.locationArray=new Uint32Array(r)},t.insertCell=function(r,n,a){e.typeArray[r]=n,e.locationArray[r]=a,r>e.maxId&&(e.maxId=r)},t.insertNextCell=function(r,n){return t.insertCell(++e.maxId,r,n),e.maxId},t.setCellTypes=function(r,n,a){e.size=r,e.typeArray=n,e.locationArray=a,e.maxId=r-1},t.getCellLocation=function(r){return e.locationArray[r]},t.deleteCell=function(r){e.typeArray[r]=Pe.VTK_EMPTY_CELL},t.getNumberOfTypes=function(){return e.maxId+1},t.isType=function(r){for(var n=t.getNumberOfTypes(),a=0;a<n;++a)if(r===t.getCellType(a))return!0;return!1},t.insertNextType=function(r){return t.insertNextCell(r,-1)},t.getCellType=function(r){return e.typeArray[r]},t.reset=function(){e.maxId=-1},t.deepCopy=function(r){t.allocate(r.getSize(),r.getExtend()),e.typeArray.set(r.getTypeArray()),e.locationArray.set(r.getLocationArray()),e.maxId=r.getMaxId()}}var SE={size:0,maxId:-1,extend:1e3};function kl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,SE,r),L.obj(t,e),L.get(t,e,["size","maxId","extend"]),L.getArray(t,e,["typeArray","locationArray"]),CE(t,e)}var EE=L.newInstance(kl,"vtkCellTypes"),xE=lE({newInstance:EE,extend:kl},TE),wE={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2},Fl={IntersectionState:wE};function sc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function oc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var pi=Fl.IntersectionState;function Cn(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a={t:Number.MIN_VALUE,distance:0},i=[],s;i[0]=r[0]-e[0],i[1]=r[1]-e[1],i[2]=r[2]-e[2];var f=i[0]*(t[0]-e[0])+i[1]*(t[1]-e[1])+i[2]*(t[2]-e[2]),o=xe(i,i),u=1e-5*f;return o!==0&&(a.t=f/o),u<0&&(u=-u),-u<o&&o<u||o<=0||a.t<0?s=e:a.t>1?s=r:(s=i,i[0]=e[0]+a.t*i[0],i[1]=e[1]+a.t*i[1],i[2]=e[2]+a.t*i[2]),n&&(n[0]=s[0],n[1]=s[1],n[2]=s[2]),a.distance=Gt(s,t),a}function Bl(t,e,r,n,a,i){var s=[],f=[],o=[];a[0]=0,i[0]=0,wr(e,t,s),wr(n,r,f),wr(r,t,o);var u=[xe(s,s),-xe(s,f),-xe(s,f),xe(f,f)],g=[];if(g[0]=xe(s,o),g[1]=-xe(f,o),q2(u,g,2)===0){for(var c=Number.MAX_VALUE,l=[t,e,r,n],h=[r,r,t,t],y=[n,n,e,e],C=[i[0],i[0],a[0],a[0]],T=[a[0],a[0],i[0],i[0]],E,w=0;w<4;w++)E=Cn(l[w],h[w],y[w]),E.distance<c&&(c=E.distance,C[w]=E.t,T[w]=w%2);return pi.ON_LINE}return a[0]=g[0],i[0]=g[1],a[0]>=0&&a[0]<=1&&i[0]>=0&&i[0]<=1?pi.YES_INTERSECTION:pi.NO_INTERSECTION}var OE={distanceToLine:Cn,intersection:Bl};function ME(t,e){e.classHierarchy.push("vtkLine");function r(n){return n>=0&&n<=1}t.getCellDimension=function(){return 1},t.intersectWithLine=function(n,a,i,s,f){var o={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};f[1]=0,f[2]=0;var u=[],g=[],c=[];e.points.getPoint(0,g),e.points.getPoint(1,c);var l=[],h=[],y=Bl(n,a,g,c,l,h);if(o.t=l[0],o.betweenPoints=r(o.t),f[0]=h[0],y===pi.YES_INTERSECTION){for(var C=0;C<3;C++)s[C]=g[C]+f[0]*(c[C]-g[C]),u[C]=n[C]+o.t*(a[C]-n[C]);if(Gt(s,u)<=i*i)return o.intersect=1,o}else{var T;if(o.t<0)return T=Cn(n,g,c,s),T.distance<=i*i&&(o.t=0,o.intersect=1,o.betweenPoints=!0),o;if(o.t>1)return T=Cn(a,g,c,s),T.distance<=i*i&&(o.t=1,o.intersect=1,o.betweenPoints=!0),o;if(f[0]<0)return f[0]=0,T=Cn(g,n,a,s),o.t=T.t,T.distance<=i*i&&(o.intersect=1),o;if(f[0]>1)return f[0]=1,T=Cn(c,n,a,s),o.t=T.t,T.distance<=i*i&&(o.intersect=1),o}return o},t.evaluateLocation=function(n,a,i){var s=[],f=[];e.points.getPoint(0,s),e.points.getPoint(1,f);for(var o=0;o<3;o++)a[o]=s[o]+n[0]*(f[o]-s[o]);i[0]=1-n[0],i[1]=n[0]}}var DE={};function Nl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,DE,r),_i.extend(t,e,r),ME(t,e)}var mE=L.newInstance(Nl,"vtkLine"),Lt=oc(oc({newInstance:mE,extend:Nl},OE),Fl);function RE(t,e){e.classHierarchy.push("vtkPointSet"),e.points?e.points=zt(e.points):e.points=Vi.newInstance(),t.getNumberOfPoints=function(){return e.points.getNumberOfPoints()},t.getBounds=function(){return e.points.getBounds()},t.computeBounds=function(){t.getBounds()};var r=t.shallowCopy;t.shallowCopy=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(n,a),e.points=Vi.newInstance(),e.points.shallowCopy(n.getPoints())}}var LE={};function Ul(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LE,r),_n.extend(t,e,r),L.setGet(t,e,["points"]),RE(t,e)}var VE=L.newInstance(Ul,"vtkPointSet"),_E={newInstance:VE,extend:Ul};function fc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function bE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rf(t,e,r,n){var a=r[0]-e[0],i=r[1]-e[1],s=r[2]-e[2],f=t[0]-e[0],o=t[1]-e[1],u=t[2]-e[2];n[0]=i*u-s*o,n[1]=s*f-a*u,n[2]=a*o-i*f}function bi(t,e,r,n){rf(t,e,r,n);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);a!==0&&(n[0]/=a,n[1]/=a,n[2]/=a)}function kE(t,e,r,n,a,i){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,f=!1,o=[],u=[],g=[],c=[],l=[];bi(t,e,r,c),bi(n,a,i,l);var h=-xe(c,t),y=-xe(l,n),C=[xe(l,t)+y,xe(l,e)+y,xe(l,r)+y];if(C[0]*C[1]>s&&C[0]*C[2]>s)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};var T=[xe(c,n)+h,xe(c,a)+h,xe(c,i)+h];if(T[0]*T[1]>s&&T[0]*T[2]>s)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};if(Math.abs(c[0]-l[0])<1e-9&&Math.abs(c[1]-l[1])<1e-9&&Math.abs(c[2]-l[2])<1e-9&&Math.abs(h-y)<1e-9)return f=!0,{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};var E=[t,e,r],w=[n,a,i],x=xe(c,l),S=(h-y*x)/(x*x-1),m=(y-h*x)/(x*x-1),D=[S*c[0]+m*l[0],S*c[1]+m*l[1],S*c[2]+m*l[2]],b=pa(c,l,[]);Dn(b);for(var N=0,P=0,O=[],A=[],z=50,j=50,B=0;B<3;B++){var Y=B,I=(B+1)%3,te=mn.intersectWithLine(E[Y],E[I],n,l);te.intersection&&te.t>0-s&&te.t<1+s&&(te.t<1+s&&te.t>1-s&&(z=N),O[N++]=xe(te.x,b)-xe(D,b));var U=mn.intersectWithLine(w[Y],w[I],t,c);U.intersection&&U.t>0-s&&U.t<1+s&&(U.t<1+s&&U.t>1-s&&(j=P),A[P++]=xe(U.x,b)-xe(D,b))}if(N>2){N--;var G=O[2];O[2]=O[z],O[z]=G}if(P>2){P--;var K=A[2];A[2]=A[j],A[j]=K}if(N!==2||P!==2)return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};if(Number.isNaN(O[0])||Number.isNaN(O[1])||Number.isNaN(A[0])||Number.isNaN(A[1]))return{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g};if(O[0]>O[1]){var Z=O[1];O[1]=O[0],O[0]=Z}if(A[0]>A[1]){var Q=A[1];A[1]=A[0],A[0]=Q}var oe,ce;return O[1]<A[0]||A[1]<O[0]?{intersect:!1,coplanar:f,pt1:o,pt2:u,surfaceId:g}:(O[0]<A[0]?O[1]<A[1]?(g[0]=2,g[1]=1,oe=A[0],ce=O[1]):(g[0]=2,g[1]=2,oe=A[0],ce=A[1]):O[1]<A[1]?(g[0]=1,g[1]=1,oe=O[0],ce=O[1]):(g[0]=1,g[1]=2,oe=O[0],ce=A[1]),Lu(D,b,oe,o),Lu(D,b,ce,u),{intersect:!0,coplanar:f,pt1:o,pt2:u,surfaceId:g})}var FE={computeNormalDirection:rf,computeNormal:bi,intersectWithTriangle:kE};function BE(t,e){e.classHierarchy.push("vtkTriangle"),t.getCellDimension=function(){return 2},t.intersectWithLine=function(r,n,a,i,s){var f={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};s[2]=0;var o=[],u=a*a,g=[],c=[],l=[];e.points.getPoint(0,g),e.points.getPoint(1,c),e.points.getPoint(2,l);var h=[],y=[];if(bi(g,c,l,h),h[0]!==0||h[1]!==0||h[2]!==0){var C=mn.intersectWithLine(r,n,g,h);if(f.betweenPoints=C.betweenPoints,f.t=C.t,i[0]=C.x[0],i[1]=C.x[1],i[2]=C.x[2],!C.intersection)return s[0]=0,s[1]=0,f.intersect=0,f;var T=t.evaluatePosition(i,o,s,y);if(T.evaluation>=0)return T.dist2<=u?(f.intersect=1,f):(f.intersect=T.evaluation,f)}var E=Gt(g,c),w=Gt(c,l),x=Gt(l,g);e.line||(e.line=Lt.newInstance()),E>w&&E>x?(e.line.getPoints().setPoint(0,g),e.line.getPoints().setPoint(1,c)):w>x&&w>E?(e.line.getPoints().setPoint(0,c),e.line.getPoints().setPoint(1,l)):(e.line.getPoints().setPoint(0,l),e.line.getPoints().setPoint(1,g));var S=e.line.intersectWithLine(r,n,a,i,s);if(f.betweenPoints=S.betweenPoints,f.t=S.t,S.intersect){for(var m=[],D=[],b=[],N=0;N<3;N++)m[N]=g[N]-l[N],D[N]=c[N]-l[N],b[N]=i[N]-l[N];return s[0]=xe(b,m)/x,s[1]=xe(b,D)/w,f.intersect=1,f}return s[0]=0,s[1]=0,f.intersect=0,f},t.evaluatePosition=function(r,n,a,i){var s={subId:0,dist2:0,evaluation:-1},f,o,u=[],g=[],c=[],l=[],h,y=[],C=[],T=[],E=0,w=0,x=[],S,m,D,b=[],N=[],P=[],O=[];s.subId=0,a[2]=0,e.points.getPoint(1,u),e.points.getPoint(2,g),e.points.getPoint(0,c),rf(u,g,c,l),mn.generalizedProjectPoint(r,u,l,O);var A=0;for(f=0;f<3;f++)l[f]<0?h=-l[f]:h=l[f],h>A&&(A=h,w=f);for(o=0,f=0;f<3;f++)f!==w&&(x[o++]=f);for(f=0;f<2;f++)y[f]=O[x[f]]-c[x[f]],C[f]=u[x[f]]-c[x[f]],T[f]=g[x[f]]-c[x[f]];if(E=li(C,T),E===0)return a[0]=0,a[1]=0,s.evaluation=-1,s;if(a[0]=li(y,T)/E,a[1]=li(C,y)/E,i[0]=1-(a[0]+a[1]),i[1]=a[0],i[2]=a[1],i[0]>=0&&i[0]<=1&&i[1]>=0&&i[1]<=1&&i[2]>=0&&i[2]<=1)n&&(s.dist2=Gt(O,r),n[0]=O[0],n[1]=O[1],n[2]=O[2]),s.evaluation=1;else{var z;if(n){if(i[1]<0&&i[2]<0)for(S=Gt(r,c),m=Lt.distanceToLine(r,u,c,z,N),D=Lt.distanceToLine(r,c,g,z,P),S<m?(s.dist2=S,b=c):(s.dist2=m,b=N),D<s.dist2&&(s.dist2=D,b=P),f=0;f<3;f++)n[f]=b[f];else if(i[2]<0&&i[0]<0)for(S=Gt(r,u),m=Lt.distanceToLine(r,u,c,z,N),D=Lt.distanceToLine(r,u,g,z,P),S<m?(s.dist2=S,b=u):(s.dist2=m,b=N),D<s.dist2&&(s.dist2=D,b=P),f=0;f<3;f++)n[f]=b[f];else if(i[1]<0&&i[0]<0)for(S=Gt(r,g),m=Lt.distanceToLine(r,g,c,z,N),D=Lt.distanceToLine(r,u,g,z,P),S<m?(s.dist2=S,b=g):(s.dist2=m,b=N),D<s.dist2&&(s.dist2=D,b=P),f=0;f<3;f++)n[f]=b[f];else if(i[0]<0){var j=Lt.distanceToLine(r,u,g,n);s.dist2=j.distance}else if(i[1]<0){var B=Lt.distanceToLine(r,g,c,n);s.dist2=B.distance}else if(i[2]<0){var Y=Lt.distanceToLine(r,u,c,n);s.dist2=Y.distance}}s.evaluation=0}return s},t.evaluateLocation=function(r,n,a){var i=[],s=[],f=[];e.points.getPoint(0,i),e.points.getPoint(1,s),e.points.getPoint(2,f);for(var o=1-r[0]-r[1],u=0;u<3;u++)n[u]=i[u]*o+s[u]*r[0]+f[u]*r[1];a[0]=o,a[1]=r[0],a[2]=r[1]},t.getParametricDistance=function(r){var n,a=0,i=[];i[0]=r[0],i[1]=r[1],i[2]=1-r[0]-r[1];for(var s=0;s<3;s++)i[s]<0?n=-i[s]:i[s]>1?n=i[s]-1:n=0,n>a&&(a=n);return a}}var NE={};function Gl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NE,r),_i.extend(t,e,r),BE(t,e)}var UE=L.newInstance(Gl,"vtkTriangle"),GE=bE({newInstance:UE,extend:Gl},FE),Vs=["verts","lines","polys","strips"],jn,uc=L.vtkWarningMacro,AE=(jn={},de(jn,Pe.VTK_LINE,Lt),de(jn,Pe.VTK_POLY_LINE,Lt),de(jn,Pe.VTK_TRIANGLE,GE),jn);function PE(t,e){e.classHierarchy.push("vtkPolyData");function r(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(i){return i.toUpperCase()}).replace(/\s+/g,"")}Vs.forEach(function(a){t["getNumberOf".concat(r(a))]=function(){return e[a].getNumberOfCells()},e[a]?e[a]=zt(e[a]):e[a]=ac.newInstance()}),t.getNumberOfCells=function(){return Vs.reduce(function(a,i){return a+e[i].getNumberOfCells()},0)};var n=t.shallowCopy;t.shallowCopy=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(a,i),Vs.forEach(function(s){e[s]=ac.newInstance(),e[s].shallowCopy(a.getReferenceByName(s))})},t.buildCells=function(){var a=t.getNumberOfVerts(),i=t.getNumberOfLines(),s=t.getNumberOfPolys(),f=t.getNumberOfStrips(),o=a+i+s+f,u=new Uint8Array(o),g=u,c=new Uint32Array(o),l=c;if(a){var h=0;e.verts.getCellSizes().forEach(function(E,w){l[w]=h,g[w]=E>1?Pe.VTK_POLY_VERTEX:Pe.VTK_VERTEX,h+=E+1}),l=l.subarray(a),g=g.subarray(a)}if(i){var y=0;e.lines.getCellSizes().forEach(function(E,w){l[w]=y,g[w]=E>2?Pe.VTK_POLY_LINE:Pe.VTK_LINE,E===1&&uc("Building VTK_LINE ",w," with only one point, but VTK_LINE needs at least two points. Check the input."),y+=E+1}),l=l.subarray(i),g=g.subarray(i)}if(s){var C=0;e.polys.getCellSizes().forEach(function(E,w){switch(l[w]=C,E){case 3:g[w]=Pe.VTK_TRIANGLE;break;case 4:g[w]=Pe.VTK_QUAD;break;default:g[w]=Pe.VTK_POLYGON;break}E<3&&uc("Building VTK_TRIANGLE ",w," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),C+=E+1}),l+=l.subarray(s),g+=g.subarray(s)}if(f){var T=0;g.fill(Pe.VTK_TRIANGLE_STRIP,0,f),e.strips.getCellSizes().forEach(function(E,w){l[w]=T,T+=E+1})}e.cells=xE.newInstance(),e.cells.setCellTypes(o,u,c)},t.buildLinks=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;e.cells===void 0&&t.buildCells(),e.links=vE.newInstance(),a>0?e.links.allocate(a):e.links.allocate(t.getPoints().getNumberOfPoints()),e.links.buildLinks(t)},t.getCellType=function(a){return e.cells.getCellType(a)},t.getCellPoints=function(a){var i=t.getCellType(a),s=null;switch(i){case Pe.VTK_VERTEX:case Pe.VTK_POLY_VERTEX:s=e.verts;break;case Pe.VTK_LINE:case Pe.VTK_POLY_LINE:s=e.lines;break;case Pe.VTK_TRIANGLE:case Pe.VTK_QUAD:case Pe.VTK_POLYGON:s=e.polys;break;case Pe.VTK_TRIANGLE_STRIP:s=e.strips;break;default:return s=null,{type:0,cellPointIds:null}}var f=e.cells.getCellLocation(a),o=s.getCell(f);return{cellType:i,cellPointIds:o}},t.getPointCells=function(a){return e.links.getCells(a)},t.getCellEdgeNeighbors=function(a,i,s){var f=e.links.getLink(i),o=e.links.getLink(s);return f.cells.filter(function(u){return u!==a&&o.cells.indexOf(u)!==-1})},t.getCell=function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=t.getCellPoints(a),f=i||AE[s.cellType].newInstance();return f.initialize(t.getPoints(),s.cellPointIds),f}}var WE={};function Al(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WE,r),_E.extend(t,e,r),L.get(t,e,["cells","links"]),L.setGet(t,e,["verts","lines","polys","strips"]),PE(t,e)}var zE=L.newInstance(Al,"vtkPolyData"),fr={newInstance:zE,extend:Al};function cc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function jE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $E(t,e){e.classHierarchy.push("vtkTexture"),t.imageLoaded=function(){e.image.removeEventListener("load",t.imageLoaded),e.imageLoaded=!0,t.modified()},t.setJsImageData=function(r){e.jsImageData!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.canvas=null),e.jsImageData=r,e.imageLoaded=!0,t.modified())},t.setCanvas=function(r){e.canvas!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.image=null,e.jsImageData=null),e.canvas=r,t.modified())},t.setImage=function(r){e.image!==r&&(r!==null&&(t.setInputData(null),t.setInputConnection(null),e.canvas=null,e.jsImageData=null),e.image=r,e.imageLoaded=!1,r.complete?t.imageLoaded():r.addEventListener("load",t.imageLoaded),t.modified())},t.getDimensionality=function(){var r=0,n=0,a=1;if(t.getInputData()){var i=t.getInputData();r=i.getDimensions()[0],n=i.getDimensions()[1],a=i.getDimensions()[2]}e.jsImageData&&(r=e.jsImageData.width,n=e.jsImageData.height),e.canvas&&(r=e.canvas.width,n=e.canvas.height),e.image&&(r=e.image.width,n=e.image.height);var s=(r>1)+(n>1)+(a>1);return s},t.getInputAsJsImageData=function(){if(!e.imageLoaded||t.getInputData())return null;if(e.jsImageData)return e.jsImageData();if(e.canvas){var r=e.canvas.getContext("2d"),n=r.getImageData(0,0,e.canvas.width,e.canvas.height);return n}if(e.image){var a=document.createElement("canvas");a.width=e.image.width,a.height=e.image.height;var i=a.getContext("2d");i.translate(0,a.height),i.scale(1,-1),i.drawImage(e.image,0,0,e.image.width,e.image.height);var s=i.getImageData(0,0,a.width,a.height);return s}return null}}var HE=function(e,r,n,a){for(var i=[1,2,1],s=4,f=i,o=s,u=e.length/(r*n),g=r,c=n,l=e,h=[l],y=0;y<a;y++){var C=Ee(l);g/=2,c/=2,l=new Uint8ClampedArray(g*c*u);for(var T=u*g,E=0,w=0;w<l.length;w+=u){w%T===0&&(E+=2*u*g);for(var x=0;x<u;x++){var S=C[E+x];S+=C[E+u+x],S+=C[E-2*T+x],S+=C[E-2*T+u+x],S/=4,l[w+x]=S}E+=2*u}for(var m=Ee(l),D=0;D<l.length;D+=u)for(var b=0;b<u;b++){for(var N=-(f.length-1)/2,P=o,O=0,A=0;A<f.length;A++){var z=D+b+N*u,j=z%T-(D+b)%T;j>u&&(z+=T),j<-u&&(z-=T),m[z]?O+=m[z]*f[A]:P-=f[A],N+=1}l[D+b]=O/P}m=Ee(l);for(var B=0;B<l.length;B+=u)for(var Y=0;Y<u;Y++){for(var I=-(f.length-1)/2,te=o,U=0,G=0;G<f.length;G++){var K=B+Y+I*T;m[K]?U+=m[K]*f[G]:te-=f[G],I+=1}l[B+Y]=U/te}h.push(l)}return h},KE={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0};function Pl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KE,r),L.obj(t,e),L.algo(t,e,6,0),L.get(t,e,["canvas","image","jsImageData","imageLoaded"]),L.setGet(t,e,["repeat","edgeClamp","interpolate","mipLevel"]),$E(t,e)}var XE=L.newInstance(Pl,"vtkTexture"),YE={generateMipmaps:HE},zi=jE({newInstance:XE,extend:Pl},YE);function gc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function qn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var IE=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],vc=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],Ha=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],lc=[0,1,0,1,0,1,0,1,2,2,2,2],$e=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],le=new Float64Array(3),Ka=new Float64Array(3),ke=new Float64Array(3),Kr=new Float64Array(3),Ur=new Float64Array(3),Xa=new Float64Array(3),_s=new Float64Array(16);function bs(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function qE(t,e){e.classHierarchy.push("vtkCubeAxesActorHelper"),t.setRenderable=function(r){e.renderable!==r&&(e.renderable=r,e.tmActor.addTexture(e.renderable.getTmTexture()),e.tmActor.setProperty(r.getProperty()),e.tmActor.setParentProp(r),t.modified())},t.createPolyDataForOneLabel=function(r,n,a,i,s,f,o){var u=e.renderable.get_tmAtlas().get(r);if(!!u){var g=e.renderable.getTextPolyData().getPoints().getData(),c=e.lastSize;le[0]=g[n*3],le[1]=g[n*3+1],le[2]=g[n*3+2],me(ke,le,a),ke[0]+=.1,me(Ka,ke,i),xr(Ur,Ka,le),ke[0]-=.1,ke[1]+=.1,me(Ka,ke,i),xr(Xa,Ka,le);for(var l=0;l<3;l++)Ur[l]/=.5*.1*c[0],Xa[l]/=.5*.1*c[1];var h=o.ptIdx,y=o.cellIdx;le[0]=g[n*3],le[1]=g[n*3+1],le[2]=g[n*3+2],s[0]<-.5?yr(ke,Ur,s[0]*f-u.width):s[0]>.5?yr(ke,Ur,s[0]*f):yr(ke,Ur,s[0]*f-u.width/2),Kn(le,le,ke),yr(ke,Xa,s[1]*f-u.height/2),Kn(le,le,ke),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[0],o.tcoords[h*2+1]=u.tcoords[1],h++,yr(ke,Ur,u.width),Kn(le,le,ke),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[2],o.tcoords[h*2+1]=u.tcoords[3],h++,yr(ke,Xa,u.height),Kn(le,le,ke),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[4],o.tcoords[h*2+1]=u.tcoords[5],h++,yr(ke,Ur,u.width),xr(le,le,ke),o.points[h*3]=le[0],o.points[h*3+1]=le[1],o.points[h*3+2]=le[2],o.tcoords[h*2]=u.tcoords[6],o.tcoords[h*2+1]=u.tcoords[7],h++,o.polys[y*4]=3,o.polys[y*4+1]=h-4,o.polys[y*4+2]=h-3,o.polys[y*4+3]=h-2,y++,o.polys[y*4]=3,o.polys[y*4+1]=h-4,o.polys[y*4+2]=h-2,o.polys[y*4+3]=h-1,o.ptIdx+=4,o.cellIdx+=2}},t.updateTexturePolyData=function(){var r=e.camera.getCompositeProjectionMatrix(e.lastAspectRatio,-1,1);We(r,r);var n=e.renderable.getTextValues().length,a=n*4,i=n*2,s=new Float64Array(a*3),f=new Uint16Array(i*4),o=new Float32Array(a*2);wt(_s,r);for(var u={ptIdx:0,cellIdx:0,polys:f,points:s,tcoords:o},g=0,c=0,l=0,h=e.renderable.getTextPolyData().getPoints().getData(),y=e.renderable.getTextValues();g<h.length/3;){le[0]=h[g*3],le[1]=h[g*3+1],le[2]=h[g*3+2],me(ke,le,r),le[0]=h[g*3+3],le[1]=h[g*3+4],le[2]=h[g*3+5],me(Kr,le,r),xr(ke,ke,Kr);var C=[ke[0],ke[1]];X2(C),t.createPolyDataForOneLabel(y[c],g,r,_s,C,e.renderable.getAxisTitlePixelOffset(),u),g+=2,c++;for(var T=0;T<e.renderable.getTickCounts()[l];T++)t.createPolyDataForOneLabel(y[c],g,r,_s,C,e.renderable.getTickLabelPixelOffset(),u),g++,c++;l++}var E=_e.newInstance({numberOfComponents:2,values:o,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(E),e.tmPolyData.getPoints().setData(s,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(f,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updateAPISpecificData=function(r,n,a){(e.lastSize[0]!==r[0]||e.lastSize[1]!==r[1])&&(e.lastSize[0]=r[0],e.lastSize[1]=r[1],e.lastAspectRatio=r[0]/r[1],e.forceUpdate=!0),e.camera=n,t.updateTexturePolyData()}}var ZE=L.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),L.obj(t,e),e.tmPolyData=fr.newInstance(),e.tmMapper=Rr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmActor=Dr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),L.setGet(t,e,["renderable"]),L.get(t,e,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),e.forceUpdate=!1,e.lastRedrawTime={},L.obj(e.lastRedrawTime,{mtime:0}),e.lastRebuildTime={},L.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.lastTickBounds=[],qE(t,e)},"vtkCubeAxesActorHelper");function QE(t,e){e.classHierarchy.push("vtkCubeAxesActor"),t.setCamera=function(r){e.camera!==r&&(e.cameraModifiedSub&&(e.cameraModifiedSub.unsubscribe(),e.cameraModifiedSub=null),e.camera=r,r&&(e.cameraModifiedSub=r.onModified(t.update)),t.update(),t.modified())},t.computeFacesToDraw=function(){var r=e.camera.getViewMatrix();We(r,r);for(var n=!1,a=je.getDiagonalLength(e.dataBounds),i=Math.sin(e.faceVisibilityAngle*Math.PI/180),s=0;s<6;s++){var f=!1,o=Math.floor(s/2),u=(o+1)%3,g=(o+2)%3;e.dataBounds[u*2]!==e.dataBounds[u*2+1]&&e.dataBounds[g*2]!==e.dataBounds[g*2+1]&&(le[o]=e.dataBounds[s]-.1*a*IE[s][o],le[u]=.5*(e.dataBounds[u*2]+e.dataBounds[u*2+1]),le[g]=.5*(e.dataBounds[g*2]+e.dataBounds[g*2+1]),me(ke,le,r),le[o]=e.dataBounds[s],me(Kr,le,r),xr(ke,Kr,ke),fa(ke,ke),f=ke[2]>i,e.camera.getParallelProjection()||(fa(Kr,Kr),f=Fg(Kr,ke)>i)),f!==e.lastFacesToDraw[s]&&(e.lastFacesToDraw[s]=f,n=!0)}return n},t.updatePolyData=function(r,n,a){var i=0,s=0;i+=8;for(var f=0,o=0;o<12;o++)n[o]>0&&f++;if(s+=f,e.gridLines)for(var u=0;u<6;u++)r[u]&&(i+=a[$e[u][0]].length*2+a[$e[u][1]].length*2,s+=a[$e[u][0]].length+a[$e[u][1]].length);for(var g=new Float64Array(i*3),c=new Uint32Array(s*3),l=0,h=0,y=0;y<2;y++)for(var C=0;C<2;C++)for(var T=0;T<2;T++)g[l*3]=e.dataBounds[T],g[l*3+1]=e.dataBounds[2+C],g[l*3+2]=e.dataBounds[4+y],l++;for(var E=0;E<12;E++)n[E]>0&&(c[h*3]=2,c[h*3+1]=Ha[E][0],c[h*3+2]=Ha[E][1],h++);if(e.gridLines){for(var w=0;w<6;w++)if(r[w]){for(var x=Math.floor(w/2),S=a[$e[w][0]],m=0;m<S.length;m++)g[l*3+x]=e.dataBounds[w],g[l*3+$e[w][0]]=S[m],g[l*3+$e[w][1]]=e.dataBounds[$e[w][1]*2],l++,g[l*3+x]=e.dataBounds[w],g[l*3+$e[w][0]]=S[m],g[l*3+$e[w][1]]=e.dataBounds[$e[w][1]*2+1],l++,c[h*3]=2,c[h*3+1]=l-2,c[h*3+2]=l-1,h++;S=a[$e[w][1]];for(var D=0;D<S.length;D++)g[l*3+x]=e.dataBounds[w],g[l*3+$e[w][1]]=S[D],g[l*3+$e[w][0]]=e.dataBounds[$e[w][0]*2],l++,g[l*3+x]=e.dataBounds[w],g[l*3+$e[w][1]]=S[D],g[l*3+$e[w][0]]=e.dataBounds[$e[w][0]*2+1],l++,c[h*3]=2,c[h*3+1]=l-2,c[h*3+2]=l-1,h++}}e.polyData.getPoints().setData(g,3),e.polyData.getPoints().modified(),e.polyData.getLines().setData(c,1),e.polyData.getLines().modified(),e.polyData.modified()},t.updateTextData=function(r,n,a,i){for(var s=0,f=0;f<12;f++)n[f]===1&&(s+=2,s+=a[lc[f]].length);for(var o=e.polyData.getPoints().getData(),u=new Float64Array(s*3),g=0,c=0,l=0,h=0;h<6;h++)if(r[h])for(var y=0;y<4;y++){var C=vc[h][y];if(n[C]===1){var T=lc[C],E=Ha[C][0]*3,w=Ha[C][1]*3;u[g*3]=.5*(o[E]+o[w]),u[g*3+1]=.5*(o[E+1]+o[w+1]),u[g*3+2]=.5*(o[E+2]+o[w+2]),g++;var x=Math.floor(h/2);u[g*3+x]=e.dataBounds[h],u[g*3+$e[h][0]]=.5*(e.dataBounds[$e[h][0]*2]+e.dataBounds[$e[h][0]*2+1]),u[g*3+$e[h][1]]=.5*(e.dataBounds[$e[h][1]*2]+e.dataBounds[$e[h][1]*2+1]),g++,e.textValues[c]=e.axisLabels[T],c++;var S=(T+1)%3,m=(T+2)%3,D=a[T],b=i[T];e.tickCounts[l]=D.length;for(var N=0;N<D.length;N++)u[g*3+T]=D[N],u[g*3+S]=o[E+S],u[g*3+m]=o[E+m],g++,e.textValues[c]=b[N],c++;l++}}e.textPolyData.getPoints().setData(u,3),e.textPolyData.modified()},t.update=function(){if(!!e.camera){for(var r=t.computeFacesToDraw(),n=e.lastFacesToDraw,a=!1,i=0;i<6;i++)e.dataBounds[i]!==e.lastTickBounds[i]&&(a=!0,e.lastTickBounds[i]=e.dataBounds[i]);if(r||a||e.forceUpdate){for(var s=new Array(12).fill(0),f=0;f<6;f++)if(n[f])for(var o=0;o<4;o++)s[vc[f][o]]++;for(var u=[],g=[],c=0;c<3;c++){var l=$o().domain([e.dataBounds[c*2],e.dataBounds[c*2+1]]);u[c]=l.ticks(5);var h=l.tickFormat(5);g[c]=u[c].map(h)}t.updatePolyData(n,s,u),t.updateTextData(n,s,u,g),(a||e.forceUpdate)&&t.updateTextureAtlas(g)}e.forceUpdate=!1}},t.updateTextureAtlas=function(r){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e._tmAtlas.clear();for(var n=0,a=1,i=0;i<3;i++){if(!e._tmAtlas.has(e.axisLabels[i])){bs(e.tmContext,e.axisTextStyle);var s=e.tmContext.measureText(e.axisLabels[i]),f={height:s.actualBoundingBoxAscent+2,startingHeight:a,width:s.width+2,textStyle:e.axisTextStyle};e._tmAtlas.set(e.axisLabels[i],f),a+=f.height,n<f.width&&(n=f.width)}bs(e.tmContext,e.tickTextStyle);for(var o=0;o<r[i].length;o++)if(!e._tmAtlas.has(r[i][o])){var u=e.tmContext.measureText(r[i][o]),g={height:u.actualBoundingBoxAscent+2,startingHeight:a,width:u.width+2,textStyle:e.tickTextStyle};e._tmAtlas.set(r[i][o],g),a+=g.height,n<g.width&&(n=g.width)}}n=Pt(n),a=Pt(a),e._tmAtlas.forEach(function(c){c.tcoords=[0,(a-c.startingHeight-c.height)/a,c.width/n,(a-c.startingHeight-c.height)/a,c.width/n,(a-c.startingHeight)/a,0,(a-c.startingHeight)/a]}),e.tmCanvas.width=n,e.tmCanvas.height=a,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,n,a),e._tmAtlas.forEach(function(c,l){bs(e.tmContext,c.textStyle),e.tmContext.fillText(l,1,c.startingHeight+c.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified()},t.onModified(function(){e.forceUpdate=!0,t.update()}),t.setTickTextStyle=function(r){e.tickTextStyle=qn(qn({},e.tickTextStyle),r),t.modified()},t.setAxisTextStyle=function(r){e.axisTextStyle=qn(qn({},e.axisTextStyle),r),t.modified()},t.get_tmAtlas=function(){return e._tmAtlas},t.getBounds=function(){return t.update(),je.setBounds(e.bounds,e.gridActor.getBounds()),je.scaleAboutCenter(e.bounds,e.boundsScaleFactor,e.boundsScaleFactor,e.boundsScaleFactor),e.bounds}}function JE(t){return qn({boundsScaleFactor:1.3,camera:null,dataBounds:Ee(je.INIT_BOUNDS),faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:12,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"}},t)}function Wl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,JE(r)),Dr.extend(t,e,r),e.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],e.axisLabels=["X-Axis","Y-Axis","Z-Axis"],e.tickCounts=[],e.textValues=[],e.lastTickBounds=[],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.tmTexture=zi.newInstance(),e.tmTexture.setInterpolate(!1),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),e.gridMapper=Rr.newInstance(),e.polyData=fr.newInstance(),e.gridMapper.setInputData(e.polyData),e.gridActor=Dr.newInstance(),e.gridActor.setMapper(e.gridMapper),e.gridActor.setProperty(t.getProperty()),e.gridActor.setParentProp(t),e.textPolyData=fr.newInstance(),L.setGet(t,e,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset"]),L.setGetArray(t,e,["dataBounds"],6),L.setGetArray(t,e,["axisLabels"],3),L.get(t,e,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),QE(t,e)}var ex=L.newInstance(Wl,"vtkCubeAxesActor"),zl={newInstance:ex,extend:Wl,newCubeAxesActorHelper:ZE};function tx(t,e){e.classHierarchy.push("vtkOpenGLCubeAxesActor"),t.buildPass=function(r){r&&(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e.openGLRenderWindow=e.openGLRenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.openGLRenderer?e.openGLRenderer.getRenderable().getActiveCamera():null,i=e.openGLRenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.openGLRenderWindow.getRenderable())}}}var rx={};function nx(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rx,r),Ie.extend(t,e,r),e.CubeAxesActorHelper=zl.newCubeAxesActorHelper(),tx(t,e)}var ax=Ue(nx,"vtkOpenGLCubeAxesActor");Mt("vtkCubeAxesActor",ax);var sr={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2},jl={ObjectType:sr};function pc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function hc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var hi=jl.ObjectType,ix={};function sx(t,e){e.classHierarchy.push("vtkOpenGLBufferObject");function r(f){switch(f){case hi.ELEMENT_ARRAY_BUFFER:return e.context.ELEMENT_ARRAY_BUFFER;case hi.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in e.context)return e.context.TEXTURE_BUFFER;case hi.ARRAY_BUFFER:default:return e.context.ARRAY_BUFFER}}var n=null,a=null,i=!0,s="";t.getType=function(){return n},t.setType=function(f){n=f},t.getHandle=function(){return a},t.isReady=function(){return i===!1},t.generateBuffer=function(f){var o=r(f);return a===null&&(a=e.context.createBuffer(),n=f),r(n)===o},t.upload=function(f,o){var u=t.generateBuffer(o);return u?(e.context.bindBuffer(r(n),a),e.context.bufferData(r(n),f,e.context.STATIC_DRAW),i=!1,!0):(s="Trying to upload array buffer to incompatible buffer.",!1)},t.bind=function(){return a?(e.context.bindBuffer(r(n),a),!0):!1},t.release=function(){return a?(e.context.bindBuffer(r(n),null),!0):!1},t.releaseGraphicsResources=function(){a!==null&&(e.context.bindBuffer(r(n),null),e.context.deleteBuffer(a),a=null)},t.setOpenGLRenderWindow=function(f){e._openGLRenderWindow!==f&&(t.releaseGraphicsResources(),e._openGLRenderWindow=f,e.context=null,f&&(e.context=e._openGLRenderWindow.getContext()))},t.getError=function(){return s}}var ox={objectType:hi.ARRAY_BUFFER,context:null};function $l(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ox,r),L.obj(t,e),L.get(t,e,["_openGLRenderWindow"]),L.moveToProtected(t,e,["openGLRenderWindow"]),sx(t,e)}var fx=L.newInstance($l),ji=hc(hc({newInstance:fx,extend:$l},ix),jl),yc=L.vtkErrorMacro;function ux(t,e){var r=new Float64Array(3);wd(r,e);var n=new Float64Array(16);return mg(n,qr(),t,r),n}function cx(t,e){return t===null||e===null?!1:!(Yf(t,[0,0,0])&&Yf(e,[1,1,1]))}function gx(t,e){e.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),t.setType(sr.ARRAY_BUFFER),t.createVBO=function(r,n,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(!r.getData()||!r.getData().length)return e.elementCount=0,0;e.blockSize=3,e.vertexOffset=0,e.normalOffset=0,e.tCoordOffset=0,e.tCoordComponents=0,e.colorComponents=0,e.colorOffset=0,e.customData=[];var f=i.points.getData(),o=null,u=null,g=null,c=i.colors?i.colors.getNumberOfComponents():0,l=i.tcoords?i.tcoords.getNumberOfComponents():0;i.normals&&(e.normalOffset=4*e.blockSize,e.blockSize+=3,o=i.normals.getData()),i.customAttributes&&i.customAttributes.forEach(function(Te){Te&&(e.customData.push({data:Te.getData(),offset:4*e.blockSize,components:Te.getNumberOfComponents(),name:Te.getName()}),e.blockSize+=Te.getNumberOfComponents())}),i.tcoords&&(e.tCoordOffset=4*e.blockSize,e.tCoordComponents=l,e.blockSize+=l,u=i.tcoords.getData()),i.colors?(e.colorComponents=i.colors.getNumberOfComponents(),e.colorOffset=0,g=i.colors.getData(),e.colorBO||(e.colorBO=ji.newInstance()),e.colorBO.setOpenGLRenderWindow(e._openGLRenderWindow)):e.colorBO=null,e.stride=4*e.blockSize;var h=0,y=0,C=0,T=0,E=0,w=0,x,S={anythingToPoints:function(ne,ue,Ce){for(var ge=0;ge<ne;++ge)x(ue[Ce+ge])},linesToWireframe:function(ne,ue,Ce){for(var ge=0;ge<ne-1;++ge)x(ue[Ce+ge]),x(ue[Ce+ge+1])},polysToWireframe:function(ne,ue,Ce){if(ne>2)for(var ge=0;ge<ne;++ge)x(ue[Ce+ge]),x(ue[Ce+(ge+1)%ne])},stripsToWireframe:function(ne,ue,Ce){if(ne>2){for(var ge=0;ge<ne-1;++ge)x(ue[Ce+ge]),x(ue[Ce+ge+1]);for(var ie=0;ie<ne-2;ie++)x(ue[Ce+ie]),x(ue[Ce+ie+2])}},polysToSurface:function(ne,ue,Ce){for(var ge=0;ge<ne-2;ge++)x(ue[Ce+0]),x(ue[Ce+ge+1]),x(ue[Ce+ge+2])},stripsToSurface:function(ne,ue,Ce){for(var ge=0;ge<ne-2;ge++)x(ue[Ce+ge]),x(ue[Ce+ge+1+ge%2]),x(ue[Ce+ge+1+(ge+1)%2])}},m={anythingToPoints:function(ne,ue){return ne},linesToWireframe:function(ne,ue){return ne>1?(ne-1)*2:0},polysToWireframe:function(ne,ue){return ne>2?ne*2:0},stripsToWireframe:function(ne,ue){return ne>2?ne*4-6:0},polysToSurface:function(ne,ue){return ne>2?(ne-2)*3:0},stripsToSurface:function(ne,ue,Ce){return ne>2?(ne-2)*3:0}},D=null,b=null;a===bt.POINTS||n==="verts"?(D=S.anythingToPoints,b=m.anythingToPoints):a===bt.WIREFRAME||n==="lines"?(D=S["".concat(n,"ToWireframe")],b=m["".concat(n,"ToWireframe")]):(D=S["".concat(n,"ToSurface")],b=m["".concat(n,"ToSurface")]);for(var N=r.getData(),P=N.length,O=0,A=0;A<P;)O+=b(N[A],N),A+=N[A]+1;var z=null,j=new Float32Array(O*e.blockSize);g&&(z=new Uint8Array(O*4));for(var B=0,Y=0,I=0,te=0,U=0;U<3;++U){var G=i.points.getRange(U),K=G[1]-G[0];I+=K*K;var Z=.5*(G[1]+G[0]);te+=Z*Z}var Q=I>0&&(Math.abs(te)/I>1e6||Math.abs(Math.log10(I))>3||I===0&&te>1e6);if(Q){for(var oe=new Float64Array(3),ce=new Float64Array(3),fe=0;fe<3;++fe){var pe=i.points.getRange(fe),Re=pe[1]-pe[0];oe[fe]=.5*(pe[1]+pe[0]),ce[fe]=Re>0?1/Re:1}t.setCoordShiftAndScale(oe,ce)}else e.coordShiftAndScaleEnabled===!0&&t.setCoordShiftAndScale(null,null);if(s)if(!s.points&&!s.cells)s.points=new Int32Array(O),s.cells=new Int32Array(O);else{var qe=new Int32Array(O+s.points.length);qe.set(s.points),s.points=qe;var He=new Int32Array(O+s.points.length);He.set(s.cells),s.cells=He}var ze=i.vertexOffset;x=function(ne){if(s&&(s.points[ze]=ne,s.cells[ze]=w),++ze,h=ne*3,e.coordShiftAndScaleEnabled?(j[B++]=(f[h++]-e.coordShift[0])*e.coordScale[0],j[B++]=(f[h++]-e.coordShift[1])*e.coordScale[1],j[B++]=(f[h++]-e.coordShift[2])*e.coordScale[2]):(j[B++]=f[h++],j[B++]=f[h++],j[B++]=f[h++]),o!==null&&(i.haveCellNormals?y=(w+i.cellOffset)*3:y=ne*3,j[B++]=o[y++],j[B++]=o[y++],j[B++]=o[y++]),e.customData.forEach(function(Ce){E=ne*Ce.components;for(var ge=0;ge<Ce.components;++ge)j[B++]=Ce.data[E++]}),u!==null){C=ne*l;for(var ue=0;ue<l;++ue)j[B++]=u[C++]}g!==null&&(i.haveCellScalars?T=(w+i.cellOffset)*c:T=ne*c,z[Y++]=g[T++],z[Y++]=g[T++],z[Y++]=g[T++],z[Y++]=c===4?g[T++]:255)};for(var tt=0;tt<P;)D(N[tt],N,tt+1),tt+=N[tt]+1,w++;return e.elementCount=O,t.upload(j,sr.ARRAY_BUFFER),e.colorBO&&(e.colorBOStride=4,e.colorBO.upload(z,sr.ARRAY_BUFFER)),w},t.setCoordShiftAndScale=function(r,n){if(r!==null&&(r.constructor!==Float64Array||r.length!==3)){yc("Wrong type for coordShift, expected vec3 or null");return}if(n!==null&&(n.constructor!==Float64Array||n.length!==3)){yc("Wrong type for coordScale, expected vec3 or null");return}(e.coordShift===null||r===null||!If(r,e.coordShift))&&(e.coordShift=r),(e.coordScale===null||n===null||!If(n,e.coordScale))&&(e.coordScale=n),e.coordShiftAndScaleEnabled=cx(e.coordShift,e.coordScale),e.coordShiftAndScaleEnabled?e.inverseShiftAndScaleMatrix=ux(e.coordShift,e.coordScale):e.inverseShiftAndScaleMatrix=null}}var vx={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function Hl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vx,r),ji.extend(t,e,r),L.setGet(t,e,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),L.get(t,e,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),gx(t,e)}var lx=L.newInstance(Hl),px={newInstance:lx,extend:Hl},hx=L.vtkErrorMacro;function yx(t,e){e.classHierarchy.push("vtkShader"),t.compile=function(){var r=e.context.VERTEX_SHADER;if(!e.source||!e.source.length||e.shaderType==="Unknown")return!1;switch(e.handle!==0&&(e.context.deleteShader(e.handle),e.handle=0),e.shaderType){case"Fragment":r=e.context.FRAGMENT_SHADER;break;case"Vertex":default:r=e.context.VERTEX_SHADER;break}e.handle=e.context.createShader(r),e.context.shaderSource(e.handle,e.source),e.context.compileShader(e.handle);var n=e.context.getShaderParameter(e.handle,e.context.COMPILE_STATUS);if(!n){var a=e.context.getShaderInfoLog(e.handle);return hx("Error compiling shader '".concat(e.source,"': ").concat(a)),e.context.deleteShader(e.handle),e.handle=0,!1}return!0},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0,e.dirty=!0)}}var dx={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function Kl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,dx,r),L.obj(t,e),L.setGet(t,e,["shaderType","source","error","handle","context"]),yx(t,e)}var Tx=L.newInstance(Kl,"vtkShader"),ks={newInstance:Tx,extend:Kl},Ht=L.vtkErrorMacro;function Cx(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Array.isArray(r)?r.join(`
`):r,i=!1;t.search(e)!==-1&&(i=!0);var s="";n&&(s="g");var f=new RegExp(e,s),o=t.replace(f,a);return{replace:i,result:o}}function Sx(t,e){e.classHierarchy.push("vtkShaderProgram"),t.compileShader=function(){return e.vertexShader.compile()?e.fragmentShader.compile()?!t.attachShader(e.vertexShader)||!t.attachShader(e.fragmentShader)?(Ht(e.error),0):t.link()?(t.setCompiled(!0),1):(Ht("Links failed: ".concat(e.error)),0):(Ht(e.fragmentShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),Ht(e.fragmentShader.getError()),0):(Ht(e.vertexShader.getSource().split(`
`).map(function(r,n){return"".concat(n,": ").concat(r)}).join(`
`)),Ht(e.vertexShader.getError()),0)},t.cleanup=function(){e.shaderType==="Unknown"||e.handle===0||(e.context.deleteShader(e.handle),e.handle=0)},t.bind=function(){return!e.linked&&!t.link()?!1:(e.context.useProgram(e.handle),t.setBound(!0),!0)},t.isBound=function(){return!!e.bound},t.release=function(){e.context.useProgram(null),t.setBound(!1)},t.setContext=function(r){e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.link=function(){if(e.inked)return!0;if(e.handle===0)return e.error="Program has not been initialized, and/or does not have shaders.",!1;e.uniformLocs={},e.context.linkProgram(e.handle);var r=e.context.getProgramParameter(e.handle,e.context.LINK_STATUS);if(!r){var n=e.context.getProgramInfoLog(e.handle);return Ht("Error linking shader ".concat(n)),e.handle=0,!1}return t.setLinked(!0),e.attributeLocs={},!0},t.setUniformMatrix=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix4fv(a,!1,i),!0},t.setUniformMatrix3x3=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;var i=new Float32Array(n);return e.context.uniformMatrix3fv(a,!1,i),!0},t.setUniformf=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1f(a,n),!0)},t.setUniformfv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1fv(a,n),!0)},t.setUniformi=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1i(a,n),!0)},t.setUniformiv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform1iv(a,n),!0)},t.setUniform2f=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2f(i,n,a),!0},t.setUniform2fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2fv(a,n),!0)},t.setUniform2i=function(r,n,a){var i=t.findUniform(r);if(i===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(a===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform2i(i,n,a),!0},t.setUniform2iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform2iv(a,n),!0)},t.setUniform3f=function(r,n,a,i){var s=t.findUniform(r);if(s===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(i===void 0)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(s,n,a,i),!0},t.setUniform3fArray=function(r,n){var a=t.findUniform(r);if(a===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;if(!Array.isArray(n)||n.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3f(a,n[0],n[1],n[2]),!0},t.setUniform3fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3fv(a,n),!0)},t.setUniform3i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==3)throw new RangeError("Invalid number of values for array");return e.context.uniform3i(n,f[0],f[1],f[2]),!0},t.setUniform3iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform3iv(a,n),!0)},t.setUniform4f=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4f(n,f[0],f[1],f[2],f[3]),!0},t.setUniform4fv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4fv(a,n),!0)},t.setUniform4i=function(r){var n=t.findUniform(r);if(n===-1)return e.error="Could not set uniform ".concat(r," . No such uniform."),!1;for(var a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var f=i;if(f.length===1&&Array.isArray(f[0])&&(f=f[0]),f.length!==4)throw new RangeError("Invalid number of values for array");return e.context.uniform4i(n,f[0],f[1],f[2],f[3]),!0},t.setUniform4iv=function(r,n){var a=t.findUniform(r);return a===-1?(e.error="Could not set uniform ".concat(r," . No such uniform."),!1):(e.context.uniform4iv(a,n),!0)},t.findUniform=function(r){if(!r||!e.linked)return-1;var n=e.uniformLocs[r];return n!==void 0?n:(n=e.context.getUniformLocation(e.handle,r),n===null?(e.error="Uniform ".concat(r," not found in current shader program."),e.uniformLocs[r]=-1,-1):(e.uniformLocs[r]=n,n))},t.isUniformUsed=function(r){if(!r)return!1;var n=e.uniformLocs[r];return n!==void 0?n!==null:e.linked?(n=e.context.getUniformLocation(e.handle,r),e.uniformLocs[r]=n,n!==null):(Ht("attempt to find uniform when the shader program is not linked"),!1)},t.isAttributeUsed=function(r){if(!r)return!1;if(r in e.attributeLocs)return!0;if(!e.linked)return Ht("attempt to find uniform when the shader program is not linked"),!1;var n=e.context.getAttribLocation(e.handle,r);return n===-1?!1:(e.attributeLocs[r]=n,!0)},t.attachShader=function(r){if(r.getHandle()===0)return e.error="Shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;if(e.handle===0){var n=e.context.createProgram();if(n===0)return e.error="Could not create shader program.",!1;e.handle=n,e.linked=!1}return r.getShaderType()==="Vertex"&&(e.vertexShaderHandle!==0&&e.comntext.detachShader(e.handle,e.vertexShaderHandle),e.vertexShaderHandle=r.getHandle()),r.getShaderType()==="Fragment"&&(e.fragmentShaderHandle!==0&&e.context.detachShader(e.handle,e.fragmentShaderHandle),e.fragmentShaderHandle=r.getHandle()),e.context.attachShader(e.handle,r.getHandle()),t.setLinked(!1),!0},t.detachShader=function(r){if(r.getHandle()===0)return e.error="shader object was not initialized, cannot attach it.",!1;if(r.getShaderType()==="Unknown")return e.error="Shader object is of type Unknown and cannot be used.",!1;switch(e.handle===0&&(e.error="This shader program has not been initialized yet."),r.getShaderType()){case"Vertex":return e.vertexShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.vertexShaderHandle=0,e.linked=!1,!0);case"Fragment":return e.fragmentShaderHandle!==r.getHandle()?(e.error="The supplied shader was not attached to this program.",!1):(e.context.detachShader(e.handle,r.getHandle()),e.fragmentShaderHandle=0,e.linked=!1,!0);default:return!1}},t.setContext=function(r){e.context=r,e.vertexShader.setContext(r),e.fragmentShader.setContext(r),e.geometryShader.setContext(r)},t.setLastCameraMTime=function(r){e.lastCameraMTime=r}}var Ex={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function Xl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ex,r),e.attributesLocs={},e.uniformLocs={},e.vertexShader=ks.newInstance(),e.vertexShader.setShaderType("Vertex"),e.fragmentShader=ks.newInstance(),e.fragmentShader.setShaderType("Fragment"),e.geometryShader=ks.newInstance(),e.geometryShader.setShaderType("Geometry"),L.obj(t,e),L.get(t,e,["lastCameraMTime"]),L.setGet(t,e,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),Sx(t,e)}var xx=L.newInstance(Xl,"vtkShaderProgram"),$={newInstance:xx,extend:Xl,substitute:Cx};function wx(t,e){e.classHierarchy.push("vtkOpenGLVertexArrayObject"),t.exposedMethod=function(){},t.initialize=function(){e.instancingExtension=null,e._openGLRenderWindow.getWebgl2()||(e.instancingExtension=e.context.getExtension("ANGLE_instanced_arrays")),!e.forceEmulation&&e._openGLRenderWindow&&e._openGLRenderWindow.getWebgl2()?(e.extension=null,e.supported=!0,e.handleVAO=e.context.createVertexArray()):(e.extension=e.context.getExtension("OES_vertex_array_object"),!e.forceEmulation&&e.extension?(e.supported=!0,e.handleVAO=e.extension.createVertexArrayOES()):e.supported=!1)},t.isReady=function(){return e.handleVAO!==0||e.supported===!1},t.bind=function(){if(t.isReady()||t.initialize(),t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(e.handleVAO):e.context.bindVertexArray(e.handleVAO);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],f=s.isMatrix?s.size:1,o=0;o<f;++o)r.enableVertexAttribArray(s.index+o),r.vertexAttribPointer(s.index+o,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*o/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+o,1):r.vertexAttribDivisor(s.index+o,1))}},t.release=function(){if(t.isReady()&&e.supported)e.extension?e.extension.bindVertexArrayOES(null):e.context.bindVertexArray(null);else if(t.isReady())for(var r=e.context,n=0;n<e.buffers.length;++n){var a=e.buffers[n];e.context.bindBuffer(r.ARRAY_BUFFER,a.buffer);for(var i=0;i<a.attributes.length;++i)for(var s=a.attributes[i],f=s.isMatrix?s.size:1,o=0;o<f;++o)r.enableVertexAttribArray(s.index+o),r.vertexAttribPointer(s.index+o,s.size,s.type,s.normalize,s.stride,s.offset+s.stride*o/s.size),s.divisor>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(s.index+o,0):r.vertexAttribDivisor(s.index+o,0)),r.disableVertexAttribArray(s.index+o)}},t.shaderProgramChanged=function(){t.release(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.handleProgram=0},t.releaseGraphicsResources=function(){t.shaderProgramChanged(),e.handleVAO&&(e.extension?e.extension.deleteVertexArrayOES(e.handleVAO):e.context.deleteVertexArray(e.handleVAO)),e.handleVAO=0,e.supported=!0,e.handleProgram=0},t.addAttributeArray=function(r,n,a,i,s,f,o,u){return t.addAttributeArrayWithDivisor(r,n,a,i,s,f,o,u,0,!1)},t.addAttributeArrayWithDivisor=function(r,n,a,i,s,f,o,u,g,c){if(!r||!r.isBound()||n.getHandle()===0||n.getType()!==sr.ARRAY_BUFFER||(e.handleProgram===0&&(e.handleProgram=r.getHandle()),t.isReady()||t.initialize(),!t.isReady()||e.handleProgram!==r.getHandle()))return!1;var l=e.context,h={};if(h.name=a,h.index=l.getAttribLocation(e.handleProgram,a),h.offset=i,h.stride=s,h.type=f,h.size=o,h.normalize=u,h.isMatrix=c,h.divisor=g,h.Index===-1)return!1;if(n.bind(),l.enableVertexAttribArray(h.index),l.vertexAttribPointer(h.index,h.size,h.type,h.normalize,h.stride,h.offset),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h.index,1):l.vertexAttribDivisor(h.index,1)),h.buffer=n.getHandle(),!e.supported){for(var y=!1,C=0;C<e.buffers.length;++C){var T=e.buffers[C];if(T.buffer===h.buffer){y=!0;for(var E=!1,w=0;w<T.attributes.length;++w){var x=T.attributes[w];x.name===a&&(E=!0,T.attributes[w]=h)}E||T.attributes.push(h)}}y||e.buffers.push({buffer:h.buffer,attributes:[h]})}return!0},t.addAttributeMatrixWithDivisor=function(r,n,a,i,s,f,o,u,g){var c=t.addAttributeArrayWithDivisor(r,n,a,i,s,f,o,u,g,!0);if(!c)return c;for(var l=e.context,h=l.getAttribLocation(e.handleProgram,a),y=1;y<o;y++)l.enableVertexAttribArray(h+y),l.vertexAttribPointer(h+y,o,f,u,s,i+s*y/o),g>0&&(e.instancingExtension?e.instancingExtension.vertexAttribDivisorANGLE(h+y,1):l.vertexAttribDivisor(h+y,1));return!0},t.removeAttributeArray=function(r){if(!t.isReady()||e.handleProgram===0)return!1;if(!e.supported)for(var n=0;n<e.buffers.length;++n)for(var a=e.buffers[n],i=0;i<a.attributes.length;++i){var s=a.attributes[i];if(s.name===r)return a.attributes.splice(i,1),a.attributes.length||e.buffers.splice(n,1),!0}return!0},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))}}var Ox={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function Yl(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ox,r),e.buffers=[],L.obj(t,e),L.get(t,e,["supported"]),L.setGet(t,e,["forceEmulation"]),wx(t,e)}var Mx=L.newInstance(Yl,"vtkOpenGLVertexArrayObject"),Il={newInstance:Mx,extend:Yl},dr={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};function Dx(t,e){e.classHierarchy.push("vtkOpenGLHelper"),t.setOpenGLRenderWindow=function(r){e.context=r.getContext(),e.program.setContext(e.context),e.VAO.setOpenGLRenderWindow(r),e.CABO.setOpenGLRenderWindow(r)},t.releaseGraphicsResources=function(r){e.VAO.releaseGraphicsResources(),e.CABO.releaseGraphicsResources(),e.CABO.setElementCount(0)},t.drawArrays=function(r,n,a,i){if(e.CABO.getElementCount()){var s=t.getOpenGLMode(a),f=t.haveWideLines(r,n),o=e.context,u=o.getParameter(o.DEPTH_WRITEMASK);e.pointPicking&&o.depthMask(!1);var g=s===o.LINES;g&&f?(t.updateShaders(r,n,i),o.drawArraysInstanced(s,0,e.CABO.getElementCount(),2*Math.ceil(n.getProperty().getLineWidth()))):(o.lineWidth(n.getProperty().getLineWidth()),t.updateShaders(r,n,i),o.drawArrays(s,0,e.CABO.getElementCount()),o.lineWidth(1));var c=(s===o.POINTS?1:0)||(s===o.LINES?2:3);return e.pointPicking&&o.depthMask(u),e.CABO.getElementCount()/c}return 0},t.getOpenGLMode=function(r){if(e.pointPicking)return e.context.POINTS;var n=e.primitiveType;return r===bt.POINTS||n===dr.Points?e.context.POINTS:r===bt.WIREFRAME||n===dr.Lines||n===dr.TrisEdges||n===dr.TriStripsEdges?e.context.LINES:e.context.TRIANGLES},t.haveWideLines=function(r,n){return n.getProperty().getLineWidth()>1?!(e.CABO.getOpenGLRenderWindow()&&e.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=n.getProperty().getLineWidth()):!1},t.getNeedToRebuildShaders=function(r,n,a){return!!(a.getNeedToRebuildShaders(t,r,n)||t.getProgram()===0||t.getShaderSourceTime().getMTime()<a.getMTime()||t.getShaderSourceTime().getMTime()<n.getMTime())},t.updateShaders=function(r,n,a){if(t.getNeedToRebuildShaders(r,n,a)){var i={Vertex:null,Fragment:null,Geometry:null};a.buildShaders(i,r,n);var s=e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(i.Vertex,i.Fragment,i.Geometry);s!==t.getProgram()&&(t.setProgram(s),t.getVAO().releaseGraphicsResources()),t.getShaderSourceTime().modified()}else e.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(t.getProgram());t.getVAO().bind(),a.setMapperShaderParameters(t,r,n),a.setPropertyShaderParameters(t,r,n),a.setCameraShaderParameters(t,r,n),a.setLightingShaderParameters(t,r,n),a.invokeShaderCallbacks(t,r,n)},t.setMapperShaderParameters=function(r,n,a){if(t.haveWideLines(r,n)){t.getProgram().setUniform2f("viewportSize",a.usize,a.vsize);var i=parseFloat(n.getProperty().getLineWidth()),s=i/2;t.getProgram().setUniformf("lineWidthStepSize",i/Math.ceil(i)),t.getProgram().setUniformf("halfLineWidth",s)}e.primitiveType===dr.Points||n.getProperty().getRepresentation()===bt.POINTS?t.getProgram().setUniformf("pointSize",n.getProperty().getPointSize()):e.pointPicking&&t.getProgram().setUniformf("pointSize",t.getPointPickingPrimitiveSize())},t.replaceShaderPositionVC=function(r,n,a){var i=r.Vertex;i=$.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,i=$.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,t.getOpenGLMode(a.getProperty().getRepresentation())===e.context.LINES&&t.haveWideLines(n,a)&&(i=$.substitute(i,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,i=$.substitute(i,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),r.Vertex=i},t.getPointPickingPrimitiveSize=function(){return e.primitiveType===dr.Points?2:e.primitiveType===dr.Lines?4:6}}var mx={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function ql(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mx,r),L.obj(t,e),e.shaderSourceTime={},L.obj(e.shaderSourceTime),e.attributeUpdateTime={},L.obj(e.attributeUpdateTime),L.setGet(t,e,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),e.program=$.newInstance(),e.VAO=Il.newInstance(),e.CABO=px.newInstance(),Dx(t,e)}var Rx=L.newInstance(ql),bn={newInstance:Rx,extend:ql,primTypes:dr},Lx={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},xo={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5},nf={Wrap:Lx,Filter:xo},Zl=new Float32Array(1),Vx=new Int32Array(Zl.buffer);function _x(t){Zl[0]=t;var e=Vx[0],r=e>>16&32768,n=e>>12&2047,a=e>>23&255;return a<103?r:a>142?(r|=31744,r|=(a===255?0:1)&&e&8388607,r):a<113?(n|=2048,r|=(n>>114-a)+(n>>113-a&1),r):(r|=a-112<<10|n>>1,r+=n&1,r)}function bx(t){var e=(t&32768)>>15,r=(t&31744)>>10,n=t&1023;return r===0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r===31?n?NaN:(e?-1:1)*(1/0):(e?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}var Wr={fromHalf:bx,toHalf:_x};function dc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function kx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var nr=nf.Wrap,st=nf.Filter,Ge=_e.VtkDataTypes,Fs=Mr,un=ve,Fx=Bi;function Bx(t,e){var r=this;e.classHierarchy.push("vtkOpenGLTexture"),t.render=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(o?e._openGLRenderWindow=o:(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent()),e.context=e._openGLRenderWindow.getContext(),e.renderable.getInterpolate()?(e.generateMipmap?t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR):t.setMinificationFilter(st.LINEAR),t.setMagnificationFilter(st.LINEAR)):(t.setMinificationFilter(st.NEAREST),t.setMagnificationFilter(st.NEAREST)),e.renderable.getRepeat()&&(t.setWrapR(nr.REPEAT),t.setWrapS(nr.REPEAT),t.setWrapT(nr.REPEAT)),e.renderable.getInputData()&&e.renderable.setImage(null),!e.handle||e.renderable.getMTime()>e.textureBuildTime.getMTime()){if(e.renderable.getImage()!==null&&(e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR)),e.renderable.getImage()&&e.renderable.getImageLoaded()&&(t.create2DFromImage(e.renderable.getImage()),t.activate(),t.sendParameters(),e.textureBuildTime.modified())),e.renderable.getCanvas()!==null){e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR));var u=e.renderable.getCanvas();t.create2DFromRaw(u.width,u.height,4,Ge.UNSIGNED_CHAR,u,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}if(e.renderable.getJsImageData()!==null){var g=e.renderable.getJsImageData();e.renderable.getInterpolate()&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR)),t.create2DFromRaw(g.width,g.height,4,Ge.UNSIGNED_CHAR,g.data,!0),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}var c=e.renderable.getInputData(0);if(c&&c.getPointData().getScalars()){for(var l=c.getExtent(),h=c.getPointData().getScalars(),y=[],C=0;C<e.renderable.getNumberOfInputPorts();++C){var T=e.renderable.getInputData(C),E=T?T.getPointData().getScalars().getData():null;E&&y.push(E)}e.renderable.getInterpolate()&&h.getNumberOfComponents()===4&&(e.generateMipmap=!0,t.setMinificationFilter(st.LINEAR_MIPMAP_LINEAR)),y.length%6===0?t.createCubeFromRaw(l[1]-l[0]+1,l[3]-l[2]+1,h.getNumberOfComponents(),h.getDataType(),y):t.create2DFromRaw(l[1]-l[0]+1,l[3]-l[2]+1,h.getNumberOfComponents(),h.getDataType(),h.getData()),t.activate(),t.sendParameters(),e.textureBuildTime.modified()}}e.handle&&t.activate()},t.destroyTexture=function(){t.deactivate(),e.context&&e.handle&&e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.components=0,e.width=0,e.height=0,e.depth=0,t.resetFormatAndType()},t.createTexture=function(){e.handle||(e.handle=e.context.createTexture(),e.target&&(e.context.bindTexture(e.target,e.handle),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.bindTexture(e.target,null)))},t.getTextureUnit=function(){return e._openGLRenderWindow?e._openGLRenderWindow.getTextureUnitForTexture(t):-1},t.activate=function(){e._openGLRenderWindow.activateTexture(t),t.bind()},t.deactivate=function(){e._openGLRenderWindow&&e._openGLRenderWindow.deactivateTexture(t)},t.releaseGraphicsResources=function(o){o&&e.handle&&(o.activateTexture(t),o.deactivateTexture(t),e.context.deleteTexture(e.handle),e.handle=0,e.numberOfDimensions=0,e.target=0,e.internalFormat=0,e.format=0,e.openGLDataType=0,e.components=0,e.width=0,e.height=0,e.depth=0),e.shaderProgram&&(e.shaderProgram.releaseGraphicsResources(o),e.shaderProgram=null)},t.bind=function(){e.context.bindTexture(e.target,e.handle),e.autoParameters&&t.getMTime()>e.sendParametersTime.getMTime()&&t.sendParameters()},t.isBound=function(){var o=!1;if(e.context&&e.handle){var u=0;switch(e.target){case e.context.TEXTURE_2D:u=e.context.TEXTURE_BINDING_2D;break;default:Fx("impossible case");break}var g=e.context.getIntegerv(u);o=g===e.handle}return o},t.sendParameters=function(){e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_S,t.getOpenGLWrapMode(e.wrapS)),e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_T,t.getOpenGLWrapMode(e.wrapT)),e._openGLRenderWindow.getWebgl2()&&e.context.texParameteri(e.target,e.context.TEXTURE_WRAP_R,t.getOpenGLWrapMode(e.wrapR)),e.context.texParameteri(e.target,e.context.TEXTURE_MIN_FILTER,t.getOpenGLFilterMode(e.minificationFilter)),e.context.texParameteri(e.target,e.context.TEXTURE_MAG_FILTER,t.getOpenGLFilterMode(e.magnificationFilter)),e._openGLRenderWindow.getWebgl2()&&(e.context.texParameteri(e.target,e.context.TEXTURE_BASE_LEVEL,e.baseLevel),e.context.texParameteri(e.target,e.context.TEXTURE_MAX_LEVEL,e.maxLevel)),e.sendParametersTime.modified()},t.getInternalFormat=function(o,u){return e.internalFormat||(e.internalFormat=t.getDefaultInternalFormat(o,u)),e.internalFormat||Fs("Unable to find suitable internal format for T=".concat(o," NC= ").concat(u)),e.internalFormat},t.getDefaultInternalFormat=function(o,u){var g=0;return g=e._openGLRenderWindow.getDefaultTextureInternalFormat(o,u,!1),g||(g=r._openGLRenderWindow.getDefaultTextureInternalFormat(o,u,!0),g||(Fs("Unsupported internal texture type!"),Fs("Unable to find suitable internal format for T=".concat(o," NC= ").concat(u))),g)},t.setInternalFormat=function(o){o!==e.internalFormat&&(e.internalFormat=o,t.modified())},t.getFormat=function(o,u){return e.format=t.getDefaultFormat(o,u),e.format},t.getDefaultFormat=function(o,u){if(e._openGLRenderWindow.getWebgl2())switch(u){case 1:return e.context.RED;case 2:return e.context.RG;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}else switch(u){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:return e.context.RGBA;default:return e.context.RGB}},t.resetFormatAndType=function(){e.format=0,e.internalFormat=0,e.openGLDataType=0},t.getDefaultDataType=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e._openGLRenderWindow.getWebgl2())switch(o){case Ge.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case(u&&Ge.SHORT):return e.context.HALF_FLOAT;case(u&&Ge.UNSIGNED_SHORT):return e.context.HALF_FLOAT;case Ge.FLOAT:case Ge.VOID:default:return e.context.FLOAT}switch(o){case Ge.UNSIGNED_CHAR:return e.context.UNSIGNED_BYTE;case Ge.FLOAT:case Ge.VOID:default:if(e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear"))return e.context.FLOAT;{var g=e.context.getExtension("OES_texture_half_float");if(g&&e.context.getExtension("OES_texture_half_float_linear"))return g.HALF_FLOAT_OES}return e.context.UNSIGNED_BYTE}},t.getOpenGLDataType=function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return e.openGLDataType||(e.openGLDataType=t.getDefaultDataType(o,u)),e.openGLDataType},t.getShiftAndScale=function(){var o=0,u=1;switch(e.openGLDataType){case e.context.BYTE:u=127.5,o=u-128;break;case e.context.UNSIGNED_BYTE:u=255,o=0;break;case e.context.SHORT:u=32767.5,o=u-32768;break;case e.context.UNSIGNED_SHORT:u=65536,o=0;break;case e.context.INT:u=21474836475e-1,o=u-2147483648;break;case e.context.UNSIGNED_INT:u=4294967295,o=0;break;case e.context.FLOAT:}return{shift:o,scale:u}},t.getOpenGLFilterMode=function(o){switch(o){case st.NEAREST:return e.context.NEAREST;case st.LINEAR:return e.context.LINEAR;case st.NEAREST_MIPMAP_NEAREST:return e.context.NEAREST_MIPMAP_NEAREST;case st.NEAREST_MIPMAP_LINEAR:return e.context.NEAREST_MIPMAP_LINEAR;case st.LINEAR_MIPMAP_NEAREST:return e.context.LINEAR_MIPMAP_NEAREST;case st.LINEAR_MIPMAP_LINEAR:return e.context.LINEAR_MIPMAP_LINEAR;default:return e.context.NEAREST}},t.getOpenGLWrapMode=function(o){switch(o){case nr.CLAMP_TO_EDGE:return e.context.CLAMP_TO_EDGE;case nr.REPEAT:return e.context.REPEAT;case nr.MIRRORED_REPEAT:return e.context.MIRRORED_REPEAT;default:return e.context.CLAMP_TO_EDGE}};function n(o,u){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=[],l=e.width*e.height*e.components;if(g&&(l*=e.depth),o!==Ge.FLOAT&&e.openGLDataType===e.context.FLOAT)for(var h=0;h<u.length;h++)if(u[h]){var y=u[h].length>l?u[h].subarray(0,l):u[h];c.push(new Float32Array(y))}else c.push(null);if(o!==Ge.UNSIGNED_CHAR&&e.openGLDataType===e.context.UNSIGNED_BYTE)for(var C=0;C<u.length;C++)if(u[C]){var T=u[C].length>l?u[C].subarray(0,l):u[C];c.push(new Uint8Array(T))}else c.push(null);var E=e.context.getExtension("OES_texture_half_float"),w=e._openGLRenderWindow.getWebgl2()?e.openGLDataType===e.context.HALF_FLOAT:E&&e.openGLDataType===E.HALF_FLOAT_OES;if(w)for(var x=0;x<u.length;x++)if(u[x]){for(var S=new Uint16Array(l),m=0;m<l;m++)S[m]=Wr.toHalf(u[x][m]);c.push(S)}else c.push(null);if(c.length===0)for(var D=0;D<u.length;D++)c.push(u[D]);return c}function a(o){if(e._openGLRenderWindow.getWebgl2())return o;var u=[],g=e.width,c=e.height,l=e.components;if(o&&(!za(g)||!za(c)))for(var h=e.context.getExtension("OES_texture_half_float"),y=Pt(g),C=Pt(c),T=y*C*e.components,E=0;E<o.length;E++)if(o[E]!==null){var w=null,x=c/C,S=g/y,m=!1;e.openGLDataType===e.context.FLOAT?w=new Float32Array(T):h&&e.openGLDataType===h.HALF_FLOAT_OES?(w=new Uint16Array(T),m=!0):w=new Uint8Array(T);for(var D=0;D<C;D++){var b=D*y*l,N=D*x,P=Math.floor(N),O=Math.ceil(N);O>=c&&(O=c-1);var A=N-P,z=1-A;P=P*g*l,O=O*g*l;for(var j=0;j<y;j++){var B=j*l,Y=j*S,I=Math.floor(Y),te=Math.ceil(Y);te>=g&&(te=g-1);var U=Y-I;I*=l,te*=l;for(var G=0;G<l;G++)m?w[b+B+G]=Wr.toHalf(Wr.fromHalf(o[E][P+I+G])*z*(1-U)+Wr.fromHalf(o[E][P+te+G])*z*U+Wr.fromHalf(o[E][O+I+G])*A*(1-U)+Wr.fromHalf(o[E][O+te+G])*A*U):w[b+B+G]=o[E][P+I+G]*z*(1-U)+o[E][P+te+G]*z*U+o[E][O+I+G]*A*(1-U)+o[E][O+te+G]*A*U}}u.push(w),e.width=y,e.height=C}else u.push(null);if(u.length===0)for(var K=0;K<o.length;K++)u.push(o[K]);return u}t.create2DFromRaw=function(o,u,g,c,l){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;if(t.getOpenGLDataType(c),t.getInternalFormat(c,g),t.getFormat(c,g),!e.internalFormat||!e.format||!e.openGLDataType)return un("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=g,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var y=[l],C=n(c,y),T=a(C);return e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,h),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,T[0]),e.generateMipmap&&e.context.generateMipmap(e.target),h&&e.context.pixelStorei(e.context.UNPACK_FLIP_Y_WEBGL,!1),t.deactivate(),!0},t.createCubeFromRaw=function(o,u,g,c,l){if(t.getOpenGLDataType(c),t.getInternalFormat(c,g),t.getFormat(c,g),!e.internalFormat||!e.format||!e.openGLDataType)return un("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_CUBE_MAP,e.components=g,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),e.maxLevel=l.length/6-1,t.createTexture(),t.bind();for(var h=n(c,l),y=a(h),C=[],T=e.width,E=e.height,w=0;w<y.length;w++){w%6===0&&w!==0&&(T/=2,E/=2),C[w]=Ta(c,E*T*e.components);for(var x=0;x<E;++x){var S=x*T*e.components,m=(E-x-1)*T*e.components;C[w].set(y[w].slice(m,m+T*e.components),S)}}e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);for(var D=0;D<6;D++)for(var b=0,N=e.width,P=e.height;N>=1&&P>=1;){var O=null;b<=e.maxLevel&&(O=C[6*b+D]),e.context.texImage2D(e.context.TEXTURE_CUBE_MAP_POSITIVE_X+D,b,e.internalFormat,N,P,0,e.format,e.openGLDataType,O),b++,N/=2,P/=2}return t.deactivate(),!0},t.createDepthFromRaw=function(o,u,g,c){return t.getOpenGLDataType(g),e.format=e.context.DEPTH_COMPONENT,e._openGLRenderWindow.getWebgl2()?g===Ge.FLOAT?e.internalFormat=e.context.DEPTH_COMPONENT32F:e.internalFormat=e.context.DEPTH_COMPONENT16:e.internalFormat=e.context.DEPTH_COMPONENT,!e.internalFormat||!e.format||!e.openGLDataType?(un("Failed to determine texture parameters."),!1):(e.target=e.context.TEXTURE_2D,e.components=1,e.width=o,e.height=u,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,c),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0)},t.create2DFromImage=function(o){if(t.getOpenGLDataType(Ge.UNSIGNED_CHAR),t.getInternalFormat(Ge.UNSIGNED_CHAR,4),t.getFormat(Ge.UNSIGNED_CHAR,4),!e.internalFormat||!e.format||!e.openGLDataType)return un("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=4,e.width=o.width,e.height=o.height,e.depth=1,e.numberOfDimensions=2,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1);var u=!za(o.width)||!za(o.height),g=document.createElement("canvas");g.width=u?Pt(o.width):o.width,g.height=u?Pt(o.height):o.height;var c=g.getContext("2d");c.translate(0,g.height),c.scale(1,-1),c.drawImage(o,0,0,o.width,o.height,0,0,g.width,g.height);var l=g;return e.context.texImage2D(e.target,0,e.internalFormat,e.format,e.openGLDataType,l),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0};function i(o,u,g){for(var c=[],l=[],h=0;h<o;++h)c[h]=g[h],l[h]=g[h];for(var y=0,C=0;C<u;++C)for(var T=0;T<o;++T)g[y]<c[T]&&(c[T]=g[y]),g[y]>l[T]&&(l[T]=g[y]),y++;for(var E=[],w=[],x=0;x<o;++x)c[x]===l[x]&&(l[x]=c[x]+1),E[x]=c[x],w[x]=l[x]-c[x];return{scale:w,offset:E}}function s(o,u){for(var g=0;g<o.length;g++){var c=o[g],l=u[g]+c;if(c<-2048||c>2048||l<-2048||l>2048)return!1}return!0}function f(o,u,g,c){var l=!0;t.getOpenGLDataType(o,l);var h=e.context.getExtension("OES_texture_half_float"),y=e._openGLRenderWindow.getWebgl2()?e.openGLDataType===e.context.HALF_FLOAT:h&&e.openGLDataType===h.HALF_FLOAT_OES;return!(!y||!s(u,g)&&!c)}t.create3DFromRaw=function(o,u,g,c,l,h){var y=!0;if(t.getOpenGLDataType(l,y),t.getInternalFormat(l,c),t.getFormat(l,c),!e.internalFormat||!e.format||!e.openGLDataType)return un("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_3D,e.components=c,e.width=o,e.height=u,e.depth=g,e.numberOfDimensions=3,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind();var C=[h],T=!0,E=n(l,C,T),w=a(E);return e.context.texImage3D(e.target,0,e.internalFormat,e.width,e.height,e.depth,0,e.format,e.openGLDataType,w[0]),e.generateMipmap&&e.context.generateMipmap(e.target),t.deactivate(),!0},t.create3DFilterableFromRaw=function(o,u,g,c,l,h){for(var y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,C=o*u*g,T=[],E=[],w=0;w<c;++w)T[w]=0,E[w]=1;e.volumeInfo={scale:E,offset:T,width:o,height:u,depth:g};var x=i(c,C,h),S=x.offset,m=x.scale;e.volumeInfo.dataComputedScale=m,e.volumeInfo.dataComputedOffset=S;var D=f(l,S,m,y);if(e._openGLRenderWindow.getWebgl2()){if(l===Ge.FLOAT||D&&(l===Ge.SHORT||l===Ge.UNSIGNED_SHORT))return t.create3DFromRaw(o,u,g,c,l,h);if(l===Ge.UNSIGNED_CHAR){for(var b=0;b<c;++b)e.volumeInfo.scale[b]=255;return t.create3DFromRaw(o,u,g,c,l,h)}var N=new Float32Array(C*c);e.volumeInfo.offset=S,e.volumeInfo.scale=m;for(var P=0,O=m.map(function(ie){return 1/ie}),A=0;A<C;A++)for(var z=0;z<c;z++)N[P]=(h[P]-S[z])*O[z],P++;return t.create3DFromRaw(o,u,g,c,Ge.FLOAT,N)}var j=i(c,C,h),B=function(Se,vt,Et,Dt,$t){Se[vt]=Et},Y=Ge.UNSIGNED_CHAR;if(l===Ge.UNSIGNED_CHAR)for(var I=0;I<c;++I)j.offset[I]=0,j.scale[I]=255;else e.context.getExtension("OES_texture_float")&&e.context.getExtension("OES_texture_float_linear")?(Y=Ge.FLOAT,B=function(Se,vt,Et,Dt,$t){Se[vt]=(Et-Dt)/$t}):(Y=Ge.UNSIGNED_CHAR,B=function(Se,vt,Et,Dt,$t){Se[vt]=255*(Et-Dt)/$t});if(t.getOpenGLDataType(Y),t.getInternalFormat(Y,c),t.getFormat(Y,c),!e.internalFormat||!e.format||!e.openGLDataType)return un("Failed to determine texture parameters."),!1;e.target=e.context.TEXTURE_2D,e.components=c,e.depth=1,e.numberOfDimensions=2;var te=e.context.getParameter(e.context.MAX_TEXTURE_SIZE);te>4096&&(Y===Ge.FLOAT||c>=3)&&(te=4096);var U=1,G=1;C>te*te&&(U=Math.ceil(Math.sqrt(C/(te*te))),G=U);var K=Math.sqrt(C)/U;K=Pt(K);var Z=Math.floor(K*U/o),Q=Math.ceil(g/Z),oe=Pt(u*Q/G);e.width=K,e.height=oe,e._openGLRenderWindow.activateTexture(t),t.createTexture(),t.bind(),e.volumeInfo.xreps=Z,e.volumeInfo.yreps=Q,e.volumeInfo.xstride=U,e.volumeInfo.ystride=G,e.volumeInfo.offset=j.offset,e.volumeInfo.scale=j.scale;var ce,fe=K*oe*c;Y===Ge.FLOAT?ce=new Float32Array(fe):ce=new Uint8Array(fe);for(var pe=0,Re=Math.floor(o/U),qe=Math.floor(u/G),He=0;He<Q;He++)for(var ze=Math.min(Z,g-He*Z),tt=c*(e.width-ze*Math.floor(o/U)),Te=0;Te<qe;Te++){for(var ne=0;ne<ze;ne++)for(var ue=c*((He*Z+ne)*o*u+G*Te*o),Ce=0;Ce<Re;Ce++)for(var ge=0;ge<c;ge++)B(ce,pe,h[ue+U*Ce*c+ge],j.offset[ge],j.scale[ge]),pe++;pe+=tt}return e.context.pixelStorei(e.context.UNPACK_ALIGNMENT,1),e.context.texImage2D(e.target,0,e.internalFormat,e.width,e.height,0,e.format,e.openGLDataType,ce),t.deactivate(),!0},t.setOpenGLRenderWindow=function(o){e._openGLRenderWindow!==o&&(t.releaseGraphicsResources(),e._openGLRenderWindow=o,e.context=null,o&&(e.context=e._openGLRenderWindow.getContext()))},t.getMaximumTextureSize=function(o){return o&&o.isCurrent()?o.getIntegerv(o.MAX_TEXTURE_SIZE):-1}}var Nx={_openGLRenderWindow:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:nr.CLAMP_TO_EDGE,wrapT:nr.CLAMP_TO_EDGE,wrapR:nr.CLAMP_TO_EDGE,minificationFilter:st.NEAREST,magnificationFilter:st.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1};function Ql(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Nx,r),Ie.extend(t,e,r),e.sendParametersTime={},yt(e.sendParametersTime,{mtime:0}),e.textureBuildTime={},yt(e.textureBuildTime,{mtime:0}),Ni(t,e,["format","openGLDataType"]),gt(t,e,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap"]),Ft(t,e,["width","height","volumeInfo","components","handle","target"]),Bx(t,e)}var Jl=Ue(Ql,"vtkOpenGLTexture"),Or=kx({newInstance:Jl,extend:Ql},nf);Mt("vtkTexture",Jl);var Ux=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

attribute vec4 vertexMC;

// frag position in VC
//VTK::PositionVC::Dec

// optional normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

// Apple Bug
//VTK::PrimID::Dec

// picking support
//VTK::Picking::Dec

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  //VTK::PrimID::Impl

  //VTK::PositionVC::Impl

  //VTK::Light::Impl

  //VTK::Picking::Impl
}
`,af=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyDataFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// Template for the polydata mappers fragment shader

uniform int PrimitiveIDOffset;

// VC position of this fragment
//VTK::PositionVC::Dec

// optional color passed in from the vertex shader, vertexColor
//VTK::Color::Dec

// optional surface normal declaration
//VTK::Normal::Dec

// extra lighting parameters
//VTK::Light::Dec

// Texture coordinates
//VTK::TCoord::Dec

// picking support
//VTK::Picking::Dec

// Depth Peeling Support
//VTK::DepthPeeling::Dec

// clipping plane vars
//VTK::Clip::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

// handle coincident offsets
//VTK::Coincident::Dec

//VTK::ZBuffer::Dec

void main()
{
  // VC position of this fragment. This should not branch/return/discard.
  //VTK::PositionVC::Impl

  // Place any calls that require uniform flow (e.g. dFdx) here.
  //VTK::UniformFlow::Impl

  // Set gl_FragDepth here (gl_FragCoord.z by default)
  //VTK::Depth::Impl

  // Early depth peeling abort:
  //VTK::DepthPeeling::PreColor

  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Clip::Impl

  //VTK::Color::Impl

  // Generate the normal if we are not passed in one
  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Light::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }

  //VTK::DepthPeeling::Impl

  //VTK::Picking::Impl

  // handle coincident offsets
  //VTK::Coincident::Impl

  //VTK::ZBuffer::Impl

  //VTK::RenderPassFragmentShader::Impl
}
`;function Gx(t,e){t.replaceShaderCoincidentOffset=function(r,n,a){var i=t.getCoincidentParameters(n,a);if(i&&(i.factor!==0||i.offset!==0)){var s=r.Fragment;s=$.substitute(s,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,e.context.getExtension("EXT_frag_depth")&&(i.factor!==0?(s=$.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),e._openGLRenderWindow.getWebgl2()&&(i.factor!==0?(s=$.substitute(s,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):s=$.substitute(s,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),r.Fragment=s}}}var ep={implementReplaceShaderCoincidentOffset:Gx},Bs=_n.FieldAssociations,Je=bn.primTypes,cn=Vn.Representation,Tc=Vn.Shading,Ya=Rr.ScalarMode,Cc=Or.Filter,Sc=Or.Wrap,Gr=ve,Ax={type:"StartEvent"},Px={type:"EndEvent"},Wx=Ea.CoordinateSystem;function zx(t){var e=t.getSelector();return e?e.getCurrentPass():ht.MIN_KNOWN_PASS-1}function jx(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper"),t.buildPass=function(n){n&&(e.currentRenderPass=null,e.openGLActor=t.getFirstAncestorOfType("vtkOpenGLActor"),e.openGLRenderer=e.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.openGLCamera=e.openGLRenderer.getViewNodeFor(e.openGLRenderer.getRenderable().getActiveCamera()))},t.translucentPass=function(n,a){n&&(e.currentRenderPass=a,t.render())},t.opaqueZBufferPass=function(n){n&&(e.haveSeenDepthRequest=!0,e.renderDepth=!0,t.render(),e.renderDepth=!1)},t.opaquePass=function(n){n&&t.render()},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=Je.Start;a<Je.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor.getRenderable(),s=e.openGLRenderer.getRenderable();t.renderPiece(s,i)},t.buildShaders=function(n,a,i){t.getShaderTemplate(n,a,i),e.lastRenderPassShaderReplacement&&e.lastRenderPassShaderReplacement(n);var s=e.renderable.getViewSpecificProperties().OpenGL,f=null;if(s&&(f=s.ShaderReplacements),f)for(var o=0;o<f.length;o++){var u=f[o];if(u.replaceFirst){var g=u.shaderType,c=n[g],l=$.substitute(c,u.originalValue,u.replacementValue,u.replaceAll);n[g]=l.result}}if(t.replaceShaderValues(n,a,i),f)for(var h=0;h<f.length;h++){var y=f[h];if(!y.replaceFirst){var C=y.shaderType,T=n[C],E=$.substitute(T,y.originalValue,y.replacementValue,y.replaceAll);n[C]=E.result}}},t.getShaderTemplate=function(n,a,i){var s=e.renderable.getViewSpecificProperties().OpenGL,f=Ux;if(s){var o=s.VertexShaderCode;o!==void 0&&o!==""&&(f=o)}n.Vertex=f;var u=af;if(s){var g=s.FragmentShaderCode;g!==void 0&&g!==""&&(u=g)}n.Fragment=u;var c="";if(s){var l=s.GeometryShaderCode;l!==void 0&&(c=l)}n.Geometry=c},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getReferenceByName("lastLightComplexity"),g=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];u&&(g=g.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));var c=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];u&&(c=c.concat(["  vec3 specularColor;","  float specularPower;"])),c=c.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),u&&(c=c.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges&&(g=g.concat(["varying vec4 vertexColorVSOutput;"]),s=$.substitute(s,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,s=$.substitute(s,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,f=$.substitute(f,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,f=$.substitute(f,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0&&!e.drawingEdges?o=$.substitute(o,"//VTK::Color::Impl",c.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result:e.renderable.getInterpolateScalarsBeforeMapping()&&e.renderable.getColorCoordinates()&&!e.drawingEdges?o=$.substitute(o,"//VTK::Color::Impl",c.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(i.getBackfaceProperty()&&!e.drawingEdges&&(g=g.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),u?(g=g.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),c=c.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):c=c.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),e.haveCellScalars&&!e.drawingEdges&&(g=g.concat(["uniform samplerBuffer texture1;"])),o=$.substitute(o,"//VTK::Color::Impl",c).result),o=$.substitute(o,"//VTK::Color::Dec",g).result,n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderLight=function(n,a,i){var s=n.Fragment,f="",o=e.lastBoundBO.getReferenceByName("lastLightComplexity"),u=e.lastBoundBO.getReferenceByName("lastLightCount"),g=[];switch(o){case 0:s=$.substitute(s,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:s=$.substitute(s,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(var c=0;c<u;++c)g=g.concat(["uniform vec3 lightColor".concat(c,";"),"uniform vec3 lightDirectionVC".concat(c,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(c,"; // normalized")]);s=$.substitute(s,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(var l=0;l<u;++l)g=g.concat(["  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC".concat(l,"));"),"  diffuseL += ((df".concat(f,") * lightColor").concat(l,");"),"  if (dot(normalVCVSOutput, lightDirectionVC".concat(l,") < 0.0)"),"    {","    float sf = pow( max(0.0, dot(lightHalfAngleVC".concat(l,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(f,") * lightColor").concat(l,");"),"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=$.substitute(s,"//VTK::Light::Impl",g,!1).result;break;case 3:for(var h=0;h<u;++h)g=g.concat(["uniform vec3 lightColor".concat(h,";"),"uniform vec3 lightDirectionVC".concat(h,"; // normalized"),"uniform vec3 lightHalfAngleVC".concat(h,"; // normalized"),"uniform vec3 lightPositionVC".concat(h,";"),"uniform vec3 lightAttenuation".concat(h,";"),"uniform float lightConeAngle".concat(h,";"),"uniform float lightExponent".concat(h,";"),"uniform int lightPositional".concat(h,";")]);s=$.substitute(s,"//VTK::Light::Dec",g).result,g=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(var y=0;y<u;++y)g=g.concat(["  attenuation = 1.0;","  if (lightPositional".concat(y," == 0)"),"    {","      vertLightDirectionVC = lightDirectionVC".concat(y,";"),"    }","  else","    {","    vertLightDirectionVC = vertexVC.xyz - lightPositionVC".concat(y,";"),"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /","      (lightAttenuation".concat(y,".x"),"       + lightAttenuation".concat(y,".y * distanceVC"),"       + lightAttenuation".concat(y,".z * distanceVC * distanceVC);"),"    // per OpenGL standard cone angle is 90 or less for a spot light","    if (lightConeAngle".concat(y," <= 90.0)"),"      {","      float coneDot = dot(vertLightDirectionVC, lightDirectionVC".concat(y,");"),"      // if inside the cone","      if (coneDot >= cos(radians(lightConeAngle".concat(y,")))"),"        {","        attenuation = attenuation * pow(coneDot, lightExponent".concat(y,");"),"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));","    diffuseL += ((df".concat(f,") * lightColor").concat(y,");"),"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {","      float sf = attenuation*pow( max(0.0, dot(lightHalfAngleVC".concat(y,",normalVCVSOutput)), specularPower);"),"    specularL += ((sf".concat(f,") * lightColor").concat(y,");"),"    }"]);g=g.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),s=$.substitute(s,"//VTK::Light::Impl",g,!1).result;break;default:Gr("bad light complexity")}n.Fragment=s},t.replaceShaderNormal=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(s>0){var f=n.Vertex,o=n.Geometry,u=n.Fragment;e.lastBoundBO.getCABO().getNormalOffset()?(f=$.substitute(f,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,f=$.substitute(f,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,o=$.substitute(o,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,o=$.substitute(o,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,u=$.substitute(u,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.haveCellNormals?(u=$.substitute(u,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):e.lastBoundBO.getOpenGLMode(i.getProperty().getRepresentation())===e.context.LINES?(u=$.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(u=$.substitute(u,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,u=$.substitute(u,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,u=$.substitute(u,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),n.Vertex=f,n.Geometry=o,n.Fragment=u}},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i);var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getReferenceByName("lastLightComplexity");u>0?(s=$.substitute(s,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,s=$.substitute(s,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,s=$.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,f=$.substitute(f,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,f=$.substitute(f,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,o=$.substitute(o,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,o=$.substitute(o,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(s=$.substitute(s,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,s=$.substitute(s,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,f=n.Geometry,o=n.Fragment;if(e.drawingEdges)return;s=$.substitute(s,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;var u=e.openGLActor.getActiveTextures(),g=2,c=2;if(u&&u.length>0&&(g=u[0].getComponents(),u[0].getTarget()===e.context.TEXTURE_CUBE_MAP&&(c=3)),e.renderable.getColorTextureMap()&&(g=e.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),c=2),c===2){if(s=$.substitute(s,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,f=$.substitute(f,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,f=$.substitute(f,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=$.substitute(o,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,u&&u.length>=1)switch(g){case 1:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(s=$.substitute(s,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,f=$.substitute(f,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,f=$.substitute(f,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,o=$.substitute(o,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,g){case 1:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:o=$.substitute(o,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}n.Vertex=s,n.Geometry=f,n.Fragment=o}},t.replaceShaderClip=function(n,a,i){var s=n.Vertex,f=n.Fragment;if(e.renderable.getNumberOfClippingPlanes()){var o=e.renderable.getNumberOfClippingPlanes();s=$.substitute(s,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[".concat(o,"];"),"varying float clipDistancesVSOutput[".concat(o,"];")]).result,s=$.substitute(s,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(o,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,f=$.substitute(f,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[".concat(o,"];")]).result,f=$.substitute(f,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < ".concat(o,"; planeNum++)"),"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}n.Vertex=s,n.Fragment=f},t.getCoincidentParameters=function(n,a){var i={factor:0,offset:0},s=a.getProperty();if(e.renderable.getResolveCoincidentTopology()||s.getEdgeVisibility()&&s.getRepresentation()===cn.SURFACE){var f=e.lastBoundBO.getPrimitiveType();f===Je.Points||s.getRepresentation()===cn.POINTS?i=e.renderable.getCoincidentTopologyPointOffsetParameter():f===Je.Lines||s.getRepresentation()===cn.WIREFRAME?i=e.renderable.getCoincidentTopologyLineOffsetParameters():(f===Je.Tris||f===Je.TriStrips)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters()),(f===Je.TrisEdges||f===Je.TriStripsEdges)&&(i=e.renderable.getCoincidentTopologyPolygonOffsetParameters(),i.factor/=2,i.offset/=2)}var o=e.openGLRenderer.getSelector();return o&&o.getFieldAssociation()===Bs.FIELD_ASSOCIATION_POINTS&&(i.offset-=2),i},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment,f=n.Vertex;if(s=$.substitute(s,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,!!e.openGLRenderer.getSelector()){switch((e.lastSelectionState===ht.ID_LOW24||e.lastSelectionState===ht.ID_HIGH24)&&(f=$.substitute(f,"//VTK::Picking::Dec",[`flat out int vertexIDVSOutput;
`,`uniform int VertexIDOffset;
`]).result,f=$.substitute(f,"//VTK::Picking::Impl",`  vertexIDVSOutput = gl_VertexID + VertexIDOffset;
`).result,s=$.substitute(s,"//VTK::Picking::Dec",`flat in int vertexIDVSOutput;
`).result,s=$.substitute(s,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),e.lastSelectionState){case ht.ID_LOW24:s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case ht.ID_HIGH24:s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx)/255.0, 0.0, 0.0, 1.0);").result;break;default:s=$.substitute(s,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}n.Fragment=s,n.Vertex=f}},t.replaceShaderValues=function(n,a,i){if(t.replaceShaderColor(n,a,i),t.replaceShaderNormal(n,a,i),t.replaceShaderLight(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderClip(n,a,i),t.replaceShaderCoincidentOffset(n,a,i),t.replaceShaderPositionVC(n,a,i),e.haveSeenDepthRequest){var s=n.Fragment;s=$.substitute(s,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,s=$.substitute(s,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=s}},t.getNeedToRebuildShaders=function(n,a,i){var s=0,f=0,o=n.getPrimitiveType(),u=e.currentInput,g=!1,c=u.getPointData().getNormals(),l=u.getCellData().getNormals(),h=i.getProperty().getInterpolation()===Tc.FLAT,y=i.getProperty().getRepresentation(),C=n.getOpenGLMode(y,o);if((C===e.context.TRIANGLES||l&&!c||!h&&c||!h&&C===e.context.LINES)&&(g=!0),i.getProperty().getLighting()&&g){s=0;for(var T=a.getLightsByReference(),E=0;E<T.length;++E){var w=T[E],x=w.getSwitch();x>0&&(f++,s===0&&(s=1)),s===1&&(f>1||w.getIntensity()!==1||!w.lightTypeIsHeadLight())&&(s=2),s<3&&w.getPositional()&&(s=3)}}var S=!1,m=e.lastBoundBO.getReferenceByName("lastLightComplexity"),D=e.lastBoundBO.getReferenceByName("lastLightCount");return(m!==s||D!==f)&&(e.lastBoundBO.set({lastLightComplexity:s},!0),e.lastBoundBO.set({lastLightCount:f},!0),S=!0),!e.currentRenderPass&&e.lastRenderPassShaderReplacement&&(S=!0,e.lastRenderPassShaderReplacement=null),e.currentRenderPass&&e.currentRenderPass.getShaderReplacement()!==e.lastRenderPassShaderReplacement&&(e.lastRenderPassShaderReplacement=e.currentRenderPass.getShaderReplacement(),S=!0),e.lastHaveSeenDepthRequest!==e.haveSeenDepthRequest||n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()||n.getShaderSourceTime().getMTime()<e.selectionStateChanged.getMTime()||S?(e.lastHaveSeenDepthRequest=e.haveSeenDepthRequest,!0):!1},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(f){f.callback(f.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isUniformUsed("VertexIDOffset")&&n.getProgram().setUniformi("VertexIDOffset",e.vertexIDOffset),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Gr("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("normalMC")&&n.getCABO().getNormalOffset()&&s>0?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"normalMC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||Gr("Error setting normalMC in shader VAO."):n.getVAO().removeAttributeArray("normalMC"),e.renderable.getCustomShaderAttributes().forEach(function(D,b){n.getProgram().isAttributeUsed("".concat(D,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(D,"MC"),n.getCABO().getCustomData()[b].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[b].components,!1)||Gr("Error setting ".concat(D,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||Gr("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),n.getProgram().isAttributeUsed("scalarColor")&&n.getCABO().getColorComponents()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"scalarColor",n.getCABO().getColorOffset(),n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,4,!0)||Gr("Error setting scalarColor in shader VAO."):n.getVAO().removeAttributeArray("scalarColor"),n.getAttributeUpdateTime().modified()}if(e.renderable.getNumberOfClippingPlanes()){var f=e.renderable.getNumberOfClippingPlanes(),o=[],u=n.getCABO().getCoordShiftAndScaleEnabled(),g=u?n.getCABO().getInverseShiftAndScaleMatrix():null,c=g?ut(e.tmpMat4,i.getMatrix()):i.getMatrix();g&&(We(c,c),Ct(c,c,g),We(c,c));for(var l=0;l<f;l++){var h=[];e.renderable.getClippingPlaneInDataCoords(c,l,h);for(var y=0;y<4;y++)o.push(h[y])}n.getProgram().setUniformi("numClipPlanes",f),n.getProgram().setUniform4fv("clipPlanes",o)}e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var C=e.openGLActor.getActiveTextures();if(C)for(var T=0;T<C.length;++T){var E=C[T],w=E.getTextureUnit(),x="texture".concat(w+1);n.getProgram().isUniformUsed(x)&&n.getProgram().setUniformi(x,w)}if(e.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",e.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){var S=t.getCoincidentParameters(a,i);n.getProgram().setUniformf("coffset",S.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",S.factor)}n.setMapperShaderParameters(a,i,e.openGLRenderer.getTiledSizeAndOrigin());var m=e.openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",m?m.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",m?m.getCurrentPass()+1:0)},t.setLightingShaderParameters=function(n,a,i){var s=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(s<2)){for(var f=n.getProgram(),o=0,u=a.getLightsByReference(),g=0;g<u.length;++g){var c=u[g],l=c.getSwitch();if(l>0){var h=c.getColorByReference(),y=c.getIntensity();e.lightColor[0]=h[0]*y,e.lightColor[1]=h[1]*y,e.lightColor[2]=h[2]*y;var C=c.getDirection(),T=a.getActiveCamera().getViewMatrix(),E=Ee(C);c.lightTypeIsSceneLight()&&(E[0]=T[0]*C[0]+T[1]*C[1]+T[2]*C[2],E[1]=T[4]*C[0]+T[5]*C[1]+T[6]*C[2],E[2]=T[8]*C[0]+T[9]*C[1]+T[10]*C[2],Dn(E)),e.lightDirection[0]=E[0],e.lightDirection[1]=E[1],e.lightDirection[2]=E[2],e.lightHalfAngle[0]=-e.lightDirection[0],e.lightHalfAngle[1]=-e.lightDirection[1],e.lightHalfAngle[2]=-e.lightDirection[2]+1,Dn(e.lightDirection),f.setUniform3fArray("lightColor".concat(o),e.lightColor),f.setUniform3fArray("lightDirectionVC".concat(o),e.lightDirection),f.setUniform3fArray("lightHalfAngleVC".concat(o),e.lightHalfAngle),o++}}if(!(s<3)){var w=a.getActiveCamera(),x=w.getViewMatrix();We(x,x),o=0;for(var S=0;S<u.length;++S){var m=u[S],D=m.getSwitch();if(D>0){var b=m.getTransformedPosition(),N=new Float64Array(3);me(N,b,x),f.setUniform3fArray("lightAttenuation".concat(o),m.getAttenuationValuesByReference()),f.setUniformi("lightPositional".concat(o),m.getPositional()),f.setUniformf("lightExponent".concat(o),m.getExponent()),f.setUniformf("lightConeAngle".concat(o),m.getConeAngle()),f.setUniform3fArray("lightPositionVC".concat(o),[N[0],N[1],N[2]]),o++}}}}};function r(n,a,i){return a.identity(i),n.reduce(function(s,f,o){return o===0?f?a.copy(s,f):a.identity(s):f?a.multiply(s,s,f):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=e.openGLCamera.getKeyMatrices(a),o=a.getActiveCamera(),u=e.openGLCamera.getKeyMatrixTime().getMTime(),g=s.getLastCameraMTime(),c=n.getCABO().getCoordShiftAndScaleEnabled(),l=c?n.getCABO().getInverseShiftAndScaleMatrix():null,h=i.getIsIdentity(),y=h?{mcwc:null,normalMatrix:null}:e.openGLActor.getKeyMatrices();if(i.getCoordinateSystem()===Wx.DISPLAY){var C=e.openGLRenderer.getTiledSizeAndOrigin();De(e.tmpMat4),e.tmpMat4[0]=2/C.usize,e.tmpMat4[12]=-1,e.tmpMat4[5]=2/C.vsize,e.tmpMat4[13]=-1,Ct(e.tmpMat4,e.tmpMat4,l),s.setUniformMatrix("MCPCMatrix",e.tmpMat4)}else s.setUniformMatrix("MCPCMatrix",r([f.wcpc,y.mcwc,l],Zs,e.tmpMat4));s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",r([f.wcvc,y.mcwc,l],Zs,e.tmpMat4)),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",r([f.normalMatrix,y.normalMatrix],Iy,e.tmpMat3)),g!==u&&(s.isUniformUsed("cameraParallel")&&s.setUniformi("cameraParallel",o.getParallelProjection()),s.setLastCameraMTime(u)),h||s.setLastCameraMTime(0)},t.setPropertyShaderParameters=function(n,a,i){var s=n.getProgram(),f=i.getProperty(),o=f.getOpacity(),u=e.drawingEdges?f.getEdgeColorByReference():f.getAmbientColorByReference(),g=e.drawingEdges?f.getEdgeColorByReference():f.getDiffuseColorByReference(),c=e.drawingEdges?1:f.getAmbient(),l=e.drawingEdges?0:f.getDiffuse(),h=e.drawingEdges?0:f.getSpecular(),y=f.getSpecularPower();s.setUniformf("opacityUniform",o),s.setUniform3fArray("ambientColorUniform",u),s.setUniform3fArray("diffuseColorUniform",g),s.setUniformf("ambient",c),s.setUniformf("diffuse",l);var C=e.lastBoundBO.getReferenceByName("lastLightComplexity");if(!(C<1)){var T=f.getSpecularColorByReference();if(s.setUniform3fArray("specularColorUniform",T),s.setUniformf("specularPowerUniform",y),s.setUniformf("specular",h),s.isUniformUsed("ambientIntensityBF")){if(f=i.getBackfaceProperty(),o=f.getOpacity(),u=f.getAmbientColor(),c=f.getAmbient(),g=f.getDiffuseColor(),l=f.getDiffuse(),T=f.getSpecularColor(),h=f.getSpecular(),s.setUniformf("ambientIntensityBF",c),s.setUniformf("diffuseIntensityBF",l),s.setUniformf("opacityUniformBF",o),s.setUniform3fArray("ambientColorUniformBF",u),s.setUniform3fArray("diffuseColorUniformBF",g),C<1)return;s.setUniformf("specularIntensityBF",h),s.setUniform3fArray("specularColorUniformBF",T),s.setUniformf("specularPowerUniformBF",y)}}},t.updateMaximumPointCellIds=function(n,a){var i,s,f,o,u=e.openGLRenderer.getSelector();if(!!u){if((i=e.selectionWebGLIdsToVTKIds)!==null&&i!==void 0&&(s=i.points)!==null&&s!==void 0&&s.length){var g=e.selectionWebGLIdsToVTKIds.points.length;u.setMaximumPointId(g-1)}if((f=e.selectionWebGLIdsToVTKIds)!==null&&f!==void 0&&(o=f.cells)!==null&&o!==void 0&&o.length){var c=e.selectionWebGLIdsToVTKIds.cells.length;u.setMaximumCellId(c-1)}var l=u.getFieldAssociation();l===Bs.FIELD_ASSOCIATION_POINTS&&(e.pointPicking=!0)}},t.renderPieceStart=function(n,a){e.primitiveIDOffset=0,e.vertexIDOffset=0;var i=zx(e.openGLRenderer);if(e.lastSelectionState!==i&&(e.selectionStateChanged.modified(),e.lastSelectionState=i),e.openGLRenderer.getSelector())switch(i){default:e.openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.renderable.getColorTextureMap()&&e.internalColorTexture.activate(),e.lastBoundBO=null},t.renderPieceDraw=function(n,a){for(var i=a.getProperty().getRepresentation(),s=a.getProperty().getEdgeVisibility()&&i===cn.SURFACE,f=e.openGLRenderer.getSelector(),o=f&&f.getFieldAssociation()===Bs.FIELD_ASSOCIATION_POINTS&&(e.lastSelectionState===ht.ID_LOW24||e.lastSelectionState===ht.ID_HIGH24),u=Je.Start;u<Je.End;u++){e.primitives[u].setPointPicking(o);var g=e.primitives[u].getCABO();g.getElementCount()&&(e.drawingEdges=s&&(u===Je.TrisEdges||u===Je.TriStripsEdges),(!e.drawingEdges||!e.renderDepth)&&(e.lastBoundBO=e.primitives[u],e.primitiveIDOffset+=e.primitives[u].drawArrays(n,a,i,t),e.vertexIDOffset+=e.primitives[u].getCABO().getElementCount()))}},t.renderPieceFinish=function(n,a){e.LastBoundBO&&e.LastBoundBO.getVAO().release(),e.renderable.getColorTextureMap()&&e.internalColorTexture.deactivate()},t.renderPiece=function(n,a){if(t.invokeEvent(Ax),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(Px),!e.currentInput){Gr("No input!");return}if(!(!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues())){var i=e.context,s=a.getProperty().getBackfaceCulling(),f=a.getProperty().getFrontfaceCulling();!s&&!f?e._openGLRenderWindow.disableCullFace():f?(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.FRONT)):(e._openGLRenderWindow.enableCullFace(),i.cullFace(i.BACK)),t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a)}},t.computeBounds=function(n,a){if(!t.getInput()){Ui(e.bounds);return}e.bounds=t.getInput().getBounds()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return i<t.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var f=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(f===Ya.USE_CELL_DATA||f===Ya.USE_CELL_FIELD_DATA||f===Ya.USE_FIELD_DATA||!i.getPointData().getScalars())&&f!==Ya.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var o=a.getProperty().getInterpolation()!==Tc.FLAT?i.getPointData().getNormals():null;o===null&&i.getCellData().getNormals()&&(e.haveCellNormals=!0,o=i.getCellData().getNormals());var u=a.getProperty().getRepresentation(),g=i.getPointData().getTCoords();if(e.openGLActor.getActiveTextures()||(g=null),e.renderable.getColorCoordinates()){g=e.renderable.getColorCoordinates(),e.internalColorTexture||(e.internalColorTexture=Or.newInstance());var c=e.internalColorTexture;c.setMinificationFilter(Cc.NEAREST),c.setMagnificationFilter(Cc.NEAREST),c.setWrapS(Sc.CLAMP_TO_EDGE),c.setWrapT(Sc.CLAMP_TO_EDGE),c.setOpenGLRenderWindow(e._openGLRenderWindow);var l=e.renderable.getColorTextureMap(),h=l.getExtent(),y=l.getPointData().getScalars();c.create2DFromRaw(h[1]-h[0]+1,h[3]-h[2]+1,y.getNumberOfComponents(),y.getDataType(),y.getData()),c.activate(),c.sendParameters(),c.deactivate()}var C="".concat(i.getMTime(),"A").concat(u,"B").concat(i.getMTime())+"C".concat(o?o.getMTime():1,"D").concat(s?s.getMTime():1)+"E".concat(a.getProperty().getEdgeVisibility())+"F".concat(g?g.getMTime():1);if(e.VBOBuildString!==C){var T=i.getPoints(),E={points:T,normals:o,tcoords:g,colors:s,cellOffset:0,vertexOffset:0,haveCellScalars:e.haveCellScalars,haveCellNormals:e.haveCellNormals,customAttributes:e.renderable.getCustomShaderAttributes().map(function(m){return i.getPointData().getArrayByName(m)})};e.renderable.getPopulateSelectionSettings()&&(e.selectionWebGLIdsToVTKIds={points:null,cells:null});for(var w=[{inRep:"verts",cells:i.getVerts()},{inRep:"lines",cells:i.getLines()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()},{inRep:"polys",cells:i.getPolys()},{inRep:"strips",cells:i.getStrips()}],x=a.getProperty().getEdgeVisibility()&&u===cn.SURFACE,S=Je.Start;S<Je.End;S++)S!==Je.TrisEdges&&S!==Je.TriStripsEdges?(E.cellOffset+=e.primitives[S].getCABO().createVBO(w[S].cells,w[S].inRep,u,E,e.selectionWebGLIdsToVTKIds),E.vertexOffset+=e.primitives[S].getCABO().getElementCount()):x?e.primitives[S].getCABO().createVBO(w[S].cells,w[S].inRep,cn.WIREFRAME,{points:T,normals:o,tcoords:null,colors:null,cellOffset:0,haveCellScalars:!1,haveCellNormals:!1}):e.primitives[S].releaseGraphicsResources();e.renderable.getPopulateSelectionSettings()&&(e.renderable.setSelectionWebGLIdsToVTKIds(e.selectionWebGLIdsToVTKIds),t.updateMaximumPointCellIds()),e.VBOBuildTime.modified(),e.VBOBuildString=C}}}}var $x={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightHalfAngle:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:ht.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function tp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,$x,r),Ie.extend(t,e,r),ep.implementReplaceShaderCoincidentOffset(t,e,r),e.primitives=[],e.primTypes=Je,e.tmpMat3=Jr(new Float64Array(9)),e.tmpMat4=De(new Float64Array(16));for(var n=Je.Start;n<Je.End;n++)e.primitives[n]=bn.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);gt(t,e,["context"]),e.VBOBuildTime={},yt(e.VBOBuildTime,{mtime:0}),e.selectionStateChanged={},yt(e.selectionStateChanged,{mtime:0}),jx(t,e)}var rp=Ue(tp,"vtkOpenGLPolyDataMapper"),np={newInstance:rp,extend:tp};Mt("vtkMapper",rp);var Hx=Lr.ColorMode,Ar=Lr.ScalarMode,Ns=Lr.GetArray;function Kx(t,e){e.classHierarchy.push("vtkMapper2D"),t.createDefaultLookupTable=function(){e.lookupTable=In.newInstance()},t.getColorModeAsString=function(){return L.enumToString(Hx,e.colorMode)},t.setColorModeToDefault=function(){return t.setColorMode(0)},t.setColorModeToMapScalars=function(){return t.setColorMode(1)},t.setColorModeToDirectScalars=function(){return t.setColorMode(2)},t.getScalarModeAsString=function(){return L.enumToString(Ar,e.scalarMode)},t.setScalarModeToDefault=function(){return t.setScalarMode(0)},t.setScalarModeToUsePointData=function(){return t.setScalarMode(1)},t.setScalarModeToUseCellData=function(){return t.setScalarMode(2)},t.setScalarModeToUsePointFieldData=function(){return t.setScalarMode(3)},t.setScalarModeToUseCellFieldData=function(){return t.setScalarMode(4)},t.setScalarModeToUseFieldData=function(){return t.setScalarMode(5)},t.getAbstractScalars=function(r,n,a,i,s){if(!r||!e.scalarVisibility)return{scalars:null,cellFLag:!1};var f=null,o=!1;if(n===Ar.DEFAULT)f=r.getPointData().getScalars(),f||(f=r.getCellData().getScalars(),o=!0);else if(n===Ar.USE_POINT_DATA)f=r.getPointData().getScalars();else if(n===Ar.USE_CELL_DATA)f=r.getCellData().getScalars(),o=!0;else if(n===Ar.USE_POINT_FIELD_DATA){var u=r.getPointData();a===Ns.BY_ID?f=u.getArrayByIndex(i):f=u.getArrayByName(s)}else if(n===Ar.USE_CELL_FIELD_DATA){var g=r.getCellData();o=!0,a===Ns.BY_ID?f=g.getArrayByIndex(i):f=g.getArrayByName(s)}else if(n===Ar.USE_FIELD_DATA){var c=r.getFieldData();a===Ns.BY_ID?f=c.getArrayByIndex(i):f=c.getArrayByName(s)}return{scalars:f,cellFlag:o}},t.getLookupTable=function(){return e.lookupTable||t.createDefaultLookupTable(),e.lookupTable},t.getMTime=function(){var r=e.mtime;if(e.lookupTable!==null){var n=e.lookupTable.getMTime();r=n>r?n:r}return r},t.mapScalars=function(r,n){var a=t.getAbstractScalars(r,e.scalarMode,e.arrayAccessMode,e.arrayId,e.colorByArrayName).scalars;if(!a){e.colorMapColors=null;return}var i="".concat(t.getMTime()).concat(a.getMTime()).concat(n);if(e.colorBuildString!==i){e.useLookupTableScalarRange||t.getLookupTable().setRange(e.scalarRange[0],e.scalarRange[1]);var s=t.getLookupTable();s&&(s.build(),e.colorMapColors=s.mapScalars(a,e.colorMode,e.fieldDataTupleId)),e.colorBuildString="".concat(t.getMTime()).concat(a.getMTime()).concat(n)}}}var Xx={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function ap(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Xx,r),ll.extend(t,e,r),L.get(t,e,["colorMapColors"]),L.setGet(t,e,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),L.setGetArray(t,e,["scalarRange"],2),e.viewSpecificProperties||(e.viewSpecificProperties={}),Kx(t,e)}var Yx=L.newInstance(ap,"vtkMapper2D"),Ix={newInstance:Yx,extend:ap},qx=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DFS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

uniform int PrimitiveIDOffset;

// Texture coordinates
//VTK::TCoord::Dec

// Scalar coloring
//VTK::Color::Dec

// Depth Peeling
//VTK::DepthPeeling::Dec

// picking support
//VTK::Picking::Dec

// the output of this shader
//VTK::Output::Dec

// Apple Bug
//VTK::PrimID::Dec

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  //VTK::Color::Impl
  //VTK::TCoord::Impl

  //VTK::DepthPeeling::Impl
  //VTK::Picking::Impl

  if (gl_FragData[0].a <= 0.0)
    {
    discard;
    }
}
`,Zx=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkPolyData2DVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/

// all variables that represent positions or directions have a suffix
// indicating the coordinate system they are in. The possible values are
// MC - Model Coordinates
// WC - WC world coordinates
// VC - View Coordinates
// DC - Display Coordinates

in vec4 vertexWC;

// frag position in VC
//VTK::PositionVC::Dec

// material property values
//VTK::Color::Dec

// Texture coordinates
//VTK::TCoord::Dec

// Apple Bug
//VTK::PrimID::Dec

uniform mat4 WCVCMatrix;  // World to view matrix

void main()
{
  // Apple Bug
  //VTK::PrimID::Impl

  gl_Position = WCVCMatrix*vertexWC;

  //VTK::TCoord::Impl

  //VTK::Color::Impl

  //VTK::PositionVC::Impl
}
`,ip={BACKGROUND:0,FOREGROUND:1},sp={DisplayLocation:ip},Ut=bn.primTypes,Ia=Ix.ScalarMode,qa=ve,Qx={type:"StartEvent"},Jx={type:"EndEvent"};function ew(t,e){e.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),t.buildPass=function(n){n&&(e.openGLActor2D=t.getFirstAncestorOfType("vtkOpenGLActor2D"),e.openGLRenderer=e.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.openGLCamera=e.openGLRenderer.getViewNodeFor(e.openGLRenderer.getRenderable().getActiveCamera()))},t.overlayPass=function(n){n&&t.render()},t.getShaderTemplate=function(n,a,i){var s=e.renderable.getViewSpecificProperties().OpenGL,f=Zx;if(s){var o=s.VertexShaderCode;o!==void 0&&o!==""&&(f=o)}n.Vertex=f;var u=qx;if(s){var g=s.FragmentShaderCode;g!==void 0&&g!==""&&(u=g)}n.Fragment=u;var c="";if(s){var l=s.GeometryShaderCode;l!==void 0&&(c=l)}n.Geometry=c},t.render=function(){var n=e._openGLRenderWindow.getContext();if(e.context!==n){e.context=n;for(var a=Ut.Start;a<Ut.End;a++)e.primitives[a].setOpenGLRenderWindow(e._openGLRenderWindow)}var i=e.openGLActor2D.getRenderable(),s=e.openGLRenderer.getRenderable();t.renderPiece(s,i)},t.renderPiece=function(n,a){if(t.invokeEvent(Qx),e.renderable.getStatic()||e.renderable.update(),e.currentInput=e.renderable.getInputData(),t.invokeEvent(Jx),!e.currentInput){qa("No input!");return}!e.currentInput.getPoints||!e.currentInput.getPoints().getNumberOfValues()||(t.renderPieceStart(n,a),t.renderPieceDraw(n,a),t.renderPieceFinish(n,a))},t.renderPieceStart=function(n,a){if(e.primitiveIDOffset=0,e.openGLRenderer.getSelector())switch(e.openGLRenderer.getSelector().getCurrentPass()){default:e.openGLRenderer.getSelector().renderProp(a)}t.updateBufferObjects(n,a),e.lastBoundBO=null},t.getNeedToRebuildShaders=function(n,a,i){return n.getShaderSourceTime().getMTime()<e.renderable.getMTime()||n.getShaderSourceTime().getMTime()<e.currentInput.getMTime()},t.updateBufferObjects=function(n,a){t.getNeedToRebuildBufferObjects(n,a)&&t.buildBufferObjects(n,a)},t.getNeedToRebuildBufferObjects=function(n,a){var i=e.VBOBuildTime.getMTime();return!!(i<t.getMTime()||i<e._openGLRenderWindow.getMTime()||i<e.renderable.getMTime()||i<a.getMTime()||i<e.currentInput.getMTime()||e.renderable.getTransformCoordinate()&&i<n.getMTime())},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,a.getProperty().getOpacity());var s=e.renderable.getColorMapColors();e.haveCellScalars=!1;var f=e.renderable.getScalarMode();e.renderable.getScalarVisibility()&&(f===Ia.USE_CELL_DATA||f===Ia.USE_CELL_FIELD_DATA||f===Ia.USE_FIELD_DATA||!i.getPointData().getScalars())&&f!==Ia.USE_POINT_FIELD_DATA&&s&&(e.haveCellScalars=!0);var o=a.getProperty().getRepresentation(),u=i.getPointData().getTCoords();e.openGLActor2D.getActiveTextures()||(u=null);var g=e.renderable.getTransformCoordinate(),c=n.getRenderWindow().getViews()[0],l=c.getViewportSize(n),h="".concat(i.getMTime(),"A").concat(o,"B").concat(i.getMTime())+"C".concat(s?s.getMTime():1)+"D".concat(u?u.getMTime():1)+"E".concat(g?n.getMTime():1)+"F".concat(l);if(e.VBOBuildString!==h){var y=i.getPoints();if(g){var C=Vi.newInstance(),T=y.getNumberOfPoints();C.setNumberOfPoints(T);for(var E=[],w=0;w<T;++w){y.getPoint(w,E),g.setValue(E);var x=g.getComputedDoubleViewportValue(n);C.setPoint(w,x[0],x[1],0)}y=C}var S={points:y,tcoords:u,colors:s,cellOffset:0,haveCellScalars:e.haveCellSCalars,customAttributes:e.renderable.getCustomShaderAttributes().map(function(m){return i.getPointData().getArrayByName(m)})};S.cellOffset+=e.primitives[Ut.Points].getCABO().createVBO(i.getVerts(),"verts",o,S),S.cellOffset+=e.primitives[Ut.Lines].getCABO().createVBO(i.getLines(),"lines",o,S),S.cellOffset+=e.primitives[Ut.Tris].getCABO().createVBO(i.getPolys(),"polys",o,S),S.cellOffset+=e.primitives[Ut.TriStrips].getCABO().createVBO(i.getStrips(),"strips",o,S),e.VBOBuildTime.modified(),e.VBOBuildString=h}}},t.renderPieceDraw=function(n,a){var i=a.getProperty().getRepresentation(),s=e.context;s.depthMask(!0);for(var f=Ut.Start;f<Ut.End;f++){var o=e.primitives[f].getCABO();o.getElementCount()&&(e.lastBoundBO=e.primitives[f],e.primitiveIDOffset+=e.primitives[f].drawArrays(n,a,i,t))}},t.renderPieceFinish=function(n,a){e.lastBoundBO&&e.lastBoundBO.getVAO().release()},t.buildShaders=function(n,a,i){t.getShaderTemplate(n,a,i);var s=e.renderable.getViewSpecificProperties().OpenGL,f=null;if(s&&(f=s.ShaderReplacements),f)for(var o=0;o<f.length;o++){var u=f[o];if(u.replaceFirst){var g=u.shaderType,c=n[g],l=$.substitute(c,u.originalValue,u.replacementValue,u.replaceAll);n[g]=l.result}}if(t.replaceShaderValues(n,a,i),f)for(var h=0;h<f.length;h++){var y=f[h];if(!y.replaceFirst){var C=y.shaderType,T=n[C],E=$.substitute(T,y.originalValue,y.replacementValue,y.replaceAll);n[C]=E.result}}},t.replaceShaderValues=function(n,a,i){t.replaceShaderColor(n,a,i),t.replaceShaderTCoord(n,a,i),t.replaceShaderPicking(n,a,i),t.replaceShaderPositionVC(n,a,i)},t.replaceShaderColor=function(n,a,i){var s=n.Vertex,f=n.Geometry,o=n.Fragment;e.haveCellScalars&&(o=$.substitute(o,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,o=$.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),e.lastBoundBO.getCABO().getColorComponents()!==0?(s=$.substitute(s,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,s=$.substitute(s,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,f=$.substitute(f,"//VTK::Color::Dec",[`in vec4 fcolorVSOutput[];
`,"out vec4 fcolorGSOutput;"]).result,f=$.substitute(f,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,o=$.substitute(o,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,o=$.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(o=$.substitute(o,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,o=$.substitute(o,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o},t.replaceShaderTCoord=function(n,a,i){if(e.lastBoundBO.getCABO().getTCoordOffset()){var s=n.Vertex,f=n.Geometry,o=n.Fragment,u=e.lastBoundBO.getCABO().getTCoordComponents();u===1?(s=$.substitute(s,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,s=$.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,f=$.substitute(f,"//VTK::TCoord::Dec",[`in float tcoordVCVSOutput[];
`,"out float tcoordVCGSOutput;"]).result,f=$.substitute(f,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,o=$.substitute(o,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o=$.substitute(o,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):u===2&&(s=$.substitute(s,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,s=$.substitute(s,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,f=$.substitute(f,"//VTK::TCoord::Dec",[`in vec2 tcoordVCVSOutput[];
`,"out vec2 tcoordVCGSOutput;"]).result,f=$.substitute(f,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,o=$.substitute(o,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o=$.substitute(o,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),e.haveCellScalars&&(f=$.substitute(f,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),n.Vertex=s,n.Geometry=f,n.Fragment=o}},t.replaceShaderPicking=function(n,a,i){var s=n.Fragment;s=$.substitute(s,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,s=$.substitute(s,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,n.Fragment=s},t.replaceShaderPositionVC=function(n,a,i){e.lastBoundBO.replaceShaderPositionVC(n,a,i)},t.invokeShaderCallbacks=function(n,a,i){var s=e.renderable.getViewSpecificProperties().ShadersCallbacks;s&&s.forEach(function(f){f.callback(f.userData,n,a,i)})},t.setMapperShaderParameters=function(n,a,i){if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",e.primitiveIDOffset),n.getProgram().isAttributeUsed("vertexWC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexWC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),e.context.FLOAT,3,!1)||qa("Error setting vertexWC in shader VAO.")),n.getCABO().getElementCount()&&(e.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){e.renderable.getCustomShaderAttributes().forEach(function(l,h){n.getProgram().isAttributeUsed("".concat(l,"MC"))&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"".concat(l,"MC"),n.getCABO().getCustomData()[h].offset,n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getCustomData()[h].components,!1)||qa("Error setting ".concat(l,"MC in shader VAO.")))}),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),e.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||qa("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),e.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",e.internalColorTexture.getTextureUnit());var s=e.openGLActor2D.getActiveTextures();if(s)for(var f=0;f<s.length;++f){var o=s[f],u=o.getTextureUnit(),g="texture".concat(u+1);n.getProgram().isUniformUsed(g)&&n.getProgram().setUniformi(g,u)}n.setMapperShaderParameters(a,i,e.openGLRenderer.getTiledSizeAndOrigin());var c=e.openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",c?c.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",c?c.getCurrentPass()+1:0)}},t.setPropertyShaderParameters=function(n,a,i){var s=e.renderable.getColorMapColors();if(!s||s.getNumberOfComponents()===0){var f=n.getProgram(),o=i.getProperty(),u=o.getOpacity(),g=o.getColor(),c=[g[0],g[1],g[2],u];f.setUniform4f("diffuseColor",c)}},t.setLightingShaderParameters=function(n,a,i){};function r(n,a,i){return a.identity(i),n.reduce(function(s,f,o){return o===0?f?a.copy(s,f):a.identity(s):f?a.multiply(s,s,f):s},i)}t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=n.getCABO().getCoordShiftAndScaleEnabled(),o=f?n.getCABO().getInverseShiftAndScaleMatrix():null,u=a.getRenderWindow().getViews()[0],g=u.getViewportSize(a),c=a.getViewport(),l=i.getActualPositionCoordinate().getComputedDoubleViewportValue(a),h=[0,0,1,1],y=[0,0,1,1];if(y[0]=c[0]>=h[0]?c[0]:h[0],y[1]=c[1]>=h[1]?c[1]:h[1],y[2]=c[2]<=h[2]?c[2]:h[2],y[3]=c[3]<=h[3]?c[3]:h[3],!(y[0]>=y[2])&&!(y[1]>=y[3])){g[0]=Wa(g[0]*(y[2]-y[0])/(c[2]-c[0])),g[1]=Wa(g[1]*(y[3]-y[1])/(c[3]-c[1]));var C=e.openGLRenderer.getParent().getSize(),T=Wa(l[0]-(y[0]-c[0])*C[0]),E=Wa(l[1]-(y[1]-c[1])*C[1]),w=-T,x=-T+g[0],S=-E,m=-E+g[1];w===x&&(x=w+1),S===m&&(m=S+1);var D=De(new Float64Array(16));D[0]=2/(x-w),D[1*4+1]=2/(m-S),D[0*4+3]=-1*(x+w)/(x-w),D[1*4+3]=-1*(m+S)/(m-S),D[2*4+2]=0,D[2*4+3]=i.getProperty().getDisplayLocation()===ip.FOREGROUND?-1:1,D[3*4+3]=1,We(D,D),s.setUniformMatrix("WCVCMatrix",r([D,o],Zs,e.tmpMat4))}}}var tw={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function rw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tw,r),Ie.extend(t,e,r),ep.implementReplaceShaderCoincidentOffset(t,e,r),e.primitives=[],e.primTypes=Ut,e.tmpMat4=De(new Float64Array(16));for(var n=Ut.Start;n<Ut.End;n++)e.primitives[n]=bn.newInstance(),e.primitives[n].setPrimitiveType(n),e.primitives[n].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);gt(t,e,["context"]),e.VBOBuildTime={},yt(e.VBOBuildTime,{mtime:0}),ew(t,e)}var nw=Ue(rw,"vtkOpenGLPolyDataMapper2D");Mt("vtkMapper2D",nw);function Ec(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ir(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ec(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ec(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var aw=Sl.VectorMode;function Us(t,e){t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeSize,t.fillStyle=e.fontColor,t.font="".concat(e.fontStyle," ").concat(e.fontSize,"px ").concat(e.fontFamily)}function op(t,e){return function(r){var n=r.getLastSize(),a=Math.pow(n[0]/700,.8),i=Math.pow(n[1]/700,.8),s=Math.min(a,i),f=r.getAxisTextStyle(),o=r.getTickTextStyle();Object.assign(f,e.axisTextStyle),Object.assign(o,e.tickTextStyle),f.fontSize=Math.max(24*s,12),r.getLastAspectRatio()>1?o.fontSize=Math.max(20*s,10):o.fontSize=Math.max(16*s,10);var u=r.updateTextureAtlas();r.setTopTitle(!1);var g=r.getBoxSizeByReference();if(r.getLastAspectRatio()>1)r.setTickLabelPixelOffset(.3*o.fontSize),u.titleWidth<=u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize?(r.setTopTitle(!0),r.setAxisTitlePixelOffset(.2*o.fontSize),g[0]=2*(u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize)/n[0],r.setBoxPosition([.98-g[0],-.92])):(r.setAxisTitlePixelOffset(.2*o.fontSize),g[0]=2*(u.titleHeight+r.getAxisTitlePixelOffset()+u.tickWidth+r.getTickLabelPixelOffset()+.8*o.fontSize)/n[0],r.setBoxPosition([.99-g[0],-.92])),g[1]=Math.max(1.2,Math.min(1.84/i,1.84));else{r.setAxisTitlePixelOffset(1.2*o.fontSize),r.setTickLabelPixelOffset(.1*o.fontSize);var c=2*(.8*o.fontSize+u.titleHeight+r.getAxisTitlePixelOffset())/n[1],l=2*u.tickWidth/n[0];g[0]=Math.min(1.9,Math.max(1.4,1.4*l*(r.getTicks().length+3))),g[1]=c,r.setBoxPosition([-.5*g[0],-.97])}r.recomputeBarSegments(u)}}function fp(t,e){return function(r){var n=r.getLastTickBounds(),a=$o().domain([n[0],n[1]]),i=a.ticks(5),s=a.tickFormat(5);r.setTicks(i),r.setTickStrings(i.map(s))}}function iw(t,e){e.classHierarchy.push("vtkScalarBarActorHelper"),t.setRenderable=function(a){e.renderable!==a&&(e.renderable=a,e.barActor.setProperty(a.getProperty()),e.barActor.setParentProp(a),e.barActor.setCoordinateSystemToDisplay(),e.tmActor.setProperty(a.getProperty()),e.tmActor.setParentProp(a),e.tmActor.setCoordinateSystemToDisplay(),e.generateTicks=a.generateTicks,e.axisTextStyle=ir({},a.getAxisTextStyle()),e.tickTextStyle=ir({},a.getTickTextStyle()),t.modified())},t.updateAPISpecificData=function(a,i,s){(e.lastSize[0]!==a[0]||e.lastSize[1]!==a[1])&&(e.lastSize[0]=a[0],e.lastSize[1]=a[1],e.lastAspectRatio=a[0]/a[1],e.forceUpdate=!0);var f=e.renderable.getScalarsToColors();if(!(!f||!e.renderable.getVisibility())&&(e.barMapper.setLookupTable(f),e.camera=i,e.renderWindow=s,e.forceUpdate||Math.max(f.getMTime(),t.getMTime(),e.renderable.getMTime())>e.lastRebuildTime.getMTime())){var o=f.getMappingRange();if(e.lastTickBounds=Ee(o),e.renderable.getGenerateTicks()(t),e.renderable.getAutomated())e.renderable.getAutoLayout()(t);else{e.axisTextStyle=ir({},e.renderable.getAxisTextStyle()),e.tickTextStyle=ir({},e.renderable.getTickTextStyle()),e.barPosition=Ee(e.renderable.getBarPosition()),e.barSize=Ee(e.renderable.getBarSize()),e.boxPosition=Ee(e.renderable.getBoxPosition()),e.boxSize=Ee(e.renderable.getBoxSize()),e.axisTitlePixelOffset=e.renderable.getAxisTitlePixelOffset(),e.tickLabelPixelOffset=e.renderable.getTickLabelPixelOffset();var u=t.updateTextureAtlas();t.recomputeBarSegments(u)}t.updatePolyDataForLabels(),t.updatePolyDataForBarSegments(),e.lastRebuildTime.modified(),e.forceUpdate=!1}},t.updateTextureAtlas=function(){e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left";var a={},i=new Map,s=0,f=1;Us(e.tmContext,e.axisTextStyle);var o=e.tmContext.measureText(e.renderable.getAxisLabel()),u={height:o.actualBoundingBoxAscent+2,startingHeight:f,width:o.width+2,textStyle:e.axisTextStyle};i.set(e.renderable.getAxisLabel(),u),f+=u.height,s=u.width,a.titleWidth=u.width,a.titleHeight=u.height,a.tickWidth=0,a.tickHeight=0,Us(e.tmContext,e.tickTextStyle);for(var g=[].concat(Ee(t.getTickStrings()),["NaN","Below","Above"]),c=0;c<g.length;c++)i.has(g[c])||(o=e.tmContext.measureText(g[c]),u={height:o.actualBoundingBoxAscent+2,startingHeight:f,width:o.width+2,textStyle:e.tickTextStyle},i.set(g[c],u),f+=u.height,s<u.width&&(s=u.width),a.tickWidth<u.width&&(a.tickWidth=u.width),a.tickHeight<u.height&&(a.tickHeight=u.height));return s=Pt(s),f=Pt(f),i.forEach(function(l){l.tcoords=[0,(f-l.startingHeight-l.height)/f,l.width/s,(f-l.startingHeight-l.height)/f,l.width/s,(f-l.startingHeight)/f,0,(f-l.startingHeight)/f]}),e.tmCanvas.width=s,e.tmCanvas.height=f,e.tmContext.textBaseline="bottom",e.tmContext.textAlign="left",e.tmContext.clearRect(0,0,s,f),i.forEach(function(l,h){Us(e.tmContext,l.textStyle),e.tmContext.fillText(h,1,l.startingHeight+l.height-1)}),e.tmTexture.setCanvas(e.tmCanvas),e.tmTexture.modified(),e._tmAtlas=i,a},t.computeBarSize=function(a){e.vertical=e.boxSize[1]>e.boxSize[0];var i=2*a.tickHeight/e.lastSize[1],s=[1,1];if(e.vertical){var f=2*(a.tickWidth+e.tickLabelPixelOffset)/e.lastSize[0];if(e.topTitle){var o=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0]-f,e.barSize[1]=e.boxSize[1]-o}else{var u=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[0];e.barSize[0]=e.boxSize[0]-u-f,e.barSize[1]=e.boxSize[1]}e.barPosition[0]=e.boxPosition[0]+f,e.barPosition[1]=e.boxPosition[1],s[1]=i}else{var g=(2*a.tickWidth-8)/e.lastSize[0],c=2*(a.titleHeight+e.axisTitlePixelOffset)/e.lastSize[1];e.barSize[0]=e.boxSize[0],e.barPosition[0]=e.boxPosition[0],e.barSize[1]=e.boxSize[1]-c,e.barPosition[1]=e.boxPosition[1],s[0]=g}return s},t.recomputeBarSegments=function(a){var i,s,f,o,u=t.computeBarSize(a);e.barSegments=[];var g=[0,0],c=e.vertical?1:0,l=e.vertical?.01:.02;function h(T,E){e.barSegments.push({corners:[[].concat(g),[g[0]+u[0],g[1]],[g[0]+u[0],g[1]+u[1]],[g[0],g[1]+u[1]]],scalars:E,title:T}),g[c]+=u[c]+l}e.renderable.getDrawNanAnnotation()&&e.renderable.getScalarsToColors().getNanColor()&&h("NaN",[NaN,NaN,NaN,NaN]),e.renderable.getDrawBelowRangeSwatch()&&(i=(s=e.renderable.getScalarsToColors()).getUseBelowRangeColor)!==null&&i!==void 0&&i.call(s)&&h("Below",[-.1,-.1,-.1,-.1]);var y=(f=(o=e.renderable.getScalarsToColors()).getUseAboveRangeColor)===null||f===void 0?void 0:f.call(o);g[c]+=l;var C=u[c];u[c]=y?1-2*l-u[c]-g[c]:1-l-g[c],h("ticks",e.vertical?[0,0,.995,.995]:[0,.995,.995,0]),e.renderable.getDrawAboveRangeSwatch()&&y&&(u[c]=C,g[c]+=l,h("Above",[1.1,1.1,1.1,1.1]))};var r=new Float64Array(3);t.createPolyDataForOneLabel=function(a,i,s,f,o,u){var g=e._tmAtlas.get(a);if(!!g){var c=u.ptIdx,l=u.cellIdx;r[0]=(.5*i[0]+.5)*e.lastSize[0],r[1]=(.5*i[1]+.5)*e.lastSize[1],r[2]=i[2],r[0]+=o[0],r[1]+=o[1];var h=[],y=f==="vertical"?[1,0]:[0,1];f==="vertical"?(h[0]=g.width,h[1]=-g.height,s[0]==="middle"?r[1]-=g.width/2:s[0]==="right"&&(r[1]-=g.width),s[1]==="middle"?r[0]+=g.height/2:s[1]==="top"&&(r[0]+=g.height)):(h[0]=g.width,h[1]=g.height,s[0]==="middle"?r[0]-=g.width/2:s[0]==="right"&&(r[0]-=g.width),s[1]==="middle"?r[1]-=g.height/2:s[1]==="top"&&(r[1]-=g.height)),u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[0],u.tcoords[c*2+1]=g.tcoords[1],c++,r[y[0]]+=h[0],u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[2],u.tcoords[c*2+1]=g.tcoords[3],c++,r[y[1]]+=h[1],u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[4],u.tcoords[c*2+1]=g.tcoords[5],c++,r[y[0]]-=h[0],u.points[c*3]=r[0],u.points[c*3+1]=r[1],u.points[c*3+2]=r[2],u.tcoords[c*2]=g.tcoords[6],u.tcoords[c*2+1]=g.tcoords[7],c++,u.polys[l*4]=3,u.polys[l*4+1]=c-4,u.polys[l*4+2]=c-3,u.polys[l*4+3]=c-2,l++,u.polys[l*4]=3,u.polys[l*4+1]=c-4,u.polys[l*4+2]=c-2,u.polys[l*4+3]=c-1,u.ptIdx+=4,u.cellIdx+=2}};var n=new Float64Array(3);t.updatePolyDataForLabels=function(){var a=t.getTickStrings().length+e.barSegments.length,i=a*4,s=a*2,f=new Float64Array(i*3),o=new Uint16Array(s*4),u=new Float32Array(i*2),g={ptIdx:0,cellIdx:0,polys:o,points:f,tcoords:u},c=e.vertical?0:1,l=e.vertical?1:0;n[2]=-.99;var h=e.vertical?["right","middle"]:["middle","bottom"],y=[0,1],C=[0,0];e.vertical?(C[0]=-e.tickLabelPixelOffset,e.topTitle?(n[0]=e.boxPosition[0]+.5*e.boxSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)):(n[0]=e.barPosition[0]+e.barSize[0],n[1]=e.barPosition[1]+.5*e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","top"],"vertical",[e.axisTitlePixelOffset,0],g)),y=[-1,0]):(C[1]=e.tickLabelPixelOffset,n[0]=e.barPosition[0]+.5*e.barSize[0],n[1]=e.barPosition[1]+e.barSize[1],t.createPolyDataForOneLabel(e.renderable.getAxisLabel(),n,["middle","bottom"],"horizontal",[0,e.axisTitlePixelOffset],g)),n[c]=e.barPosition[c]+(.5*y[c]+.5)*e.barSize[c],n[l]=e.barPosition[l]+e.barSize[l]*.5;for(var T=null,E=0;E<e.barSegments.length;E++){var w=e.barSegments[E];w.title==="ticks"?T=w:(n[l]=e.barPosition[l]+.5*e.barSize[l]*(w.corners[2][l]+w.corners[0][l]),t.createPolyDataForOneLabel(w.title,n,h,"horizontal",C,g))}for(var x=e.barPosition[l]+e.barSize[l]*T.corners[0][l],S=e.barSize[l]*(T.corners[2][l]-T.corners[0][l]),m=t.getTicks(),D=t.getTickStrings(),b=0;b<m.length;b++){var N=(m[b]-e.lastTickBounds[0])/(e.lastTickBounds[1]-e.lastTickBounds[0]);n[l]=x+S*N,t.createPolyDataForOneLabel(D[b],n,h,"horizontal",C,g)}var P=_e.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"});e.tmPolyData.getPointData().setTCoords(P),e.tmPolyData.getPoints().setData(f,3),e.tmPolyData.getPoints().modified(),e.tmPolyData.getPolys().setData(o,1),e.tmPolyData.getPolys().modified(),e.tmPolyData.modified()},t.updatePolyDataForBarSegments=function(){var a,i,s=e.renderable.getScalarsToColors(),f=0;e.renderable.getDrawNanAnnotation()&&s.getNanColor()&&(f+=1),e.renderable.getDrawBelowRangeSwatch()&&(a=s.getUseBelowRangeColor)!==null&&a!==void 0&&a.call(s)&&(f+=1),e.renderable.getDrawAboveRangeSwatch()&&(i=s.getUseAboveRangeColor)!==null&&i!==void 0&&i.call(s)&&(f+=1);var o=4*(1+f),u=o,g=1;s.getVectorMode()===aw.COMPONENT&&(g=s.getVectorComponent()+1);for(var c=new Float64Array(o*3),l=new Uint16Array(u*5),h=new Float32Array(o*g),y=0,C=0,T=0;T<e.barSegments.length;T++){for(var E=e.barSegments[T],w=0;w<4;w++){n[0]=e.barPosition[0]+E.corners[w][0]*e.barSize[0],n[1]=e.barPosition[1]+E.corners[w][1]*e.barSize[1],c[y*3]=(.5*n[0]+.5)*e.lastSize[0],c[y*3+1]=(.5*n[1]+.5)*e.lastSize[1],c[y*3+2]=n[2];for(var x=0;x<g;x++)h[y*g+x]=e.lastTickBounds[0]+E.scalars[w]*(e.lastTickBounds[1]-e.lastTickBounds[0]);y++}l[C*5]=4,l[C*5+1]=y-4,l[C*5+2]=y-3,l[C*5+3]=y-2,l[C*5+4]=y-1,C++}var S=_e.newInstance({numberOfComponents:g,values:h,name:"Scalars"});e.polyData.getPointData().setScalars(S),e.polyData.getPoints().setData(c,3),e.polyData.getPoints().modified(),e.polyData.getPolys().setData(l,1),e.polyData.getPolys().modified(),e.polyData.modified()}}var sw=L.newInstance(function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{renderable:null};Object.assign(e,{},r),L.obj(t,e),L.setGet(t,e,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),L.get(t,e,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),L.getArray(t,e,["boxPosition","boxSize"]),L.setArray(t,e,["boxPosition","boxSize"],2),e.forceUpdate=!1,e.lastRebuildTime={},L.obj(e.lastRebuildTime,{mtime:0}),e.lastSize=[-1,-1],e.tmCanvas=document.createElement("canvas"),e.tmContext=e.tmCanvas.getContext("2d"),e._tmAtlas=new Map,e.barMapper=Rr.newInstance(),e.barMapper.setInterpolateScalarsBeforeMapping(!0),e.barMapper.setUseLookupTableScalarRange(!0),e.polyData=fr.newInstance(),e.barMapper.setInputData(e.polyData),e.barActor=Dr.newInstance(),e.barActor.setMapper(e.barMapper),e.tmPolyData=fr.newInstance(),e.tmMapper=Rr.newInstance(),e.tmMapper.setInputData(e.tmPolyData),e.tmTexture=zi.newInstance(),e.tmTexture.setInterpolate(!1),e.tmActor=Dr.newInstance({parentProp:t}),e.tmActor.setMapper(e.tmMapper),e.tmActor.addTexture(e.tmTexture),e.barPosition=[0,0],e.barSize=[0,0],e.boxPosition=[.88,-.92],e.boxSize=[.1,1.1],e.lastTickBounds=[],iw(t,e)},"vtkScalarBarActorHelper");function ow(t,e){e.classHierarchy.push("vtkScalarBarActor"),t.setTickTextStyle=function(r){e.tickTextStyle=ir(ir({},e.tickTextStyle),r),t.modified()},t.setAxisTextStyle=function(r){e.axisTextStyle=ir(ir({},e.axisTextStyle),r),t.modified()},t.resetAutoLayoutToDefault=function(){t.setAutoLayout(op(t,e))},t.resetGenerateTicksToDefault=function(){t.setGenerateTicks(fp())}}function fw(t){return ir({automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0},t)}function up(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fw(r)),e.autoLayout||(e.autoLayout=op(t,e)),e.generateTicks||(e.generateTicks=fp()),Dr.extend(t,e,r),t.getProperty().setDiffuse(0),t.getProperty().setAmbient(1),L.setGet(t,e,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),L.get(t,e,["axisTextStyle","tickTextStyle"]),L.getArray(t,e,["barPosition","barSize","boxPosition","boxSize"]),L.setArray(t,e,["barPosition","barSize","boxPosition","boxSize"],2),ow(t,e)}var uw=L.newInstance(up,"vtkScalarBarActor"),cp={newInstance:uw,extend:up,newScalarBarActorHelper:sw};function cw(t,e){e.classHierarchy.push("vtkOpenGLScalarBarActor"),t.buildPass=function(r){r&&(e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.openGLRenderer?e.openGLRenderer.getRenderable().getActiveCamera():null,i=e.openGLRenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e._openGLRenderWindow.getRenderable())}}}var gw={};function vw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,gw,r),Ie.extend(t,e,r),e.scalarBarActorHelper=cp.newScalarBarActorHelper(),cw(t,e)}var lw=Ue(vw,"vtkOpenGLScalarBarActor");Mt("vtkScalarBarActor",lw);var xc=ve;function pw(t,e){e.classHierarchy.push("vtkOpenGLSkybox"),t.buildPass=function(r){if(r){e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent(),e.context=e._openGLRenderWindow.getContext(),e.tris.setOpenGLRenderWindow(e._openGLRenderWindow),e.openGLTexture.setOpenGLRenderWindow(e._openGLRenderWindow);var n=e.openGLRenderer.getRenderable();e.openGLCamera=e.openGLRenderer.getViewNodeFor(n.getActiveCamera())}},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;n.incrementOpaqueActorCount()}},t.opaquePass=function(r,n){if(r&&!e.openGLRenderer.getSelector()){t.updateBufferObjects(),e.context.depthMask(!0),e._openGLRenderWindow.getShaderCache().readyShaderProgram(e.tris.getProgram()),e.openGLTexture.render(e._openGLRenderWindow);var a=e.openGLTexture.getTextureUnit();e.tris.getProgram().setUniformi("sbtexture",a);var i=e.openGLRenderer.getRenderable(),s=e.openGLCamera.getKeyMatrices(i),f=new Float64Array(16);if(wt(f,s.wcpc),e.tris.getProgram().setUniformMatrix("IMCPCMatrix",f),e.lastFormat==="box"){var o=i.getActiveCamera().getPosition();e.tris.getProgram().setUniform3f("camPos",o[0],o[1],o[2])}e.tris.getVAO().bind(),e.context.drawArrays(e.context.TRIANGLES,0,e.tris.getCABO().getElementCount()),e.tris.getVAO().release(),e.openGLTexture.deactivate()}},t.updateBufferObjects=function(){if(!e.tris.getCABO().getElementCount()){for(var r=new Float32Array(12),n=0;n<4;n++)r[n*3]=n%2*2-1,r[n*3+1]=n>1?1:-1,r[n*3+2]=1;var a=_e.newInstance({numberOfComponents:3,values:r});a.setName("points");var i=new Uint16Array(8);i[0]=3,i[1]=0,i[2]=1,i[3]=3,i[4]=3,i[5]=0,i[6]=3,i[7]=2;var s=_e.newInstance({numberOfComponents:1,values:i});e.tris.getCABO().createVBO(s,"polys",bt.SURFACE,{points:a,cellOffset:0})}e.renderable.getFormat()!==e.lastFormat&&(e.lastFormat=e.renderable.getFormat(),e.lastFormat==="box"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec3 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = wpos.xyz/wpos.w;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec3 TexCoords;
             uniform samplerCube sbtexture;
             uniform vec3 camPos;
             void main () {
               // skybox looks from inside out
               // which means we have to adjust
               // our tcoords. Otherwise text would
               // be flipped
               vec3 tc = normalize(TexCoords - camPos);
               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))
               {
                 tc = vec3(1.0, 1.0, -1.0) * tc;
               }
               else
               {
                 tc = vec3(-1.0, 1.0, 1.0) * tc;
               }
               gl_FragData[0] = textureCube(sbtexture, tc);
             }`,"")),e.lastFormat==="background"&&e.tris.setProgram(e._openGLRenderWindow.getShaderCache().readyShaderProgramArray(`//VTK::System::Dec
             attribute vec3 vertexMC;
             uniform mat4 IMCPCMatrix;
             varying vec2 TexCoords;
             void main () {
              gl_Position = vec4(vertexMC.xyz, 1.0);
              vec4 wpos = IMCPCMatrix * gl_Position;
              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;
             }`,`//VTK::System::Dec
             //VTK::Output::Dec
             varying vec2 TexCoords;
             uniform sampler2D sbtexture;
             void main () {
               gl_FragData[0] = texture2D(sbtexture, TexCoords);
             }`,"")),e.tris.getShaderSourceTime().modified(),e.tris.getVAO().bind(),e.tris.getVAO().addAttributeArray(e.tris.getProgram(),e.tris.getCABO(),"vertexMC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),e.context.FLOAT,3,e.context.FALSE)||xc("Error setting vertexMC in shader VAO."));var f=e.renderable.getTextures();f.length||xc("vtkSkybox requires a texture map"),e.openGLTexture.getRenderable()!==f[0]&&(e.openGLTexture.releaseGraphicsResources(e._openGLRenderWindow),e.openGLTexture.setRenderable(f[0]))}}var hw={context:null};function yw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,hw,r),Ie.extend(t,e,r),e.openGLTexture=Or.newInstance(),e.tris=bn.newInstance(),e.keyMatrixTime={},yt(e.keyMatrixTime,{mtime:0}),e.keyMatrices={normalMatrix:Jr(new Float64Array(9)),mcwc:De(new Float64Array(16))},gt(t,e,["context"]),Ft(t,e,["activeTextures"]),pw(t,e)}var dw=Ue(yw);Mt("vtkSkybox",dw);var Tw=Mr;function Cw(t,e){e.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e.openGLRenderer=t.getFirstAncestorOfType("vtkOpenGLRenderer"),e._openGLRenderWindow=e.openGLRenderer.getParent();var a=e.openGLRenderer.getAspectRatio(),i=e.openGLRenderer?e.openGLRenderer.getRenderable().getActiveCamera():null,s=e.openGLRenderer.getTiledSizeAndOrigin(),f=null;if(e.renderable.getUseZValues()){var o=n.getZBufferTexture(),u=Math.floor(o.getWidth()),g=Math.floor(o.getHeight()),c=e._openGLRenderWindow.getContext();o.bind();var l=n.getFramebuffer();l?l.saveCurrentBindingsAndBuffers():Tw("No framebuffer to save/restore");var h=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,h),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o.getHandle(),0),c.checkFramebufferStatus(c.FRAMEBUFFER)===c.FRAMEBUFFER_COMPLETE&&(f=new Uint8Array(u*g*4),c.viewport(0,0,u,g),c.readPixels(0,0,u,g,c.RGBA,c.UNSIGNED_BYTE,f)),l&&l.restorePreviousBindingsAndBuffers(),c.deleteFramebuffer(h)}e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,f)},t.queryPass=function(r,n){r&&e.renderable.getUseZValues()&&n.requestDepth()}}var Sw={};function Ew(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Sw,r),Ie.extend(t,e,r),Cw(t,e)}var xw=Ue(Ew,"vtkOpenGLPixelSpaceCallbackMapper");Mt("vtkPixelSpaceCallbackMapper",xw);var gp=Object.create(null);function jt(t,e){gp[t]=e}function ww(t,e){e.classHierarchy.push("vtkWebGPUViewNodeFactory")}var Ow={};function Mw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ow,r),e.overrides=gp,ov.extend(t,e,r),ww(t,e)}L.newInstance(Mw,"vtkWebGPUViewNodeFactory");function Dw(t,e){e.classHierarchy.push("vtkWebGPUCamera"),t.getProjectionMatrix=function(r,n,a,i){if(De(r),e.renderable.getParallelProjection()){var s=e.renderable.getParallelScale(),f=s*n,o=s,u=(i[0]-1)*f,g=(i[0]+1)*f,c=(i[1]-1)*o,l=(i[1]+1)*o,h=1/(g-u),y=1/(l-c);r[0]=2*h,r[5]=2*y,r[10]=1/(a[1]-a[0]),r[12]=(g+u)*h,r[13]=(l+c)*y,r[14]=a[1]/(a[1]-a[0])}else{var C=Math.tan(Math.PI*e.renderable.getViewAngle()/360),T,E;e.renderable.getUseHorizontalViewAngle()===!0?(T=a[0]*C,E=a[0]*C/n):(T=a[0]*C*n,E=a[0]*C);var w=(i[0]-1)*T,x=(i[0]+1)*T,S=(i[1]-1)*E,m=(i[1]+1)*E;r[0]=2*a[0]/(x-w),r[5]=2*a[0]/(m-S),r[12]=(w+x)/(x-w),r[13]=(S+m)/(m-S),r[10]=0,r[14]=a[0],r[11]=-1,r[15]=0}},t.convertToOpenGLDepth=function(r){if(e.renderable.getParallelProjection())return 1-r;var n=e.renderable.getClippingRangeByReference(),a=-n[0]/r;return a=(n[0]+n[1])/(n[1]-n[0])+2*n[0]*n[1]/(a*(n[1]-n[0])),.5*a+.5},t.getKeyMatrices=function(r){var n=r.getRenderable(),a=r.getParent();if(Math.max(a.getMTime(),t.getMTime(),n.getMTime(),e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatrixTime.getMTime()){var i=e.renderable.getViewMatrix();ut(e.keyMatrices.normalMatrix,i),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,wt(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),We(e.keyMatrices.wcvc,i);var s=r.getStabilizedCenterByReference();et(e.keyMatrices.scvc,e.keyMatrices.wcvc,s);var f=r.getAspectRatio(),o=e.renderable.getClippingRangeByReference();t.getProjectionMatrix(e.keyMatrices.vcpc,f,o,e.renderable.getWindowCenterByReference()),Ct(e.keyMatrices.scpc,e.keyMatrices.vcpc,e.keyMatrices.scvc),wt(e.keyMatrices.pcsc,e.keyMatrices.scpc),e.keyMatrixTime.modified()}return e.keyMatrices}}var mw={keyMatrixTime:null,keyMatrices:null};function Rw(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mw,r),Ie.extend(t,e,r),e.keyMatrixTime={},L.obj(e.keyMatrixTime),e.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},L.setGet(t,e,["keyMatrixTime"]),Dw(t,e)}var Lw=L.newInstance(Rw);jt("vtkCamera",Lw);function Vw(t,e){e.classHierarchy.push("vtkWebGPUBindGroup"),t.setBindables=function(r){if(e.bindables.length===r.length){for(var n=!0,a=0;a<e.bindables.length;a++)e.bindables[a]!==r[a]&&(n=!1);if(n)return}e.bindables=r,t.modified()},t.getBindGroupLayout=function(r){for(var n=[],a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupLayoutEntry();i.binding=a,n.push(i)}return r.getBindGroupLayout({entries:n})},t.getBindGroup=function(r){for(var n=t.getMTime(),a=0;a<e.bindables.length;a++){var i=e.bindables[a].getBindGroupTime().getMTime();n=i>n?i:n}if(n<e.bindGroupTime.getMTime())return e.bindGroup;for(var s=[],f=0;f<e.bindables.length;f++){var o=e.bindables[f].getBindGroupEntry();o.binding=f,s.push(o)}return e.bindGroup=r.getHandle().createBindGroup({layout:t.getBindGroupLayout(r),entries:s,label:e.label}),e.bindGroupTime.modified(),e.bindGroup},t.getShaderCode=function(r){for(var n=[],a=r.getBindGroupLayoutCount(e.label),i=0;i<e.bindables.length;i++)n.push(e.bindables[i].getShaderCode(i,a));return n.join(`
`)}}var _w={device:null,handle:null,label:null};function vp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,_w,r),L.obj(t,e),e.bindables=[],e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),L.get(t,e,["bindGroupTime","handle","sizeInBytes","usage"]),L.setGet(t,e,["label","device","arrayInformation"]),Vw(t,e)}var bw=L.newInstance(vp),lp={newInstance:bw,extend:vp};function kw(t,e){e.classHierarchy.push("vtkWebGPUShaderModule"),t.initialize=function(r,n){e.device=r,e.handle=e.device.getHandle().createShaderModule({code:n.getCode()})}}var Fw={device:null,handle:null};function pp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Fw,r),L.obj(t,e),L.get(t,e,["lastCameraMTime"]),L.setGet(t,e,["device","handle"]),kw(t,e)}var Bw=L.newInstance(pp,"vtkWebGPUShaderModule"),Nw={newInstance:Bw,extend:pp};function Uw(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=Array.isArray(r)?r.join(`
`):r,i=!1;t.search(e)!==-1&&(i=!0);var s="";n&&(s="g");var f=new RegExp(e,s),o=t.replace(f,a);return{replace:i,result:o}}function Gw(t,e){e.classHierarchy.push("vtkWebGPUShaderCache"),t.getShaderModule=function(r){for(var n=r.getType(),a=r.getHash(),i=e._shaderModules.keys(),s=0;s<i.length;s++){var f=i[s];if(f.getHash()===a&&f.getType()===n)return e._shaderModules.get(f)}var o=Nw.newInstance();return o.initialize(e.device,r),e._shaderModules.set(r,o),o}}var Aw={shaderModules:null,device:null,window:null};function hp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Aw,r),e._shaderModules=new Map,L.obj(t,e),L.setGet(t,e,["device","window"]),Gw(t,e)}var Pw=L.newInstance(hp,"vtkWebGPUShaderCache"),Fe={newInstance:Pw,extend:hp,substitute:Uw};function Ww(t,e){e.classHierarchy.push("vtkWebGPUPipeline"),t.getShaderDescriptions=function(){return e.shaderDescriptions},t.initialize=function(r,n){e.pipelineDescription=e.renderEncoder.getPipelineSettings(),e.pipelineDescription.primitive.topology=e.topology,e.pipelineDescription.vertex=e.vertexState,e.pipelineDescription.label=n;for(var a=[],i=0;i<e.layouts.length;i++)a.push(e.layouts[i].layout);e.pipelineLayout=r.getHandle().createPipelineLayout({bindGroupLayouts:a}),e.pipelineDescription.layout=e.pipelineLayout;for(var s=0;s<e.shaderDescriptions.length;s++){var f=e.shaderDescriptions[s],o=r.getShaderModule(f);f.getType()==="vertex"&&(e.pipelineDescription.vertex.module=o.getHandle(),e.pipelineDescription.vertex.entryPoint="main"),f.getType()==="fragment"&&(e.pipelineDescription.fragment.module=o.getHandle(),e.pipelineDescription.fragment.entryPoint="main")}e.handle=r.getHandle().createRenderPipeline(e.pipelineDescription)},t.getShaderDescription=function(r){for(var n=0;n<e.shaderDescriptions.length;n++)if(e.shaderDescriptions[n].getType()===r)return e.shaderDescriptions[n];return null},t.addBindGroupLayout=function(r){!r||e.layouts.push({layout:r.getBindGroupLayout(e.device),label:r.getLabel()})},t.getBindGroupLayout=function(r){return e.layouts[r].layout},t.getBindGroupLayoutCount=function(r){for(var n=0;n<e.layouts.length;n++)if(e.layouts[n].label===r)return n;return 0},t.bindVertexInput=function(r,n){n.bindBuffers(r)}}var zw={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function yp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zw,r),yt(t,e),e.layouts=[],e.shaderDescriptions=[],Ft(t,e,["handle","pipelineDescription"]),gt(t,e,["device","renderEncoder","topology","vertexState"]),Ww(t,e)}var jw=Ue(yp,"vtkWebGPUPipeline"),$w={newInstance:jw,extend:yp};function Hw(t,e){e.classHierarchy.push("vtkWebGPUShaderDescription"),t.hasOutput=function(r){return e.outputNames.includes(r)},t.addOutput=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;e.outputTypes.push(r),e.outputNames.push(n),e.outputInterpolations.push(a)},t.addBuiltinOutput=function(r,n){e.builtinOutputTypes.push(r),e.builtinOutputNames.push(n)},t.addBuiltinInput=function(r,n){e.builtinInputTypes.push(r),e.builtinInputNames.push(n)},t.replaceShaderCode=function(r,n){var a=[],i=[];if(n&&a.push(n.getShaderCode()),r||e.builtinInputNames.length){var s=[];if(s.push("struct ".concat(e.type,`Input
{`)),r)for(var f=r.getOutputNamesByReference(),o=r.getOutputTypesByReference(),u=r.getOutputInterpolationsByReference(),g=0;g<f.length;g++)u[g]!==void 0?s.push("  @location(".concat(g,") @interpolate(").concat(u[g],") ").concat(f[g]," : ").concat(o[g],",")):s.push("  @location(".concat(g,") ").concat(f[g]," : ").concat(o[g],","));for(var c=0;c<e.builtinInputNames.length;c++)s.push("  ".concat(e.builtinInputNames[c]," : ").concat(e.builtinInputTypes[c],","));s.length>1&&(s.push("};"),i=s,a[a.length-1]+=",",a.push("input: ".concat(e.type,"Input")))}if(a.length&&(e.code=Fe.substitute(e.code,"//VTK::IOStructs::Input",a).result),e.outputNames.length+e.builtinOutputNames.length){for(var l=["struct ".concat(e.type,`Output
{`)],h=0;h<e.outputNames.length;h++)e.outputInterpolations[h]!==void 0?l.push("  @location(".concat(h,") @interpolate(").concat(e.outputInterpolations[h],") ").concat(e.outputNames[h]," : ").concat(e.outputTypes[h],",")):l.push("  @location(".concat(h,") ").concat(e.outputNames[h]," : ").concat(e.outputTypes[h],","));for(var y=0;y<e.builtinOutputNames.length;y++)l.push("  ".concat(e.builtinOutputNames[y]," : ").concat(e.builtinOutputTypes[y],","));l.push("};"),i=i.concat(l),e.code=Fe.substitute(e.code,"//VTK::IOStructs::Output",["-> ".concat(e.type,"Output")]).result}e.code=Fe.substitute(e.code,"//VTK::IOStructs::Dec",i).result}}var Kw={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function dp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Kw,r),e.outputNames=[],e.outputTypes=[],e.outputInterpolations=[],e.builtinOutputNames=[],e.builtinOutputTypes=[],e.builtinInputNames=[],e.builtinInputTypes=[],L.obj(t,e),L.setGet(t,e,["type","hash","code"]),L.getArray(t,e,["outputTypes","outputNames","outputInterpolations"]),Hw(t,e)}var Xw=L.newInstance(dp,"vtkWebGPUShaderDescription"),wc={newInstance:Xw,extend:dp},Oc={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};function Yw(t){return!t||t.length<6?0:t in Oc?Oc[t]:(ve("unknown format ".concat(t)),null)}function Iw(t){if(!t||t.length<5)return 0;var e=1;t[t.length-2]==="x"&&(e=Number(t[t.length-1]));var r=e===1?t.length-1:t.length-3,n=Number(t[r]);if(Number.isNaN(n))return ve("unknown format ".concat(t)),0;var a=5-n/2;return e*a}function qw(t){if(!t||t.length<5)return 0;var e=1;return t[t.length-2]==="x"&&(e=Number(t[t.length-1])),e}function Zw(t){if(!t||t.length<5)return 0;var e;if(t[0]==="f")e="Float";else if(t[0]==="s")e="Int";else if(t[0]==="u")e="Uint";else{ve("unknown format ".concat(t));return}var r=t.split("x")[0],n=Number(r[r.length-1]);if(Number.isNaN(n)){ve("unknown format ".concat(t));return}return e+=8*(5-n/2),e+="Array",e}function Qw(t){var e;if(t[0]==="f"||t[1]==="n")e="f32";else if(t[0]==="s"&&t[1]==="i")e="i32";else if(t[0]==="u"&&t[1]==="i")e="u32";else{ve("unknown format ".concat(t));return}var r=1;return t[t.length-2]==="x"&&(r=Number(t[t.length-1])),r===4?"vec4<".concat(e,">"):r===3?"vec3<".concat(e,">"):r===2?"vec2<".concat(e,">"):e}function Jw(t){if(!t)return 0;var e=1;t.substring(0,3)==="vec"?e=Number(t[3]):t.substring(0,3)==="mat"&&(e=t[3]*t[5]);var r=4;return e*r}function eO(t){if(!!t){if(t.includes("f32"))return"Float32Array";if(t.includes("i32"))return"Int32Array";if(t.includes("u32"))return"Uint32Array";ve("unknown format ".concat(t))}}var ot={getDetailsFromTextureFormat:Yw,getByteStrideFromBufferFormat:Iw,getNumberOfComponentsFromBufferFormat:qw,getNativeTypeFromBufferFormat:Zw,getShaderTypeFromBufferFormat:Qw,getByteStrideFromShaderFormat:Jw,getNativeTypeFromShaderFormat:eO};function tO(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!e.includes(t[r]))return!1;return!0}function rO(t,e){e.classHierarchy.push("vtkWebGPUVertexInput"),t.addBuffer=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"vertex",i=n;Array.isArray(i)||(i=[i]);for(var s=0;s<e.inputs.length;s++)if(tO(e.inputs[s].names,i)){if(e.inputs[s].buffer===r)return;e.inputs[s].buffer=r;return}e.inputs.push({buffer:r,stepMode:a,names:i}),e.inputs=e.inputs.sort(function(f,o){return f.names[0]<o.names[0]?-1:f.names[0]>o.names[0]?1:0})},t.removeBufferIfPresent=function(r){for(var n=0;n<e.inputs.length;n++)e.inputs[n].names.includes(r)&&e.inputs.splice(n,1)},t.getBuffer=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer;return null},t.hasAttribute=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return!0;return!1},t.getAttributeTime=function(r){for(var n=0;n<e.inputs.length;n++)if(e.inputs[n].names.includes(r))return e.inputs[n].buffer.getSourceTime();return 0},t.getShaderCode=function(){for(var r="",n=0,a=0;a<e.inputs.length;a++)for(var i=0;i<e.inputs[a].names.length;i++){var s=e.inputs[a].buffer.getArrayInformation()[i],f=ot.getShaderTypeFromBufferFormat(s.format);n>0&&(r+=`,
`),r="".concat(r,"  @location(").concat(n,") ").concat(e.inputs[a].names[i]," : ").concat(f),n++}return r},t.getVertexInputInformation=function(){var r={};if(e.inputs.length){for(var n=[],a=0,i=0;i<e.inputs.length;i++){for(var s=e.inputs[i].buffer,f={arrayStride:s.getStrideInBytes(),stepMode:e.inputs[i].stepMode,attributes:[]},o=s.getArrayInformation(),u=0;u<e.inputs[i].names.length;u++)f.attributes.push({shaderLocation:a,offset:o[u].offset,format:o[u].format}),a++;n.push(f)}r.buffers=n}return r},t.bindBuffers=function(r){for(var n=0;n<e.inputs.length;n++)r.setVertexBuffer(n,e.inputs[n].buffer.getHandle());e.indexBuffer&&r.setIndexBuffer(e.indexBuffer.getHandle(),e.indexBuffer.getArrayInformation()[0].format)},t.getReady=function(){},t.releaseGraphicsResources=function(){e.created&&(e.inputs=[],e.bindingDescriptions=[],e.attributeDescriptions=[])}}var nO={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function Tp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,nO,r),yt(t,e),e.bindingDescriptions=[],e.attributeDescriptions=[],e.inputs=[],gt(t,e,["created","device","handle","indexBuffer"]),rO(t,e)}var aO=Ue(Tp,"vtkWebGPUVertexInput"),iO={newInstance:aO,extend:Tp},sO=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  // var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,oO=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::Light::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);

  //VTK::RenderEncoder::Impl
  return output;
}
`;function fO(t,e){e.classHierarchy.push("vtkWebGPUSimpleMapper"),t.generateShaderDescriptions=function(r,n,a){var i=wc.newInstance({type:"vertex",hash:r,code:e.vertexShaderTemplate}),s=wc.newInstance({type:"fragment",hash:r,code:e.fragmentShaderTemplate}),f=n.getShaderDescriptions();f.push(i),f.push(s);for(var o=e.vertexShaderTemplate+e.fragmentShaderTemplate,u=new RegExp("//VTK::[^:]*::","g"),g=o.match(u).filter(function(y,C,T){return T.indexOf(y)===C}),c=g.map(function(y){return"replaceShader".concat(y.substring(7,y.length-2))}),l=0;l<c.length;l++){var h=c[l];h!=="replaceShaderIOStructs"&&e.shaderReplacements.has(h)&&e.shaderReplacements.get(h)(r,n,a)}t.replaceShaderIOStructs(r,n,a)},t.replaceShaderIOStructs=function(r,n,a){var i=n.getShaderDescription("vertex");i.replaceShaderCode(null,a);var s=n.getShaderDescription("fragment");s.replaceShaderCode(i)},t.replaceShaderRenderEncoder=function(r,n,a){e.renderEncoder.replaceShaderCode(n)},e.shaderReplacements.set("replaceShaderRenderEncoder",t.replaceShaderRenderEncoder),t.replaceShaderRenderer=function(r,n,a){if(!!e.WebGPURenderer){var i=e.WebGPURenderer.getBindGroup().getShaderCode(n),s=n.getShaderDescription("vertex"),f=s.getCode();f=Fe.substitute(f,"//VTK::Renderer::Dec",[i]).result,s.setCode(f);var o=n.getShaderDescription("fragment");f=o.getCode(),f=Fe.substitute(f,"//VTK::Renderer::Dec",[i]).result,o.setCode(f)}},e.shaderReplacements.set("replaceShaderRenderer",t.replaceShaderRenderer),t.replaceShaderMapper=function(r,n,a){var i=e.bindGroup.getShaderCode(n),s=n.getShaderDescription("vertex"),f=s.getCode();f=Fe.substitute(f,"//VTK::Mapper::Dec",[i]).result,s.setCode(f);var o=n.getShaderDescription("fragment");o.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),f=o.getCode(),f=Fe.substitute(f,"//VTK::Mapper::Dec",[i]).result,o.setCode(f)},e.shaderReplacements.set("replaceShaderMapper",t.replaceShaderMapper),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var s=i.getCode();s=Fe.substitute(s,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderTCoord=function(r,n,a){var i=n.getShaderDescription("vertex");i.addOutput("vec2<f32>","tcoordVS")},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.addTextureView=function(r){e.textureViews.includes(r)||e.textureViews.push(r)},t.prepareToDraw=function(r){e.renderEncoder=r,t.updateInput(),t.updateBuffers(),t.updateBindings(),t.updatePipeline()},t.updateInput=function(){},t.updateBuffers=function(){},t.updateBindings=function(){e.bindGroup.setBindables(t.getBindables())},t.computePipelineHash=function(){},t.registerDrawCallback=function(r){r.registerDrawCallback(e.pipeline,t.draw)},t.prepareAndDraw=function(r){t.prepareToDraw(r),r.setPipeline(e.pipeline),t.draw(r)},t.draw=function(r){var n=r.getBoundPipeline();r.activateBindGroup(e.bindGroup),e.WebGPURenderer&&e.WebGPURenderer.bindUBO(r),n.bindVertexInput(r,e.vertexInput);var a=e.vertexInput.getIndexBuffer();a?r.drawIndexed(a.getIndexCount(),e.numberOfInstances,0,0,0):r.draw(e.numberOfVertices,e.numberOfInstances,0,0)},t.getBindables=function(){var r=Ee(e.additionalBindables);e.UBO&&r.push(e.UBO),e.SSBO&&r.push(e.SSBO);for(var n=0;n<e.textureViews.length;n++){r.push(e.textureViews[n]);var a=e.textureViews[n].getSampler();a&&r.push(a)}return r},t.updatePipeline=function(){t.computePipelineHash(),e.pipeline=e.device.getPipeline(e.pipelineHash),e.pipeline||(e.pipeline=$w.newInstance(),e.pipeline.setDevice(e.device),e.WebGPURenderer&&e.pipeline.addBindGroupLayout(e.WebGPURenderer.getBindGroup()),e.pipeline.addBindGroupLayout(e.bindGroup),t.generateShaderDescriptions(e.pipelineHash,e.pipeline,e.vertexInput),e.pipeline.setTopology(e.topology),e.pipeline.setRenderEncoder(e.renderEncoder),e.pipeline.setVertexState(e.vertexInput.getVertexInputInformation()),e.device.createPipeline(e.pipelineHash,e.pipeline))}}var uO={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function Cp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uO,r),Ie.extend(t,e,r),e.textureViews=[],e.vertexInput=iO.newInstance(),e.bindGroup=lp.newInstance({label:"mapperBG"}),e.additionalBindables=[],e.fragmentShaderTemplate=e.fragmentShaderTemplate||oO,e.vertexShaderTemplate=e.vertexShaderTemplate||sO,e.shaderReplacements=new Map,L.get(t,e,["pipeline","vertexInput"]),L.setGet(t,e,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),fO(t,e)}var cO=L.newInstance(Cp,"vtkWebGPUSimpleMapper"),Sp={newInstance:cO,extend:Cp};function gO(t,e){e.classHierarchy.push("vtkWebGPUFullScreenQuad"),t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();s=Fe.substitute(s,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.updateBuffers=function(){var r=e.device.getBufferManager().getFullScreenQuadBuffer();e.vertexInput.addBuffer(r,["vertexBC"]),e.numberOfVertices=6}}var vO={};function Ep(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,vO,r),Sp.extend(t,e,r),gO(t,e)}var lO=L.newInstance(Ep,"vtkWebGPUFullScreenQuad"),Mc={newInstance:lO,extend:Ep},pO={Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},hO={Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6},xa={BufferUsage:pO,PrimitiveTypes:hO};function Dc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function yO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Gs=["getMappedRange","mapAsync","unmap"];function dO(t,e,r,n){var a=n.byteLength,i=t.createBuffer({size:a,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),s=i.getMappedRange(0,a);new Uint8Array(s).set(new Uint8Array(n)),i.unmap();var f=t.createCommandEncoder();f.copyBufferToBuffer(i,0,e,r,a);var o=f.finish(),u=t.queue;u.submit([o]),i.destroy()}function TO(t,e){e.classHierarchy.push("vtkWebGPUBuffer"),t.create=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a,usage:i,label:e.label}),e.sizeInBytes=a,e.usage=i},t.write=function(a){dO(e.device.getHandle(),e.handle,0,a.buffer)},t.createAndWrite=function(a,i){e.handle=e.device.getHandle().createBuffer({size:a.byteLength,usage:i,mappedAtCreation:!0,label:e.label}),e.sizeInBytes=a.byteLength,e.usage=i,new Uint8Array(e.handle.getMappedRange()).set(new Uint8Array(a.buffer)),e.handle.unmap()};for(var r=function(i){t[Gs[i]]=function(){var s;return(s=e.handle)[Gs[i]].apply(s,arguments)}},n=0;n<Gs.length;n++)r(n)}var CO={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function xp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CO,r),L.obj(t,e),L.get(t,e,["handle","sizeInBytes","usage"]),L.setGet(t,e,["strideInBytes","device","arrayInformation","label","sourceTime"]),TO(t,e)}var SO=L.newInstance(xp),wo=yO({newInstance:SO,extend:xp},xa);function mc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function EO(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Rc=Vn.Representation,Sr=xa.PrimitiveTypes,xO=function(){function t(){No(this,t),this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}return Uo(t,[{key:"clear",value:function(){this.count=0}},{key:"has",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return!0}},{key:"get",value:function(r){for(var n=0;n<this.count;n++)if(this.keys[n]===r)return this.values[n]}},{key:"set",value:function(r,n){this.count<9&&(this.keys[this.count]=r,this.values[this.count++]=n)}}]),t}();function wO(t){switch(t){case Sr.Points:return"points";case Sr.Lines:return"lines";case Sr.Triangles:case Sr.TriangleEdges:return"polys";case Sr.TriangleStripEdges:case Sr.TriangleStrips:return"strips";default:return""}}function Za(t,e,r){var n=t.pointIdToFlatId[e];return n<0&&(n=t.flatId,t.pointIdToFlatId[e]=n,t.flatIdToPointId[t.flatId]=e,t.flatIdToCellId[t.flatId]=r,t.flatId++),n}function OO(t,e,r){for(var n=t.length,a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i)){r.ibo[r.iboId++]=r.cellProvokedMap.get(i);for(var s=a+1;s<a+n;s++){i=t[s%n];var f=Za(r,i,e);r.ibo[r.iboId++]=f}return}}for(var o=0;o<n;o++){var u=t[o];if(!r.provokedPointIds[u]){var g=Za(r,u,e);r.provokedPointIds[u]=1,r.cellProvokedMap.set(u,g),r.flatIdToCellId[g]=e,r.ibo[r.iboId++]=g;for(var c=o+1;c<o+n;c++)u=t[c%n],g=Za(r,u,e),r.ibo[r.iboId++]=g;return}}var l=t[0],h=r.flatId;r.cellProvokedMap.set(l,h),r.flatIdToPointId[r.flatId]=l,r.flatIdToCellId[r.flatId]=e,r.flatId++,r.ibo[r.iboId++]=h;for(var y=1;y<n;y++)l=t[y],h=Za(r,l,e),r.ibo[r.iboId++]=h}function MO(t,e,r){var n=t.length;r.iboSize+=n;for(var a=0;a<n;a++){var i=t[a];if(r.cellProvokedMap.has(i))return}for(var s=0;s<n;s++){var f=t[s];if(!r.provokedPointIds[f]){r.provokedPointIds[f]=1,r.cellProvokedMap.set(f,1);return}}r.cellProvokedMap.set(t[0],1),r.extraPoints++}var rr,Lc=new Uint32Array(1),Rt=new Uint32Array(2),pr=new Uint32Array(3),As={anythingToPoints:function(e,r,n,a,i){for(var s=0;s<e;++s)Lc[0]=r[n+s],rr(Lc,a,i)},linesToWireframe:function(e,r,n,a,i){for(var s=0;s<e-1;++s)Rt[0]=r[n+s],Rt[1]=r[n+s+1],rr(Rt,a,i)},polysToWireframe:function(e,r,n,a,i){if(e>2)for(var s=0;s<e;++s)Rt[0]=r[n+s],Rt[1]=r[n+(s+1)%e],rr(Rt,a,i)},stripsToWireframe:function(e,r,n,a,i){if(e>2){for(var s=0;s<e-1;++s)Rt[0]=r[n+s],Rt[1]=r[n+s+1],rr(Rt,a,i);for(var f=0;f<e-2;f++)Rt[0]=r[n+f],Rt[1]=r[n+f+2],rr(Rt,a,i)}},polysToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)pr[0]=r[n],pr[1]=r[n+s+1],pr[2]=r[n+s+2],rr(pr,a,i)},stripsToSurface:function(e,r,n,a,i){for(var s=0;s<e-2;s++)pr[0]=r[n+s],pr[1]=r[n+s+1+s%2],pr[2]=r[n+s+1+(s+1)%2],rr(pr,a,i)}};function DO(t,e){e.classHierarchy.push("vtkWebGPUIndexBuffer"),t.buildIndexBuffer=function(r){var n=r.cells,a=r.primitiveType,i=r.representation,s=r.cellOffset,f=n.getData(),o=f.length,u=wO(a),g=r.numberOfPoints,c={provokedPointIds:new Uint8Array(g),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new xO},l=null;i===Rc.POINTS||a===Sr.Points?l=As.anythingToPoints:i===Rc.WIREFRAME||a===Sr.Lines?l=As["".concat(u,"ToWireframe")]:l=As["".concat(u,"ToSurface")],rr=MO;for(var h=s||0,y=0;y<o;)c.cellProvokedMap.clear(),l(f[y],f,y+1,h,c),y+=f[y]+1,h++;g<=65535?c.flatIdToPointId=new Uint16Array(g+c.extraPoints):c.flatIdToPointId=new Uint32Array(g+c.extraPoints),g+c.extraPoints<36863?c.pointIdToFlatId=new Int16Array(g):c.pointIdToFlatId=new Int32Array(g),g+c.extraPoints<=65535?(c.ibo=new Uint16Array(c.iboSize),r.format="uint16"):(c.ibo=new Uint32Array(c.iboSize),r.format="uint32"),h<=65535?c.flatIdToCellId=new Uint16Array(g+c.extraPoints):c.flatIdToCellId=new Uint32Array(g+c.extraPoints),c.pointIdToFlatId.fill(-1),c.provokedPointIds.fill(0),rr=OO,h=s||0;for(var C=0;C<o;)c.cellProvokedMap.clear(),l(f[C],f,C+1,h,c),C+=f[C]+1,h++;delete c.provokedPointIds,delete c.pointIdToFlatId,r.nativeArray=c.ibo,e.flatIdToPointId=c.flatIdToPointId,e.flatIdToCellId=c.flatIdToCellId,e.flatSize=c.flatId,e.indexCount=c.iboId}}var mO={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function wp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mO,r),wo.extend(t,e,r),L.setGet(t,e,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),DO(t,e)}var RO=L.newInstance(wp),LO=EO({newInstance:RO,extend:wp},xa);function Vc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var hr=xa.BufferUsage,VO=ve,Pr=_e.VtkDataTypes,_O={};function bO(t){var e;switch(t.getDataType()){case Pr.UNSIGNED_CHAR:e="uint8";break;case Pr.FLOAT:e="float32";break;case Pr.UNSIGNED_INT:e="uint32";break;case Pr.INT:e="sint32";break;case Pr.DOUBLE:e="float32";break;case Pr.UNSIGNED_SHORT:e="uint16";break;case Pr.SHORT:e="sin16";break;default:e="float32";break}switch(t.getNumberOfComponents()){case 2:e+="x2";break;case 3:e.includes("32")||VO("unsupported x3 type for ".concat(e)),e+="x3";break;case 4:e+="x4";break}return e}function bc(t,e,r,n,a){var i={},s=t.getFlatSize();if(!s)return i;var f=[0,0,0,0];a.shift&&(a.shift.length?f=a.shift:f.fill(a.shift));var o=[1,1,1,1];a.scale&&(a.scale.length?o=a.scale:o.fill(a.scale));var u=Object.prototype.hasOwnProperty.call(a,"packExtra")?a.packExtra:!1,g,c=0,l=r+(u?1:0),h=Ta(n,s*l),y=t.getFlatIdToPointId();a.cellData&&(y=t.getFlatIdToCellId()),r===1?g=function(w){h[c++]=o[0]*e[w]+f[0]}:r===2?g=function(w){h[c++]=o[0]*e[w]+f[0],h[c++]=o[1]*e[w+1]+f[1]}:r===3&&!u?g=function(w){h[c++]=o[0]*e[w]+f[0],h[c++]=o[1]*e[w+1]+f[1],h[c++]=o[2]*e[w+2]+f[2]}:r===3&&u?g=function(w){h[c++]=o[0]*e[w]+f[0],h[c++]=o[1]*e[w+1]+f[1],h[c++]=o[2]*e[w+2]+f[2],h[c++]=o[3]*1+f[3]}:r===4&&(g=function(w){h[c++]=o[0]*e[w]+f[0],h[c++]=o[1]*e[w+1]+f[1],h[c++]=o[2]*e[w+2]+f[2],h[c++]=o[3]*e[w+3]+f[3]});for(var C=0;C<s;C++){var T=r*y[C];g(T)}return i.nativeArray=h,i}function kO(t,e,r,n){var a=[t[n*3]-t[r*3],t[n*3+1]-t[r*3+1],t[n*3+2]-t[r*3+2]],i=[t[e*3]-t[r*3],t[e*3+1]-t[r*3+1],t[e*3+2]-t[r*3+2]],s=[];return pa(a,i,s),Dn(s),s}function FO(t,e){var r=e.getData(),n=t.getData();if(!n||!r)return null;for(var a=new Int8Array(t.getNumberOfCells()*4),i=n.length,s=0,f=0;f<i;){var o=kO(r,n[f+1],n[f+2],n[f+3]);a[s++]=127*o[0],a[s++]=127*o[1],a[s++]=127*o[2],a[s++]=127,f+=n[f]+1}return a}function BO(t,e){e.classHierarchy.push("vtkWebGPUBufferManager");function r(n){n.dataArray&&!n.nativeArray&&(n.nativeArray=n.dataArray.getData());var a,i;if(n.usage===hr.Index&&(a=LO.newInstance({label:n.label}),a.setDevice(e.device),i=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,a.buildIndexBuffer(n),a.createAndWrite(n.nativeArray,i),a.setArrayInformation([{format:n.format}])),a||(a=wo.newInstance({label:n.label}),a.setDevice(e.device)),n.usage===hr.UniformArray&&(i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===hr.Storage&&(i=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,a.createAndWrite(n.nativeArray,i)),n.usage===hr.Texture&&(i=GPUBufferUsage.COPY_SRC,a.createAndWrite(n.nativeArray,i)),n.usage===hr.PointArray){i=GPUBufferUsage.VERTEX;var s=ot.getNativeTypeFromBufferFormat(n.format),f=bc(n.indexBuffer,n.dataArray.getData(),n.dataArray.getNumberOfComponents(),s,{packExtra:n.packExtra,shift:n.shift,scale:n.scale,cellData:n.cellData,cellOffset:n.cellOffset});a.createAndWrite(f.nativeArray,i),a.setStrideInBytes(ot.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:n.cellData?"flat":"perspective"}])}if(n.usage===hr.NormalsFromPoints){i=GPUBufferUsage.VERTEX;var o=ot.getNativeTypeFromBufferFormat(n.format),u=FO(n.cells,n.dataArray),g=bc(n.indexBuffer,u,4,o,{cellData:!0});a.createAndWrite(g.nativeArray,i),a.setStrideInBytes(ot.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format,interpolation:"flat"}])}return n.usage===hr.RawVertex&&(i=GPUBufferUsage.VERTEX,a.createAndWrite(n.nativeArray,i),a.setStrideInBytes(ot.getByteStrideFromBufferFormat(n.format)),a.setArrayInformation([{offset:0,format:n.format}])),a.setSourceTime(n.time),a}t.hasBuffer=function(n){return e.device.hasCachedObject(n)},t.getBuffer=function(n){return n.hash?e.device.getCachedObject(n.hash,r,n):r(n)},t.getBufferForPointArray=function(n,a){var i=bO(n),s={hash:"".concat(n.getMTime(),"I").concat(a.getMTime()).concat(i),usage:hr.PointArray,format:i,dataArray:n,indexBuffer:a};return t.getBuffer(s)},t.getFullScreenQuadBuffer=function(){if(e.fullScreenQuadBuffer)return e.fullScreenQuadBuffer;e.fullScreenQuadBuffer=wo.newInstance(),e.fullScreenQuadBuffer.setDevice(e.device);var n=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return e.fullScreenQuadBuffer.createAndWrite(n,GPUBufferUsage.VERTEX),e.fullScreenQuadBuffer.setStrideInBytes(12),e.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),e.fullScreenQuadBuffer}}var NO={device:null,fullScreenQuadBuffer:null};function Op(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,NO,r),yt(t,e),gt(t,e,["device"]),BO(t,e)}var UO=Ue(Op),ur=_c(_c({newInstance:UO,extend:Op},_O),xa),GO=ur.BufferUsage,gn=L.vtkErrorMacro;function AO(t,e){e.classHierarchy.push("vtkWebGPUStorageBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){gn("entry named ".concat(r," already exists"));return}e._bufferEntryNames.set(r,e.bufferEntries.length);var a=ot.getByteStrideFromShaderFormat(n);e.bufferEntries.push({name:r,type:n,sizeInBytes:a,offset:e.sizeInBytes,nativeType:ot.getNativeTypeFromShaderFormat(n)}),e.sizeInBytes+=a},t.send=function(r){if(!e._buffer){var n={nativeArray:e.Float32Array,usage:GO.Storage,label:e.label};e._buffer=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e._sendTime.modified();return}r.getHandle().queue.writeBuffer(e._buffer.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes*e.numberOfInstances),e._sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes*e.numberOfInstances)),e[r]=L.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){gn("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);var f=e[s.nativeType];f[(s.offset+n*e.sizeInBytes)/f.BYTES_PER_ELEMENT]=a},t.setArray=function(r,n,a){var i=e._bufferEntryNames.get(r);if(i===void 0){gn("entry named ".concat(r," not found in UBO"));return}var s=e.bufferEntries[i];t.createView(s.nativeType);for(var f=e[s.nativeType],o=(s.offset+n*e.sizeInBytes)/f.BYTES_PER_ELEMENT,u=0;u<a.length;u++)f[o+u]=a[u]},t.setAllInstancesFromArray=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){gn("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=n.length/e.numberOfInstances,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,g=0;g<f;g++)s[u+g]=n[o*f+g]},t.setAllInstancesFromArrayColorToFloat=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){gn("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=n.length/e.numberOfInstances,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,g=0;g<f;g++)s[u+g]=n[o*f+g]/255},t.setAllInstancesFromArray3x3To4x4=function(r,n){var a=e._bufferEntryNames.get(r);if(a===void 0){gn("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=9,o=0;o<e.numberOfInstances;o++)for(var u=(i.offset+o*e.sizeInBytes)/s.BYTES_PER_ELEMENT,g=0;g<3;g++)for(var c=0;c<3;c++)s[u+g*4+c]=n[o*f+g*3+c]},t.getSendTime=function(){return e._sendTime.getMTime()},t.getShaderCode=function(r,n){for(var a=["struct ".concat(e.label,`StructEntry
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`
};
struct `.concat(e.label,`Struct
{
  values: array<`).concat(e.label,`StructEntry>,
};
@binding(`).concat(r,") @group(").concat(n,") var<storage, read> ").concat(e.label,": ").concat(e.label,`Struct;
`)),a.join(`
`)},t.getBindGroupEntry=function(){var r={resource:{buffer:e._buffer.getHandle()}};return r},t.clearData=function(){e.numberOfInstances=0,e.sizeInBytes=0,e.bufferEntries=[],e._bufferEntryNames=new Map,e._buffer=null,delete e.arrayBuffer,delete e.Float32Array}}var PO={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function Mp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,PO,r),L.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e._sendTime={},L.obj(e._sendTime,{mtime:0}),e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},L.get(t,e,["bindGroupTime"]),L.setGet(t,e,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),AO(t,e)}var WO=L.newInstance(Mp,"vtkWebGPUStorageBuffer"),zO={newInstance:WO,extend:Mp},jO=ur.BufferUsage,Ps=L.vtkErrorMacro;function $O(t,e){e.classHierarchy.push("vtkWebGPUUniformBuffer"),t.addEntry=function(r,n){if(e._bufferEntryNames.has(r)){Ps("entry named ".concat(r," already exists"));return}e.sortDirty=!0,e._bufferEntryNames.set(r,e.bufferEntries.length),e.bufferEntries.push({name:r,type:n,sizeInBytes:ot.getByteStrideFromShaderFormat(n),offset:-1,nativeType:ot.getNativeTypeFromShaderFormat(n),packed:!1})},t.sortBufferEntries=function(){if(!!e.sortDirty){for(var r=0,n=[],a=4,i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];s.sizeInBytes%16===0&&(a=Math.max(16,a)),s.sizeInBytes%8===0&&(a=Math.max(8,a))}for(var f=0;f<e.bufferEntries.length;f++){var o=e.bufferEntries[f];o.packed===!1&&o.sizeInBytes%16===0&&(o.packed=!0,o.offset=r,n.push(o),r+=o.sizeInBytes)}for(var u=0;u<e.bufferEntries.length;u++){var g=e.bufferEntries[u];if(g.packed===!1&&g.sizeInBytes===12)for(var c=0;c<e.bufferEntries.length;c++){var l=e.bufferEntries[c];if(l.packed===!1&&l.sizeInBytes===4){g.packed=!0,g.offset=r,n.push(g),r+=g.sizeInBytes,l.packed=!0,l.offset=r,n.push(l),r+=l.sizeInBytes;break}}}for(var h=0;h<e.bufferEntries.length;h++){var y=e.bufferEntries[h];if(!y.packed&&y.sizeInBytes%8===0)for(var C=h+1;C<e.bufferEntries.length;C++){var T=e.bufferEntries[C];if(!T.packed&&T.sizeInBytes%8===0){y.packed=!0,y.offset=r,n.push(y),r+=y.sizeInBytes,T.packed=!0,T.offset=r,n.push(T),r+=T.sizeInBytes;break}}}for(var E=0;E<e.bufferEntries.length;E++){var w=e.bufferEntries[E];if(!w.packed&&w.sizeInBytes%8===0)for(var x=!1,S=0;!x&&S<e.bufferEntries.length;S++){var m=e.bufferEntries[S];if(!m.packed&&m.sizeInBytes===4)for(var D=S+1;D<e.bufferEntries.length;D++){var b=e.bufferEntries[D];if(!b.packed&&b.sizeInBytes===4){w.packed=!0,w.offset=r,n.push(w),r+=w.sizeInBytes,m.packed=!0,m.offset=r,n.push(m),r+=m.sizeInBytes,b.packed=!0,b.offset=r,n.push(b),r+=b.sizeInBytes,x=!0;break}}}}for(var N=0;N<e.bufferEntries.length;N++){var P=e.bufferEntries[N];!P.packed&&P.sizeInBytes>4&&(P.packed=!0,P.offset=r,n.push(P),r+=P.sizeInBytes)}for(var O=0;O<e.bufferEntries.length;O++){var A=e.bufferEntries[O];A.packed||(A.packed=!0,A.offset=r,n.push(A),r+=A.sizeInBytes)}e.bufferEntries=n,e._bufferEntryNames.clear();for(var z=0;z<e.bufferEntries.length;z++)e._bufferEntryNames.set(e.bufferEntries[z].name,z);e.sizeInBytes=r,e.sizeInBytes=a*Math.ceil(e.sizeInBytes/a),e.sortDirty=!1}},t.sendIfNeeded=function(r){if(!e.UBO){var n={nativeArray:e.Float32Array,usage:jO.UniformArray,label:e.label};e.UBO=r.getBufferManager().getBuffer(n),e.bindGroupTime.modified(),e.sendDirty=!1}e.sendDirty&&(r.getHandle().queue.writeBuffer(e.UBO.getHandle(),0,e.arrayBuffer,0,e.sizeInBytes),e.sendDirty=!1),e.sendTime.modified()},t.createView=function(r){r in e||(e.arrayBuffer||(e.arrayBuffer=new ArrayBuffer(e.sizeInBytes)),e[r]=L.newTypedArray(r,e.arrayBuffer))},t.setValue=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){Ps("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);var s=e[i.nativeType];i.lastValue!==n&&(s[i.offset/s.BYTES_PER_ELEMENT]=n,e.sendDirty=!0),i.lastValue=n},t.setArray=function(r,n){t.sortBufferEntries();var a=e._bufferEntryNames.get(r);if(a===void 0){Ps("entry named ".concat(r," not found in UBO"));return}var i=e.bufferEntries[a];t.createView(i.nativeType);for(var s=e[i.nativeType],f=!1,o=0;o<n.length;o++)(!i.lastValue||i.lastValue[o]!==n[o])&&(s[i.offset/s.BYTES_PER_ELEMENT+o]=n[o],f=!0);f&&(e.sendDirty=!0,i.lastValue=Ee(n))},t.getBindGroupEntry=function(){var r={resource:{buffer:e.UBO.getHandle()}};return r},t.getSendTime=function(){return e.sendTime.getMTime()},t.getShaderCode=function(r,n){t.sortBufferEntries();for(var a=["struct ".concat(e.label,`Struct
{`)],i=0;i<e.bufferEntries.length;i++){var s=e.bufferEntries[i];a.push("  ".concat(s.name,": ").concat(s.type,","))}return a.push(`};
@binding(`.concat(r,") @group(").concat(n,") var<uniform> ").concat(e.label,": ").concat(e.label,"Struct;")),a.join(`
`)}}var HO={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function Dp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HO,r),L.obj(t,e),e._bufferEntryNames=new Map,e.bufferEntries=[],e.bindGroupLayoutEntry=e.bindGroupLayoutEntry||{buffer:{type:"uniform"}},e.sendTime={},L.obj(e.sendTime,{mtime:0}),e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),e.sendDirty=!0,e.sortDirty=!0,L.get(t,e,["binding","bindGroupTime"]),L.setGet(t,e,["bindGroupLayoutEntry","device","label","sizeInBytes"]),$O(t,e)}var KO=L.newInstance(Dp,"vtkWebGPUUniformBuffer"),aa={newInstance:KO,extend:Dp},XO=Mr,kc=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;

  //VTK::RenderEncoder::Impl
  return output;
}
`,YO=`
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::TCoord::Dec

//VTK::RenderEncoder::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output: fragmentOutput;

  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);
  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);
  // textureSampleLevel gets rid of some ugly artifacts
  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0);
  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);

  //VTK::RenderEncoder::Impl
  return output;
}
`,Qa=new Float64Array(16),Fc=new Float64Array(16);function IO(t){return t.getPositional()?t.getConeAngle()>=90?0:2:1}function qO(t,e){e.classHierarchy.push("vtkWebGPURenderer"),t.buildPass=function(r){if(r){if(!e.renderable)return;e.camera=e.renderable.getActiveCamera(),t.updateLights(),t.prepareNodes(),t.addMissingNode(e.camera),t.addMissingNodes(e.renderable.getViewPropsWithNestedProps()),t.removeUnusedNodes(),e.webgpuCamera=t.getViewNodeFor(e.camera),t.updateStabilizedMatrix()}},t.updateStabilizedMatrix=function(){var r=e.camera.getClippingRange(),n=e.camera.getPositionByReference(),a=e.camera.getDirectionOfProjectionByReference(),i=[],s=[];yr(s,a,.5*(r[0]+r[1])),Kn(i,n,s),Qs(s,i,e.stabilizedCenter);var f=Bg(s);f/(r[1]-r[0])>e.recenterThreshold&&(e.stabilizedCenter=i,e.stabilizedTime.modified())},t.updateLights=function(){for(var r=0,n=e.renderable.getLightsByReference(),a=0;a<n.length;++a)n[a].getSwitch()>0&&r++;return r||(XO("No lights are on, creating one."),e.renderable.createLight()),r},t.updateUBO=function(){var r=e.UBO.getSendTime();if(e._parent.getMTime()>r||t.getMTime()>r||e.camera.getMTime()>r||e.renderable.getMTime()>r){var n,a=e.webgpuCamera.getKeyMatrices(t);e.UBO.setArray("WCVCMatrix",a.wcvc),e.UBO.setArray("SCPCMatrix",a.scpc),e.UBO.setArray("PCSCMatrix",a.pcsc),e.UBO.setArray("SCVCMatrix",a.scvc),e.UBO.setArray("VCPCMatrix",a.vcpc),e.UBO.setArray("WCVCNormals",a.normalMatrix),e.UBO.setValue("LightCount",e.renderable.getLights().length),e.UBO.setValue("MaxEnvironmentMipLevel",(n=e.renderable.getEnvironmentTexture())===null||n===void 0?void 0:n.getMipLevel()),e.UBO.setValue("BackgroundDiffuseStrength",e.renderable.getEnvironmentTextureDiffuseStrength()),e.UBO.setValue("BackgroundSpecularStrength",e.renderable.getEnvironmentTextureSpecularStrength());var i=t.getYInvertedTiledSizeAndOrigin();e.UBO.setArray("viewportSize",[i.usize,i.vsize]),e.UBO.setValue("cameraParallel",e.camera.getParallelProjection());var s=e._parent.getDevice();e.UBO.sendIfNeeded(s)}},t.updateSSBO=function(){for(var r=e.renderable.getLights(),n=e.webgpuCamera.getKeyMatrices(t),a="".concat(e.renderable.getMTime()),i=0;i<r.length;i++)a+=r[i].getMTime();if(a!==e.lightTimeString){for(var s=new Float32Array(r.length*4),f=new Float32Array(r.length*4),o=new Float32Array(r.length*4),u=new Float32Array(r.length*4),g=0;g<r.length;g++){var c=g*4,l=r[g].getPosition();me(l,l,n.wcvc),s[c]=l[0],s[c+1]=l[1],s[c+2]=l[2],s[c+3]=0,f[c]=-r[g].getDirection()[0],f[c+1]=-r[g].getDirection()[1],f[c+2]=-r[g].getDirection()[2],f[c+3]=0,o[c]=r[g].getColor()[0],o[c+1]=r[g].getColor()[1],o[c+2]=r[g].getColor()[2],o[c+3]=r[g].getIntensity()*5,u[c]=IO(r[g]),u[c+1]=Math.cos(Ke(r[g].getConeAngle())),u[c+2]=Math.cos(Ke(r[g].getConeAngle()+r[g].getConeFalloff())),u[c+3]=0}e.SSBO.clearData(),e.SSBO.setNumberOfInstances(r.length),e.SSBO.addEntry("LightPos","vec4<f32>"),e.SSBO.addEntry("LightDir","vec4<f32>"),e.SSBO.addEntry("LightColor","vec4<f32>"),e.SSBO.addEntry("LightData","vec4<f32>"),e.SSBO.setAllInstancesFromArray("LightPos",s),e.SSBO.setAllInstancesFromArray("LightDir",f),e.SSBO.setAllInstancesFromArray("LightColor",o),e.SSBO.setAllInstancesFromArray("LightData",u);var h=e._parent.getDevice();e.SSBO.send(h)}e.lightTimeString=a},t.scissorAndViewport=function(r){var n=t.getYInvertedTiledSizeAndOrigin();r.getHandle().setViewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize,0,1),r.getHandle().setScissorRect(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)},t.bindUBO=function(r){r.activateBindGroup(e.bindGroup)},t.opaquePass=function(r){r?(e.renderEncoder.begin(e._parent.getCommandEncoder()),t.updateUBO(),t.updateSSBO()):(t.scissorAndViewport(e.renderEncoder),t.clear(),e.renderEncoder.end())},t.clear=function(){var r;if(!(e.renderable.getTransparent()||e.suppressClear)){var n=e._parent.getDevice();if(!e.clearFSQ){e.clearFSQ=Mc.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(kc);var a=aa.newInstance({label:"mapperUBO"});a.addEntry("FSQMatrix","mat4x4<f32>"),a.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(a),e.backgroundTex=e.renderable.getEnvironmentTexture()}if(e.clearFSQ.getPipelineHash()!=="clearfsqwithtexture"&&e.renderable.getUseEnvironmentTextureAsBackground()&&(r=e.backgroundTex)!==null&&r!==void 0&&r.getImageLoaded()){e.clearFSQ.setFragmentShaderTemplate(YO);var i=aa.newInstance({label:"mapperUBO"});i.addEntry("FSQMatrix","mat4x4<f32>"),i.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(i);var s=n.getTextureManager().getTextureForVTKTexture(e.backgroundTex);if(s.getReady()){var f=s.createView("EnvironmentTexture");e.clearFSQ.setTextureViews([f]),e.backgroundTexLoaded=!0;var o=e.backgroundTex.getInterpolate()?"linear":"nearest";f.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:o,magFilter:o,mipmapFilter:"linear"})}e.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if(e.clearFSQ.getPipelineHash()==="clearfsqwithtexture"&&!e.renderable.getUseEnvironmentTextureAsBackground()){e.clearFSQ=Mc.newInstance(),e.clearFSQ.setDevice(n),e.clearFSQ.setPipelineHash("clearfsq"),e.clearFSQ.setFragmentShaderTemplate(kc);var u=aa.newInstance({label:"mapperUBO"});u.addEntry("FSQMatrix","mat4x4<f32>"),u.addEntry("BackgroundColor","vec4<f32>"),e.clearFSQ.setUBO(u)}var g=e.webgpuCamera.getKeyMatrices(t),c=e.renderable.getBackgroundByReference();e.clearFSQ.getUBO().setArray("BackgroundColor",c),We(Fc,g.normalMatrix),qs(Qa,g.scvc,g.pcsc),qs(Qa,Fc,Qa),e.clearFSQ.getUBO().setArray("FSQMatrix",Qa),e.clearFSQ.getUBO().sendIfNeeded(n),e.clearFSQ.prepareAndDraw(e.renderEncoder)}},t.translucentPass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.volumeDepthRangePass=function(r){r?e.renderEncoder.begin(e._parent.getCommandEncoder()):(t.scissorAndViewport(e.renderEncoder),e.renderEncoder.end())},t.getAspectRatio=function(){var r=e._parent.getSizeByReference(),n=e.renderable.getViewportByReference();return r[0]*(n[2]-n[0])/((n[3]-n[1])*r[1])},t.convertToOpenGLDepth=function(r){return e.webgpuCamera.convertToOpenGLDepth(r)},t.getYInvertedTiledSizeAndOrigin=function(){var r=t.getTiledSizeAndOrigin(),n=e._parent.getSizeByReference();return r.lowerLeftV=n[1]-r.vsize-r.lowerLeftV,r},t.getTiledSizeAndOrigin=function(){var r=e.renderable.getViewportByReference(),n=[0,0,1,1],a=r[0]-n[0],i=r[1]-n[1],s=e._parent.normalizedDisplayToDisplay(a,i),f=Math.round(s[0]),o=Math.round(s[1]),u=r[2]-n[0],g=r[3]-n[1],c=e._parent.normalizedDisplayToDisplay(u,g),l=Math.round(c[0])-f,h=Math.round(c[1])-o;return l<0&&(l=0),h<0&&(h=0),{usize:l,vsize:h,lowerLeftU:f,lowerLeftV:o}},t.getPropFromID=function(r){for(var n=0;n<e.children.length;n++){var a=e.children[n].getPropID?e.children[n].getPropID():-1;if(a===r)return e.children[n]}return null},t.getStabilizedTime=function(){return e.stabilizedTime.getMTime()},t.releaseGraphicsResources=function(){e.selector!==null&&e.selector.releaseGraphicsResources()}}var ZO={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function QO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZO,r),Ie.extend(t,e,r),e.UBO=aa.newInstance({label:"rendererUBO"}),e.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),e.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),e.UBO.addEntry("WCVCNormals","mat4x4<f32>"),e.UBO.addEntry("viewportSize","vec2<f32>"),e.UBO.addEntry("LightCount","i32"),e.UBO.addEntry("MaxEnvironmentMipLevel","f32"),e.UBO.addEntry("BackgroundDiffuseStrength","f32"),e.UBO.addEntry("BackgroundSpecularStrength","f32"),e.UBO.addEntry("cameraParallel","u32"),e.SSBO=zO.newInstance({label:"rendererLightSSBO"}),e.lightTimeString="",e.bindGroup=lp.newInstance({label:"rendererBG"}),e.bindGroup.setBindables([e.UBO,e.SSBO]),e.tmpMat4=De(new Float64Array(16)),e.stabilizedTime={},yt(e.stabilizedTime,{mtime:0}),Ft(t,e,["bindGroup","stabilizedTime"]),Ca(t,e,["stabilizedCenter"]),gt(t,e,["renderEncoder","selector","suppressClear","UBO"]),qO(t,e)}var JO=Ue(QO,"vtkWebGPURenderer");jt("vtkRenderer",JO);var Bc=Ea.CoordinateSystem;function eM(t,e){e.classHierarchy.push("vtkWebGPUActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.renderable.computeMatrix();var n=e.renderable.getMatrix();e.bufferShift[0]=n[3],e.bufferShift[1]=n[7],e.bufferShift[2]=n[11];var a=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Bc.WORLD&&(e.bufferShift[0]-=a[0],e.bufferShift[1]-=a[1],e.bufferShift[2]-=a[2]),We(e.keyMatrices.bcwc,n),e.renderable.getIsIdentity()?De(e.keyMatrices.normalMatrix):(ut(e.keyMatrices.normalMatrix,e.keyMatrices.bcwc),e.keyMatrices.normalMatrix[3]=0,e.keyMatrices.normalMatrix[7]=0,e.keyMatrices.normalMatrix[11]=0,wt(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix),We(e.keyMatrices.normalMatrix,e.keyMatrices.normalMatrix)),et(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Bc.WORLD?et(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-a[0],-a[1],-a[2]]):ut(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var tM={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function rM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tM,r),Ie.extend(t,e,r),e.keyMatricesTime={},L.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},L.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],eM(t,e)}var nM=L.newInstance(rM);jt("vtkActor",nM);var Nc=Ea.CoordinateSystem;function aM(t,e){e.classHierarchy.push("vtkWebGPUActor2D"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),e.propID===void 0&&(e.propID=e.WebGPURenderWindow.getUniquePropID()),t.prepareNodes(),t.addMissingNode(e.renderable.getMapper()),t.removeUnusedNodes())},t.traverseOpaquePass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||!e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.traverseTranslucentPass=function(r){!e.renderable||!e.renderable.getNestedVisibility()||e.renderable.getIsOpaque()||e.WebGPURenderer.getSelector()&&!e.renderable.getNestedPickable()||(t.apply(r,!0),e.children[0]&&e.children[0].traverse(r),t.apply(r,!1))},t.queryPass=function(r,n){if(r){if(!e.renderable||!e.renderable.getVisibility())return;e.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},t.getBufferShift=function(r){return t.getKeyMatrices(r),e.bufferShift},t.getKeyMatrices=function(r){if(Math.max(e.renderable.getMTime(),r.getStabilizedTime())>e.keyMatricesTime.getMTime()){e.bufferShift[0]=0,e.bufferShift[1]=0,e.bufferShift[2]=0;var n=r.getStabilizedCenterByReference();e.renderable.getCoordinateSystem()===Nc.WORLD&&(e.bufferShift[0]-=n[0],e.bufferShift[1]-=n[1],e.bufferShift[2]-=n[2]),De(e.keyMatrices.bcwc),De(e.keyMatrices.normalMatrix),et(e.keyMatrices.bcwc,e.keyMatrices.bcwc,[-e.bufferShift[0],-e.bufferShift[1],-e.bufferShift[2]]),e.renderable.getCoordinateSystem()===Nc.WORLD?et(e.keyMatrices.bcsc,e.keyMatrices.bcwc,[-n[0],-n[1],-n[2]]):ut(e.keyMatrices.bcsc,e.keyMatrices.bcwc),e.keyMatricesTime.modified()}return e.keyMatrices}}var iM={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function sM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,iM,r),Ie.extend(t,e,r),e.keyMatricesTime={},L.obj(e.keyMatricesTime,{mtime:0}),e.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},L.get(t,e,["propID","keyMatricesTime"]),e.bufferShift=[0,0,0,0],aM(t,e)}var oM=L.newInstance(sM);jt("vtkActor2D",oM);function fM(t,e){e.classHierarchy.push("vtkWebGPUCubeAxesActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.CubeAxesActorHelper.getRenderable()||e.CubeAxesActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.CubeAxesActorHelper.getTmActor()),t.addMissingNode(e.renderable.getGridActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.CubeAxesActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var uM={};function cM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,uM,r),Ie.extend(t,e,r),e.CubeAxesActorHelper=zl.newCubeAxesActorHelper(),fM(t,e)}var gM=Ue(cM,"vtkWebGPUCubeAxesActor");jt("vtkCubeAxesActor",gM);function Uc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function vM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Oo=sp.DisplayLocation;function lM(t,e){e.classHierarchy.push("vtkProperty2D"),t.setDisplayLocationToBackground=function(){return t.setDisplayLocation(Oo.BACKGROUND)},t.setDisplayLocationToForeground=function(){return t.setDisplayLocation(Oo.FOREGROUND)},t.setRepresentationToWireframe=function(){return t.setRepresentation(bt.WIREFRAME)},t.setRepresentationToSurface=function(){return t.setRepresentation(bt.SURFACE)},t.setRepresentationToPoints=function(){return t.setRepresentation(bt.POINTS)},t.getRepresentationAsString=function(){return L.enumToString(bt,e.representation)}}var pM={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:bt.SURFACE,displayLocation:Oo.FOREGROUND};function mp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pM,r),L.obj(t,e),L.setGet(t,e,["opacity","lineWidth","pointSize","displayLocation","representation"]),L.setGetArray(t,e,["color"],3),lM(t,e)}var hM=L.newInstance(mp,"vtkProperty2D"),yM=vM({newInstance:hM,extend:mp},sp),nt=ur.BufferUsage,lt=ur.PrimitiveTypes,Ja=Vn.Representation,ei=Rr.ScalarMode,dM=Ea.CoordinateSystem,TM=yM.DisplayLocation,CM=`
//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::Normal::Dec

//VTK::TCoord::Dec

//VTK::Select::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertex: vec4<f32> = vertexBC;

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Select::Impl

  //VTK::Position::Impl

  return output;
}
`,SM=`
struct PBRData {
  diffuse: vec3<f32>,
  specular: vec3<f32>,
}

// Dot product with the max already in it
fn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  return max(0.0, dot(a, b));
}
// Dot product with a max in it that does not allow for negative values
// Physically based rendering is accurate as long as normals are accurate,
// however this is pretty often not the case. In order to prevent negative
// values from ruining light calculations and creating zones of zero light,
// this remapping is used, which smoothly clamps the dot product between
// zero and one while still maintaining a good amount of accuracy.
fn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {
  var d: f32 = max(0.0, dot(a, b));
  d = pow((d + 1) / 2.0, 2.6);
  return d;
}

// Lambertian diffuse model
fn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {
  var pi: f32 = 3.14159265359; 
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5);
  return (base/pi)*NdotL;
}

// Yasuhiro Fujii improvement on the Oren-Nayar model
// https://mimosa-pudica.net/improved-oren-nayar.html
// p is surface color, o is roughness
fn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {
  var invpi: f32 = 0.31830988618; // 1/pi

  var o2 = o*o;
  var NdotL: f32 = mdot(N, L);
  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better

  var NdotV: f32 = mdot(N, V);
  var LdotV: f32 = mdot(L, V);

  var s: f32 = LdotV - NdotL*NdotV;
  var t: f32 = mix(1, max(NdotL, NdotV), step(0, s)); // Mix with step is the equivalent of an if statement
  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));
  A = invpi*(1 - A);
  var B: f32 = 0.45*(o2 / (o2 + 0.09));
  B = invpi*B;

  return p*NdotL*(A + B*(s/t));
}

// Fresnel portion of BRDF (IOR only, simplified)
fn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {
  var NdotV: f32 = mdot(V, N);
  var F0: f32 = (pow((ior - 1.0), 2) + k*k) / (pow((ior + 1.0), 2) + k*k); // This takes into account the roughness, which the other one does not
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Fresnel portion of BRDF (Color ior, better)
fn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {
  var NdotV: f32 = mdot(V, N);
  return F0 + (1 - F0) * pow((1-NdotV), 5); 
}

// Normal portion of BRDF
// https://learnopengl.com/PBR/Theory
// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2
fn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {
  var pi: f32 = 3.14159265359; 

  var a2: f32 = a*a;
  var NdotH = mdot(N, H);
  var NdotH2 = NdotH*NdotH;
  
  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;

  return a2 / max((pi*denom*denom), 0.000001);
}

// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent
fn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {
  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;

  var ggx1: f32 = trGGX(N + Op*s, H, a);
  var ggx2: f32 = trGGX(N - Op*s, H, a);
  return (0.5 * ggx1 + 0.5 * ggx2);
}

// Geometry portion of BRDF
fn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {
  var NdotX = cdot(N, X);
  return NdotX / max(0.000001, (NdotX*(1-k) + k));
}

fn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {
  var ggx1: f32 = min(1, schlickGGX(N, V, k));
  var ggx2: f32 = min(1, schlickGGX(N, L, k));
  return ggx1*ggx2;
}

// BRDF Combination
fn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {
  var num: f32 = D*F*G;
  var denom: f32 = 4*cdot(V, N)*cdot(L, N);

  return num / max(denom, 0.000001);
}

// Different lighting calculations for different light sources
fn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  
  var L: vec3<f32> = normalize(direction); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2;

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L); // Fresnel term is replaced with 1 because it is added later
  var incoming: vec3<f32> = color;
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5);

  var specular: vec3<f32> = brdf*incoming*angle;
  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate
  // control property for the diffuse vs specular roughness
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); 
  // Stores the specular and diffuse separately to allow for finer post processing
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// TODO: find some way to reduce the number of arguments going in here
fn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos); // Light Vector
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  var incoming: vec3<f32> = color * (1. / (dist*dist));
  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights
fn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {
  var L: vec3<f32> = normalize(position - fragPos);
  var H: vec3<f32> = normalize(L + V); // Halfway Vector
  var dist = distance(position, fragPos);

  var alpha = roughness*roughness;
  var k: f32 = alpha*alpha / 2; // could also be pow(alpha + 1.0, 2) / 8

  var D: f32 = trGGX(N, H, alpha); // Distribution
  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel
  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry

  var brdf: f32 = cookTorrance(D, 1, G, N, V, L);  
  
  // Cones.x is the inner phi and cones.y is the outer phi
  var theta: f32 = mdot(normalize(direction), L);
  var epsilon: f32 = cones.x - cones.y;
  var intensity: f32 = (theta - cones.y) / epsilon;
  intensity = clamp(intensity, 0.0, 1.0);
  intensity /= dist*dist;

  var incoming: vec3<f32> = color * intensity;

  var angle: f32 = mdot(L, N);
  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources

  var specular: vec3<f32> = brdf*incoming*angle;
  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);

  // Stores the specular and diffuse separately to allow for finer post processing
  // Could also be done (propably more properly) with a struct
  var out = PBRData(diffuse, specular);
  
  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)
}

// Environment mapping stuff
// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point
fn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {
  var tau: f32 = 6.28318530718;
  var pi: f32 = 3.14159265359;
  var out: vec2<f32> = vec2<f32>(0.0);

  out.x = atan2(dir.z, dir.x) / tau;
  out.x += 0.5;

  var phix: f32 = length(vec2(dir.x, dir.z));
  out.y = atan2(dir.y, phix) / pi + 0.5;

  return out;
}

//VTK::Renderer::Dec

//VTK::Color::Dec

//VTK::TCoord::Dec

// optional surface normal declaration
//VTK::Normal::Dec

//VTK::Select::Dec

//VTK::RenderEncoder::Dec

//VTK::Mapper::Dec

//VTK::IOStructs::Dec

@fragment
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : fragmentOutput;

  // Temporary ambient, diffuse, and opacity
  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;
  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;
  var opacity: f32 = mapperUBO.Opacity;

  // This should be declared somewhere else
  var _diffuseMap: vec4<f32> = vec4<f32>(1);
  var _roughnessMap: vec4<f32> = vec4<f32>(1);
  var _metallicMap: vec4<f32> = vec4<f32>(1);
  var _normalMap: vec4<f32> = vec4<f32>(0, 0, 1, 0); // normal map was setting off the normal vector detection in fragment
  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1);
  var _emissionMap: vec4<f32> = vec4<f32>(0);

  //VTK::Color::Impl

  //VTK::TCoord::Impl

  //VTK::Normal::Impl

  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);

  //VTK::Light::Impl

  //VTK::Select::Impl

  if (computedColor.a == 0.0) { discard; };

  //VTK::Position::Impl

  //VTK::RenderEncoder::Impl

  return output;
}
`;function Gc(t){return t.indexOf("edge")>=0}function EM(t,e){e.classHierarchy.push("vtkWebGPUCellArrayMapper"),t.buildPass=function(r){r&&(e.is2D?(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.forceZValue=!0):(e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.forceZValue=!1),e.coordinateSystem=e.WebGPUActor.getRenderable().getCoordinateSystem(),e.useRendererMatrix=e.coordinateSystem!==dM.DISPLAY,e.WebGPURenderer=e.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.device=e.WebGPURenderWindow.getDevice())},t.translucentPass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.opaquePass=function(r){r&&(t.prepareToDraw(e.WebGPURenderer.getRenderEncoder()),e.renderEncoder.registerDrawCallback(e.pipeline,t.draw))},t.updateUBO=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty(),a=e.UBO.getSendTime();if(t.getMTime()>a||n.getMTime()>a||e.renderable.getMTime()>a){var i,s=e.WebGPUActor.getKeyMatrices(e.WebGPURenderer);if(e.UBO.setArray("BCWCMatrix",s.bcwc),e.UBO.setArray("BCSCMatrix",s.bcsc),e.UBO.setArray("MCWCNormals",s.normalMatrix),e.is2D){e.UBO.setValue("ZValue",e.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===TM.FOREGROUND?1:0);var f=n.getColorByReference();e.UBO.setValue("AmbientIntensity",1),e.UBO.setArray("DiffuseColor",[f[0],f[1],f[2],1]),e.UBO.setValue("DiffuseIntensity",0),e.UBO.setValue("SpecularIntensity",0)}else{var o=n.getAmbientColorByReference();e.UBO.setValue("AmbientIntensity",n.getAmbient()),e.UBO.setArray("AmbientColor",[o[0],o[1],o[2],1]),e.UBO.setValue("DiffuseIntensity",n.getDiffuse()),o=n.getDiffuseColorByReference(),e.UBO.setArray("DiffuseColor",[o[0],o[1],o[2],1]),e.UBO.setValue("Roughness",n.getRoughness()),e.UBO.setValue("BaseIOR",n.getBaseIOR()),e.UBO.setValue("Metallic",n.getMetallic()),e.UBO.setValue("NormalStrength",n.getNormalStrength()),e.UBO.setValue("Emission",n.getEmission()),e.UBO.setValue("SpecularIntensity",n.getSpecular()),o=n.getSpecularColorByReference(),e.UBO.setArray("SpecularColor",[o[0],o[1],o[2],1])}var u=(i=n.getEdgeColorByReference)===null||i===void 0?void 0:i.call(n);u&&e.UBO.setArray("EdgeColor",[u[0],u[1],u[2],1]),e.UBO.setValue("LineWidth",n.getLineWidth()),e.UBO.setValue("Opacity",n.getOpacity()),e.UBO.setValue("PropID",e.WebGPUActor.getPropID());var g=e.WebGPURenderWindow.getDevice();e.UBO.sendIfNeeded(g)}},t.haveWideLines=function(){var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();return r.getProperty().getLineWidth()<=1||e.primitiveType===lt.Verts?!1:e.primitiveType===lt.Triangles||e.primitiveType===lt.TriangleStrips?n===Ja.WIREFRAME:!0},t.replaceShaderPosition=function(r,n,a){var i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=i.getCode();e.useRendererMatrix?(s=Fe.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,e.forceZValue&&(s=Fe.substitute(s,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(s=Fe.substitute(s,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,e.forceZValue&&(s=Fe.substitute(s,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),t.haveWideLines()&&(i.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),s=Fe.substitute(s,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),s=Fe.substitute(s,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,i.setCode(s)},e.shaderReplacements.set("replaceShaderPosition",t.replaceShaderPosition),t.replaceShaderNormal=function(r,n,a){var i=a.getBuffer("normalMC"),s=e.WebGPUActor.getRenderable();if(i){var f=n.getShaderDescription("vertex");f.hasOutput("normalVC")||f.addOutput("vec3<f32>","normalVC",i.getArrayInformation()[0].interpolation),f.hasOutput("tangentVC")||f.addOutput("vec3<f32>","tangentVC",i.getArrayInformation()[0].interpolation),f.hasOutput("bitangentVC")||f.addOutput("vec3<f32>","bitangentVC",i.getArrayInformation()[0].interpolation);var o=f.getCode();o=Fe.substitute(o,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,f.setCode(o);var u=n.getShaderDescription("fragment");o=u.getCode(),s.getProperty().getNormalTexture()?o=Fe.substitute(o,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:o=Fe.substitute(o,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,u.setCode(o)}},e.shaderReplacements.set("replaceShaderNormal",t.replaceShaderNormal),t.replaceShaderLight=function(r,n,a){if(!r.includes("sel")){var i=n.getShaderDescription("vertex");i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");var s=e.WebGPURenderer.getRenderable(),f=n.getShaderDescription("fragment"),o=f.getCode();if(o.includes("var normal:")&&e.useRendererMatrix&&!Gc(r)&&!e.is2D&&!r.includes("sel")){var u,g=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];(u=s.getEnvironmentTexture())!==null&&u!==void 0&&u.getImageLoaded()&&g.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),o=Fe.substitute(o,"//VTK::Light::Impl",g).result,f.setCode(o)}else o=Fe.substitute(o,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,f.setCode(o)}},e.shaderReplacements.set("replaceShaderLight",t.replaceShaderLight),t.replaceShaderColor=function(r,n,a){if(Gc(r)){var i=n.getShaderDescription("fragment"),s=i.getCode();s=Fe.substitute(s,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,i.setCode(s);return}var f=a.getBuffer("colorVI");if(!!f){var o=n.getShaderDescription("vertex");o.addOutput("vec4<f32>","color",f.getArrayInformation()[0].interpolation);var u=o.getCode();u=Fe.substitute(u,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,o.setCode(u);var g=n.getShaderDescription("fragment");u=g.getCode(),u=Fe.substitute(u,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,g.setCode(u)}},e.shaderReplacements.set("replaceShaderColor",t.replaceShaderColor),t.replaceShaderTCoord=function(r,n,a){var i,s,f,o,u,g,c,l,h,y,C,T,E,w,x,S,m,D;if(!!a.hasAttribute("tcoord")){var b=n.getShaderDescription("vertex"),N=a.getBuffer("tcoord"),P=ot.getNumberOfComponentsFromBufferFormat(N.getArrayInformation()[0].format),O=b.getCode();b.addOutput("vec".concat(P,"<f32>"),"tcoordVS"),O=Fe.substitute(O,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,b.setCode(O);var A=n.getShaderDescription("fragment");O=A.getCode();var z=e.WebGPUActor.getRenderable(),j=function(U){if(!U)return!1;var G=U.getDimensionality();return G===P},B=[];if((i=(s=z.getProperty()).getDiffuseTexture)!==null&&i!==void 0&&(f=i.call(s))!==null&&f!==void 0&&f.getImageLoaded()||z.getTextures()[0]||e.colorTexture){var Y,I;(j((Y=(I=z.getProperty()).getDiffuseTexture)===null||Y===void 0?void 0:Y.call(I))||j(z.getTextures()[0])||j(e.colorTexture))&&B.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);")}(o=(u=z.getProperty()).getRoughnessTexture)!==null&&o!==void 0&&(g=o.call(u))!==null&&g!==void 0&&g.getImageLoaded()&&j(z.getProperty().getRoughnessTexture())&&B.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),(c=(l=z.getProperty()).getMetallicTexture)!==null&&c!==void 0&&(h=c.call(l))!==null&&h!==void 0&&h.getImageLoaded()&&j(z.getProperty().getMetallicTexture())&&B.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),(y=(C=z.getProperty()).getNormalTexture)!==null&&y!==void 0&&(T=y.call(C))!==null&&T!==void 0&&T.getImageLoaded()&&j(z.getProperty().getNormalTexture())&&B.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),(E=(w=z.getProperty()).getAmbientOcclusionTexture)!==null&&E!==void 0&&(x=E.call(w))!==null&&x!==void 0&&x.getImageLoaded()&&j(z.getProperty().getAmbientOcclusionTexture())&&B.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),(S=(m=z.getProperty()).getEmissionTexture)!==null&&S!==void 0&&(D=S.call(m))!==null&&D!==void 0&&D.getImageLoaded()&&j(z.getProperty().getEmissionTexture())&&B.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),O=Fe.substitute(O,"//VTK::TCoord::Impl",B).result,A.setCode(O)}},e.shaderReplacements.set("replaceShaderTCoord",t.replaceShaderTCoord),t.replaceShaderSelect=function(r,n,a){if(r.includes("sel")){var i=n.getShaderDescription("fragment"),s=i.getCode();s=Fe.substitute(s,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,i.setCode(s)}},e.shaderReplacements.set("replaceShaderSelect",t.replaceShaderSelect),t.getUsage=function(r,n){return r===Ja.POINTS||n===lt.Points?nt.Verts:n===lt.Lines?nt.Lines:r===Ja.WIREFRAME?n===lt.Triangles?nt.LinesFromTriangles:nt.LinesFromStrips:n===lt.Triangles?nt.Triangles:n===lt.TriangleStrips?nt.Strips:n===lt.TriangleEdges?nt.LinesFromTriangles:nt.LinesFromStrips},t.getHashFromUsage=function(r){return"pt".concat(r)},t.getTopologyFromUsage=function(r){switch(r){case nt.Triangles:return"triangle-list";case nt.Verts:return"point-list";case nt.Lines:default:return"line-list"}},t.buildVertexInput=function(){var r,n,a=e.currentInput,i=e.cellArray,s=e.primitiveType,f=e.WebGPUActor.getRenderable(),o=f.getProperty().getRepresentation(),u=e.WebGPURenderWindow.getDevice(),g=!1;s===lt.TriangleEdges&&(g=!0,o=Ja.WIREFRAME);var c=e.vertexInput,l=a.getPoints(),h;if(i){var y={hash:"R".concat(o,"P").concat(s).concat(i.getMTime()),usage:nt.Index,cells:i,numberOfPoints:l.getNumberOfPoints(),primitiveType:s,representation:o};h=u.getBufferManager().getBuffer(y),c.setIndexBuffer(h)}else c.setIndexBuffer(null);if(l){var C=e.WebGPUActor.getBufferShift(e.WebGPURenderer),T={hash:"".concat(l.getMTime(),"I").concat(h.getMTime()).concat(C.join(),"float32x4"),usage:nt.PointArray,format:"float32x4",dataArray:l,indexBuffer:h,shift:C,packExtra:!0},E=u.getBufferManager().getBuffer(T);c.addBuffer(E,["vertexBC"])}else c.removeBufferIfPresent("vertexBC");var w=t.getUsage(o,s);if(e._usesCellNormals=!1,!e.is2D&&(w===nt.Triangles||w===nt.Strips)){var x=a.getPointData().getNormals(),S={format:"snorm8x4",indexBuffer:h,packExtra:!0,shift:0,scale:127};if(x){S.hash="".concat(x.getMTime(),"I").concat(h.getMTime(),"snorm8x4"),S.dataArray=x,S.usage=nt.PointArray;var m=u.getBufferManager().getBuffer(S);c.addBuffer(m,["normalMC"])}else if(s===lt.Triangles){e._usesCellNormals=!0,S.hash="PFN".concat(l.getMTime(),"I").concat(h.getMTime(),"snorm8x4"),S.dataArray=l,S.cells=i,S.usage=nt.NormalsFromPoints;var D=u.getBufferManager().getBuffer(S);c.addBuffer(D,["normalMC"])}else c.removeBufferIfPresent("normalMC")}else c.removeBufferIfPresent("normalMC");var b=!1;if(e.renderable.getScalarVisibility()){var N=e.renderable.getColorMapColors();if(N&&!g){var P=e.renderable.getScalarMode(),O=!1;(P===ei.USE_CELL_DATA||P===ei.USE_CELL_FIELD_DATA||P===ei.USE_FIELD_DATA||!a.getPointData().getScalars())&&P!==ei.USE_POINT_FIELD_DATA&&N&&(O=!0);var A={usage:nt.PointArray,format:"unorm8x4",hash:"".concat(O).concat(N.getMTime(),"I").concat(h.getMTime(),"unorm8x4"),dataArray:N,indexBuffer:h,cellData:O,cellOffset:0},z=u.getBufferManager().getBuffer(A);c.addBuffer(z,["colorVI"]),b=!0}}b||c.removeBufferIfPresent("colorVI");var j=null;if((r=(n=e.renderable).getInterpolateScalarsBeforeMapping)!==null&&r!==void 0&&r.call(n)&&e.renderable.getColorCoordinates()?j=e.renderable.getColorCoordinates():j=a.getPointData().getTCoords(),j&&!g){var B=u.getBufferManager().getBufferForPointArray(j,c.getIndexBuffer());c.addBuffer(B,["tcoord"])}else c.removeBufferIfPresent("tcoord")},t.updateTextures=function(){var r,n,a,i,s,f,o,u,g,c,l,h,y,C,T,E=[],w=[],x=(r=(n=e.renderable).getColorTextureMap)===null||r===void 0?void 0:r.call(n);x&&(e.colorTexture||(e.colorTexture=zi.newInstance({label:"polyDataColor"})),e.colorTexture.setInputData(x),w.push(["Diffuse",e.colorTexture]));var S=e.WebGPUActor.getRenderable(),m=e.WebGPURenderer.getRenderable(),D=[];if((a=(i=S.getProperty()).getDiffuseTexture)!==null&&a!==void 0&&a.call(i)){var b=["Diffuse",S.getProperty().getDiffuseTexture()];D.push(b)}if(S.getTextures()[0]){var N=["Diffuse",S.getTextures()[0]];D.push(N)}if(e.colorTexture){var P=["Diffuse",e.colorTexture];D.push(P)}if((s=(f=S.getProperty()).getRoughnessTexture)!==null&&s!==void 0&&s.call(f)){var O=["Roughness",S.getProperty().getRoughnessTexture()];D.push(O)}if((o=(u=S.getProperty()).getMetallicTexture)!==null&&o!==void 0&&o.call(u)){var A=["Metallic",S.getProperty().getMetallicTexture()];D.push(A)}if((g=(c=S.getProperty()).getNormalTexture)!==null&&g!==void 0&&g.call(c)){var z=["Normal",S.getProperty().getNormalTexture()];D.push(z)}if((l=(h=S.getProperty()).getAmbientOcclusionTexture)!==null&&l!==void 0&&l.call(h)){var j=["AmbientOcclusion",S.getProperty().getAmbientOcclusionTexture()];D.push(j)}if((y=(C=S.getProperty()).getEmissionTexture)!==null&&y!==void 0&&y.call(C)){var B=["Emission",S.getProperty().getEmissionTexture()];D.push(B)}if((T=m.getEnvironmentTexture)!==null&&T!==void 0&&T.call(m)){var Y=["Environment",m.getEnvironmentTexture()];D.push(Y)}for(var I=0;I<D.length;I++)(D[I][1].getInputData()||D[I][1].getJsImageData()||D[I][1].getCanvas())&&w.push(D[I]),D[I][1].getImage()&&D[I][1].getImageLoaded()&&w.push(D[I]);for(var te=0;te<w.length;te++){var U=w[te][1],G=w[te][0],K=e.device.getTextureManager().getTextureForVTKTexture(U);if(K.getReady()){for(var Z=!1,Q=0;Q<e.textures.length;Q++)e.textures[Q]===K&&(Z=!0,E[Q]=!0);if(!Z){E[e.textures.length]=!0;var oe=K.createView("".concat(G,"Texture"));e.textures.push(K),e.textureViews.push(oe);var ce=U.getInterpolate()?"linear":"nearest",fe=null;!fe&&U.getEdgeClamp()&&U.getRepeat()&&(fe="mirror-repeat"),!fe&&U.getEdgeClamp()&&(fe="clamp-to-edge"),!fe&&U.getRepeat()&&(fe="repeat"),G!=="Environment"?oe.addSampler(e.device,{addressModeU:fe,addressModeV:fe,addressModeW:fe,minFilter:ce,magFilter:ce}):oe.addSampler(e.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:ce,magFilter:ce,mipmapFilter:"linear"})}}}for(var pe=e.textures.length-1;pe>=0;pe--)E[pe]||(e.textures.splice(pe,1),e.textureViews.splice(pe,1))},t.computePipelineHash=function(){var r="pd".concat(e.useRendererMatrix?"r":"").concat(e.forceZValue?"z":"");if(e.primitiveType===lt.TriangleEdges||e.primitiveType===lt.TriangleStripEdges)r+="edge";else{if(e.vertexInput.hasAttribute("normalMC")&&(r+="n"),e.vertexInput.hasAttribute("colorVI")&&(r+="c"),e.vertexInput.hasAttribute("tcoord")){var n=e.vertexInput.getBuffer("tcoord"),a=ot.getNumberOfComponentsFromBufferFormat(n.getArrayInformation()[0].format);r+="t".concat(a)}e.textures.length&&(r+="tx".concat(e.textures.length))}e._usesCellNormals&&(r+="cn"),e.SSBO&&(r+="ssbo");var i=t.getHashFromUsage(e.usage);r+=i,r+=e.renderEncoder.getPipelineHash(),e.pipelineHash=r},t.updateBuffers=function(){e.primitiveType!==lt.TriangleEdges&&e.primitiveType!==lt.TriangleStripEdges&&t.updateTextures();var r=e.WebGPUActor.getRenderable(),n=r.getProperty().getRepresentation();e.usage=t.getUsage(n,e.primitiveType),t.buildVertexInput();var a=e.vertexInput.getBuffer("vertexBC");if(t.setNumberOfVertices(a.getSizeInBytes()/a.getStrideInBytes()),t.setTopology(t.getTopologyFromUsage(e.usage)),t.updateUBO(),t.haveWideLines()){var i=r.getProperty();t.setNumberOfInstances(Math.ceil(i.getLineWidth()*2))}else t.setNumberOfInstances(1)}}var xM={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function Rp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xM,r),Sp.extend(t,e,r),e.fragmentShaderTemplate=SM,e.vertexShaderTemplate=CM,e._tmpMat3=Jr(new Float64Array(9)),e._tmpMat4=De(new Float64Array(16)),e.UBO=aa.newInstance({label:"mapperUBO"}),e.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),e.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),e.UBO.addEntry("MCWCNormals","mat4x4<f32>"),e.UBO.addEntry("AmbientColor","vec4<f32>"),e.UBO.addEntry("DiffuseColor","vec4<f32>"),e.UBO.addEntry("EdgeColor","vec4<f32>"),e.UBO.addEntry("SpecularColor","vec4<f32>"),e.UBO.addEntry("AmbientIntensity","f32"),e.UBO.addEntry("DiffuseIntensity","f32"),e.UBO.addEntry("Roughness","f32"),e.UBO.addEntry("Metallic","f32"),e.UBO.addEntry("Ambient","f32"),e.UBO.addEntry("Normal","f32"),e.UBO.addEntry("Emission","f32"),e.UBO.addEntry("NormalStrength","f32"),e.UBO.addEntry("BaseIOR","f32"),e.UBO.addEntry("SpecularIntensity","f32"),e.UBO.addEntry("LineWidth","f32"),e.UBO.addEntry("Opacity","f32"),e.UBO.addEntry("ZValue","f32"),e.UBO.addEntry("PropID","u32"),e.UBO.addEntry("ClipNear","f32"),e.UBO.addEntry("ClipFar","f32"),e.UBO.addEntry("Time","u32"),gt(t,e,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),e.textures=[],EM(t,e)}var wM=Ue(Rp,"vtkWebGPUCellArrayMapper"),$i={newInstance:wM,extend:Rp},ti=ur.PrimitiveTypes;function OM(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper"),t.createCellArrayMapper=function(){return $i.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=ti.Points;s<=ti.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var f=e.primitives[s];f.setCellArray(n[s]),f.setCurrentInput(r),f.setCellOffset(i),f.setPrimitiveType(s),f.setRenderable(e.renderable),i+=n[s].getNumberOfCells(),a.push(f)}else e.primitives[s]=null;if(e.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(var o=ti.TriangleEdges;o<=ti.TriangleStripEdges;o++)if(n[o-2].getNumberOfValues()>0){e.primitives[o]||(e.primitives[o]=t.createCellArrayMapper());var u=e.primitives[o];u.setCellArray(n[o-2]),u.setCurrentInput(r),u.setCellOffset(e.primitives[o-2].getCellOffset()),u.setPrimitiveType(o),u.setRenderable(e.renderable),a.push(u)}else e.primitives[o]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}var MM={primitives:null};function DM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,MM,r),Ie.extend(t,e,r),e.primitives=[],OM(t,e)}var mM=Ue(DM,"vtkWebGPUPolyDataMapper");jt("vtkMapper",mM);function Ac(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function RM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ac(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Pc=ur.PrimitiveTypes;function LM(t,e){e.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),t.createCellArrayMapper=function(){return $i.newInstance()},t.buildPass=function(r){if(r){e.WebGPUActor=t.getFirstAncestorOfType("vtkWebGPUActor2D"),e.renderable.getStatic()||e.renderable.update();var n=e.renderable.getInputData();e.renderable.mapScalars(n,1),t.updateCellArrayMappers(n)}},t.updateCellArrayMappers=function(r){for(var n=[r.getVerts(),r.getLines(),r.getPolys(),r.getStrips()],a=[],i=0,s=Pc.Points;s<=Pc.Triangles;s++)if(n[s].getNumberOfValues()>0){e.primitives[s]||(e.primitives[s]=t.createCellArrayMapper());var f=e.primitives[s];f.setCellArray(n[s]),f.setCurrentInput(r),f.setCellOffset(i),f.setPrimitiveType(s),f.setRenderable(e.renderable),f.setIs2D(!0),i+=n[s].getNumberOfCells(),a.push(f)}else e.primitives[s]=null;t.prepareNodes(),t.addMissingChildren(a),t.removeUnusedNodes()}}function VM(t){return RM({primitives:[]},t)}function _M(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,VM(r)),Ie.extend(t,e,r),e.primitives=[],LM(t,e)}var bM=Ue(_M,"vtkWebGPUPolyDataMapper2D");jt("vtkMapper2D",bM);function kM(t,e){e.classHierarchy.push("vtkWebGPUScalarBarActor"),t.buildPass=function(r){r&&(e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent(),e.scalarBarActorHelper.getRenderable()||e.scalarBarActorHelper.setRenderable(e.renderable),t.prepareNodes(),t.addMissingNode(e.scalarBarActorHelper.getBarActor()),t.addMissingNode(e.scalarBarActorHelper.getTmActor()),t.removeUnusedNodes())},t.opaquePass=function(r,n){if(r){var a=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,i=e.WebGPURenderer.getTiledSizeAndOrigin();e.scalarBarActorHelper.updateAPISpecificData([i.usize,i.vsize],a,e.WebGPURenderWindow.getRenderable())}}}var FM={};function BM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,FM,r),Ie.extend(t,e,r),e.scalarBarActorHelper=cp.newScalarBarActorHelper(),kM(t,e)}var NM=Ue(BM,"vtkWebGPUScalarBarActor");jt("vtkScalarBarActor",NM);function UM(t,e){e.classHierarchy.push("vtkWebGPUSampler"),t.create=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.device=r,e.options.addressModeU=n.addressModeU?n.addressModeU:"clamp-to-edge",e.options.addressModeV=n.addressModeV?n.addressModeV:"clamp-to-edge",e.options.addressModeW=n.addressModeW?n.addressModeW:"clamp-to-edge",e.options.magFilter=n.magFilter?n.magFilter:"nearest",e.options.minFilter=n.minFilter?n.minFilter:"nearest",e.options.mipmapFilter=n.mipmapFilter?n.mipmapFilter:"nearest",e.options.label=e.label,e.handle=e.device.getHandle().createSampler(e.options),e.bindGroupTime.modified()},t.getShaderCode=function(r,n){var a="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": sampler;");return a},t.getBindGroupEntry=function(){var r={resource:e.handle};return r}}var GM={device:null,handle:null,label:null,options:null};function Lp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,GM,r),L.obj(t,e),e.options={},e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),L.get(t,e,["bindGroupTime","handle","options"]),L.setGet(t,e,["bindGroupLayoutEntry","device","label"]),UM(t,e)}var AM=L.newInstance(Lp),PM={newInstance:AM,extend:Lp};function WM(t,e){e.classHierarchy.push("vtkWebGPUTextureView"),t.create=function(r,n){e.texture=r,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=ot.getDetailsFromTextureFormat(e.texture.getFormat());e.bindGroupLayoutEntry.texture.sampleType=a.sampleType},t.createFromTextureHandle=function(r,n){e.texture=null,e.options=n,e.options.dimension=e.options.dimension||"2d",e.options.label=e.label,e.textureHandle=r,e.handle=e.textureHandle.createView(e.options),e.bindGroupLayoutEntry.texture.viewDimension=e.options.dimension;var a=ot.getDetailsFromTextureFormat(n.format);e.bindGroupLayoutEntry.texture.sampleType=a.sampleType,e.bindGroupTime.modified()},t.getBindGroupEntry=function(){var r={resource:t.getHandle()};return r},t.getShaderCode=function(r,n){var a="f32";e.bindGroupLayoutEntry.texture.sampleType==="sint"?a="i32":e.bindGroupLayoutEntry.texture.sampleType==="uint"&&(a="u32");var i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_").concat(e.options.dimension,"<").concat(a,">;");return e.bindGroupLayoutEntry.texture.sampleType==="depth"&&(i="@binding(".concat(r,") @group(").concat(n,") var ").concat(e.label,": texture_depth_").concat(e.options.dimension,";")),i},t.addSampler=function(r,n){var a=PM.newInstance({label:"".concat(e.label,"Sampler")});a.create(r,n),t.setSampler(a)},t.getBindGroupTime=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.bindGroupTime},t.getHandle=function(){return e.texture&&e.texture.getHandle()!==e.textureHandle&&(e.textureHandle=e.texture.getHandle(),e.handle=e.textureHandle.createView(e.options),e.bindGroupTime.modified()),e.handle}}var zM={texture:null,handle:null,sampler:null,label:null};function Vp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zM,r),L.obj(t,e),e.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},e.bindGroupTime={},L.obj(e.bindGroupTime,{mtime:0}),L.get(t,e,["bindGroupTime","texture"]),L.setGet(t,e,["bindGroupLayoutEntry","label","sampler"]),WM(t,e)}var jM=L.newInstance(Vp),$M={newInstance:jM,extend:Vp},Wc=ur.BufferUsage;function HM(t,e){e.classHierarchy.push("vtkWebGPUTexture"),t.create=function(r,n){e.device=r,e.width=n.width,e.height=n.height,e.depth=n.depth?n.depth:1;var a=e.depth===1?"2d":"3d";e.format=n.format?n.format:"rgba8unorm",e.mipLevel=n.mipLevel?n.mipLevel:0,e.usage=n.usage?n.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label,dimension:a,mipLevelCount:e.mipLevel+1})},t.assignFromHandle=function(r,n,a){e.device=r,e.handle=n,e.width=a.width,e.height=a.height,e.depth=a.depth?a.depth:1,e.format=a.format?a.format:"rgba8unorm",e.usage=a.usage?a.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},t.writeImageData=function(r){var n=[];if(r.canvas){e.device.getHandle().queue.copyExternalImageToTexture({source:r.canvas,flipY:r.flip},{texture:e.handle,premultipliedAlpha:!0},[e.width,e.height,e.depth]),e.ready=!0;return}r.jsImageData&&!r.nativeArray&&(r.width=r.jsImageData.width,r.height=r.jsImageData.height,r.depth=1,r.format="rgba8unorm",r.flip=!0,r.nativeArray=r.jsImageData.data);var a=ot.getDetailsFromTextureFormat(e.format),i=e.width*a.stride,s=function(D,b,N){var P=D.length/(b*N)*D.BYTES_PER_ELEMENT,O=a.elementSize===2&&a.sampleType==="float";if(O||P%256){for(var A=D,z=P/A.BYTES_PER_ELEMENT,j=a.elementSize,B=256*Math.floor((z*j+255)/256),Y=B/j,I=L.newTypedArray(O?"Uint16Array":A.constructor.name,Y*b*N),te=0;te<b*N;te++)if(O)for(var U=0;U<z;U++)I[te*Y+U]=Wr.toHalf(A[te*z+U]);else I.set(A.subarray(te*z,(te+1)*z),te*Y);return[I,B]}return[D,P]};if(r.nativeArray&&(n=r.nativeArray),r.image){var f=document.createElement("canvas");f.width=r.image.width,f.height=r.image.height;var o=f.getContext("2d");o.translate(0,f.height),o.scale(1,-1),o.drawImage(r.image,0,0,r.image.width,r.image.height,0,0,f.width,f.height);var u=o.getImageData(0,0,r.image.width,r.image.height);n=u.data}var g=e.device.createCommandEncoder();if(t.getDimensionality()!==3){for(var c=zi.generateMipmaps(n,e.width,e.height,e.mipLevel),l=e.width,h=e.height,y=0;y<=e.mipLevel;y++){var C=s(c[y],h,1);i=C[1];var T={dataArray:r.dataArray?r.dataArray:null,nativeArray:C[0],usage:Wc.Texture},E=e.device.getBufferManager().getBuffer(T);g.copyBufferToTexture({buffer:E.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:h},{texture:e.handle,mipLevel:y},[l,h,1]),l/=2,h/=2}e.device.submitCommandEncoder(g),e.ready=!0}else{var w=s(n,e.height,e.depth);i=w[1];var x={dataArray:r.dataArray?r.dataArray:null,usage:Wc.Texture};x.nativeArray=w[0];var S=e.device.getBufferManager().getBuffer(x);g.copyBufferToTexture({buffer:S.getHandle(),offset:0,bytesPerRow:i,rowsPerImage:e.height},{texture:e.handle},[e.width,e.height,e.depth]),e.device.submitCommandEncoder(g),e.ready=!0}},t.getScale=function(){var r=ot.getDetailsFromTextureFormat(e.format),n=r.elementSize===2&&r.sampleType==="float";return n?1:255},t.getNumberOfComponents=function(){var r=ot.getDetailsFromTextureFormat(e.format);return r.numComponents},t.getDimensionality=function(){var r=0;return e.width>1&&r++,e.height>1&&r++,e.depth>1&&r++,r},t.resizeToMatch=function(r){(r.getWidth()!==e.width||r.getHeight()!==e.height||r.getDepth()!==e.depth)&&(e.width=r.getWidth(),e.height=r.getHeight(),e.depth=r.getDepth(),e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.resize=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;(r!==e.width||n!==e.height||a!==e.depth)&&(e.width=r,e.height=n,e.depth=a,e.handle=e.device.getHandle().createTexture({size:[e.width,e.height,e.depth],format:e.format,usage:e.usage,label:e.label}))},t.createView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n.dimension||(n.dimension=e.depth===1?"2d":"3d");var a=$M.newInstance({label:r});return a.create(t,n),a}}var KM={device:null,handle:null,buffer:null,ready:!1,label:null};function XM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KM,r),L.obj(t,e),L.get(t,e,["handle","ready","width","height","depth","format","usage"]),L.setGet(t,e,["device","label"]),HM(t,e)}L.newInstance(XM);function YM(t,e){e.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),t.opaquePass=function(r,n){e.WebGPURenderer=t.getFirstAncestorOfType("vtkWebGPURenderer"),e.WebGPURenderWindow=e.WebGPURenderer.getParent();var a=e.WebGPURenderer.getAspectRatio(),i=e.WebGPURenderer?e.WebGPURenderer.getRenderable().getActiveCamera():null,s=e.WebGPURenderer.getTiledSizeAndOrigin(),f=null;e.renderable.getUseZValues(),e.renderable.invokeCallback(e.renderable.getInputData(),i,a,s,f)}}var IM={};function qM(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,IM,r),Ie.extend(t,e,r),YM(t,e)}var ZM=L.newInstance(qM,"vtkWebGPUPixelSpaceCallbackMapper");jt("vtkPixelSpaceCallbackMapper",ZM);var QM=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkSphereMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Spheres

attribute vec4 vertexMC;
attribute vec2 offsetMC;

// optional normal declaration
//VTK::Normal::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying vec3 centerVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  // compute the projected vertex position
  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = length(offsetMC)*0.5;

  // make the triangle face the camera
  if (cameraParallel == 0)
    {
    vec3 dir = normalize(-vertexVCVSOutput.xyz);
    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));
    vec3 base1 = cross(base2,dir);
    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + offsetMC.x*base1 + offsetMC.y*base2;
    }
  else
    {
    // add in the offset
    vertexVCVSOutput.xy = vertexVCVSOutput.xy + offsetMC;
    }

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;function zc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function JM(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var eD=ve;function tD(t,e){e.classHierarchy.push("vtkOpenGLSphereMapper");var r=JM({},t);t.getShaderTemplate=function(n,a,i){n.Vertex=QM,n.Fragment=af,n.Geometry=""},t.replaceShaderValues=function(n,a,i){var s=n.Vertex,f=n.Fragment;s=$.substitute(s,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,f=$.substitute(f,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,f=$.substitute(f,"//VTK::PositionVC::Impl",[`vec4 vertexVC = vertexVCVSOutput;
`]).result;var o=[`uniform float invertedDepth;
`,`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];f=$.substitute(f,"//VTK::Normal::Dec",o).result;var u="";e.context.getExtension("EXT_frag_depth")&&(u=`gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(u=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),f=$.substitute(f,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float b = 2.0*dot(EyePos,EyeDir);
`,`  float c = dot(EyePos,EyePos) - 1.0;
`,`  float d = b*b - 4.0*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t = (-b - invertedDepth*sqrt(d))*0.5;
`,`    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);
`,`    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,u]).result,f=$.substitute(f,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(f=$.substitute(f,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=s,n.Fragment=f,r.replaceShaderValues(n,a,i)},t.setMapperShaderParameters=function(n,a,i){n.getCABO().getElementCount()&&(e.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&n.getProgram().isAttributeUsed("offsetMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"offsetMC",12,n.getCABO().getStride(),e.context.FLOAT,2,!1)||eD("Error setting 'offsetMC' in shader VAO.")),n.getProgram().isUniformUsed("invertedDepth")&&n.getProgram().setUniformf("invertedDepth",e.invert?-1:1),r.setMapperShaderParameters(n,a,i)},t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=a.getActiveCamera(),o=e.openGLCamera.getKeyMatrices(a);if(s.isUniformUsed("VCPCMatrix")&&s.setUniformMatrix("VCPCMatrix",o.vcpc),s.isUniformUsed("MCVCMatrix"))if(i.getIsIdentity())s.setUniformMatrix("MCVCMatrix",o.wcvc);else{var u=e.openGLActor.getKeyMatrices(),g=new Float64Array(16);Ct(g,o.wcvc,u.mcwc),s.setUniformMatrix("MCVCMatrix",g)}s.isUniformUsed("cameraParallel")&&n.getProgram().setUniformi("cameraParallel",f.getParallelProjection())},t.getOpenGLMode=function(n,a){return e.context.TRIANGLES},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors(),f=e.primitives[e.primTypes.Tris].getCABO(),o=i.getPointData(),u=i.getPoints(),g=u.getNumberOfPoints(),c=u.getData(),l=5,h=null;e.renderable.getScaleArray()!=null&&o.hasArray(e.renderable.getScaleArray())&&(h=o.getArray(e.renderable.getScaleArray()).getData());var y=null,C=0,T=null;s?(C=s.getNumberOfComponents(),f.setColorOffset(0),f.setColorBOStride(4),y=s.getData(),T=new Uint8Array(3*g*4),f.getColorBO()||f.setColorBO(ji.newInstance()),f.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow)):f.getColorBO()&&f.setColorBO(null),f.setColorComponents(C);var E=new Float32Array(l*g*3);f.setStride(l*4);for(var w=Math.cos(Ke(30)),x=0,S=0,m=0,D=0,b=0;b<g;++b){var N=e.renderable.getRadius();h&&(N=h[b]),x=b*3,E[m++]=c[x++],E[m++]=c[x++],E[m++]=c[x++],E[m++]=-2*N*w,E[m++]=-N,y&&(S=b*C,T[D++]=y[S],T[D++]=y[S+1],T[D++]=y[S+2],T[D++]=y[S+3]),x=b*3,E[m++]=c[x++],E[m++]=c[x++],E[m++]=c[x++],E[m++]=2*N*w,E[m++]=-N,y&&(T[D++]=y[S],T[D++]=y[S+1],T[D++]=y[S+2],T[D++]=y[S+3]),x=b*3,E[m++]=c[x++],E[m++]=c[x++],E[m++]=c[x++],E[m++]=0,E[m++]=2*N,y&&(T[D++]=y[S],T[D++]=y[S+1],T[D++]=y[S+2],T[D++]=y[S+3])}f.setElementCount(m/l),f.upload(E,sr.ARRAY_BUFFER),s&&f.getColorBO().upload(T,sr.ARRAY_BUFFER),e.VBOBuildTime.modified()}}}var rD={};function nD(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rD,r),np.extend(t,e,r),tD(t,e)}var aD=Ue(nD,"vtkOpenGLSphereMapper");Mt("vtkSphereMapper",aD);var iD=`//VTK::System::Dec

/*=========================================================================

  Program:   Visualization Toolkit
  Module:    vtkStickMapperVS.glsl

  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen
  All rights reserved.
  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.

     This software is distributed WITHOUT ANY WARRANTY; without even
     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
     PURPOSE.  See the above copyright notice for more information.

=========================================================================*/
// this shader implements imposters in OpenGL for Sticks

attribute vec4 vertexMC;
attribute vec3 orientMC;
attribute vec4 offsetMC;
attribute float radiusMC;

// optional normal declaration
//VTK::Normal::Dec

//VTK::Picking::Dec

// Texture coordinates
//VTK::TCoord::Dec

uniform mat3 normalMatrix; // transform model coordinate directions to view coordinates

// material property values
//VTK::Color::Dec

// clipping plane vars
//VTK::Clip::Dec

// camera and actor matrix values
//VTK::Camera::Dec

varying vec4 vertexVCVSOutput;
varying float radiusVCVSOutput;
varying float lengthVCVSOutput;
varying vec3 centerVCVSOutput;
varying vec3 orientVCVSOutput;

uniform int cameraParallel;

void main()
{
  //VTK::Picking::Impl

  //VTK::Color::Impl

  //VTK::Normal::Impl

  //VTK::TCoord::Impl

  //VTK::Clip::Impl

  vertexVCVSOutput = MCVCMatrix * vertexMC;
  centerVCVSOutput = vertexVCVSOutput.xyz;
  radiusVCVSOutput = radiusMC;
  lengthVCVSOutput = length(orientMC);
  orientVCVSOutput = normalMatrix * normalize(orientMC);

  // make sure it is pointing out of the screen
  if (orientVCVSOutput.z < 0.0)
    {
    orientVCVSOutput = -orientVCVSOutput;
    }

  // make the basis
  vec3 xbase;
  vec3 ybase;
  vec3 dir = vec3(0.0,0.0,1.0);
  if (cameraParallel == 0)
    {
    dir = normalize(-vertexVCVSOutput.xyz);
    }
  if (abs(dot(dir,orientVCVSOutput)) == 1.0)
    {
    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));
    ybase = cross(xbase,orientVCVSOutput);
    }
  else
    {
    xbase = normalize(cross(orientVCVSOutput,dir));
    ybase = cross(orientVCVSOutput,xbase);
    }

  vec3 offsets = offsetMC.xyz*2.0-1.0;
  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +
    radiusVCVSOutput*offsets.x*xbase +
    radiusVCVSOutput*offsets.y*ybase +
    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;

  gl_Position = VCPCMatrix * vertexVCVSOutput;
}
`;function jc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function sD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ri=ve;function oD(t,e){e.classHierarchy.push("vtkOpenGLStickMapper");var r=sD({},t);t.getShaderTemplate=function(n,a,i){n.Vertex=iD,n.Fragment=af,n.Geometry=""},t.replaceShaderValues=function(n,a,i){var s=n.Vertex,f=n.Fragment;s=$.substitute(s,"//VTK::Camera::Dec",[`uniform mat4 VCPCMatrix;
`,"uniform mat4 MCVCMatrix;"]).result,f=$.substitute(f,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,f=$.substitute(f,"//VTK::PositionVC::Impl",`  vec4 vertexVC = vertexVCVSOutput;
`).result;var o=[`uniform int cameraParallel;
`,`varying float radiusVCVSOutput;
`,`varying vec3 orientVCVSOutput;
`,`varying float lengthVCVSOutput;
`,`varying vec3 centerVCVSOutput;
`,`uniform mat4 VCPCMatrix;
`];f=$.substitute(f,"//VTK::Normal::Dec",o).result;var u="";e.context.getExtension("EXT_frag_depth")&&(u=`  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;
`),e._openGLRenderWindow.getWebgl2()&&(u=`gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;
`),f=$.substitute(f,"//VTK::Depth::Impl",[`  vec3 EyePos;
`,`  vec3 EyeDir;
`,`  if (cameraParallel != 0) {
`,`    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);
`,`    EyeDir = vec3(0.0,0.0,-1.0); }
`,`  else {
`,`    EyeDir = vertexVC.xyz;
`,`    EyePos = vec3(0.0,0.0,0.0);
`,`    float lengthED = length(EyeDir);
`,`    EyeDir = normalize(EyeDir);
`,`    if (lengthED > radiusVCVSOutput*3.0) {
`,`      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }
`,`    }
`,`  EyePos = EyePos - centerVCVSOutput;
`,`  vec3 base1;
`,`  if (abs(orientVCVSOutput.z) < 0.99) {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }
`,`  else {
`,`    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }
`,`  vec3 base2 = cross(orientVCVSOutput,base1);
`,`  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));
`,`  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));
`,`  EyePos = EyePos/radiusVCVSOutput;
`,`  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
`,`  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
`,`  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
`,`  float d = b*b - 4.0*a*c;
`,`  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);
`,`  if (d < 0.0) { discard; }
`,`  else {
`,`    float t =  (-b - sqrt(d))/(2.0*a);
`,`    float tz = EyePos.z + t*EyeDir.z;
`,`    vec3 iPoint = EyePos + t*EyeDir;
`,`    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {
`,`      float t2 = (-b + sqrt(d))/(2.0*a);
`,`      float tz2 = EyePos.z + t2*EyeDir.z;
`,`      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }
`,`      else {
`,`        normalVCVSOutput = orientVCVSOutput;
`,`        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;
`,`        iPoint = EyePos + t3*EyeDir;
`,`        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`        }
`,`      }
`,`    else {
`,`      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;
`,`      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;
`,`      }
`,`    }
`,`  vec4 pos = VCPCMatrix * vertexVC;
`,u]).result,f=$.substitute(f,"//VTK::Normal::Impl","").result,e.haveSeenDepthRequest&&(f=$.substitute(f,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=s,n.Fragment=f,r.replaceShaderValues(n,a,i)},t.setMapperShaderParameters=function(n,a,i){n.getCABO().getElementCount()&&(e.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(n.getProgram().isAttributeUsed("orientMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"orientMC",12,n.getCABO().getStride(),e.context.FLOAT,3,!1)||ri("Error setting 'orientMC' in shader VAO.")),n.getProgram().isAttributeUsed("offsetMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"offsetMC",0,n.getCABO().getColorBOStride(),e.context.UNSIGNED_BYTE,3,!0)||ri("Error setting 'offsetMC' in shader VAO.")),n.getProgram().isAttributeUsed("radiusMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"radiusMC",24,n.getCABO().getStride(),e.context.FLOAT,1,!1)||ri("Error setting 'radiusMC' in shader VAO."))),r.setMapperShaderParameters(n,a,i)},t.setCameraShaderParameters=function(n,a,i){var s=n.getProgram(),f=a.getActiveCamera(),o=e.openGLCamera.getKeyMatrices(a);if(s.isUniformUsed("VCPCMatrix")&&s.setUniformMatrix("VCPCMatrix",o.vcpc),i.getIsIdentity())s.isUniformUsed("MCVCMatrix")&&s.setUniformMatrix("MCVCMatrix",o.wcvc),s.isUniformUsed("normalMatrix")&&s.setUniformMatrix3x3("normalMatrix",o.normalMatrix);else{var u=e.openGLActor.getKeyMatrices();if(s.isUniformUsed("MCVCMatrix")){var g=new Float64Array(16);Ct(g,o.wcvc,u.mcwc),s.setUniformMatrix("MCVCMatrix",g)}if(s.isUniformUsed("normalMatrix")){var c=new Float64Array(9);bo(c,o.normalMatrix,u.normalMatrix),s.setUniformMatrix3x3("normalMatrix",c)}}s.isUniformUsed("cameraParallel")&&n.getProgram().setUniformi("cameraParallel",f.getParallelProjection())},t.getOpenGLMode=function(n,a){return e.context.TRIANGLES},t.buildBufferObjects=function(n,a){var i=e.currentInput;if(i!==null){e.renderable.mapScalars(i,1);var s=e.renderable.getColorMapColors(),f=e.primitives[e.primTypes.Tris].getCABO(),o=i.getPointData(),u=i.getPoints(),g=u.getNumberOfPoints(),c=u.getData(),l=3;l+=4;var h=null,y=0;f.setColorBOStride(4),f.getColorBO()||f.setColorBO(ji.newInstance()),f.getColorBO().setOpenGLRenderWindow(e._openGLRenderWindow),s&&(y=s.getNumberOfComponents(),f.setColorOffset(4),h=s.getData(),f.setColorBOStride(8)),f.setColorComponents(y),f.setStride(l*4);var C=new Float32Array(l*g*12),T=new Uint8Array(12*g*(h?8:4)),E=null,w=null;e.renderable.getScaleArray()!=null&&o.hasArray(e.renderable.getScaleArray())&&(E=o.getArray(e.renderable.getScaleArray()).getData()),e.renderable.getOrientationArray()!=null&&o.hasArray(e.renderable.getOrientationArray())?w=o.getArray(e.renderable.getOrientationArray()).getData():ri([`Error setting orientationArray.
`,"You have to specify the stick orientation"]);for(var x=[0,1,3,0,3,2,2,3,5,2,5,4],S=0,m=0,D=0,b=0,N=0;N<g;++N){var P=e.renderable.getLength(),O=e.renderable.getRadius();E&&(P=E[N*2],O=E[N*2+1]);for(var A=0;A<x.length;++A)S=N*3,C[D++]=c[S++],C[D++]=c[S++],C[D++]=c[S++],S=N*3,C[D++]=w[S++]*P,C[D++]=w[S++]*P,C[D++]=w[S++]*P,C[D++]=O,T[b++]=255*(x[A]%2),T[b++]=x[A]>=4?255:0,T[b++]=x[A]>=2?255:0,T[b++]=255,m=N*y,h&&(T[b++]=h[m],T[b++]=h[m+1],T[b++]=h[m+2],T[b++]=h[m+3])}f.setElementCount(D/l),f.upload(C,sr.ARRAY_BUFFER),f.getColorBO().upload(T,sr.ARRAY_BUFFER),e.VBOBuildTime.modified()}}}var fD={};function uD(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,fD,r),np.extend(t,e,r),oD(t,e)}var cD=Ue(uD,"vtkOpenGLStickMapper");Mt("vtkStickMapper",cD);var Ws=ur.BufferUsage,gD=ve,vD=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::Color::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var output : vertexOutput;

  var vertexVC: vec4<f32> = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);

  //VTK::Color::Impl

  // compute the projected vertex position
  output.centerVC = vertexVC.xyz;
  output.radiusVC = length(offsetMC)*0.5;

  // make the triangle face the camera
  if (rendererUBO.cameraParallel == 0u)
    {
    var dir: vec3<f32> = normalize(-vertexVC.xyz);
    var base2: vec3<f32> = normalize(cross(dir,vec3<f32>(1.0,0.0,0.0)));
    var base1: vec3<f32> = cross(base2,dir);
    dir = vertexVC.xyz + offsetMC.x*base1 + offsetMC.y*base2;
    vertexVC = vec4<f32>(dir, 1.0);
    }
  else
    {
    // add in the offset
    var tmp2: vec2<f32> = vertexVC.xy + offsetMC;
    vertexVC = vec4<f32>(tmp2, vertexVC.zw);
    }

  output.vertexVC = vec4<f32>(vertexVC.xyz, 0.0);

  //VTK::Position::Impl

  return output;
}
`;function lD(t,e){e.classHierarchy.push("vtkWebGPUSphereMapper");var r=t.buildPass;t.buildPass=function(n){if(n){e.renderable.getStatic()||e.renderable.update();var a=e.renderable.getInputData();t.setCellArray(a.getVerts()),t.setCurrentInput(a)}r(n)},t.replaceShaderNormal=function(n,a,i){var s=a.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC"),s.addOutput("vec3<f32>","centerVC"),s.addOutput("f32","radiusVC");var f=a.getShaderDescription("fragment");f.addBuiltinOutput("f32","@builtin(frag_depth) fragDepth");var o=`
    // compute the eye position and unit direction
    var vertexVC: vec4<f32>;
    var EyePos: vec3<f32>;
    var EyeDir: vec3<f32>;
    var invertedDepth: f32 = 1.0;
    if (rendererUBO.cameraParallel != 0u) {
      EyePos = vec3<f32>(input.vertexVC.x, input.vertexVC.y, input.vertexVC.z + 3.0*input.radiusVC);
      EyeDir = vec3<f32>(0.0, 0.0, -1.0);
    }
    else {
      EyeDir = input.vertexVC.xyz;
      EyePos = vec3<f32>(0.0,0.0,0.0);
      var lengthED: f32 = length(EyeDir);
      EyeDir = normalize(EyeDir);
      // we adjust the EyePos to be closer if it is too far away
      // to prevent floating point precision noise
      if (lengthED > input.radiusVC*3.0) {
        EyePos = input.vertexVC.xyz - EyeDir*3.0*input.radiusVC;
      }
    }

    // translate to Sphere center
    EyePos = EyePos - input.centerVC;
    // scale to radius 1.0
    EyePos = EyePos * (1.0 / input.radiusVC);
    // find the intersection
    var b: f32 = 2.0*dot(EyePos,EyeDir);
    var c: f32 = dot(EyePos,EyePos) - 1.0;
    var d: f32 = b*b - 4.0*c;
    var normal: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
    if (d < 0.0) { discard; }
    else {
      var t: f32 = (-b - invertedDepth*sqrt(d))*0.5;

      // compute the normal, for unit sphere this is just
      // the intersection point
      normal = invertedDepth*normalize(EyePos + t*EyeDir);
      // compute the intersection point in VC
      vertexVC = vec4<f32>(normal * input.radiusVC + input.centerVC, 1.0);
    }
    // compute the pixel's depth
    var pos: vec4<f32> = rendererUBO.VCPCMatrix * vertexVC;
    output.fragDepth = pos.z / pos.w;
    `,u=f.getCode();u=Fe.substitute(u,"//VTK::Normal::Impl",[o]).result,f.setCode(u)},t.replaceShaderPosition=function(n,a,i){var s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var f=s.getCode();f=Fe.substitute(f,"//VTK::Position::Impl",["  output.Position = rendererUBO.VCPCMatrix*vertexVC;"]).result,s.setCode(f)},t.computePipelineHash=function(){e.pipelineHash="spm",e.vertexInput.hasAttribute("colorVI")&&(e.pipelineHash+="c"),e.pipelineHash+=e.renderEncoder.getPipelineHash()},t.updateBuffers=function(){var n=e.currentInput;e.renderable.mapScalars(n,1);var a=n.getPoints(),i=a.getNumberOfPoints(),s=a.getData();t.setNumberOfInstances(1),t.setNumberOfVertices(3*i);var f=e.vertexInput,o="spm".concat(a.getMTime(),"float32x3");if(!e.device.getBufferManager().hasBuffer(o)){for(var u={hash:o,usage:Ws.RawVertex,format:"float32x3"},g=new Float32Array(3*i*3),c=0,l=0,h=0;h<i;++h)c=h*3,g[l++]=s[c],g[l++]=s[c+1],g[l++]=s[c+2],g[l++]=s[c],g[l++]=s[c+1],g[l++]=s[c+2],g[l++]=s[c],g[l++]=s[c+1],g[l++]=s[c+2];u.nativeArray=g;var y=e.device.getBufferManager().getBuffer(u);f.addBuffer(y,["vertexBC"])}var C=n.getPointData(),T=null;e.renderable.getScaleArray()!=null&&C.hasArray(e.renderable.getScaleArray())&&(T=C.getArray(e.renderable.getScaleArray()).getData());var E=e.renderable.getRadius();if(T||E!==e._lastRadius){if(o="spm".concat(T?C.getArray(e.renderable.getScaleArray()).getMTime():E,"float32x2"),!e.device.getBufferManager().hasBuffer(o)){for(var w={hash:o,usage:Ws.RawVertex,format:"float32x2"},x=new Float32Array(3*i*2),S=Math.cos(Ke(30)),m=0,D=0;D<i;++D){var b=e.renderable.getRadius();T&&(b=T[D]),x[m++]=-2*b*S,x[m++]=-b,x[m++]=2*b*S,x[m++]=-b,x[m++]=0,x[m++]=2*b}w.nativeArray=x;var N=e.device.getBufferManager().getBuffer(w);f.addBuffer(N,["offsetMC"])}e._lastRadius=E}var P=!1;if(e.renderable.getScalarVisibility()){var O=e.renderable.getColorMapColors();if(O){if(o="spm".concat(O.getMTime(),"unorm8x4"),!e.device.getBufferManager().hasBuffer(o)){var A={hash:o,usage:Ws.RawVertex,format:"unorm8x4"},z=O.getNumberOfComponents();z!==4&&gD("this should be 4");for(var j=new Uint8Array(3*i*4),B=0,Y=O.getData(),I=0;I<i;++I)for(var te=I*z,U=0;U<3;U++)j[B++]=Y[te],j[B++]=Y[te+1],j[B++]=Y[te+2],j[B++]=Y[te+3];A.nativeArray=j;var G=e.device.getBufferManager().getBuffer(A);f.addBuffer(G,["colorVI"])}P=!0}}P||f.removeBufferIfPresent("colorVI"),t.setTopology("triangle-list"),t.updateUBO()}}var pD={};function hD(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,pD,r),$i.extend(t,e,r),t.setVertexShaderTemplate(vD),lD(t,e);var n=e.shaderReplacements;n.set("replaceShaderPosition",t.replaceShaderPosition),n.set("replaceShaderNormal",t.replaceShaderNormal)}var yD=Ue(hD,"vtkWebGPUSphereMapper");jt("vtkSphereMapper",yD);var ni=ur.BufferUsage,$c=ve,dD=`
//VTK::Renderer::Dec

//VTK::Mapper::Dec

//VTK::Color::Dec

//VTK::IOStructs::Dec

@vertex
fn main(
//VTK::IOStructs::Input
)
//VTK::IOStructs::Output
{
  var offsetsArray: array<vec3<f32>, 12> = array<vec3<f32>, 12>(
    vec3<f32>(-1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, 1.0),

    vec3<f32>(-1.0, -1.0, -1.0),
    vec3<f32>(1.0, -1.0, 1.0),
    vec3<f32>(-1.0, -1.0, 1.0),

    vec3<f32>(-1.0, -1.0, 1.0),
    vec3<f32>(1.0, -1.0, 1.0),
    vec3<f32>(1.0, 1.0, 1.0),

    vec3<f32>(-1.0, -1.0, 1.0),
    vec3<f32>(1.0, 1.0, 1.0),
    vec3<f32>(-1.0, 1.0, 1.0)
  );

  var output : vertexOutput;

  var vertexVC: vec4<f32> = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);

  //VTK::Color::Impl

  // compute the projected vertex position
  output.centerVC = vertexVC.xyz;
  output.radiusVC = radiusMC;
  output.lengthVC = length(orientMC);
  output.orientVC = (rendererUBO.WCVCNormals * vec4<f32>(normalize(orientMC), 0.0)).xyz;

  // make sure it is pointing out of the screen
  if (output.orientVC.z < 0.0)
    {
    output.orientVC = -output.orientVC;
    }

  // make the basis
  var xbase: vec3<f32>;
  var ybase: vec3<f32>;
  var dir: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
  if (rendererUBO.cameraParallel == 0u)
    {
    dir = normalize(-vertexVC.xyz);
    }
  if (abs(dot(dir,output.orientVC)) == 1.0)
    {
    xbase = normalize(cross(vec3<f32>(0.0,1.0,0.0),output.orientVC));
    ybase = cross(xbase,output.orientVC);
    }
  else
    {
    xbase = normalize(cross(output.orientVC,dir));
    ybase = cross(output.orientVC,xbase);
    }


  var vertIdx: u32 = input.vertexIndex % 12u;
  var offsets: vec3<f32> = offsetsArray[vertIdx];

  vertexVC = vec4<f32>(vertexVC.xyz +
    output.radiusVC * offsets.x * xbase +
    output.radiusVC * offsets.y * ybase +
    0.5 * output.lengthVC * offsets.z * output.orientVC, 1.0);

  output.vertexVC = vertexVC;

  //VTK::Position::Impl

  return output;
}
`;function TD(t,e){e.classHierarchy.push("vtkWebGPUStickMapper");var r=t.buildPass;t.buildPass=function(n){if(n){e.renderable.getStatic()||e.renderable.update();var a=e.renderable.getInputData();t.setCellArray(a.getVerts()),t.setCurrentInput(a)}r(n)},t.replaceShaderNormal=function(n,a,i){var s=a.getShaderDescription("vertex");s.hasOutput("vertexVC")||s.addOutput("vec4<f32>","vertexVC"),s.addOutput("vec3<f32>","centerVC"),s.addOutput("vec3<f32>","orientVC"),s.addOutput("f32","radiusVC"),s.addOutput("f32","lengthVC"),s.addBuiltinInput("u32","@builtin(vertex_index) vertexIndex");var f=a.getShaderDescription("fragment");f.addBuiltinOutput("f32","@builtin(frag_depth) fragDepth");var o=`
    // compute the eye position and unit direction
    var vertexVC: vec4<f32>;
    var EyePos: vec3<f32>;
    var EyeDir: vec3<f32>;

    if (rendererUBO.cameraParallel != 0u)
    {
      EyePos = vec3<f32>(input.vertexVC.x, input.vertexVC.y, input.vertexVC.z + 3.0*input.radiusVC);
      EyeDir = vec3<f32>(0.0, 0.0, -1.0);
    }
    else
    {
      EyeDir = input.vertexVC.xyz;
      EyePos = vec3<f32>(0.0,0.0,0.0);
      var lengthED: f32 = length(EyeDir);
      EyeDir = normalize(EyeDir);
      // we adjust the EyePos to be closer if it is too far away
      // to prevent floating point precision noise
      if (lengthED > input.radiusVC*3.0)
      {
        EyePos = input.vertexVC.xyz - EyeDir*3.0*input.radiusVC;
      }
    }
    // translate to Sphere center
    EyePos = EyePos - input.centerVC;

    // rotate to new basis
    // base1, base2, orientVC
    var base1: vec3<f32>;
    if (abs(input.orientVC.z) < 0.99)
    {
      base1 = normalize(cross(input.orientVC,vec3<f32>(0.0,0.0,1.0)));
    }
    else
    {
      base1 = normalize(cross(input.orientVC,vec3<f32>(0.0,1.0,0.0)));
    }
    var base2: vec3<f32> = cross(input.orientVC,base1);
    EyePos = vec3<f32>(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,input.orientVC));
    EyeDir = vec3<f32>(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,input.orientVC));

    // scale to radius 1.0
    EyePos = EyePos * (1.0 / input.radiusVC);

    // find the intersection
    var a: f32 = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;
    var b: f32 = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);
    var c: f32 = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;
    var d: f32 = b*b - 4.0*a*c;
    var normal: vec3<f32> = vec3<f32>(0.0,0.0,1.0);
    if (d < 0.0) { discard; }
    else
    {
      var t: f32 = (-b - sqrt(d))*(0.5 / a);
      var tz: f32 = EyePos.z + t*EyeDir.z;
      var iPoint: vec3<f32> = EyePos + t*EyeDir;
      if (abs(iPoint.z)*input.radiusVC > input.lengthVC*0.5)
      {
        // test for end cap
        var t2: f32 = (-b + sqrt(d))*(0.5 / a);
        var tz2: f32 = EyePos.z + t2*EyeDir.z;
        if (tz2*input.radiusVC > input.lengthVC*0.5 || tz*input.radiusVC < -0.5*input.lengthVC) { discard; }
        else
        {
          normal = input.orientVC;
          var t3: f32 = (input.lengthVC*0.5/input.radiusVC - EyePos.z)/EyeDir.z;
          iPoint = EyePos + t3*EyeDir;
          vertexVC = vec4<f32>(input.radiusVC*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*input.orientVC) + input.centerVC, 1.0);
        }
      }
      else
      {
        // The normal is the iPoint.xy rotated back into VC
        normal = iPoint.x*base1 + iPoint.y*base2;
        // rescale rerotate and translate
        vertexVC = vec4<f32>(input.radiusVC*(normal + iPoint.z*input.orientVC) + input.centerVC, 1.0);
      }
    }
    // compute the pixel's depth
    var pos: vec4<f32> = rendererUBO.VCPCMatrix * vertexVC;
    output.fragDepth = pos.z / pos.w;
  `,u=f.getCode();u=Fe.substitute(u,"//VTK::Normal::Impl",[o]).result,f.setCode(u)},t.replaceShaderPosition=function(n,a,i){var s=a.getShaderDescription("vertex");s.addBuiltinOutput("vec4<f32>","@builtin(position) Position");var f=s.getCode();f=Fe.substitute(f,"//VTK::Position::Impl",["  output.Position = rendererUBO.VCPCMatrix*vertexVC;"]).result,s.setCode(f)},t.computePipelineHash=function(){e.pipelineHash="stm",e.vertexInput.hasAttribute("colorVI")&&(e.pipelineHash+="c"),e.pipelineHash+=e.renderEncoder.getPipelineHash()},t.updateBuffers=function(){var n=e.currentInput;e.renderable.mapScalars(n,1);var a=e.device,i=n.getPoints(),s=n.getPointData(),f=i.getNumberOfPoints(),o=i.getData();t.setNumberOfInstances(f),t.setNumberOfVertices(12);var u=e.vertexInput,g="stm".concat(i.getMTime(),"float32x3");if(!a.getBufferManager().hasBuffer(g)){for(var c={hash:g,usage:ni.RawVertex,format:"float32x3"},l=new Float32Array(f*3),h=0,y=0,C=0;C<f;++C)h=C*3,l[y++]=o[h],l[y++]=o[h+1],l[y++]=o[h+2];c.nativeArray=l;var T=a.getBufferManager().getBuffer(c);u.addBuffer(T,["vertexBC"],"instance")}var E=null;e.renderable.getScaleArray()!=null&&s.hasArray(e.renderable.getScaleArray())&&(E=s.getArray(e.renderable.getScaleArray()).getData());var w=e.renderable.getRadius();if(E||w!==e._lastRadius){if(g="stm".concat(E?s.getArray(e.renderable.getScaleArray()).getMTime():w,"float32"),!a.getBufferManager().hasBuffer(g)){for(var x={hash:g,usage:ni.RawVertex,format:"float32"},S=new Float32Array(f),m=0,D=0;D<f;++D){var b=e.renderable.getRadius();E&&(b=E[D*2+1]),S[m++]=b}x.nativeArray=S;var N=a.getBufferManager().getBuffer(x);u.addBuffer(N,["radiusMC"],"instance")}e._lastRadius=w}var P=null;if(e.renderable.getOrientationArray()!=null&&s.hasArray(e.renderable.getOrientationArray())?P=s.getArray(e.renderable.getOrientationArray()).getData():$c([`Error setting orientationArray.
`,"You have to specify the stick orientation"]),g="stm".concat(s.getArray(e.renderable.getOrientationArray()).getMTime(),"float32x3"),!a.getBufferManager().hasBuffer(g)){for(var O={hash:g,usage:ni.RawVertex,format:"float32x3"},A=new Float32Array(f*3),z=0,j=0,B=0;B<f;++B){z=B*3;var Y=e.renderable.getLength();E&&(Y=E[B*2]),A[j++]=P[z]*Y,A[j++]=P[z+1]*Y,A[j++]=P[z+2]*Y}O.nativeArray=A;var I=a.getBufferManager().getBuffer(O);u.addBuffer(I,["orientMC"],"instance")}var te=!1;if(e.renderable.getScalarVisibility()){var U=e.renderable.getColorMapColors();if(U){if(g="stm".concat(U.getMTime(),"unorm8x4"),!a.getBufferManager().hasBuffer(g)){var G={usage:ni.RawVertex,format:"unorm8x4"},K=U.getNumberOfComponents();K!==4&&$c("this should be 4");for(var Z=new Uint8Array(f*4),Q=0,oe=U.getData(),ce=0;ce<f;++ce){var fe=ce*K;Z[Q++]=oe[fe],Z[Q++]=oe[fe+1],Z[Q++]=oe[fe+2],Z[Q++]=oe[fe+3]}G.nativeArray=Z;var pe=a.getBufferManager().getBuffer(G);u.addBuffer(pe,["colorVI"],"instance")}te=!0}}te||u.removeBufferIfPresent("colorVI"),t.setTopology("triangle-list"),t.updateUBO()}}var CD={};function SD(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CD,r),$i.extend(t,e,r),t.setVertexShaderTemplate(dD),TD(t,e);var n=e.shaderReplacements;n.set("replaceShaderPosition",t.replaceShaderPosition),n.set("replaceShaderNormal",t.replaceShaderNormal)}var ED=Ue(SD,"vtkWebGPUStickMapper");jt("vtkStickMapper",ED);function ha(){}function _p(t){return t()}function Hc(){return Object.create(null)}function wa(t){t.forEach(_p)}function xD(t){return typeof t=="function"}function wD(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function OD(t){return Object.keys(t).length===0}function vn(t,e){t.appendChild(e)}function bp(t,e,r){t.insertBefore(e,r||null)}function sf(t){t.parentNode.removeChild(t)}function Zn(t){return document.createElement(t)}function kp(t){return document.createTextNode(t)}function Kc(){return kp(" ")}function Mo(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function zr(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function MD(t){return Array.from(t.childNodes)}function DD(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let ya;function ia(t){ya=t}function mD(){if(!ya)throw new Error("Function called outside component initialization");return ya}function RD(t){mD().$$.on_mount.push(t)}const Qn=[],Do=[],yi=[],Xc=[],LD=Promise.resolve();let mo=!1;function VD(){mo||(mo=!0,LD.then(Fp))}function Ro(t){yi.push(t)}const zs=new Set;let ai=0;function Fp(){const t=ya;do{for(;ai<Qn.length;){const e=Qn[ai];ai++,ia(e),_D(e.$$)}for(ia(null),Qn.length=0,ai=0;Do.length;)Do.pop()();for(let e=0;e<yi.length;e+=1){const r=yi[e];zs.has(r)||(zs.add(r),r())}yi.length=0}while(Qn.length);for(;Xc.length;)Xc.pop()();mo=!1,zs.clear(),ia(t)}function _D(t){if(t.fragment!==null){t.update(),wa(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ro)}}const bD=new Set;function kD(t,e){t&&t.i&&(bD.delete(t),t.i(e))}function FD(t,e,r,n){const{fragment:a,on_mount:i,on_destroy:s,after_update:f}=t.$$;a&&a.m(e,r),n||Ro(()=>{const o=i.map(_p).filter(xD);s?s.push(...o):wa(o),t.$$.on_mount=[]}),f.forEach(Ro)}function BD(t,e){const r=t.$$;r.fragment!==null&&(wa(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function ND(t,e){t.$$.dirty[0]===-1&&(Qn.push(t),VD(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function UD(t,e,r,n,a,i,s,f=[-1]){const o=ya;ia(t);const u=t.$$={fragment:null,ctx:null,props:i,update:ha,not_equal:a,bound:Hc(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:Hc(),dirty:f,skip_bound:!1,root:e.target||o.$$.root};s&&s(u.root);let g=!1;if(u.ctx=r?r(t,e.props||{},(c,l,...h)=>{const y=h.length?h[0]:l;return u.ctx&&a(u.ctx[c],u.ctx[c]=y)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](y),g&&ND(t,c)),l}):[],u.update(),g=!0,wa(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const c=MD(e.target);u.fragment&&u.fragment.l(c),c.forEach(sf)}else u.fragment&&u.fragment.c();e.intro&&kD(t.$$.fragment),FD(t,e.target,e.anchor,e.customElement),Fp()}ia(o)}class GD{$destroy(){BD(this,1),this.$destroy=ha}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const a=n.indexOf(r);a!==-1&&n.splice(a,1)}}$set(e){this.$$set&&!OD(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Yc(t,e,r,n,a,i,s){try{var f=t[i](s),o=f.value}catch(u){r(u);return}f.done?e(o):Promise.resolve(o).then(n,a)}function wn(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var i=t.apply(e,r);function s(o){Yc(i,n,a,s,f,"next",o)}function f(o){Yc(i,n,a,s,f,"throw",o)}s(void 0)})}}var Bp={exports:{}},Np={exports:{}};(function(t){var e=function(r){var n=Object.prototype,a=n.hasOwnProperty,i,s=typeof Symbol=="function"?Symbol:{},f=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function g(U,G,K){return Object.defineProperty(U,G,{value:K,enumerable:!0,configurable:!0,writable:!0}),U[G]}try{g({},"")}catch{g=function(G,K,Z){return G[K]=Z}}function c(U,G,K,Z){var Q=G&&G.prototype instanceof w?G:w,oe=Object.create(Q.prototype),ce=new Y(Z||[]);return oe._invoke=A(U,K,ce),oe}r.wrap=c;function l(U,G,K){try{return{type:"normal",arg:U.call(G,K)}}catch(Z){return{type:"throw",arg:Z}}}var h="suspendedStart",y="suspendedYield",C="executing",T="completed",E={};function w(){}function x(){}function S(){}var m={};g(m,f,function(){return this});var D=Object.getPrototypeOf,b=D&&D(D(I([])));b&&b!==n&&a.call(b,f)&&(m=b);var N=S.prototype=w.prototype=Object.create(m);x.prototype=S,g(N,"constructor",S),g(S,"constructor",x),x.displayName=g(S,u,"GeneratorFunction");function P(U){["next","throw","return"].forEach(function(G){g(U,G,function(K){return this._invoke(G,K)})})}r.isGeneratorFunction=function(U){var G=typeof U=="function"&&U.constructor;return G?G===x||(G.displayName||G.name)==="GeneratorFunction":!1},r.mark=function(U){return Object.setPrototypeOf?Object.setPrototypeOf(U,S):(U.__proto__=S,g(U,u,"GeneratorFunction")),U.prototype=Object.create(N),U},r.awrap=function(U){return{__await:U}};function O(U,G){function K(oe,ce,fe,pe){var Re=l(U[oe],U,ce);if(Re.type==="throw")pe(Re.arg);else{var qe=Re.arg,He=qe.value;return He&&typeof He=="object"&&a.call(He,"__await")?G.resolve(He.__await).then(function(ze){K("next",ze,fe,pe)},function(ze){K("throw",ze,fe,pe)}):G.resolve(He).then(function(ze){qe.value=ze,fe(qe)},function(ze){return K("throw",ze,fe,pe)})}}var Z;function Q(oe,ce){function fe(){return new G(function(pe,Re){K(oe,ce,pe,Re)})}return Z=Z?Z.then(fe,fe):fe()}this._invoke=Q}P(O.prototype),g(O.prototype,o,function(){return this}),r.AsyncIterator=O,r.async=function(U,G,K,Z,Q){Q===void 0&&(Q=Promise);var oe=new O(c(U,G,K,Z),Q);return r.isGeneratorFunction(G)?oe:oe.next().then(function(ce){return ce.done?ce.value:oe.next()})};function A(U,G,K){var Z=h;return function(oe,ce){if(Z===C)throw new Error("Generator is already running");if(Z===T){if(oe==="throw")throw ce;return te()}for(K.method=oe,K.arg=ce;;){var fe=K.delegate;if(fe){var pe=z(fe,K);if(pe){if(pe===E)continue;return pe}}if(K.method==="next")K.sent=K._sent=K.arg;else if(K.method==="throw"){if(Z===h)throw Z=T,K.arg;K.dispatchException(K.arg)}else K.method==="return"&&K.abrupt("return",K.arg);Z=C;var Re=l(U,G,K);if(Re.type==="normal"){if(Z=K.done?T:y,Re.arg===E)continue;return{value:Re.arg,done:K.done}}else Re.type==="throw"&&(Z=T,K.method="throw",K.arg=Re.arg)}}}function z(U,G){var K=U.iterator[G.method];if(K===i){if(G.delegate=null,G.method==="throw"){if(U.iterator.return&&(G.method="return",G.arg=i,z(U,G),G.method==="throw"))return E;G.method="throw",G.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var Z=l(K,U.iterator,G.arg);if(Z.type==="throw")return G.method="throw",G.arg=Z.arg,G.delegate=null,E;var Q=Z.arg;if(!Q)return G.method="throw",G.arg=new TypeError("iterator result is not an object"),G.delegate=null,E;if(Q.done)G[U.resultName]=Q.value,G.next=U.nextLoc,G.method!=="return"&&(G.method="next",G.arg=i);else return Q;return G.delegate=null,E}P(N),g(N,u,"Generator"),g(N,f,function(){return this}),g(N,"toString",function(){return"[object Generator]"});function j(U){var G={tryLoc:U[0]};1 in U&&(G.catchLoc=U[1]),2 in U&&(G.finallyLoc=U[2],G.afterLoc=U[3]),this.tryEntries.push(G)}function B(U){var G=U.completion||{};G.type="normal",delete G.arg,U.completion=G}function Y(U){this.tryEntries=[{tryLoc:"root"}],U.forEach(j,this),this.reset(!0)}r.keys=function(U){var G=[];for(var K in U)G.push(K);return G.reverse(),function Z(){for(;G.length;){var Q=G.pop();if(Q in U)return Z.value=Q,Z.done=!1,Z}return Z.done=!0,Z}};function I(U){if(U){var G=U[f];if(G)return G.call(U);if(typeof U.next=="function")return U;if(!isNaN(U.length)){var K=-1,Z=function Q(){for(;++K<U.length;)if(a.call(U,K))return Q.value=U[K],Q.done=!1,Q;return Q.value=i,Q.done=!0,Q};return Z.next=Z}}return{next:te}}r.values=I;function te(){return{value:i,done:!0}}return Y.prototype={constructor:Y,reset:function(U){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(B),!U)for(var G in this)G.charAt(0)==="t"&&a.call(this,G)&&!isNaN(+G.slice(1))&&(this[G]=i)},stop:function(){this.done=!0;var U=this.tryEntries[0],G=U.completion;if(G.type==="throw")throw G.arg;return this.rval},dispatchException:function(U){if(this.done)throw U;var G=this;function K(pe,Re){return oe.type="throw",oe.arg=U,G.next=pe,Re&&(G.method="next",G.arg=i),!!Re}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var Q=this.tryEntries[Z],oe=Q.completion;if(Q.tryLoc==="root")return K("end");if(Q.tryLoc<=this.prev){var ce=a.call(Q,"catchLoc"),fe=a.call(Q,"finallyLoc");if(ce&&fe){if(this.prev<Q.catchLoc)return K(Q.catchLoc,!0);if(this.prev<Q.finallyLoc)return K(Q.finallyLoc)}else if(ce){if(this.prev<Q.catchLoc)return K(Q.catchLoc,!0)}else if(fe){if(this.prev<Q.finallyLoc)return K(Q.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(U,G){for(var K=this.tryEntries.length-1;K>=0;--K){var Z=this.tryEntries[K];if(Z.tryLoc<=this.prev&&a.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var Q=Z;break}}Q&&(U==="break"||U==="continue")&&Q.tryLoc<=G&&G<=Q.finallyLoc&&(Q=null);var oe=Q?Q.completion:{};return oe.type=U,oe.arg=G,Q?(this.method="next",this.next=Q.finallyLoc,E):this.complete(oe)},complete:function(U,G){if(U.type==="throw")throw U.arg;return U.type==="break"||U.type==="continue"?this.next=U.arg:U.type==="return"?(this.rval=this.arg=U.arg,this.method="return",this.next="end"):U.type==="normal"&&G&&(this.next=G),E},finish:function(U){for(var G=this.tryEntries.length-1;G>=0;--G){var K=this.tryEntries[G];if(K.finallyLoc===U)return this.complete(K.completion,K.afterLoc),B(K),E}},catch:function(U){for(var G=this.tryEntries.length-1;G>=0;--G){var K=this.tryEntries[G];if(K.tryLoc===U){var Z=K.completion;if(Z.type==="throw"){var Q=Z.arg;B(K)}return Q}}throw new Error("illegal catch attempt")},delegateYield:function(U,G,K){return this.delegate={iterator:I(U),resultName:G,nextLoc:K},this.method==="next"&&(this.arg=i),E}},r}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(Np);(function(t){t.exports=Np.exports})(Bp);const Vt=Ud(Bp.exports);var AD=navigator.gpu?"WebGPU":"WebGL",ki=Object.create(null);function Up(t,e){ki[t]=e}function PD(){return Object.keys(ki)}function Gp(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ki[t]&&ki[t](e)}function WD(t,e){e.classHierarchy.push("vtkRenderWindow"),t.addRenderer=function(r){t.hasRenderer(r)||(r.setRenderWindow(t),e.renderers.push(r),t.modified())},t.removeRenderer=function(r){e.renderers=e.renderers.filter(function(n){return n!==r}),t.modified()},t.hasRenderer=function(r){return e.renderers.indexOf(r)!==-1},t.newAPISpecificView=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Gp(r||e.defaultViewAPI,n)},t.addView=function(r){t.hasView(r)||(r.setRenderable(t),e.views.push(r),t.modified())},t.removeView=function(r){e.views=e.views.filter(function(n){return n!==r}),t.modified()},t.hasView=function(r){return e.views.indexOf(r)!==-1},t.preRender=function(){e.renderers.forEach(function(r){r.isActiveCameraCreated()||r.resetCamera()})},t.render=function(){t.preRender(),e.interactor?e.interactor.render():e.views.forEach(function(r){return r.traverseAllPasses()})},t.getStatistics=function(){var r={propCount:0,invisiblePropCount:0};return e.renderers.forEach(function(n){var a=n.getViewProps();a.forEach(function(i){if(i.getVisibility()){r.propCount+=1;var s=i.getMapper&&i.getMapper();if(s&&s.getPrimitiveCount){var f=s.getPrimitiveCount();Object.keys(f).forEach(function(o){r[o]||(r[o]=0),r[o]+=f[o]})}}else r.invisiblePropCount+=1})}),r.str=Object.keys(r).map(function(n){return"".concat(n,": ").concat(r[n])}).join(`
`),r},t.captureImages=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return L.setImmediate(t.render),e.views.map(function(a){return a.captureNextImage?a.captureNextImage(r,n):void 0}).filter(function(a){return!!a})}}var zD={defaultViewAPI:AD,renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1};function Ap(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,zD,r),L.obj(t,e),L.setGet(t,e,["interactor","numberOfLayers","views","defaultViewAPI"]),L.get(t,e,["neverRendered"]),L.getArray(t,e,["renderers"]),L.event(t,e,"completion"),WD(t,e)}var jD=L.newInstance(Ap,"vtkRenderWindow"),$D={newInstance:jD,extend:Ap,registerViewConstructor:Up,listViewAPIs:PD,newAPISpecificView:Gp};function HD(t,e){e.classHierarchy.push("vtkFramebuffer"),t.getBothMode=function(){return e.context.FRAMEBUFFER},t.saveCurrentBindingsAndBuffers=function(r){var n=typeof r<"u"?r:t.getBothMode();t.saveCurrentBindings(n),t.saveCurrentBuffers(n)},t.saveCurrentBindings=function(r){if(!e.context){ve("you must set the OpenGLRenderWindow before calling saveCurrentBindings");return}var n=e.context;e.previousDrawBinding=n.getParameter(e.context.FRAMEBUFFER_BINDING),e.previousActiveFramebuffer=e._openGLRenderWindow.getActiveFramebuffer()},t.saveCurrentBuffers=function(r){},t.restorePreviousBindingsAndBuffers=function(r){var n=typeof r<"u"?r:t.getBothMode();t.restorePreviousBindings(n),t.restorePreviousBuffers(n)},t.restorePreviousBindings=function(r){if(!e.context){ve("you must set the OpenGLRenderWindow before calling restorePreviousBindings");return}var n=e.context;n.bindFramebuffer(n.FRAMEBUFFER,e.previousDrawBinding),e._openGLRenderWindow.setActiveFramebuffer(e.previousActiveFramebuffer)},t.restorePreviousBuffers=function(r){},t.bind=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=r;n===null&&(n=e.context.FRAMEBUFFER),e.context.bindFramebuffer(n,e.glFramebuffer);for(var a=0;a<e.colorBuffers.length;a++)e.colorBuffers[a].bind();e._openGLRenderWindow.setActiveFramebuffer(t)},t.create=function(r,n){if(!e.context){ve("you must set the OpenGLRenderWindow before calling create");return}e.glFramebuffer=e.context.createFramebuffer(),e.glFramebuffer.width=r,e.glFramebuffer.height=n},t.setColorBuffer=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=e.context;if(!a){ve("you must set the OpenGLRenderWindow before calling setColorBuffer");return}var i=a.COLOR_ATTACHMENT0;if(n>0)if(e._openGLRenderWindow.getWebgl2())i+=n;else{ve("Using multiple framebuffer attachments requires WebGL 2");return}e.colorBuffers[n]=r,a.framebufferTexture2D(a.FRAMEBUFFER,i,a.TEXTURE_2D,r.getHandle(),0)},t.removeColorBuffer=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=e.context;if(!n){ve("you must set the OpenGLRenderWindow before calling removeColorBuffer");return}var a=n.COLOR_ATTACHMENT0;if(r>0)if(e._openGLRenderWindow.getWebgl2())a+=r;else{ve("Using multiple framebuffer attachments requires WebGL 2");return}n.framebufferTexture2D(n.FRAMEBUFFER,a,n.TEXTURE_2D,null,0),e.colorBuffers=e.colorBuffers.splice(r,1)},t.setDepthBuffer=function(r){if(!e.context){ve("you must set the OpenGLRenderWindow before calling setDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){var n=e.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,r.getHandle(),0)}else ve("Attaching depth buffer textures to fbo requires WebGL 2")},t.removeDepthBuffer=function(){if(!e.context){ve("you must set the OpenGLRenderWindow before calling removeDepthBuffer");return}if(e._openGLRenderWindow.getWebgl2()){var r=e.context;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,null,0)}else ve("Attaching depth buffer textures to framebuffers requires WebGL 2")},t.getGLFramebuffer=function(){return e.glFramebuffer},t.setOpenGLRenderWindow=function(r){e._openGLRenderWindow!==r&&(t.releaseGraphicsResources(),e._openGLRenderWindow=r,e.context=null,r&&(e.context=e._openGLRenderWindow.getContext()))},t.releaseGraphicsResources=function(){e.glFramebuffer&&e.context.deleteFramebuffer(e.glFramebuffer)},t.getSize=function(){var r=[0,0];return e.glFramebuffer!==null&&(r[0]=e.glFramebuffer.width,r[1]=e.glFramebuffer.height),r},t.populateFramebuffer=function(){if(!e.context){ve("you must set the OpenGLRenderWindow before calling populateFrameBuffer");return}t.bind();var r=e.context,n=Or.newInstance();n.setOpenGLRenderWindow(e._openGLRenderWindow),n.setMinificationFilter(xo.LINEAR),n.setMagnificationFilter(xo.LINEAR),n.create2DFromRaw(e.glFramebuffer.width,e.glFramebuffer.height,4,mr.UNSIGNED_CHAR,null),t.setColorBuffer(n),e.depthTexture=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,e.depthTexture),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,e.glFramebuffer.width,e.glFramebuffer.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e.depthTexture)},t.getColorTexture=function(){return e.colorBuffers[0]}}var KD={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function Pp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,KD,r),yt(t,e),e.colorBuffers&&ve("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),e.colorBuffers=[],Ca(t,e,["colorBuffers"]),HD(t,e)}var XD=Ue(Pp,"vtkFramebuffer"),of={newInstance:XD,extend:Pp};function YD(t,e){e.classHierarchy.push("vtkRenderPass"),t.getOperation=function(){return e.currentOperation},t.setCurrentOperation=function(r){e.currentOperation=r,e.currentTraverseOperation="traverse".concat(L.capitalize(e.currentOperation))},t.getTraverseOperation=function(){return e.currentTraverseOperation},t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;e.deleted||(e.currentParent=n,e.preDelegateOperations.forEach(function(a){t.setCurrentOperation(a),r.traverse(t)}),e.delegates.forEach(function(a){a.traverse(r,t)}),e.postDelegateOperations.forEach(function(a){t.setCurrentOperation(a),r.traverse(t)}))}}var ID={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function Wp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ID,r),L.obj(t,e),L.get(t,e,["currentOperation"]),L.setGet(t,e,["delegates","currentParent","preDelegateOperations","postDelegateOperations"]),YD(t,e)}var qD=L.newInstance(Wp,"vtkRenderPass"),ff={newInstance:qD,extend:Wp},ZD=Vn.Representation,Ic=L.vtkErrorMacro;function QD(t){var e=$.substitute(t.Fragment,"//VTK::RenderPassFragmentShader::Impl",`
      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);
      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);
      gl_FragData[1].r = weight;
    `,!1);t.Fragment=e.result}var JD=`//VTK::System::Dec

in vec2 tcoord;

uniform sampler2D translucentRTexture;
uniform sampler2D translucentRGBATexture;

// the output of this shader
//VTK::Output::Dec

void main()
{
  vec4 t1Color = texture(translucentRGBATexture, tcoord);
  float t2Color = texture(translucentRTexture, tcoord).r;
  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);
}
`;function em(t,e){e.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),t.createVertexBuffer=function(){var r=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),n=new Float32Array([0,0,1,0,0,1,1,1]),a=new Uint16Array([4,0,1,3,2]),i=_e.newInstance({numberOfComponents:3,values:r});i.setName("points");var s=_e.newInstance({numberOfComponents:2,values:n});s.setName("tcoords");var f=_e.newInstance({numberOfComponents:1,values:a});e.tris.getCABO().createVBO(f,"polys",ZD.SURFACE,{points:i,tcoords:s,cellOffset:0}),e.VBOBuildTime.modified()},t.createFramebuffer=function(r){var n,a=r.getSize(),i=r.getContext();e.framebuffer=of.newInstance(),e.framebuffer.setOpenGLRenderWindow(r),(n=e.framebuffer).create.apply(n,Ee(a)),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind(),e.translucentRGBATexture=Or.newInstance(),e.translucentRGBATexture.setInternalFormat(i.RGBA16F),e.translucentRGBATexture.setFormat(i.RGBA),e.translucentRGBATexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRGBATexture.setOpenGLRenderWindow(r),e.translucentRGBATexture.create2DFromRaw(a[0],a[1],4,"Float32Array",null),e.translucentRTexture=Or.newInstance(),e.translucentRTexture.setInternalFormat(i.R16F),e.translucentRTexture.setFormat(i.RED),e.translucentRTexture.setOpenGLDataType(i.HALF_FLOAT),e.translucentRTexture.setOpenGLRenderWindow(r),e.translucentRTexture.create2DFromRaw(a[0],a[1],1,"Float32Array",null),e.translucentZTexture=Or.newInstance(),e.translucentZTexture.setOpenGLRenderWindow(r),e.translucentZTexture.createDepthFromRaw(a[0],a[1],"Float32Array",null),e.framebuffer.setColorBuffer(e.translucentRGBATexture,0),e.framebuffer.setColorBuffer(e.translucentRTexture,1),e.framebuffer.setDepthBuffer(e.translucentZTexture)},t.createCopyShader=function(r){e.copyShader=r.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join(`
`),JD,"")},t.createVBO=function(r){var n=r.getContext();e.tris.setOpenGLRenderWindow(r),t.createVertexBuffer();var a=e.copyShader;e.tris.getCABO().bind(),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"vertexDC",e.tris.getCABO().getVertexOffset(),e.tris.getCABO().getStride(),n.FLOAT,3,n.FALSE)||Ic("Error setting vertexDC in copy shader VAO."),e.copyVAO.addAttributeArray(a,e.tris.getCABO(),"tcoordTC",e.tris.getCABO().getTCoordOffset(),e.tris.getCABO().getStride(),n.FLOAT,2,n.FALSE)||Ic("Error setting vertexDC in copy shader VAO.")},t.traverse=function(r,n,a){if(!e.deleted){var i=r.getSize(),s=r.getContext();if(e._supported=!1,n.getSelector()||!s||!r.getWebgl2()||!s.getExtension("EXT_color_buffer_half_float")&&!s.getExtension("EXT_color_buffer_float")){t.setCurrentOperation("translucentPass"),n.traverse(t);return}if(e._supported=!0,e.framebuffer===null)t.createFramebuffer(r);else{var f=e.framebuffer.getSize();f===null||f[0]!==i[0]||f[1]!==i[1]?(e.framebuffer.releaseGraphicsResources(),e.translucentRGBATexture.releaseGraphicsResources(r),e.translucentRTexture.releaseGraphicsResources(r),e.translucentZTexture.releaseGraphicsResources(r),t.createFramebuffer(r)):(e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.bind())}s.drawBuffers([s.COLOR_ATTACHMENT0]),s.clearBufferfv(s.COLOR,0,[0,0,0,0]),s.clearBufferfv(s.DEPTH,0,[1]),s.colorMask(!1,!1,!1,!1),a.getOpaqueActorCount()>0&&(a.setCurrentOperation("opaquePass"),n.traverse(a)),s.colorMask(!0,!0,!0,!0),s.drawBuffers([s.COLOR_ATTACHMENT0,s.COLOR_ATTACHMENT1]),s.viewport(0,0,i[0],i[1]),s.scissor(0,0,i[0],i[1]),s.clearBufferfv(s.COLOR,0,[0,0,0,1]),s.clearBufferfv(s.COLOR,1,[0,0,0,0]),s.enable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFuncSeparate(s.ONE,s.ONE,s.ZERO,s.ONE_MINUS_SRC_ALPHA),t.setCurrentOperation("translucentPass"),n.traverse(t),s.drawBuffers([s.NONE]),e.framebuffer.restorePreviousBindingsAndBuffers(),e.copyShader===null?t.createCopyShader(r):r.getShaderCache().readyShaderProgram(e.copyShader),e.copyVAO||(e.copyVAO=Il.newInstance(),e.copyVAO.setOpenGLRenderWindow(r)),e.copyVAO.bind(),e.VBOBuildTime.getMTime()<t.getMTime()&&t.createVBO(r),s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA),s.depthMask(!1),s.depthFunc(s.ALWAYS),s.viewport(0,0,i[0],i[1]),s.scissor(0,0,i[0],i[1]),e.translucentRGBATexture.activate(),e.copyShader.setUniformi("translucentRGBATexture",e.translucentRGBATexture.getTextureUnit()),e.translucentRTexture.activate(),e.copyShader.setUniformi("translucentRTexture",e.translucentRTexture.getTextureUnit()),s.drawArrays(s.TRIANGLES,0,e.tris.getCABO().getElementCount()),s.depthMask(!0),s.depthFunc(s.LEQUAL),e.translucentRGBATexture.deactivate(),e.translucentRTexture.deactivate()}},t.getShaderReplacement=function(){return e._supported?QD:null},t.releaseGraphicsResources=function(r){e.framebuffer&&(e.framebuffer.releaseGraphicsResources(r),e.framebuffer=null),e.translucentRGBATexture&&(e.translucentRGBATexture.releaseGraphicsResources(r),e.translucentRGBATexture=null),e.translucentRTexture&&(e.translucentRTexture.releaseGraphicsResources(r),e.translucentRTexture=null),e.translucentZTexture&&(e.translucentZTexture.releaseGraphicsResources(r),e.translucentZTexture=null),e.copyVAO&&(e.copyVAO.releaseGraphicsResources(r),e.copyVAO=null),e.copyShader&&(e.copyShader.releaseGraphicsResources(r),e.copyShader=null),e.tris&&(e.tris.releaseGraphicsResources(r),e.tris=null),t.modified()}}var tm={framebuffer:null,copyShader:null,tris:null};function zp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,tm,r),ff.extend(t,e,r),e.VBOBuildTime={},L.obj(e.VBOBuildTime,{mtime:0}),e.tris=bn.newInstance(),L.get(t,e,["framebuffer"]),em(t,e)}var rm=L.newInstance(zp,"vtkOpenGLOrderIndependentTranslucentPass"),nm={newInstance:rm,extend:zp};function am(t,e){e.classHierarchy.push("vtkForwardPass"),t.traverse=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!e.deleted){e.currentParent=n,t.setCurrentOperation("buildPass"),r.traverse(t);for(var a=r.getRenderable().getNumberOfLayers(),i=r.getChildren(),s=0;s<a;s++)for(var f=0;f<i.length;f++){var o=i[f],u=r.getRenderable().getRenderers()[f];if(u.getDraw()&&u.getLayer()===s){if(e.opaqueActorCount=0,e.translucentActorCount=0,e.volumeCount=0,e.overlayActorCount=0,t.setCurrentOperation("queryPass"),o.traverse(t),e.opaqueActorCount>0&&e.volumeCount>0||e.depthRequested){var g=r.getFramebufferSize();e.framebuffer===null&&(e.framebuffer=of.newInstance()),e.framebuffer.setOpenGLRenderWindow(r),e.framebuffer.saveCurrentBindingsAndBuffers();var c=e.framebuffer.getSize();(c===null||c[0]!==g[0]||c[1]!==g[1])&&(e.framebuffer.create(g[0],g[1]),e.framebuffer.populateFramebuffer()),e.framebuffer.bind(),t.setCurrentOperation("opaqueZBufferPass"),o.traverse(t),e.framebuffer.restorePreviousBindingsAndBuffers(),e.depthRequested=!1}t.setCurrentOperation("cameraPass"),o.traverse(t),e.opaqueActorCount>0&&(t.setCurrentOperation("opaquePass"),o.traverse(t)),e.translucentActorCount>0&&(e.translucentPass||(e.translucentPass=nm.newInstance()),e.translucentPass.traverse(r,o,t)),e.volumeCount>0&&(t.setCurrentOperation("volumePass"),o.traverse(t)),e.overlayActorCount>0&&(t.setCurrentOperation("overlayPass"),o.traverse(t))}}}},t.getZBufferTexture=function(){return e.framebuffer?e.framebuffer.getColorTexture():null},t.requestDepth=function(){e.depthRequested=!0},t.incrementOpaqueActorCount=function(){return e.opaqueActorCount++},t.incrementTranslucentActorCount=function(){return e.translucentActorCount++},t.incrementVolumeCount=function(){return e.volumeCount++},t.incrementOverlayActorCount=function(){return e.overlayActorCount++}}var im={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function jp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,im,r),ff.extend(t,e,r),L.get(t,e,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),am(t,e)}var sm=L.newInstance(jp,"vtkForwardPass"),om={newInstance:sm,extend:jp},fm=_n.FieldAssociations;function um(t,e){e.classHierarchy.push("vtkHardwareSelector"),t.getSourceDataAsync=function(){var r=wn(Vt.mark(function n(a,i,s,f,o){return Vt.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:case"end":return g.stop()}},n)}));return function(n,a,i,s,f){return r.apply(this,arguments)}}(),t.selectAsync=function(){var r=wn(Vt.mark(function n(a,i,s,f,o){var u;return Vt.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.getSourceDataAsync(a,i,s,f,o);case 2:if(u=c.sent,!u){c.next=5;break}return c.abrupt("return",u.generateSelection(i,s,f,o));case 5:return c.abrupt("return",[]);case 6:case"end":return c.stop()}},n)}));return function(n,a,i,s,f){return r.apply(this,arguments)}}()}var cm={fieldAssociation:fm.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function $p(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,cm,r),L.obj(t,e),L.setGet(t,e,["fieldAssociation","captureZValues"]),um(t,e)}var gm=L.newInstance($p,"vtkHardwareSelector"),vm={newInstance:gm,extend:$p},lm={GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},pm={CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5},hm={SelectionContent:lm,SelectionField:pm};function qc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function ym(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dm(t,e){e.classHierarchy.push("vtkSelectionNode"),t.getBounds=function(){return e.points.getBounds()}}var Tm={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function Hp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Tm,r),L.obj(t,e),e.properties={},L.setGet(t,e,["contentType","fieldType","properties","selectionList"]),dm(t,e)}var Cm=L.newInstance(Hp,"vtkSelectionNode"),uf=ym({newInstance:Cm,extend:Hp},hm);function Zc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Sm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zc(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Qe=Ol.PassTypes,Em=uf.SelectionContent,Qc=uf.SelectionField,sa=_n.FieldAssociations,Kp=L.vtkErrorMacro,Er=1;function Xp(t){return"".concat(t.propID," ").concat(t.compositeID)}function Yp(t,e,r,n){if(!r)return 0;var a=(e*(n[2]-n[0]+1)+t)*4;return r[a+3]}function ar(t,e,r,n){if(!r)return 0;var a=(e*(n[2]-n[0]+1)+t)*4,i=[];i[0]=r[a],i[1]=r[a+1],i[2]=r[a+2];var s=i[2];return s*=256,s+=i[1],s*=256,s+=i[0],s}function Ip(t,e){var r=e;return r<<=24,r|=t,r}function yn(t,e,r,n){var a=r<0?0:r;if(a===0){if(n[0]=e[0],n[1]=e[1],e[0]<t.area[0]||e[0]>t.area[2]||e[1]<t.area[1]||e[1]>t.area[3])return null;var i=[e[0]-t.area[0],e[1]-t.area[1]],s=ar(i[0],i[1],t.pixBuffer[Qe.ACTOR_PASS],t.area);if(s<=0||s-Er>=t.props.length)return null;var f={};f.valid=!0,f.propID=s-Er,f.prop=t.props[f.propID];var o=ar(i[0],i[1],t.pixBuffer[Qe.COMPOSITE_INDEX_PASS],t.area);if((o<0||o>16777215)&&(o=0),f.compositeID=o-Er,t.captureZValues){var u=(i[1]*(t.area[2]-t.area[0]+1)+i[0])*4;f.zValue=(256*t.zBuffer[u]+t.zBuffer[u+1])/65535,f.displayPosition=e}if(t.pixBuffer[Qe.ID_LOW24]&&Yp(i[0],i[1],t.pixBuffer[Qe.ID_LOW24],t.area)===0)return f;var g=ar(i[0],i[1],t.pixBuffer[Qe.ID_LOW24],t.area),c=ar(i[0],i[1],t.pixBuffer[Qe.ID_HIGH24],t.area);return f.attributeID=Ip(g,c),f}var l=[e[0],e[1]],h=[0,0],y=yn(t,e,0,n);if(y&&y.valid)return y;for(var C=1;C<a;++C){for(var T=l[1]>C?l[1]-C:0;T<=l[1]+C;++T)if(h[1]=T,l[0]>=C&&(h[0]=l[0]-C,y=yn(t,h,0,n),y&&y.valid)||(h[0]=l[0]+C,y=yn(t,h,0,n),y&&y.valid))return y;for(var E=l[0]>=C?l[0]-(C-1):0;E<=l[0]+(C-1);++E)if(h[0]=E,l[1]>=C&&(h[1]=l[1]-C,y=yn(t,h,0,n),y&&y.valid)||(h[1]=l[1]+C,y=yn(t,h,0,n),y&&y.valid))return y}return n[0]=e[0],n[1]=e[1],null}function qp(t,e,r,n,a){var i=[],s=0;return e.forEach(function(f,o){var u=uf.newInstance();switch(u.setContentType(Em.INDICES),t){case sa.FIELD_ASSOCIATION_CELLS:u.setFieldType(Qc.CELL);break;case sa.FIELD_ASSOCIATION_POINTS:u.setFieldType(Qc.POINT);break;default:Kp("Unknown field association")}u.getProperties().propID=f.info.propID,u.getProperties().prop=f.info.prop,u.getProperties().compositeID=f.info.compositeID,u.getProperties().attributeID=f.info.attributeID,u.getProperties().pixelCount=f.pixelCount,r&&(u.getProperties().displayPosition=[f.info.displayPosition[0],f.info.displayPosition[1],f.info.zValue],u.getProperties().worldPosition=a.displayToWorld(f.info.displayPosition[0],f.info.displayPosition[1],f.info.zValue,n)),u.setSelectionList(f.attributeIDs),i[s]=u,s++}),i}function xm(t,e,r,n,a){for(var i=Math.floor(e),s=Math.floor(r),f=Math.floor(n),o=Math.floor(a),u=new Map,g=[0,0],c=s;c<=o;c++)for(var l=i;l<=f;l++){var h=[l,c],y=yn(t,h,0,g);if(y&&y.valid){var C=Xp(y);if(!u.has(C))u.set(C,{info:y,pixelCount:1,attributeIDs:[y.attributeID]});else{var T=u.get(C);T.pixelCount++,t.captureZValues&&y.zValue<T.info.zValue&&(T.info=y),T.attributeIDs.indexOf(y.attributeID)===-1&&T.attributeIDs.push(y.attributeID)}}}return qp(t.fieldAssociation,u,t.captureZValues,t.renderer,t.openGLRenderWindow)}function wm(t,e){e.classHierarchy.push("vtkOpenGLHardwareSelector"),t.releasePixBuffers=function(){e.rawPixBuffer=[],e.pixBuffer=[],e.zBuffer=null},t.beginSelection=function(){e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e.maxAttributeId=0;var n=e._openGLRenderWindow.getSize();if(!e.framebuffer)e.framebuffer=of.newInstance(),e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers(),e.framebuffer.create(n[0],n[1]),e.framebuffer.populateFramebuffer();else{e.framebuffer.setOpenGLRenderWindow(e._openGLRenderWindow),e.framebuffer.saveCurrentBindingsAndBuffers();var a=e.framebuffer.getSize();a[0]!==n[0]||a[1]!==n[1]?(e.framebuffer.create(n[0],n[1]),e.framebuffer.populateFramebuffer()):e.framebuffer.bind()}if(e._openGLRenderer.clear(),e._openGLRenderer.setSelector(t),e.hitProps={},e.propPixels={},e.props=[],t.releasePixBuffers(),e.fieldAssociation===sa.FIELD_ASSOCIATION_POINTS){var i=e._openGLRenderWindow.getContext(),s=i.isEnabled(i.BLEND);i.disable(i.BLEND),e._openGLRenderWindow.traverseAllPasses(),e._renderer.setPreserveDepthBuffer(!0),s&&i.enable(i.BLEND)}},t.endSelection=function(){e.hitProps={},e._openGLRenderer.setSelector(null),e.framebuffer.restorePreviousBindingsAndBuffers(),e._renderer.setPreserveDepthBuffer(!1)},t.preCapturePass=function(){var n=e._openGLRenderWindow.getContext();e.originalBlending=n.isEnabled(n.BLEND),n.disable(n.BLEND)},t.postCapturePass=function(){var n=e._openGLRenderWindow.getContext();e.originalBlending&&n.enable(n.BLEND)},t.select=function(){var n=null;return t.captureBuffers()&&(n=t.generateSelection(e.area[0],e.area[1],e.area[2],e.area[3]),t.releasePixBuffers()),n},t.getSourceDataAsync=function(){var n=wn(Vt.mark(function a(i,s,f,o,u){var g,c;return Vt.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(e._renderer=i,s===void 0?(g=e._openGLRenderWindow.getSize(),t.setArea(0,0,g[0]-1,g[1]-1)):t.setArea(s,f,o,u),t.captureBuffers()){h.next=4;break}return h.abrupt("return",!1);case 4:return c={area:Ee(e.area),pixBuffer:Ee(e.pixBuffer),captureZValues:e.captureZValues,zBuffer:e.zBuffer,props:Ee(e.props),fieldAssociation:e.fieldAssociation,renderer:i,openGLRenderWindow:e._openGLRenderWindow},c.generateSelection=function(){for(var y=arguments.length,C=new Array(y),T=0;T<y;T++)C[T]=arguments[T];return xm.apply(void 0,[c].concat(C))},h.abrupt("return",c);case 7:case"end":return h.stop()}},a)}));return function(a,i,s,f,o){return n.apply(this,arguments)}}(),t.captureBuffers=function(){if(!e._renderer||!e._openGLRenderWindow)return Kp("Renderer and view must be set before calling Select."),!1;e._openGLRenderer=e._openGLRenderWindow.getViewNodeFor(e._renderer),e._openGLRenderWindow.getRenderable().preRender(),t.invokeEvent({type:"StartEvent"}),e.originalBackground=e._renderer.getBackgroundByReference(),e._renderer.setBackground(0,0,0,0);var n=e._openGLRenderWindow.getRenderPasses();for(t.beginSelection(),e.currentPass=Qe.MIN_KNOWN_PASS;e.currentPass<=Qe.MAX_KNOWN_PASS;e.currentPass++)t.passRequired(e.currentPass)&&(t.preCapturePass(e.currentPass),e.captureZValues&&e.currentPass===Qe.ACTOR_PASS&&typeof n[0].requestDepth=="function"&&typeof n[0].getFramebuffer=="function"&&n[0].requestDepth(),e._openGLRenderWindow.traverseAllPasses(),t.postCapturePass(e.currentPass),t.savePixelBuffer(e.currentPass),t.processPixelBuffers());return t.endSelection(),e._renderer.setBackground(e.originalBackground),t.invokeEvent({type:"EndEvent"}),!0},t.processPixelBuffers=function(){e.props.forEach(function(n,a){t.isPropHit(a)&&n.processSelectorPixelBuffers(t,e.propPixels[a])})},t.passRequired=function(n){if(n===Qe.ID_HIGH24){if(e.fieldAssociation===sa.FIELD_ASSOCIATION_POINTS)return e.maximumPointId>16777215;if(e.fieldAssociation===sa.FIELD_ASSOCIATION_CELLS)return e.maximumCellId>16777215}return!0},t.savePixelBuffer=function(n){if(e.pixBuffer[n]=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),!e.rawPixBuffer[n]){var a=(e.area[2]-e.area[0]+1)*(e.area[3]-e.area[1]+1)*4;e.rawPixBuffer[n]=new Uint8Array(a),e.rawPixBuffer[n].set(e.pixBuffer[n])}if(n===Qe.ACTOR_PASS){if(e.captureZValues){var i=e._openGLRenderWindow.getRenderPasses();if(typeof i[0].requestDepth=="function"&&typeof i[0].getFramebuffer=="function"){var s=i[0].getFramebuffer();s.saveCurrentBindingsAndBuffers(),s.bind(),e.zBuffer=e._openGLRenderWindow.getPixelData(e.area[0],e.area[1],e.area[2],e.area[3]),s.restorePreviousBindingsAndBuffers()}}t.buildPropHitList(e.rawPixBuffer[n])}},t.buildPropHitList=function(n){for(var a=0,i=0;i<=e.area[3]-e.area[1];i++)for(var s=0;s<=e.area[2]-e.area[0];s++){var f=ar(s,i,n,e.area);f>0&&(f--,f in e.hitProps||(e.hitProps[f]=!0,e.propPixels[f]=[]),e.propPixels[f].push(a*4)),++a}},t.renderProp=function(n){e.currentPass===Qe.ACTOR_PASS&&(t.setPropColorValueFromInt(e.props.length+Er),e.props.push(n))},t.renderCompositeIndex=function(n){e.currentPass===Qe.COMPOSITE_INDEX_PASS&&t.setPropColorValueFromInt(n+Er)},t.renderAttributeId=function(n){n<0||(e.maxAttributeId=n>e.maxAttributeId?n:e.maxAttributeId)},t.passTypeToString=function(n){return L.enumToString(Qe,n)},t.isPropHit=function(n){return Boolean(e.hitProps[n])},t.setPropColorValueFromInt=function(n){e.propColorValue[0]=n%256/255,e.propColorValue[1]=Math.floor(n/256)%256/255,e.propColorValue[2]=Math.floor(n/65536)%256/255},t.getPixelInformation=function(n,a,i){var s=a<0?0:a;if(s===0){if(i[0]=n[0],i[1]=n[1],n[0]<e.area[0]||n[0]>e.area[2]||n[1]<e.area[1]||n[1]>e.area[3])return null;var f=[n[0]-e.area[0],n[1]-e.area[1]],o=ar(f[0],f[1],e.pixBuffer[Qe.ACTOR_PASS],e.area);if(o<=0||o-Er>=e.props.length)return null;var u={};u.valid=!0,u.propID=o-Er,u.prop=e.props[u.propID];var g=ar(f[0],f[1],e.pixBuffer[Qe.COMPOSITE_INDEX_PASS],e.area);if((g<0||g>16777215)&&(g=0),u.compositeID=g-Er,e.captureZValues){var c=(f[1]*(e.area[2]-e.area[0]+1)+f[0])*4;u.zValue=(256*e.zBuffer[c]+e.zBuffer[c+1])/65535,u.displayPosition=n}if(e.pixBuffer[Qe.ID_LOW24]&&Yp(f[0],f[1],e.pixBuffer[Qe.ID_LOW24],e.area)===0)return u;var l=ar(f[0],f[1],e.pixBuffer[Qe.ID_LOW24],e.area),h=ar(f[0],f[1],e.pixBuffer[Qe.ID_HIGH24],e.area);return u.attributeID=Ip(l,h),u}var y=[n[0],n[1]],C=[0,0],T=t.getPixelInformation(n,0,i);if(T&&T.valid)return T;for(var E=1;E<s;++E){for(var w=y[1]>E?y[1]-E:0;w<=y[1]+E;++w)if(C[1]=w,y[0]>=E&&(C[0]=y[0]-E,T=t.getPixelInformation(C,0,i),T&&T.valid)||(C[0]=y[0]+E,T=t.getPixelInformation(C,0,i),T&&T.valid))return T;for(var x=y[0]>=E?y[0]-(E-1):0;x<=y[0]+(E-1);++x)if(C[0]=x,y[1]>=E&&(C[1]=y[1]-E,T=t.getPixelInformation(C,0,i),T&&T.valid)||(C[1]=y[1]+E,T=t.getPixelInformation(C,0,i),T&&T.valid))return T}return i[0]=n[0],i[1]=n[1],null},t.generateSelection=function(n,a,i,s){for(var f=Math.floor(n),o=Math.floor(a),u=Math.floor(i),g=Math.floor(s),c=new Map,l=[0,0],h=o;h<=g;h++)for(var y=f;y<=u;y++){var C=[y,h],T=t.getPixelInformation(C,0,l);if(T&&T.valid){var E=Xp(T);if(!c.has(E))c.set(E,{info:T,pixelCount:1,attributeIDs:[T.attributeID]});else{var w=c.get(E);w.pixelCount++,e.captureZValues&&T.zValue<w.info.zValue&&(w.info=T),w.attributeIDs.indexOf(T.attributeID)===-1&&w.attributeIDs.push(T.attributeID)}}}return qp(e.fieldAssociation,c,e.captureZValues,e._renderer,e._openGLRenderWindow)},t.getRawPixelBuffer=function(n){return e.rawPixBuffer[n]},t.getPixelBuffer=function(n){return e.pixBuffer[n]},t.attach=function(n,a){e._openGLRenderWindow=n,e._renderer=a};var r=t.setArea;t.setArea=function(){return r.apply(void 0,arguments)?(e.area[0]=Math.floor(e.area[0]),e.area[1]=Math.floor(e.area[1]),e.area[2]=Math.floor(e.area[2]),e.area[3]=Math.floor(e.area[3]),!0):!1}}var Om={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function Zp(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Om,r),vm.extend(t,e,r),e.propColorValue=[0,0,0],e.props=[],e.area||(e.area=[0,0,0,0]),L.setGetArray(t,e,["area"],4),L.setGet(t,e,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),L.setGetArray(t,e,["propColorValue"],3),L.moveToProtected(t,e,["renderer","openGLRenderWindow"]),L.event(t,e,"event"),wm(t,e)}var Mm=L.newInstance(Zp,"vtkOpenGLHardwareSelector"),Qp=Sm({newInstance:Mm,extend:Zp},Ol),Jp={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(r){var n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function a(E,w){var x=E[0],S=E[1],m=E[2],D=E[3];x+=(S&m|~S&D)+w[0]-680876936|0,x=(x<<7|x>>>25)+S|0,D+=(x&S|~x&m)+w[1]-389564586|0,D=(D<<12|D>>>20)+x|0,m+=(D&x|~D&S)+w[2]+606105819|0,m=(m<<17|m>>>15)+D|0,S+=(m&D|~m&x)+w[3]-1044525330|0,S=(S<<22|S>>>10)+m|0,x+=(S&m|~S&D)+w[4]-176418897|0,x=(x<<7|x>>>25)+S|0,D+=(x&S|~x&m)+w[5]+1200080426|0,D=(D<<12|D>>>20)+x|0,m+=(D&x|~D&S)+w[6]-1473231341|0,m=(m<<17|m>>>15)+D|0,S+=(m&D|~m&x)+w[7]-45705983|0,S=(S<<22|S>>>10)+m|0,x+=(S&m|~S&D)+w[8]+1770035416|0,x=(x<<7|x>>>25)+S|0,D+=(x&S|~x&m)+w[9]-1958414417|0,D=(D<<12|D>>>20)+x|0,m+=(D&x|~D&S)+w[10]-42063|0,m=(m<<17|m>>>15)+D|0,S+=(m&D|~m&x)+w[11]-1990404162|0,S=(S<<22|S>>>10)+m|0,x+=(S&m|~S&D)+w[12]+1804603682|0,x=(x<<7|x>>>25)+S|0,D+=(x&S|~x&m)+w[13]-40341101|0,D=(D<<12|D>>>20)+x|0,m+=(D&x|~D&S)+w[14]-1502002290|0,m=(m<<17|m>>>15)+D|0,S+=(m&D|~m&x)+w[15]+1236535329|0,S=(S<<22|S>>>10)+m|0,x+=(S&D|m&~D)+w[1]-165796510|0,x=(x<<5|x>>>27)+S|0,D+=(x&m|S&~m)+w[6]-1069501632|0,D=(D<<9|D>>>23)+x|0,m+=(D&S|x&~S)+w[11]+643717713|0,m=(m<<14|m>>>18)+D|0,S+=(m&x|D&~x)+w[0]-373897302|0,S=(S<<20|S>>>12)+m|0,x+=(S&D|m&~D)+w[5]-701558691|0,x=(x<<5|x>>>27)+S|0,D+=(x&m|S&~m)+w[10]+38016083|0,D=(D<<9|D>>>23)+x|0,m+=(D&S|x&~S)+w[15]-660478335|0,m=(m<<14|m>>>18)+D|0,S+=(m&x|D&~x)+w[4]-405537848|0,S=(S<<20|S>>>12)+m|0,x+=(S&D|m&~D)+w[9]+568446438|0,x=(x<<5|x>>>27)+S|0,D+=(x&m|S&~m)+w[14]-1019803690|0,D=(D<<9|D>>>23)+x|0,m+=(D&S|x&~S)+w[3]-187363961|0,m=(m<<14|m>>>18)+D|0,S+=(m&x|D&~x)+w[8]+1163531501|0,S=(S<<20|S>>>12)+m|0,x+=(S&D|m&~D)+w[13]-1444681467|0,x=(x<<5|x>>>27)+S|0,D+=(x&m|S&~m)+w[2]-51403784|0,D=(D<<9|D>>>23)+x|0,m+=(D&S|x&~S)+w[7]+1735328473|0,m=(m<<14|m>>>18)+D|0,S+=(m&x|D&~x)+w[12]-1926607734|0,S=(S<<20|S>>>12)+m|0,x+=(S^m^D)+w[5]-378558|0,x=(x<<4|x>>>28)+S|0,D+=(x^S^m)+w[8]-2022574463|0,D=(D<<11|D>>>21)+x|0,m+=(D^x^S)+w[11]+1839030562|0,m=(m<<16|m>>>16)+D|0,S+=(m^D^x)+w[14]-35309556|0,S=(S<<23|S>>>9)+m|0,x+=(S^m^D)+w[1]-1530992060|0,x=(x<<4|x>>>28)+S|0,D+=(x^S^m)+w[4]+1272893353|0,D=(D<<11|D>>>21)+x|0,m+=(D^x^S)+w[7]-155497632|0,m=(m<<16|m>>>16)+D|0,S+=(m^D^x)+w[10]-1094730640|0,S=(S<<23|S>>>9)+m|0,x+=(S^m^D)+w[13]+681279174|0,x=(x<<4|x>>>28)+S|0,D+=(x^S^m)+w[0]-358537222|0,D=(D<<11|D>>>21)+x|0,m+=(D^x^S)+w[3]-722521979|0,m=(m<<16|m>>>16)+D|0,S+=(m^D^x)+w[6]+76029189|0,S=(S<<23|S>>>9)+m|0,x+=(S^m^D)+w[9]-640364487|0,x=(x<<4|x>>>28)+S|0,D+=(x^S^m)+w[12]-421815835|0,D=(D<<11|D>>>21)+x|0,m+=(D^x^S)+w[15]+530742520|0,m=(m<<16|m>>>16)+D|0,S+=(m^D^x)+w[2]-995338651|0,S=(S<<23|S>>>9)+m|0,x+=(m^(S|~D))+w[0]-198630844|0,x=(x<<6|x>>>26)+S|0,D+=(S^(x|~m))+w[7]+1126891415|0,D=(D<<10|D>>>22)+x|0,m+=(x^(D|~S))+w[14]-1416354905|0,m=(m<<15|m>>>17)+D|0,S+=(D^(m|~x))+w[5]-57434055|0,S=(S<<21|S>>>11)+m|0,x+=(m^(S|~D))+w[12]+1700485571|0,x=(x<<6|x>>>26)+S|0,D+=(S^(x|~m))+w[3]-1894986606|0,D=(D<<10|D>>>22)+x|0,m+=(x^(D|~S))+w[10]-1051523|0,m=(m<<15|m>>>17)+D|0,S+=(D^(m|~x))+w[1]-2054922799|0,S=(S<<21|S>>>11)+m|0,x+=(m^(S|~D))+w[8]+1873313359|0,x=(x<<6|x>>>26)+S|0,D+=(S^(x|~m))+w[15]-30611744|0,D=(D<<10|D>>>22)+x|0,m+=(x^(D|~S))+w[6]-1560198380|0,m=(m<<15|m>>>17)+D|0,S+=(D^(m|~x))+w[13]+1309151649|0,S=(S<<21|S>>>11)+m|0,x+=(m^(S|~D))+w[4]-145523070|0,x=(x<<6|x>>>26)+S|0,D+=(S^(x|~m))+w[11]-1120210379|0,D=(D<<10|D>>>22)+x|0,m+=(x^(D|~S))+w[2]+718787259|0,m=(m<<15|m>>>17)+D|0,S+=(D^(m|~x))+w[9]-343485551|0,S=(S<<21|S>>>11)+m|0,E[0]=x+E[0]|0,E[1]=S+E[1]|0,E[2]=m+E[2]|0,E[3]=D+E[3]|0}function i(E){var w=[],x;for(x=0;x<64;x+=4)w[x>>2]=E.charCodeAt(x)+(E.charCodeAt(x+1)<<8)+(E.charCodeAt(x+2)<<16)+(E.charCodeAt(x+3)<<24);return w}function s(E){var w=[],x;for(x=0;x<64;x+=4)w[x>>2]=E[x]+(E[x+1]<<8)+(E[x+2]<<16)+(E[x+3]<<24);return w}function f(E){var w=E.length,x=[1732584193,-271733879,-1732584194,271733878],S,m,D,b,N,P;for(S=64;S<=w;S+=64)a(x,i(E.substring(S-64,S)));for(E=E.substring(S-64),m=E.length,D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=0;S<m;S+=1)D[S>>2]|=E.charCodeAt(S)<<(S%4<<3);if(D[S>>2]|=128<<(S%4<<3),S>55)for(a(x,D),S=0;S<16;S+=1)D[S]=0;return b=w*8,b=b.toString(16).match(/(.*?)(.{0,8})$/),N=parseInt(b[2],16),P=parseInt(b[1],16)||0,D[14]=N,D[15]=P,a(x,D),x}function o(E){var w=E.length,x=[1732584193,-271733879,-1732584194,271733878],S,m,D,b,N,P;for(S=64;S<=w;S+=64)a(x,s(E.subarray(S-64,S)));for(E=S-64<w?E.subarray(S-64):new Uint8Array(0),m=E.length,D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=0;S<m;S+=1)D[S>>2]|=E[S]<<(S%4<<3);if(D[S>>2]|=128<<(S%4<<3),S>55)for(a(x,D),S=0;S<16;S+=1)D[S]=0;return b=w*8,b=b.toString(16).match(/(.*?)(.{0,8})$/),N=parseInt(b[2],16),P=parseInt(b[1],16)||0,D[14]=N,D[15]=P,a(x,D),x}function u(E){var w="",x;for(x=0;x<4;x+=1)w+=n[E>>x*8+4&15]+n[E>>x*8&15];return w}function g(E){var w;for(w=0;w<E.length;w+=1)E[w]=u(E[w]);return E.join("")}g(f("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function E(w,x){return w=w|0||0,w<0?Math.max(w+x,0):Math.min(w,x)}ArrayBuffer.prototype.slice=function(w,x){var S=this.byteLength,m=E(w,S),D=S,b,N,P,O;return x!==r&&(D=E(x,S)),m>D?new ArrayBuffer(0):(b=D-m,N=new ArrayBuffer(b),P=new Uint8Array(N),O=new Uint8Array(this,m,b),P.set(O),N)}}();function c(E){return/[\u0080-\uFFFF]/.test(E)&&(E=unescape(encodeURIComponent(E))),E}function l(E,w){var x=E.length,S=new ArrayBuffer(x),m=new Uint8Array(S),D;for(D=0;D<x;D+=1)m[D]=E.charCodeAt(D);return w?m:S}function h(E){return String.fromCharCode.apply(null,new Uint8Array(E))}function y(E,w,x){var S=new Uint8Array(E.byteLength+w.byteLength);return S.set(new Uint8Array(E)),S.set(new Uint8Array(w),E.byteLength),x?S:S.buffer}function C(E){var w=[],x=E.length,S;for(S=0;S<x-1;S+=2)w.push(parseInt(E.substr(S,2),16));return String.fromCharCode.apply(String,w)}function T(){this.reset()}return T.prototype.append=function(E){return this.appendBinary(c(E)),this},T.prototype.appendBinary=function(E){this._buff+=E,this._length+=E.length;var w=this._buff.length,x;for(x=64;x<=w;x+=64)a(this._hash,i(this._buff.substring(x-64,x)));return this._buff=this._buff.substring(x-64),this},T.prototype.end=function(E){var w=this._buff,x=w.length,S,m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D;for(S=0;S<x;S+=1)m[S>>2]|=w.charCodeAt(S)<<(S%4<<3);return this._finish(m,x),D=g(this._hash),E&&(D=C(D)),this.reset(),D},T.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},T.prototype.setState=function(E){return this._buff=E.buff,this._length=E.length,this._hash=E.hash,this},T.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},T.prototype._finish=function(E,w){var x=w,S,m,D;if(E[x>>2]|=128<<(x%4<<3),x>55)for(a(this._hash,E),x=0;x<16;x+=1)E[x]=0;S=this._length*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),m=parseInt(S[2],16),D=parseInt(S[1],16)||0,E[14]=m,E[15]=D,a(this._hash,E)},T.hash=function(E,w){return T.hashBinary(c(E),w)},T.hashBinary=function(E,w){var x=f(E),S=g(x);return w?C(S):S},T.ArrayBuffer=function(){this.reset()},T.ArrayBuffer.prototype.append=function(E){var w=y(this._buff.buffer,E,!0),x=w.length,S;for(this._length+=E.byteLength,S=64;S<=x;S+=64)a(this._hash,s(w.subarray(S-64,S)));return this._buff=S-64<x?new Uint8Array(w.buffer.slice(S-64)):new Uint8Array(0),this},T.ArrayBuffer.prototype.end=function(E){var w=this._buff,x=w.length,S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m,D;for(m=0;m<x;m+=1)S[m>>2]|=w[m]<<(m%4<<3);return this._finish(S,x),D=g(this._hash),E&&(D=C(D)),this.reset(),D},T.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.ArrayBuffer.prototype.getState=function(){var E=T.prototype.getState.call(this);return E.buff=h(E.buff),E},T.ArrayBuffer.prototype.setState=function(E){return E.buff=l(E.buff,!0),T.prototype.setState.call(this,E)},T.ArrayBuffer.prototype.destroy=T.prototype.destroy,T.ArrayBuffer.prototype._finish=T.prototype._finish,T.ArrayBuffer.hash=function(E,w){var x=o(new Uint8Array(E)),S=g(x);return w?C(S):S},T})})(Jp);const Dm=Jp.exports;var mm=["lastShaderBound","context","_openGLRenderWindow"];function Rm(t,e){e.classHierarchy.push("vtkShaderCache"),t.replaceShaderValues=function(r,n,a){var i=n;a.length>0&&(i=$.substitute(i,"VSOut","GSOut").result);var s=e._openGLRenderWindow.getWebgl2(),f=`
`,o=`#version 100
`;s?o=`#version 300 es
#define attribute in
#define textureCube texture
#define texture2D texture
#define textureCubeLod textureLod
#define texture2DLod textureLod
`:(e.context.getExtension("OES_standard_derivatives"),e.context.getExtension("EXT_frag_depth")&&(f=`#extension GL_EXT_frag_depth : enable
`),e.context.getExtension("EXT_shader_texture_lod")&&(f+=`#extension GL_EXT_shader_texture_lod : enable
#define textureCubeLod textureCubeLodEXT
#define texture2DLod texture2DLodEXT`)),i=$.substitute(i,"//VTK::System::Dec",["".concat(o,`
`),s?"":`#extension GL_OES_standard_derivatives : enable
`,f,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;var u=$.substitute(r,"//VTK::System::Dec",["".concat(o,`
`),"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(s){u=$.substitute(u,"varying","out").result,i=$.substitute(i,"varying","in").result;for(var g="",c=0;i.includes("gl_FragData[".concat(c,"]"));)i=$.substitute(i,"gl_FragData\\[".concat(c,"\\]"),"fragOutput".concat(c)).result,g+="layout(location = ".concat(c,") out vec4 fragOutput").concat(c,`;
`),c++;i=$.substitute(i,"//VTK::Output::Dec",g).result}var l=$.substitute(a,"//VTK::System::Dec",o).result;return{VSSource:u,FSSource:i,GSSource:l}},t.readyShaderProgramArray=function(r,n,a){var i=t.replaceShaderValues(r,n,a),s=t.getShaderProgram(i.VSSource,i.FSSource,i.GSSource);return t.readyShaderProgram(s)},t.readyShaderProgram=function(r){return!r||!r.getCompiled()&&!r.compileShader()||!t.bindShader(r)?null:r},t.getShaderProgram=function(r,n,a){var i="".concat(r).concat(n).concat(a),s=Dm.hash(i);if(!(s in e.shaderPrograms)){var f=$.newInstance();return f.setContext(e.context),f.getVertexShader().setSource(r),f.getFragmentShader().setSource(n),a&&f.getGeometryShader().setSource(a),f.setMd5Hash(s),e.shaderPrograms[s]=f,f}return e.shaderPrograms[s]},t.releaseGraphicsResources=function(r){t.releaseCurrentShader(),Object.keys(e.shaderPrograms).map(function(n){return e.shaderPrograms[n]}).forEach(function(n){return n.releaseGraphicsResources(r)})},t.releaseGraphicsResources=function(){e.astShaderBound&&(e.lastShaderBound.release(),e.lastShaderBound=null)},t.bindShader=function(r){return e.lastShaderBound===r||(e.lastShaderBound&&e.lastShaderBound.release(),r.bind(),e.lastShaderBound=r),1}}var Lm={lastShaderBound:null,shaderPrograms:null,context:null};function e0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Lm,r),e.shaderPrograms={},L.obj(t,e),L.setGet(t,e,mm),L.moveToProtected(t,e,["openGLRenderWindow"]),Rm(t,e)}var Vm=L.newInstance(e0,"vtkShaderCache"),_m={newInstance:Vm,extend:e0},bm=L.vtkErrorMacro;function km(t,e){e.classHierarchy.push("vtkOpenGLTextureUnitManager"),t.deleteTable=function(){for(var r=0;r<e.numberOfTextureUnits;++r)e.textureUnits[r]===!0&&bm("some texture units  were not properly released");e.textureUnits=[],e.numberOfTextureUnits=0},t.setContext=function(r){if(e.context!==r){if(e.context!==0&&t.deleteTable(),e.context=r,e.context){e.numberOfTextureUnits=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS);for(var n=0;n<e.numberOfTextureUnits;++n)e.textureUnits[n]=!1}t.modified()}},t.allocate=function(){for(var r=0;r<e.numberOfTextureUnits;r++)if(!t.isAllocated(r))return e.textureUnits[r]=!0,r;return-1},t.allocateUnit=function(r){return t.isAllocated(r)?-1:(e.textureUnits[r]=!0,r)},t.isAllocated=function(r){return e.textureUnits[r]},t.free=function(r){e.textureUnits[r]=!1}}var Fm={context:null,numberOfTextureUnits:0,textureUnits:0};function t0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Fm,r),L.obj(t,e),e.textureUnits=[],L.get(t,e,["numberOfTextureUnits"]),L.setGet(t,e,["context"]),km(t,e)}var Bm=L.newInstance(t0,"vtkOpenGLTextureUnitManager"),Nm={newInstance:Bm,extend:t0};function Um(t,e){e.classHierarchy.push("vtkRenderWindowViewNode"),t.getViewNodeFactory=function(){return null},t.getAspectRatio=function(){return e.size[0]/e.size[1]},t.getAspectRatioForRenderer=function(r){var n=r.getViewportByReference();return e.size[0]*(n[2]-n[0])/((n[3]-n[1])*e.size[1])},t.isInViewport=function(r,n,a){var i=a.getViewportByReference(),s=t.getFramebufferSize();return i[0]*s[0]<=r&&i[2]*s[0]>=r&&i[1]*s[1]<=n&&i[3]*s[1]>=n},t.getViewportSize=function(r){var n=r.getViewportByReference(),a=t.getFramebufferSize();return[(n[2]-n[0])*a[0],(n[3]-n[1])*a[1]]},t.getViewportCenter=function(r){var n=t.getViewportSize(r);return[n[0]*.5,n[1]*.5]},t.displayToNormalizedDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r/i[0],n/i[1],a]},t.normalizedDisplayToDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r*i[0],n*i[1],a]},t.worldToView=function(r,n,a,i){return i.worldToView(r,n,a)},t.viewToWorld=function(r,n,a,i){return i.viewToWorld(r,n,a)},t.worldToDisplay=function(r,n,a,i){var s=i.worldToView(r,n,a),f=t.getViewportSize(i),o=i.viewToProjection(s[0],s[1],s[2],f[0]/f[1]),u=i.projectionToNormalizedDisplay(o[0],o[1],o[2]);return t.normalizedDisplayToDisplay(u[0],u[1],u[2])},t.displayToWorld=function(r,n,a,i){var s=t.displayToNormalizedDisplay(r,n,a),f=i.normalizedDisplayToProjection(s[0],s[1],s[2]),o=t.getViewportSize(i),u=i.projectionToView(f[0],f[1],f[2],o[0]/o[1]);return i.viewToWorld(u[0],u[1],u[2])},t.normalizedDisplayToViewport=function(r,n,a,i){var s=i.getViewportByReference();s=t.normalizedDisplayToDisplay(s[0],s[1],0);var f=t.normalizedDisplayToDisplay(r,n,a);return[f[0]-s[0]-.5,f[1]-s[1]-.5,a]},t.viewportToNormalizedViewport=function(r,n,a,i){var s=t.getViewportSize(i);return s&&s[0]!==0&&s[1]!==0?[r/(s[0]-1),n/(s[1]-1),a]:[r,n,a]},t.normalizedViewportToViewport=function(r,n,a,i){var s=t.getViewportSize(i);return[r*(s[0]-1),n*(s[1]-1),a]},t.displayToLocalDisplay=function(r,n,a){var i=t.getFramebufferSize();return[r,i[1]-n-1,a]},t.viewportToNormalizedDisplay=function(r,n,a,i){var s=i.getViewportByReference();s=t.normalizedDisplayToDisplay(s[0],s[1],0);var f=r+s[0]+.5,o=n+s[1]+.5;return t.displayToNormalizedDisplay(f,o,a)},t.getPixelData=function(r,n,a,i){L.vtkErrorMacro("not implemented")},t.createSelector=function(){L.vtkErrorMacro("not implemented")}}var Gm={size:void 0,selector:void 0};function r0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Gm,r),e.size||(e.size=[300,300]),L.getArray(t,e,["size"],2),L.get(t,e,["selector"]),Ie.extend(t,e,r),Um(t,e)}var Am=L.newInstance(r0,"vtkRenderWindowViewNode"),Pm={newInstance:Am,extend:r0};function Wm(){var t=new Map,e={apply:function(i,s,f){return t.has(f[0])?t.get(f[0]):i.apply(s,f)}};function r(a){return{apply:function(s,f,o){return t.set(a,o[0]),s.apply(f,o)}}}var n=Object.create(null);return n.getParameter=function(a,i,s,f){return new Proxy(f.bind(a),e)},n.depthMask=function(a,i,s,f){return new Proxy(f.bind(a),r(a.DEPTH_WRITEMASK))},{get:function(i,s,f){var o=Reflect.get(i,s,i);o instanceof Function&&(o=o.bind(i));var u=n[s];return u?u(i,s,f,o):o}}}var Jc=L.vtkDebugMacro,eg=L.vtkErrorMacro,zm={position:"absolute",top:0,left:0,width:"100%",height:"100%"},ln={vr:{rescaleFactor:1,translateZ:-.7},ar:{rescaleFactor:.25,translateZ:-.5}};function pt(t,e,r){var n=t.createFramebuffer(),a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,e,2,2,0,e,r,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER);return t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),i===t.FRAMEBUFFER_COMPLETE}var Fi=0,Hi=[];function jm(){Fi++,Hi.forEach(function(t){return t(Fi)})}function $m(){Fi--,Hi.forEach(function(t){return t(Fi)})}function Hm(t){Hi.push(t)}function Km(t){return Hi.pop()}function Xm(t,e){e.classHierarchy.push("vtkOpenGLRenderWindow");var r=Wm();t.getViewNodeFactory=function(){return e.myFactory},e.canvas.addEventListener("webglcontextlost",function(o){o.preventDefault()},!1),e.canvas.addEventListener("webglcontextrestored",t.restoreContext,!1);var n=navigator.xr!==void 0&&navigator.xr.isSessionSupported("immersive-vr"),a=[0,0];function i(){e.renderable&&(e.size[0]!==a[0]||e.size[1]!==a[1])&&(a[0]=e.size[0],a[1]=e.size[1],e.canvas.setAttribute("width",e.size[0]),e.canvas.setAttribute("height",e.size[1])),e.viewStream&&e.viewStream.setSize(e.size[0],e.size[1]),e.canvas.style.display=e.useOffScreen?"none":"block",e.el&&(e.el.style.cursor=e.cursorVisibility?e.cursor:"none"),e.containerSize=null}t.onModified(i),t.buildPass=function(o){if(o){if(!e.renderable)return;t.prepareNodes(),t.addMissingNodes(e.renderable.getRenderersByReference()),t.removeUnusedNodes(),t.initialize(),e.children.forEach(function(u){u.setOpenGLRenderWindow(t)})}},t.initialize=function(){if(!e.initialized){e.context=t.get3DContext(),e.textureUnitManager=Nm.newInstance(),e.textureUnitManager.setContext(e.context),e.shaderCache.setContext(e.context);var o=e.context;o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA),o.depthFunc(o.LEQUAL),o.enable(o.BLEND),e.initialized=!0}},t.makeCurrent=function(){e.context.makeCurrent()},t.setContainer=function(o){e.el&&e.el!==o&&(e.canvas.parentNode!==e.el&&eg("Error: canvas parent node does not match container"),e.el.removeChild(e.canvas),e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)),e.el!==o&&(e.el=o,e.el&&(e.el.appendChild(e.canvas),e.useBackgroundImage&&e.el.appendChild(e.bgImage)),t.modified())},t.getContainer=function(){return e.el},t.getContainerSize=function(){if(!e.containerSize&&e.el){var o=e.el.getBoundingClientRect(),u=o.width,g=o.height;e.containerSize=[u,g]}return e.containerSize||e.size},t.getFramebufferSize=function(){return e.activeFramebuffer?e.activeFramebuffer.getSize():e.size},t.getPixelData=function(o,u,g,c){var l=new Uint8Array((g-o+1)*(c-u+1)*4);return e.context.readPixels(o,u,g-o+1,c-u+1,e.context.RGBA,e.context.UNSIGNED_BYTE,l),l},t.get3DContext=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},u=null;n&&t.invokeHaveVRDisplay();var g=typeof WebGL2RenderingContext<"u";return e.webgl2=!1,e.defaultToWebgl2&&g&&(u=e.canvas.getContext("webgl2",o),u&&(e.webgl2=!0,Jc("using webgl2"))),u||(Jc("using webgl1"),u=e.canvas.getContext("webgl",o)||e.canvas.getContext("experimental-webgl",o)),new Proxy(u,r)},t.startXR=function(o){if(navigator.xr===void 0)throw new Error("WebXR is not available");e.xrSessionIsAR=o;var u=o?"immersive-ar":"immersive-vr";if(!navigator.xr.isSessionSupported(u))throw o?new Error("Device does not support AR session"):new Error("VR display is not available");if(e.xrSession===null)navigator.xr.requestSession(u).then(t.enterXR,function(){throw new Error("Failed to create XR session!")});else throw new Error("XR Session already exists!")},t.enterXR=function(){var o=wn(Vt.mark(function u(g){var c,l;return Vt.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e.xrSession=g,e.oldCanvasSize=e.size.slice(),e.xrSession===null){y.next=15;break}return c=t.get3DContext(),y.next=6,c.makeXRCompatible();case 6:l=new global.XRWebGLLayer(e.xrSession,c),t.setSize(l.framebufferWidth,l.framebufferHeight),e.xrSession.updateRenderState({baseLayer:l}),e.xrSession.requestReferenceSpace("local").then(function(C){e.xrReferenceSpace=C}),t.resetXRScene(),e.renderable.getInteractor().switchToXRAnimation(),e.xrSceneFrame=e.xrSession.requestAnimationFrame(t.xrRender),y.next=16;break;case 15:throw new Error("Failed to enter VR with a null xrSession.");case 16:case"end":return y.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),t.resetXRScene=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ln.vr.rescaleFactor,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ln.vr.translateZ,g=o,c=u;e.xrSessionIsAR&&g===ln.vr.rescaleFactor&&(g=ln.ar.rescaleFactor),e.xrSessionIsAR&&c===ln.vr.translateZ&&(c=ln.ar.translateZ);var l=e.renderable.getRenderers()[0];l.resetCamera();var h=l.getActiveCamera(),y=h.getPhysicalScale(),C=h.getPhysicalTranslation();y/=g,c*=y,C[2]+=c,h.setPhysicalScale(y),h.setPhysicalTranslation(C),h.setClippingRange(.1*y,100*y)},t.stopXR=wn(Vt.mark(function o(){var u,g;return Vt.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(navigator.xr!==void 0){l.next=2;break}return l.abrupt("return");case 2:if(e.xrSession===null){l.next=10;break}return e.xrSession.cancelAnimationFrame(e.xrSceneFrame),e.renderable.getInteractor().returnFromXRAnimation(),u=t.get3DContext(),u.bindFramebuffer(u.FRAMEBUFFER,null),l.next=9,e.xrSession.end().catch(function(h){if(!(h instanceof DOMException))throw h});case 9:e.xrSession=null;case 10:e.oldCanvasSize!==void 0&&t.setSize.apply(t,Ee(e.oldCanvasSize)),g=e.renderable.getRenderers()[0],g.getActiveCamera().setProjectionMatrix(null),g.resetCamera(),g.setViewport(0,0,1,1),t.traverseAllPasses();case 16:case"end":return l.stop()}},o)})),t.xrRender=function(){var o=wn(Vt.mark(function u(g,c){var l,h,y,C,T;return Vt.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:l=c.session,e.renderable.getInteractor().updateXRGamepads(l,c,e.xrReferenceSpace),e.xrSceneFrame=e.xrSession.requestAnimationFrame(t.xrRender),h=c.getViewerPose(e.xrReferenceSpace),h&&(y=t.get3DContext(),e.xrSessionIsAR&&e.oldCanvasSize!==void 0&&(y.canvas.width=e.oldCanvasSize[0],y.canvas.height=e.oldCanvasSize[1]),C=l.renderState.baseLayer,y.bindFramebuffer(y.FRAMEBUFFER,C.framebuffer),y.clear(y.COLOR_BUFFER_BIT),y.clear(y.DEPTH_BUFFER_BIT),T=e.renderable.getRenderers()[0],h.views.forEach(function(x){var S=C.getViewport(x);if(y.viewport(S.x,S.y,S.width,S.height),!e.xrSessionIsAR)if(x.eye==="left")T.setViewport(0,0,.5,1);else if(x.eye==="right")T.setViewport(.5,0,1,1);else return;T.getActiveCamera().computeViewParametersFromPhysicalMatrix(x.transform.inverse.matrix),T.getActiveCamera().setProjectionMatrix(x.projectionMatrix),t.traverseAllPasses()}));case 5:case"end":return w.stop()}},u)}));return function(u,g){return o.apply(this,arguments)}}(),t.restoreContext=function(){var o=ff.newInstance();o.setCurrentOperation("Release"),o.traverse(t,null)},t.activateTexture=function(o){var u=e._textureResourceIds.get(o);if(u!==void 0){e.context.activeTexture(e.context.TEXTURE0+u);return}var g=t.getTextureUnitManager().allocate();if(g<0){eg("Hardware does not support the number of textures defined.");return}e._textureResourceIds.set(o,g),e.context.activeTexture(e.context.TEXTURE0+g)},t.deactivateTexture=function(o){var u=e._textureResourceIds.get(o);u!==void 0&&(t.getTextureUnitManager().free(u),delete e._textureResourceIds.delete(o))},t.getTextureUnitForTexture=function(o){var u=e._textureResourceIds.get(o);return u!==void 0?u:-1},t.getDefaultTextureInternalFormat=function(o,u,g){if(e.webgl2)switch(o){case mr.UNSIGNED_CHAR:switch(u){case 1:return e.context.R8;case 2:return e.context.RG8;case 3:return e.context.RGB8;case 4:default:return e.context.RGBA8}case mr.FLOAT:default:switch(u){case 1:return e.context.R16F;case 2:return e.context.RG16F;case 3:return e.context.RGB16F;case 4:default:return e.context.RGBA16F}}switch(u){case 1:return e.context.LUMINANCE;case 2:return e.context.LUMINANCE_ALPHA;case 3:return e.context.RGB;case 4:default:return e.context.RGBA}},t.setBackgroundImage=function(o){e.bgImage.src=o.src},t.setUseBackgroundImage=function(o){e.useBackgroundImage=o,e.useBackgroundImage&&!e.el.contains(e.bgImage)?e.el.appendChild(e.bgImage):!e.useBackgroundImage&&e.el.contains(e.bgImage)&&e.el.removeChild(e.bgImage)};function s(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.imageFormat,u=document.createElement("canvas"),g=u.getContext("2d");u.width=e.canvas.width,u.height=e.canvas.height,g.drawImage(e.canvas,0,0);var c=e.canvas.getBoundingClientRect(),l=e.renderable,h=l.getRenderers();h.forEach(function(C){var T=C.getViewProps();T.forEach(function(E){if(E.getContainer)for(var w=E.getContainer(),x=w.getElementsByTagName("canvas"),S=0;S<x.length;S++){var m=x[S],D=m.getBoundingClientRect(),b=D.x-c.x,N=D.y-c.y;g.drawImage(m,b,N)}})});var y=u.toDataURL(o);u.remove(),t.invokeImageReady(y)}t.captureNextImage=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=u.resetCamera,c=g===void 0?!1:g,l=u.size,h=l===void 0?null:l,y=u.scale,C=y===void 0?1:y;if(e.deleted)return null;e.imageFormat=o;var T=e.notifyStartCaptureImage;return e.notifyStartCaptureImage=!0,e._screenshot={size:!!h||C!==1?h||e.size.map(function(E){return E*C}):null},new Promise(function(E,w){var x=t.onImageReady(function(S){if(e._screenshot.size===null)e.notifyStartCaptureImage=T,x.unsubscribe(),e._screenshot.placeHolder&&(e.size=e._screenshot.originalSize,t.modified(),e._screenshot.cameras&&e._screenshot.cameras.forEach(function(b){var N=b.restoreParamsFn,P=b.arg;return N(P)}),t.traverseAllPasses(),e.el.removeChild(e._screenshot.placeHolder),e._screenshot.placeHolder.remove(),e._screenshot=null),E(S);else{var m=document.createElement("img");if(m.style=zm,m.src=S,e._screenshot.placeHolder=e.el.appendChild(m),e.canvas.style.display="none",e._screenshot.originalSize=e.size,e.size=e._screenshot.size,e._screenshot.size=null,t.modified(),c){var D=c!==!0;e._screenshot.cameras=e.renderable.getRenderers().map(function(b){var N=b.getActiveCamera(),P=N.get("focalPoint","position","parallelScale");return{resetCameraArgs:D?{renderer:b}:void 0,resetCameraFn:D?c:b.resetCamera,restoreParamsFn:N.set,arg:JSON.parse(JSON.stringify(P))}}),e._screenshot.cameras.forEach(function(b){var N=b.resetCameraFn,P=b.resetCameraArgs;return N(P)})}t.traverseAllPasses()}})})};var f;t.getHardwareMaximumLineWidth=function(){if(f!=null)return f;var o=t.get3DContext(),u=o.getParameter(o.ALIASED_LINE_WIDTH_RANGE);return f=u[1],u[1]},t.getGLInformations=function(){for(var o=t.get3DContext(),u=o.getExtension("OES_texture_float"),g=o.getExtension("OES_texture_half_float"),c=o.getExtension("WEBGL_debug_renderer_info"),l=o.getExtension("WEBGL_draw_buffers"),h=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),y=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",o.getParameter(o.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",o.getParameter(o.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",o.getParameter(o.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",h&&o.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",o.getParameter(o.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",o.getParameter(o.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",o.getParameter(o.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",o.getParameter(o.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",o.getParameter(o.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",o.getParameter(o.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",o.getParameter(o.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",o.getParameter(o.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",o.getParameter(o.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",o.getParameter(o.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",o.getParameter(o.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",o.getParameter(o.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",o.getParameter(o.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[u&&pt(o,o.RGBA,o.UNSIGNED_BYTE)?"RGBA":"",u&&pt(o,o.RGB,o.UNSIGNED_BYTE)?"RGB":"",u&&pt(o,o.LUMINANCE,o.UNSIGNED_BYTE)?"LUMINANCE":"",u&&pt(o,o.ALPHA,o.UNSIGNED_BYTE)?"ALPHA":"",u&&pt(o,o.LUMINANCE_ALPHA,o.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[g&&pt(o,o.RGBA,g.HALF_FLOAT_OES)?"RGBA":"",g&&pt(o,o.RGB,g.HALF_FLOAT_OES)?"RGB":"",g&&pt(o,o.LUMINANCE,g.HALF_FLOAT_OES)?"LUMINANCE":"",g&&pt(o,o.ALPHA,g.HALF_FLOAT_OES)?"ALPHA":"",g&&pt(o,o.LUMINANCE_ALPHA,g.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[u&&pt(o,o.RGBA,o.FLOAT)?"RGBA":"",u&&pt(o,o.RGB,o.FLOAT)?"RGB":"",u&&pt(o,o.LUMINANCE,o.FLOAT)?"LUMINANCE":"",u&&pt(o,o.ALPHA,o.FLOAT)?"ALPHA":"",u&&pt(o,o.LUMINANCE_ALPHA,o.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",l?o.getParameter(l.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_FLOAT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_INT).precision," (-2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_INT).rangeMin,"</sup> - 2<sup>",o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",o.getSupportedExtensions().join("<br/>					    ")],["WebGL Renderer","RENDERER",o.getParameter(o.RENDERER)],["WebGL Vendor","VENDOR",o.getParameter(o.VENDOR)],["WebGL Version","VERSION",o.getParameter(o.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",o.getParameter(o.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",c&&o.getParameter(c.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",c&&o.getParameter(c.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",e.webgl2?2:1]],C={};y.length;){var T=y.pop(),E=St(T,3),w=E[0],x=E[1],S=E[2];x&&(C[x]={label:w,value:S})}return C},t.traverseAllPasses=function(){if(e.renderPasses)for(var o=0;o<e.renderPasses.length;++o)e.renderPasses[o].traverse(t,null);e.notifyStartCaptureImage&&s()},t.disableCullFace=function(){e.cullFaceEnabled&&(e.context.disable(e.context.CULL_FACE),e.cullFaceEnabled=!1)},t.enableCullFace=function(){e.cullFaceEnabled||(e.context.enable(e.context.CULL_FACE),e.cullFaceEnabled=!0)},t.setViewStream=function(o){if(e.viewStream===o)return!1;if(e.subscription&&(e.subscription.unsubscribe(),e.subscription=null),e.viewStream=o,e.viewStream){var u=e.renderable.getRenderers()[0];u.getBackgroundByReference()[3]=0,t.setUseBackgroundImage(!0),e.subscription=e.viewStream.onImageReady(function(g){return t.setBackgroundImage(g.image)}),e.viewStream.setSize(e.size[0],e.size[1]),e.viewStream.invalidateCache(),e.viewStream.render(),t.modified()}return!0},t.createSelector=function(){var o=Qp.newInstance();return o.setOpenGLRenderWindow(t),o},t.delete=L.chain(t.delete,t.setViewStream,$m)}var Ym={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,xrSession:null,xrSessionIsAR:!1,xrReferenceSpace:null,xrSupported:!0,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function n0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Ym,r),Pm.extend(t,e,r),e.canvas=document.createElement("canvas"),e.canvas.style.width="100%",jm(),e.selector||(e.selector=Qp.newInstance(),e.selector.setOpenGLRenderWindow(t)),e.bgImage=new Image,e.bgImage.style.position="absolute",e.bgImage.style.left="0",e.bgImage.style.top="0",e.bgImage.style.width="100%",e.bgImage.style.height="100%",e.bgImage.style.zIndex="-1",e._textureResourceIds=new Map,e.myFactory=TT.newInstance(),e.myFactory.registerOverride("vtkRenderWindow",cf),e.shaderCache=_m.newInstance(),e.shaderCache.setOpenGLRenderWindow(t),e.renderPasses[0]=om.newInstance(),L.event(t,e,"imageReady"),L.event(t,e,"haveVRDisplay"),L.get(t,e,["shaderCache","textureUnitManager","webgl2","vrDisplay","useBackgroundImage","xrSupported"]),L.setGet(t,e,["initialized","context","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen","activeFramebuffer"]),L.setGetArray(t,e,["size"],2),Xm(t,e)}var cf=L.newInstance(n0,"vtkOpenGLRenderWindow");Up("WebGL",cf);var Im={newInstance:cf,extend:n0,pushMonitorGLContextCount:Hm,popMonitorGLContextCount:Km},ii=L.vtkDebugMacro;function qm(t,e){e.classHierarchy.push("vtkCamera");var r=new Float64Array(3),n=new Float64Array([0,0,-1]),a=new Float64Array([0,1,0]),i=De(new Float64Array(16)),s=De(new Float64Array(16)),f=new Float64Array(3),o=new Float64Array(3),u=new Float64Array(3),g=De(new Float64Array(16)),c=De(new Float64Array(16)),l=new Float64Array(3),h=new Float64Array(3);function y(){e.viewPlaneNormal[0]=-e.directionOfProjection[0],e.viewPlaneNormal[1]=-e.directionOfProjection[1],e.viewPlaneNormal[2]=-e.directionOfProjection[2]}t.orthogonalizeViewUp=function(){var C=t.getViewMatrix();e.viewUp[0]=C[4],e.viewUp[1]=C[5],e.viewUp[2]=C[6],t.modified()},t.setPosition=function(C,T,E){C===e.position[0]&&T===e.position[1]&&E===e.position[2]||(e.position[0]=C,e.position[1]=T,e.position[2]=E,t.computeDistance(),t.modified())},t.setFocalPoint=function(C,T,E){C===e.focalPoint[0]&&T===e.focalPoint[1]&&E===e.focalPoint[2]||(e.focalPoint[0]=C,e.focalPoint[1]=T,e.focalPoint[2]=E,t.computeDistance(),t.modified())},t.setDistance=function(C){if(e.distance!==C){e.distance=C,e.distance<1e-20&&(e.distance=1e-20,ii("Distance is set to minimum."));var T=e.directionOfProjection;e.focalPoint[0]=e.position[0]+T[0]*e.distance,e.focalPoint[1]=e.position[1]+T[1]*e.distance,e.focalPoint[2]=e.position[2]+T[2]*e.distance,t.modified()}},t.computeDistance=function(){var C=e.focalPoint[0]-e.position[0],T=e.focalPoint[1]-e.position[1],E=e.focalPoint[2]-e.position[2];if(e.distance=Math.sqrt(C*C+T*T+E*E),e.distance<1e-20){e.distance=1e-20,ii("Distance is set to minimum.");var w=e.directionOfProjection;e.focalPoint[0]=e.position[0]+w[0]*e.distance,e.focalPoint[1]=e.position[1]+w[1]*e.distance,e.focalPoint[2]=e.position[2]+w[2]*e.distance}e.directionOfProjection[0]=C/e.distance,e.directionOfProjection[1]=T/e.distance,e.directionOfProjection[2]=E/e.distance,y()},t.dolly=function(C){if(!(C<=0)){var T=e.distance/C;t.setPosition(e.focalPoint[0]-T*e.directionOfProjection[0],e.focalPoint[1]-T*e.directionOfProjection[1],e.focalPoint[2]-T*e.directionOfProjection[2])}},t.roll=function(C){var T=e.position,E=e.focalPoint,w=e.viewUp,x=new Float64Array([w[0],w[1],w[2],0]);De(g);var S=new Float64Array([E[0]-T[0],E[1]-T[1],E[2]-T[2]]);Xt(g,g,Ke(C),S),dn(x,x,g),e.viewUp[0]=x[0],e.viewUp[1]=x[1],e.viewUp[2]=x[2],t.modified()},t.azimuth=function(C){var T=e.focalPoint;De(c),et(c,c,T),Xt(c,c,Ke(C),e.viewUp),et(c,c,[-T[0],-T[1],-T[2]]),me(l,e.position,c),t.setPosition(l[0],l[1],l[2])},t.yaw=function(C){var T=e.position;De(c),et(c,c,T),Xt(c,c,Ke(C),e.viewUp),et(c,c,[-T[0],-T[1],-T[2]]),me(h,e.focalPoint,c),t.setFocalPoint(h[0],h[1],h[2])},t.elevation=function(C){var T=e.focalPoint,E=t.getViewMatrix(),w=[-E[0],-E[1],-E[2]];De(c),et(c,c,T),Xt(c,c,Ke(C),w),et(c,c,[-T[0],-T[1],-T[2]]),me(l,e.position,c),t.setPosition(l[0],l[1],l[2])},t.pitch=function(C){var T=e.position,E=t.getViewMatrix(),w=[E[0],E[1],E[2]];De(c),et(c,c,T),Xt(c,c,Ke(C),w),et(c,c,[-T[0],-T[1],-T[2]]),me(h,e.focalPoint,c),t.setFocalPoint.apply(t,Ee(h))},t.zoom=function(C){C<=0||(e.parallelProjection?e.parallelScale/=C:e.viewAngle/=C,t.modified())},t.translate=function(C,T,E){var w=[C,T,E];lo(e.position,w,e.position),lo(e.focalPoint,w,e.focalPoint),t.computeDistance(),t.modified()},t.applyTransform=function(C){var T=[].concat(Ee(e.viewUp),[1]),E=[],w=[],x=[];T[0]+=e.position[0],T[1]+=e.position[1],T[2]+=e.position[2],dn(E,[].concat(Ee(e.position),[1]),C),dn(w,[].concat(Ee(e.focalPoint),[1]),C),dn(x,T,C),x[0]-=E[0],x[1]-=E[1],x[2]-=E[2],t.setPosition.apply(t,Ee(E.slice(0,3))),t.setFocalPoint.apply(t,Ee(w.slice(0,3))),t.setViewUp.apply(t,Ee(x.slice(0,3)))},t.getThickness=function(){return e.clippingRange[1]-e.clippingRange[0]},t.setThickness=function(C){var T=C;T<1e-20&&(T=1e-20,ii("Thickness is set to minimum.")),t.setClippingRange(e.clippingRange[0],e.clippingRange[0]+T)},t.setThicknessFromFocalPoint=function(C){var T=C;T<1e-20&&(T=1e-20,ii("Thickness is set to minimum.")),t.setClippingRange(e.distance-T/2,e.distance+T/2)},t.setRoll=function(C){},t.getRoll=function(){},t.setObliqueAngles=function(C,T){},t.getOrientation=function(){},t.getOrientationWXYZ=function(){},t.getFrustumPlanes=function(C){},t.getCameraLightTransformMatrix=function(C){return ut(C,e.cameraLightTransform),C},t.computeCameraLightTransform=function(){ut(i,t.getViewMatrix()),wt(i,i),wg(s,[e.distance,e.distance,e.distance]),Ct(i,i,s),De(e.cameraLightTransform),et(e.cameraLightTransform,i,[0,0,-1])},t.deepCopy=function(C){},t.physicalOrientationToWorldDirection=function(C){var T=Zf(C[0],C[1],C[2],C[3]),E=qr(),w=Zf(0,0,1,0);return Rd(E,T),qf(w,T,w),qf(w,w,E),[w[0],w[1],w[2]]},t.getPhysicalToWorldMatrix=function(C){t.getWorldToPhysicalMatrix(C),wt(C,C)},t.getWorldToPhysicalMatrix=function(C){De(C);var T=[3];pa(e.physicalViewNorth,e.physicalViewUp,T),C[0]=T[0],C[1]=T[1],C[2]=T[2],C[4]=e.physicalViewUp[0],C[5]=e.physicalViewUp[1],C[6]=e.physicalViewUp[2],C[8]=-e.physicalViewNorth[0],C[9]=-e.physicalViewNorth[1],C[10]=-e.physicalViewNorth[2],We(C,C),Ti(f,1/e.physicalScale,1/e.physicalScale,1/e.physicalScale),oa(C,C,f),et(C,C,e.physicalTranslation)},t.computeViewParametersFromViewMatrix=function(C){wt(i,C),me(f,r,i),t.computeDistance();var T=e.distance;t.setPosition(f[0],f[1],f[2]),me(o,n,i),xr(o,o,f),fa(o,o),t.setDirectionOfProjection(o[0],o[1],o[2]),me(u,a,i),xr(u,u,f),fa(u,u),t.setViewUp(u[0],u[1],u[2]),t.setDistance(T)},t.computeViewParametersFromPhysicalMatrix=function(C){t.getWorldToPhysicalMatrix(i),Ct(i,C,i),t.computeViewParametersFromViewMatrix(i)},t.setViewMatrix=function(C){e.viewMatrix=C,e.viewMatrix&&(ut(i,e.viewMatrix),t.computeViewParametersFromViewMatrix(i),We(e.viewMatrix,e.viewMatrix))},t.getViewMatrix=function(){if(e.viewMatrix)return e.viewMatrix;_g(i,e.position,e.focalPoint,e.viewUp),We(i,i);var C=new Float64Array(16);return ut(C,i),C},t.setProjectionMatrix=function(C){e.projectionMatrix=C},t.getProjectionMatrix=function(C,T,E){var w=new Float64Array(16);if(De(w),e.projectionMatrix){var x=1/e.physicalScale;return Ti(f,x,x,x),ut(w,e.projectionMatrix),oa(w,w,f),We(w,w),w}De(i);var S=e.clippingRange[1]-e.clippingRange[0],m=[e.clippingRange[0]+(T+1)*S/2,e.clippingRange[0]+(E+1)*S/2];if(e.parallelProjection){var D=e.parallelScale*C,b=e.parallelScale,N=(e.windowCenter[0]-1)*D,P=(e.windowCenter[0]+1)*D,O=(e.windowCenter[1]-1)*b,A=(e.windowCenter[1]+1)*b;Vg(i,N,P,O,A,m[0],m[1]),We(i,i)}else{if(e.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");var z=Math.tan(Ke(e.viewAngle)/2),j,B;e.useHorizontalViewAngle===!0?(j=e.clippingRange[0]*z,B=e.clippingRange[0]*z/C):(j=e.clippingRange[0]*z*C,B=e.clippingRange[0]*z);var Y=(e.windowCenter[0]-1)*j,I=(e.windowCenter[0]+1)*j,te=(e.windowCenter[1]-1)*B,U=(e.windowCenter[1]+1)*B,G=m[0],K=m[1];i[0]=2*G/(I-Y),i[5]=2*G/(U-te),i[2]=(Y+I)/(I-Y),i[6]=(te+U)/(U-te),i[10]=-(G+K)/(K-G),i[14]=-1,i[11]=-2*G*K/(K-G),i[15]=0}return ut(w,i),w},t.getCompositeProjectionMatrix=function(C,T,E){var w=t.getViewMatrix(),x=t.getProjectionMatrix(C,T,E);return Ct(x,w,x),x},t.setDirectionOfProjection=function(C,T,E){if(!(e.directionOfProjection[0]===C&&e.directionOfProjection[1]===T&&e.directionOfProjection[2]===E)){e.directionOfProjection[0]=C,e.directionOfProjection[1]=T,e.directionOfProjection[2]=E;var w=e.directionOfProjection;e.focalPoint[0]=e.position[0]+w[0]*e.distance,e.focalPoint[1]=e.position[1]+w[1]*e.distance,e.focalPoint[2]=e.position[2]+w[2]*e.distance,y()}},t.setDeviceAngles=function(C,T,E,w){var x=[3];pa(e.physicalViewNorth,e.physicalViewUp,x);var S=De(new Float64Array(16));Xt(S,S,Ke(C),e.physicalViewUp),Xt(S,S,Ke(T),x),Xt(S,S,Ke(E),e.physicalViewNorth),Xt(S,S,Ke(-w),e.physicalViewUp);var m=new Float64Array([-e.physicalViewUp[0],-e.physicalViewUp[1],-e.physicalViewUp[2]]),D=new Float64Array(e.physicalViewNorth);me(m,m,S),me(D,D,S),t.setDirectionOfProjection(m[0],m[1],m[2]),t.setViewUp(D[0],D[1],D[2]),t.modified()},t.setOrientationWXYZ=function(C,T,E,w){var x=De(new Float64Array(16));if(C!==0&&(T!==0||E!==0||w!==0)){var S=Ke(C),m=qr();Bo(m,[T,E,w],S),Fo(x,m)}var D=new Float64Array(3);me(D,[0,0,-1],x);var b=new Float64Array(3);me(b,[0,1,0],x),t.setDirectionOfProjection.apply(t,Ee(D)),t.setViewUp.apply(t,Ee(b)),t.modified()},t.computeClippingRange=function(C){var T=null,E=null;T=e.viewPlaneNormal,E=e.position;for(var w=-T[0],x=-T[1],S=-T[2],m=-(w*E[0]+x*E[1]+S*E[2]),D=[w*C[0]+x*C[2]+S*C[4]+m,1e-18],b=0;b<2;b++)for(var N=0;N<2;N++)for(var P=0;P<2;P++){var O=w*C[P]+x*C[2+N]+S*C[4+b]+m;D[0]=O<D[0]?O:D[0],D[1]=O>D[1]?O:D[1]}return D}}var Zm={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:ko(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function a0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,Zm,r),L.obj(t,e),L.get(t,e,["distance"]),L.setGet(t,e,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),L.getArray(t,e,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),L.setGetArray(t,e,["clippingRange","windowCenter"],2),L.setGetArray(t,e,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),qm(t,e)}var Qm=L.newInstance(a0,"vtkCamera"),Jm={newInstance:Qm,extend:a0},eR=["HeadLight","CameraLight","SceneLight"];function tR(t,e){e.classHierarchy.push("vtkLight");var r=new Float64Array(3);t.getTransformedPosition=function(){return e.transformMatrix?me(r,e.position,e.transformMatrix):Ti(r,e.position[0],e.position[1],e.position[2]),r},t.getTransformedFocalPoint=function(){return e.transformMatrix?me(r,e.focalPoint,e.transformMatrix):Ti(r,e.focalPoint[0],e.focalPoint[1],e.focalPoint[2]),r},t.getDirection=function(){return e.directionMTime<e.mtime&&(Qs(e.direction,e.focalPoint,e.position),Dn(e.direction),e.directionMTime=e.mtime),e.direction},t.setDirection=function(n){var a=new Float64Array(3);Qs(a,e.position,n),e.focalPoint=a},t.setDirectionAngle=function(n,a){var i=Ke(n),s=Ke(a);t.setPosition(Math.cos(i)*Math.sin(s),Math.sin(i),Math.cos(i)*Math.cos(s)),t.setFocalPoint(0,0,0),t.setPositional(0)},t.setLightTypeToHeadLight=function(){t.setLightType("HeadLight")},t.setLightTypeToCameraLight=function(){t.setLightType("CameraLight")},t.setLightTypeToSceneLight=function(){t.setTransformMatrix(null),t.setLightType("SceneLight")},t.lightTypeIsHeadLight=function(){return e.lightType==="HeadLight"},t.lightTypeIsSceneLight=function(){return e.lightType==="SceneLight"},t.lightTypeIsCameraLight=function(){return e.lightType==="CameraLight"}}var rR={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function i0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rR,r),L.obj(t,e),L.setGet(t,e,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),L.setGetArray(t,e,["color","position","focalPoint","attenuationValues"],3),tR(t,e)}var nR=L.newInstance(i0,"vtkLight"),aR={newInstance:nR,extend:i0,LIGHT_TYPES:eR},di=L.vtkErrorMacro;function iR(t){return function(){return di("vtkViewport::".concat(t," - NOT IMPLEMENTED"))}}function sR(t,e){e.classHierarchy.push("vtkViewport"),t.getViewProps=function(){return e.props},t.hasViewProp=function(n){return!!e.props.filter(function(a){return a===n}).length},t.addViewProp=function(n){n&&!t.hasViewProp(n)&&(e.props=e.props.concat(n))},t.removeViewProp=function(n){var a=e.props.filter(function(i){return i!==n});e.props.length!==a.length&&(e.props=a)},t.removeAllViewProps=function(){e.props=[]};function r(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];a.push(n);var i=n.getNestedProps();if(i&&i.length)for(var s=0;s<i.length;s++)r(i[s],a);return a}t.getViewPropsWithNestedProps=function(){for(var n=[],a=0;a<e.props.length;a++)r(e.props[a],n);return n},t.addActor2D=t.addViewProp,t.removeActor2D=function(n){t.removeViewProp(n)},t.getActors2D=function(){return e.actors2D=[],e.props.forEach(function(n){e.actors2D=e.actors2D.concat(n.getActors2D())}),e.actors2D},t.displayToView=function(){return di("call displayToView on your view instead")},t.viewToDisplay=function(){return di("callviewtodisplay on your view instead")},t.getSize=function(){return di("call getSize on your View instead")},t.normalizedDisplayToProjection=function(n,a,i){var s=t.normalizedDisplayToNormalizedViewport(n,a,i);return t.normalizedViewportToProjection(s[0],s[1],s[2])},t.normalizedDisplayToNormalizedViewport=function(n,a,i){var s=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[(n-e.viewport[0])/s[0],(a-e.viewport[1])/s[1],i]},t.normalizedViewportToProjection=function(n,a,i){return[n*2-1,a*2-1,i*2-1]},t.projectionToNormalizedDisplay=function(n,a,i){var s=t.projectionToNormalizedViewport(n,a,i);return t.normalizedViewportToNormalizedDisplay(s[0],s[1],s[2])},t.normalizedViewportToNormalizedDisplay=function(n,a,i){var s=[e.viewport[2]-e.viewport[0],e.viewport[3]-e.viewport[1]];return[n*s[0]+e.viewport[0],a*s[1]+e.viewport[1],i]},t.projectionToNormalizedViewport=function(n,a,i){return[(n+1)*.5,(a+1)*.5,(i+1)*.5]},t.PickPropFrom=iR("PickPropFrom")}var oR={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function s0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,oR,r),L.obj(t,e),L.event(t,e,"event"),L.setGetArray(t,e,["viewport"],4),L.setGetArray(t,e,["background","background2"],3),sR(t,e)}var fR=L.newInstance(s0,"vtkViewport"),uR={newInstance:fR,extend:s0},$n=Mr,Tr=ve,cR=Bi;function tg(t){return function(){return Tr("vtkRenderer::".concat(t," - NOT IMPLEMENTED"))}}function gR(t,e){e.classHierarchy.push("vtkRenderer");var r={type:"ComputeVisiblePropBoundsEvent",renderer:t},n={type:"ResetCameraClippingRangeEvent",renderer:t},a={type:"ResetCameraEvent",renderer:t};t.updateCamera=function(){return e.activeCamera||($n("No cameras are on, creating one."),t.getActiveCameraAndResetIfCreated()),e.activeCamera.render(t),!0},t.updateLightsGeometryToFollowCamera=function(){var i=t.getActiveCameraAndResetIfCreated();e.lights.forEach(function(s){s.lightTypeIsSceneLight()||(s.lightTypeIsHeadLight()?(s.setPositionFrom(i.getPositionByReference()),s.setFocalPointFrom(i.getFocalPointByReference()),s.modified(i.getMTime())):s.lightTypeIsCameraLight()?s.setTransformMatrix(i.getCameraLightTransformMatrix(ko())):Tr("light has unknown light type",s.get()))})},t.updateLightGeometry=function(){return e.lightFollowCamera?t.updateLightsGeometryToFollowCamera():!0},t.allocateTime=tg("allocateTime"),t.updateGeometry=tg("updateGeometry"),t.getVTKWindow=function(){return e._renderWindow},t.setLayer=function(i){$n(t.getClassName(),t,"setting Layer to ",i),e.layer!==i&&(e.layer=i,t.modified()),t.setPreserveColorBuffer(!!i)},t.setActiveCamera=function(i){return e.activeCamera===i?!1:(e.activeCamera=i,t.modified(),t.invokeEvent({type:"ActiveCameraEvent",camera:i}),!0)},t.makeCamera=function(){var i=Jm.newInstance();return t.invokeEvent({type:"CreateCameraEvent",camera:i}),i},t.getActiveCamera=function(){return e.activeCamera||(e.activeCamera=t.makeCamera()),e.activeCamera},t.getActiveCameraAndResetIfCreated=function(){return e.activeCamera||(t.getActiveCamera(),t.resetCamera()),e.activeCamera},t.getActors=function(){return e.actors=[],e.props.forEach(function(i){e.actors=e.actors.concat(i.getActors())}),e.actors},t.addActor=t.addViewProp,t.removeActor=function(i){e.actors=e.actors.filter(function(s){return s!==i}),t.removeViewProp(i),t.modified()},t.removeAllActors=function(){var i=t.getActors();i.forEach(function(s){t.removeViewProp(s)}),e.actors=[],t.modified()},t.getVolumes=function(){return e.volumes=[],e.props.forEach(function(i){e.volumes=e.volumes.concat(i.getVolumes())}),e.volumes},t.addVolume=t.addViewProp,t.removeVolume=function(i){e.volumes=e.volumes.filter(function(s){return s!==i}),t.removeViewProp(i),t.modified()},t.removeAllVolumes=function(){var i=t.getVolumes();i.forEach(function(s){t.removeViewProp(s)}),e.volumes=[],t.modified()},t.addLight=function(i){e.lights=[].concat(e.lights,i),t.modified()},t.removeLight=function(i){e.lights=e.lights.filter(function(s){return s!==i}),t.modified()},t.removeAllLights=function(){e.lights=[],t.modified()},t.setLightCollection=function(i){e.lights=i,t.modified()},t.makeLight=aR.newInstance,t.createLight=function(){!e.automaticLightCreation||(e._createdLight&&(t.removeLight(e._createdLight),e._createdLight.delete(),e._createdLight=null),e._createdLight=t.makeLight(),t.addLight(e._createdLight),e._createdLight.setLightTypeToHeadLight(),e._createdLight.setPosition(t.getActiveCamera().getPosition()),e._createdLight.setFocalPoint(t.getActiveCamera().getFocalPoint()))},t.normalizedDisplayToWorld=function(i,s,f,o){var u=t.normalizedDisplayToProjection(i,s,f);return u=t.projectionToView(u[0],u[1],u[2],o),t.viewToWorld(u[0],u[1],u[2])},t.worldToNormalizedDisplay=function(i,s,f,o){var u=t.worldToView(i,s,f);return u=t.viewToProjection(u[0],u[1],u[2],o),t.projectionToNormalizedDisplay(u[0],u[1],u[2])},t.viewToWorld=function(i,s,f){if(e.activeCamera===null)return Tr("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];var o=e.activeCamera.getViewMatrix();wt(o,o),We(o,o);var u=new Float64Array([i,s,f]);return me(u,u,o),u},t.projectionToView=function(i,s,f,o){if(e.activeCamera===null)return Tr("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];var u=e.activeCamera.getProjectionMatrix(o,-1,1);wt(u,u),We(u,u);var g=new Float64Array([i,s,f]);return me(g,g,u),g},t.worldToView=function(i,s,f){if(e.activeCamera===null)return Tr("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];var o=e.activeCamera.getViewMatrix();We(o,o);var u=new Float64Array([i,s,f]);return me(u,u,o),u},t.viewToProjection=function(i,s,f,o){if(e.activeCamera===null)return Tr("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];var u=e.activeCamera.getProjectionMatrix(o,-1,1);We(u,u);var g=new Float64Array([i,s,f]);return me(g,g,u),g},t.computeVisiblePropBounds=function(){e.allBounds[0]=je.INIT_BOUNDS[0],e.allBounds[1]=je.INIT_BOUNDS[1],e.allBounds[2]=je.INIT_BOUNDS[2],e.allBounds[3]=je.INIT_BOUNDS[3],e.allBounds[4]=je.INIT_BOUNDS[4],e.allBounds[5]=je.INIT_BOUNDS[5];var i=!0;t.invokeEvent(r);for(var s=0;s<e.props.length;++s){var f=e.props[s];if(f.getVisibility()&&f.getUseBounds()){var o=f.getBounds();o&&Os(o)&&(i=!1,o[0]<e.allBounds[0]&&(e.allBounds[0]=o[0]),o[1]>e.allBounds[1]&&(e.allBounds[1]=o[1]),o[2]<e.allBounds[2]&&(e.allBounds[2]=o[2]),o[3]>e.allBounds[3]&&(e.allBounds[3]=o[3]),o[4]<e.allBounds[4]&&(e.allBounds[4]=o[4]),o[5]>e.allBounds[5]&&(e.allBounds[5]=o[5]))}}return i&&(Ui(e.allBounds),$n("Can't compute bounds, no 3D props are visible")),e.allBounds},t.resetCamera=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=i||t.computeVisiblePropBounds(),f=[0,0,0];if(!Os(s))return $n("Cannot reset camera!"),!1;var o=null;if(t.getActiveCamera())o=e.activeCamera.getViewPlaneNormal();else return Tr("Trying to reset non-existent camera"),!1;e.activeCamera.setViewAngle(30),f[0]=(s[0]+s[1])/2,f[1]=(s[2]+s[3])/2,f[2]=(s[4]+s[5])/2;var u=s[1]-s[0],g=s[3]-s[2],c=s[5]-s[4];u*=u,g*=g,c*=c;var l=u+g+c;l=l===0?1:l,l=Math.sqrt(l)*.5;var h=Ke(e.activeCamera.getViewAngle()),y=l,C=l/Math.sin(h*.5),T=e.activeCamera.getViewUp();return Math.abs(xe(T,o))>.999&&(cR("Resetting view-up since view plane normal is parallel"),e.activeCamera.setViewUp(-T[2],T[0],T[1])),e.activeCamera.setFocalPoint(f[0],f[1],f[2]),e.activeCamera.setPosition(f[0]+C*o[0],f[1]+C*o[1],f[2]+C*o[2]),t.resetCameraClippingRange(s),e.activeCamera.setParallelScale(y),e.activeCamera.setPhysicalScale(l),e.activeCamera.setPhysicalTranslation(-f[0],-f[1],-f[2]),t.invokeEvent(a),!0},t.resetCameraClippingRange=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=i||t.computeVisiblePropBounds();if(!Os(s))return $n("Cannot reset camera clipping range!"),!1;if(t.getActiveCameraAndResetIfCreated(),!e.activeCamera)return Tr("Trying to reset clipping range of non-existent camera"),!1;var f=e.activeCamera.computeClippingRange(s),o=0;if(e.activeCamera.getParallelProjection())o=.2*e.activeCamera.getParallelScale();else{var u=Ke(e.activeCamera.getViewAngle());o=.2*Math.tan(u/2)*f[1]}return f[1]-f[0]<o&&(o=o-f[1]+f[0],f[1]+=o/2,f[0]-=o/2),f[0]<0&&(f[0]=0),f[0]=.99*f[0]-(f[1]-f[0])*e.clippingRangeExpansion,f[1]=1.01*f[1]+(f[1]-f[0])*e.clippingRangeExpansion,f[0]=f[0]>=f[1]?.01*f[1]:f[0],e.nearClippingPlaneTolerance||(e.nearClippingPlaneTolerance=.01),f[0]<e.nearClippingPlaneTolerance*f[1]&&(f[0]=e.nearClippingPlaneTolerance*f[1]),e.activeCamera.setClippingRange(f[0],f[1]),t.invokeEvent(n),!1},t.setRenderWindow=function(i){i!==e._renderWindow&&(e._vtkWindow=i,e._renderWindow=i)},t.visibleActorCount=function(){return e.props.filter(function(i){return i.getVisibility()}).length},t.visibleVolumeCount=t.visibleActorCount,t.getMTime=function(){var i=e.mtime,s=e.activeCamera?e.activeCamera.getMTime():0;s>i&&(i=s);var f=e._createdLight?e._createdLight.getMTime():0;return f>i&&(i=f),i},t.getTransparent=function(){return!!e.preserveColorBuffer},t.isActiveCameraCreated=function(){return!!e.activeCamera}}var vR={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:Dv(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function o0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};for(Object.assign(e,vR,r),uR.extend(t,e,r),e.background||(e.background=[0,0,0,1]);e.background.length<3;)e.background.push(0);e.background.length===3&&e.background.push(1),Ft(t,e,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),gt(t,e,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),Ca(t,e,["actors","volumes","lights"]),tv(t,e,["background"],4,1),Ao(t,e,["renderWindow"]),gR(t,e)}var lR=Ue(o0,"vtkRenderer"),pR={newInstance:lR,extend:o0},Lo={Unknown:0,LeftController:1,RightController:2},Jn={Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},hR={Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4},gf={Device:Lo,Input:Jn,Axis:hR};function rg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function Ne(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rg(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var si=gf.Device,jr=gf.Input,oi=L.vtkWarningMacro,fi=L.vtkErrorMacro,yR=L.normalizeWheel,dR=L.vtkOnceErrorMacro,pn=new MouseEvent(""),js={"xr-standard":[jr.Trigger,jr.Grip,jr.TrackPad,jr.Thumbstick,jr.A,jr.B]},vf=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function Hn(t){t.cancelable&&t.preventDefault()}function ui(t){var e=Object.create(null);return t.forEach(function(r){var n=r.pointerId,a=r.position;e[n]=a}),e}function TR(t,e){e.classHierarchy.push("vtkRenderWindowInteractor");var r=new Set,n=new Map;t.start=function(){!e.initialized&&(t.initialize(),!e.initialized)||t.startEventLoop()},t.setRenderWindow=function(c){fi("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},t.setInteractorStyle=function(c){e.interactorStyle!==c&&(e.interactorStyle!=null&&e.interactorStyle.setInteractor(null),e.interactorStyle=c,e.interactorStyle!=null&&e.interactorStyle.getInteractor()!==t&&e.interactorStyle.setInteractor(t))},t.initialize=function(){e.initialized=!0,t.enable(),t.render()},t.enable=function(){return t.setEnabled(!0)},t.disable=function(){return t.setEnabled(!1)},t.startEventLoop=function(){return oi("empty event loop")};function a(c,l){e._forcedRenderer||(e.currentRenderer=t.findPokedRenderer(c,l))}t.getCurrentRenderer=function(){return e.currentRenderer||a(0,0),e.currentRenderer};function i(c){var l=e._view.getCanvas(),h=l.getBoundingClientRect(),y=l.width/h.width,C=l.height/h.height,T={x:y*(c.clientX-h.left),y:C*(h.height-c.clientY+h.top),z:0};return(n.size<=1||!e.currentRenderer)&&a(T.x,T.y),T}function s(c){return{controlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey}}function f(c){var l=s(c),h=Ne({key:c.key,keyCode:c.charCode},l);return h}function o(c){return c.pointerType||""}t.bindEvents=function(c){e.container=c,c.addEventListener("contextmenu",Hn),c.addEventListener("wheel",t.handleWheel),c.addEventListener("DOMMouseScroll",t.handleWheel),c.addEventListener("pointerenter",t.handlePointerEnter),c.addEventListener("pointerleave",t.handlePointerLeave),c.addEventListener("pointermove",t.handlePointerMove,{passive:!1}),c.addEventListener("pointerdown",t.handlePointerDown,{passive:!1}),c.addEventListener("pointerup",t.handlePointerUp),c.addEventListener("pointercancel",t.handlePointerCancel),document.addEventListener("keypress",t.handleKeyPress),document.addEventListener("keydown",t.handleKeyDown),document.addEventListener("keyup",t.handleKeyUp),document.addEventListener("pointerlockchange",t.handlePointerLockChange),c.style.touchAction="none",c.style.userSelect="none",c.style.webkitTapHighlightColor="rgba(0,0,0,0)"},t.unbindEvents=function(){var c=e.container;c.removeEventListener("contextmenu",Hn),c.removeEventListener("wheel",t.handleWheel),c.removeEventListener("DOMMouseScroll",t.handleWheel),c.removeEventListener("pointerenter",t.handlePointerEnter),c.removeEventListener("pointerleave",t.handlePointerLeave),c.removeEventListener("pointermove",t.handlePointerMove,{passive:!1}),c.removeEventListener("pointerdown",t.handlePointerDown,{passive:!1}),c.removeEventListener("pointerup",t.handlePointerUp),c.removeEventListener("pointercancel",t.handlePointerCancel),document.removeEventListener("keypress",t.handleKeyPress),document.removeEventListener("keydown",t.handleKeyDown),document.removeEventListener("keyup",t.handleKeyUp),document.removeEventListener("pointerlockchange",t.handlePointerLockChange),e.container=null,n.clear()},t.handleKeyPress=function(c){var l=f(c);t.keyPressEvent(l)},t.handleKeyDown=function(c){var l=f(c);t.keyDownEvent(l)},t.handleKeyUp=function(c){var l=f(c);t.keyUpEvent(l)},t.handlePointerEnter=function(c){var l=Ne(Ne({},s(c)),{},{position:i(c),deviceType:o(c)});t.pointerEnterEvent(l),l.deviceType==="mouse"&&t.mouseEnterEvent(l)},t.handlePointerLeave=function(c){var l=Ne(Ne({},s(c)),{},{position:i(c),deviceType:o(c)});t.pointerLeaveEvent(l),l.deviceType==="mouse"&&t.mouseLeaveEvent(l)},t.handlePointerDown=function(c){if(!(c.button>2||t.isPointerLocked()))switch(e.preventDefaultOnPointerDown&&Hn(c),c.target.hasPointerCapture(c.pointerId)&&c.target.releasePointerCapture(c.pointerId),e.container.setPointerCapture(c.pointerId),n.has(c.pointerId)&&oi("[RenderWindowInteractor] duplicate pointerId detected"),n.set(c.pointerId,{pointerId:c.pointerId,position:i(c)}),c.pointerType){case"pen":case"touch":t.handleTouchStart(c);break;case"mouse":default:t.handleMouseDown(c);break}},t.handlePointerUp=function(c){if(n.has(c.pointerId))switch(e.preventDefaultOnPointerUp&&Hn(c),n.delete(c.pointerId),e.container.releasePointerCapture(c.pointerId),c.pointerType){case"pen":case"touch":t.handleTouchEnd(c);break;case"mouse":default:t.handleMouseUp(c);break}},t.handlePointerCancel=function(c){if(n.has(c.pointerId))switch(n.delete(c.pointerId),c.pointerType){case"pen":case"touch":t.handleTouchEnd(c);break;case"mouse":default:t.handleMouseUp(c);break}},t.handlePointerMove=function(c){if(n.has(c.pointerId)){var l=n.get(c.pointerId);l.position=i(c)}switch(c.pointerType){case"pen":case"touch":t.handleTouchMove(c);break;case"mouse":default:t.handleMouseMove(c);break}},t.handleMouseDown=function(c){var l=Ne(Ne({},s(c)),{},{position:i(c),deviceType:o(c)});switch(c.button){case 0:t.leftButtonPressEvent(l);break;case 1:t.middleButtonPressEvent(l);break;case 2:t.rightButtonPressEvent(l);break;default:fi("Unknown mouse button pressed: ".concat(c.button));break}},t.requestPointerLock=function(){e.container&&e.container.requestPointerLock()},t.exitPointerLock=function(){return document.exitPointerLock()},t.isPointerLocked=function(){return!!e.container&&document.pointerLockElement===e.container},t.handlePointerLockChange=function(){t.isPointerLocked()?t.startPointerLockEvent():t.endPointerLockEvent()};function u(){e._view&&e.enabled&&e.enableRender&&(e.inRender=!0,e._view.traverseAllPasses(),e.inRender=!1),t.invokeRenderEvent()}t.requestAnimation=function(c){if(c===void 0){fi("undefined requester, can not start animating");return}if(r.has(c)){oi("requester is already registered for animating");return}r.add(c),!e.animationRequest&&r.size===1&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.extendAnimation=function(c){var l=Date.now()+c;e._animationExtendedEnd=Math.max(e._animationExtendedEnd,l),!e.animationRequest&&r.size===0&&!e.xrAnimation&&(e._animationStartTime=Date.now(),e._animationFrameCount=0,e.animationRequest=requestAnimationFrame(t.handleAnimation),t.startAnimationEvent())},t.isAnimating=function(){return e.xrAnimation||e.animationRequest!==null},t.cancelAnimation=function(c){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r.has(c)){if(!l){var h=c&&c.getClassName?c.getClassName():c;oi("".concat(h," did not request an animation"))}return}r.delete(c),e.animationRequest&&r.size===0&&Date.now()>e._animationExtendedEnd&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.switchToXRAnimation=function(){e.animationRequest&&(cancelAnimationFrame(e.animationRequest),e.animationRequest=null),e.xrAnimation=!0},t.returnFromXRAnimation=function(){e.xrAnimation=!1,r.size!==0&&(e.recentAnimationFrameRate=10,e.animationRequest=requestAnimationFrame(t.handleAnimation))},t.updateXRGamepads=function(c,l,h){c.inputSources.forEach(function(y){var C=y.gripSpace==null?null:l.getPose(y.gripSpace,h),T=y.gamepad,E=y.handedness;if(T){T.index in e.lastGamepadValues||(e.lastGamepadValues[T.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(var w=0;w<T.buttons.length;++w)w in e.lastGamepadValues[T.index][E].buttons||(e.lastGamepadValues[T.index][E].buttons[w]=!1),e.lastGamepadValues[T.index][E].buttons[w]!==T.buttons[w].pressed&&C!=null&&(t.button3DEvent({gamepad:T,position:C.transform.position,orientation:C.transform.orientation,pressed:T.buttons[w].pressed,device:y.handedness==="left"?si.LeftController:si.RightController,input:js[T.mapping]&&js[T.mapping][w]?js[T.mapping][w]:jr.Trigger}),e.lastGamepadValues[T.index][E].buttons[w]=T.buttons[w].pressed),e.lastGamepadValues[T.index][E].buttons[w]&&C!=null&&t.move3DEvent({gamepad:T,position:C.transform.position,orientation:C.transform.orientation,device:y.handedness==="left"?si.LeftController:si.RightController})}})},t.handleMouseMove=function(c){var l=Ne(Ne({},s(c)),{},{position:i(c),deviceType:o(c)});e.moveTimeoutID===0?t.startMouseMoveEvent(l):(t.mouseMoveEvent(l),clearTimeout(e.moveTimeoutID)),e.moveTimeoutID=setTimeout(function(){t.endMouseMoveEvent(),e.moveTimeoutID=0},200)},t.handleAnimation=function(){var c=Date.now();e._animationFrameCount++,c-e._animationStartTime>1e3&&e._animationFrameCount>1&&(e.recentAnimationFrameRate=1e3*(e._animationFrameCount-1)/(c-e._animationStartTime),e.lastFrameTime=1/e.recentAnimationFrameRate,t.animationFrameRateUpdateEvent(),e._animationStartTime=c,e._animationFrameCount=1),t.animationEvent(),u(),r.size>0||Date.now()<e._animationExtendedEnd?e.animationRequest=requestAnimationFrame(t.handleAnimation):(cancelAnimationFrame(e.animationRequest),e.animationRequest=null,t.endAnimationEvent(),t.render())},t.handleWheel=function(c){Hn(c);var l=Ne(Ne(Ne({},yR(c)),s(c)),{},{position:i(c),deviceType:o(c)});e.wheelTimeoutID===0?t.startMouseWheelEvent(l):(t.mouseWheelEvent(l),clearTimeout(e.wheelTimeoutID)),e.wheelTimeoutID=setTimeout(function(){t.extendAnimation(600),t.endMouseWheelEvent(),e.wheelTimeoutID=0},200)},t.handleMouseUp=function(c){var l=Ne(Ne({},s(c)),{},{position:i(c),deviceType:o(c)});switch(c.button){case 0:t.leftButtonReleaseEvent(l);break;case 1:t.middleButtonReleaseEvent(l);break;case 2:t.rightButtonReleaseEvent(l);break;default:fi("Unknown mouse button released: ".concat(c.button));break}},t.handleTouchStart=function(c){var l=Ee(n.values());if(e.recognizeGestures&&l.length>1){var h=ui(n);if(l.length===2){var y=Ne(Ne({},s(pn)),{},{position:l[0].position,deviceType:o(c)});t.leftButtonReleaseEvent(y)}t.recognizeGesture("TouchStart",h)}else if(l.length===1){var C=Ne(Ne({},s(pn)),{},{position:i(c),deviceType:o(c)});t.leftButtonPressEvent(C)}},t.handleTouchMove=function(c){var l=Ee(n.values());if(e.recognizeGestures&&l.length>1){var h=ui(n);t.recognizeGesture("TouchMove",h)}else if(l.length===1){var y=Ne(Ne({},s(pn)),{},{position:l[0].position,deviceType:o(c)});t.mouseMoveEvent(y)}},t.handleTouchEnd=function(c){var l=Ee(n.values());if(e.recognizeGestures)if(l.length===0){var h=Ne(Ne({},s(pn)),{},{position:i(c),deviceType:o(c)});t.leftButtonReleaseEvent(h)}else if(l.length===1){var y=ui(n);t.recognizeGesture("TouchEnd",y);var C=Ne(Ne({},s(pn)),{},{position:l[0].position,deviceType:o(c)});t.leftButtonPressEvent(C)}else{var T=ui(n);t.recognizeGesture("TouchMove",T)}else if(l.length===1){var E=Ne(Ne({},s(pn)),{},{position:l[0].position,deviceType:o(c)});t.leftButtonReleaseEvent(E)}},t.setView=function(c){e._view!==c&&(e._view=c,e._view.getRenderable().setInteractor(t),t.modified())},t.getFirstRenderer=function(){var c,l,h;return(c=e._view)===null||c===void 0||(l=c.getRenderable())===null||l===void 0||(h=l.getRenderersByReference())===null||h===void 0?void 0:h[0]},t.findPokedRenderer=function(){var c,l,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!e._view)return null;var C=(c=e._view)===null||c===void 0||(l=c.getRenderable())===null||l===void 0?void 0:l.getRenderers();if(!C)return null;C.sort(function(m,D){return m.getLayer()-D.getLayer()});for(var T=null,E=null,w=null,x=C.length;x--;){var S=C[x];if(e._view.isInViewport(h,y,S)&&S.getInteractive()){w=S;break}T===null&&S.getInteractive()&&(T=S),E===null&&e._view.isInViewport(h,y,S)&&(E=S)}return w===null&&(w=T),w===null&&(w=E),w==null&&(w=C[0]),w},t.render=function(){!t.isAnimating()&&!e.inRender&&u()},vf.forEach(function(c){var l=c.charAt(0).toLowerCase()+c.slice(1);t["".concat(l,"Event")]=function(h){if(!!e.enabled){var y=t.getCurrentRenderer();if(!y){dR(`
          Can not forward events without a current renderer on the interactor.
        `);return}var C=Ne({type:c,pokedRenderer:e.currentRenderer,firstRenderer:t.getFirstRenderer()},h);t["invoke".concat(c)](C)}}}),t.recognizeGesture=function(c,l){if(!(Object.keys(l).length>2)){if(e.startingEventPositions||(e.startingEventPositions={}),c==="TouchStart"){Object.keys(l).forEach(function(I){e.startingEventPositions[I]=l[I]}),e.currentGesture="Start";return}if(c==="TouchEnd"){e.currentGesture==="Pinch"&&(t.render(),t.endPinchEvent()),e.currentGesture==="Rotate"&&(t.render(),t.endRotateEvent()),e.currentGesture==="Pan"&&(t.render(),t.endPanEvent()),e.currentGesture="Start",e.startingEventPositions={};return}var h=0,y=[],C=[];Object.keys(l).forEach(function(I){y[h]=l[I],C[h]=e.startingEventPositions[I],h++});var T=Math.sqrt((C[0].x-C[1].x)*(C[0].x-C[1].x)+(C[0].y-C[1].y)*(C[0].y-C[1].y)),E=Math.sqrt((y[0].x-y[1].x)*(y[0].x-y[1].x)+(y[0].y-y[1].y)*(y[0].y-y[1].y)),w=la(Math.atan2(C[1].y-C[0].y,C[1].x-C[0].x)),x=la(Math.atan2(y[1].y-y[0].y,y[1].x-y[0].x)),S=x-w;x=x+180>=360?x-180:x+180,w=w+180>=360?w-180:w+180,Math.abs(x-w)<Math.abs(S)&&(S=x-w);var m=[];if(m[0]=(y[0].x-C[0].x+y[1].x-C[1].x)/2,m[1]=(y[0].y-C[0].y+y[1].y-C[1].y)/2,c==="TouchMove")if(e.currentGesture==="Start"){var D=.01*Math.sqrt(e.container.clientWidth*e.container.clientWidth+e.container.clientHeight*e.container.clientHeight);D<15&&(D=15);var b=Math.abs(E-T),N=E*3.1415926*Math.abs(S)/360,P=Math.sqrt(m[0]*m[0]+m[1]*m[1]);if(b>D&&b>N&&b>P){e.currentGesture="Pinch";var O={scale:1,touches:l};t.startPinchEvent(O)}else if(N>D&&N>P){e.currentGesture="Rotate";var A={rotation:0,touches:l};t.startRotateEvent(A)}else if(P>D){e.currentGesture="Pan";var z={translation:[0,0],touches:l};t.startPanEvent(z)}}else{if(e.currentGesture==="Rotate"){var j={rotation:S,touches:l};t.rotateEvent(j)}if(e.currentGesture==="Pinch"){var B={scale:E/T,touches:l};t.pinchEvent(B)}if(e.currentGesture==="Pan"){var Y={translation:m,touches:l};t.panEvent(Y)}}}},t.handleVisibilityChange=function(){e._animationStartTime=Date.now(),e._animationFrameCount=0},t.setCurrentRenderer=function(c){e._forcedRenderer=!!c,e.currentRenderer=c};var g=t.delete;t.delete=function(){for(;r.size;)t.cancelAnimation(r.values().next().value);typeof document.hidden<"u"&&document.removeEventListener("visibilitychange",t.handleVisibilityChange),g()},typeof document.hidden<"u"&&document.addEventListener("visibilitychange",t.handleVisibilityChange,!1)}var CR={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1};function f0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,CR,r),L.obj(t,e),e._animationExtendedEnd=0,L.event(t,e,"RenderEvent"),vf.forEach(function(n){return L.event(t,e,n)}),L.get(t,e,["initialized","container","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),L.setGet(t,e,["lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp"]),L.moveToProtected(t,e,["view"]),TR(t,e)}var SR=L.newInstance(f0,"vtkRenderWindowInteractor"),u0=Ne({newInstance:SR,extend:f0,handledEvents:vf},gf);function ng(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function c0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ng(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ng(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ER=L.vtkErrorMacro,xR=L.VOID;function wR(t,e,r,n){var a=t.getRenderWindow().getViews()[0];return a.worldToDisplay(e,r,n,t)}function OR(t,e,r,n){var a=t.getRenderWindow().getViews()[0];return a.displayToWorld(e,r,n,t)}var MR={computeWorldToDisplay:wR,computeDisplayToWorld:OR};function DR(t,e){e.classHierarchy.push("vtkInteractorObserver");var r=c0({},t);function n(){for(;e.subscribedEvents.length;)e.subscribedEvents.pop().unsubscribe()}function a(){u0.handledEvents.forEach(function(i){t["handle".concat(i)]&&e.subscribedEvents.push(e._interactor["on".concat(i)](function(s){return e.processEvents?t["handle".concat(i)](s):xR},e.priority))})}t.setInteractor=function(i){i!==e._interactor&&(n(),e._interactor=i,i&&e.enabled&&a(),t.modified())},t.setEnabled=function(i){i!==e.enabled&&(n(),i&&(e._interactor?a():ER(`
          The interactor must be set before subscribing to events
        `)),e.enabled=i,t.modified())},t.computeDisplayToWorld=function(i,s,f,o){return i?e._interactor.getView().displayToWorld(s,f,o,i):null},t.computeWorldToDisplay=function(i,s,f,o){return i?e._interactor.getView().worldToDisplay(s,f,o,i):null},t.setPriority=function(i){var s=r.setPriority(i);s&&e._interactor&&(n(),a())}}var mR={enabled:!0,priority:0,processEvents:!0,subscribedEvents:[]};function g0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,mR,r),L.obj(t,e),L.event(t,e,"InteractionEvent"),L.event(t,e,"StartInteractionEvent"),L.event(t,e,"EndInteractionEvent"),L.get(t,e,["_interactor","enabled"]),L.setGet(t,e,["priority","processEvents"]),L.moveToProtected(t,e,["interactor"]),DR(t,e)}var RR=L.newInstance(g0,"vtkInteractorObserver"),LR=c0({newInstance:RR,extend:g0},MR),VR={IS_START:0,IS_NONE:0,IS_ROTATE:1,IS_PAN:2,IS_SPIN:3,IS_DOLLY:4,IS_CAMERA_POSE:11,IS_WINDOW_LEVEL:1024,IS_SLICE:1025},lf={States:VR};function ag(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function _R(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ag(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ag(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var It=lf.States,$s={Rotate:It.IS_ROTATE,Pan:It.IS_PAN,Spin:It.IS_SPIN,Dolly:It.IS_DOLLY,CameraPose:It.IS_CAMERA_POSE,WindowLevel:It.IS_WINDOW_LEVEL,Slice:It.IS_SLICE};function bR(t,e){e.classHierarchy.push("vtkInteractorStyle"),Object.keys($s).forEach(function(r){L.event(t,e,"Start".concat(r,"Event")),t["start".concat(r)]=function(){e.state===It.IS_NONE&&(e.state=$s[r],e._interactor.requestAnimation(t),t.invokeStartInteractionEvent({type:"StartInteractionEvent"}),t["invokeStart".concat(r,"Event")]({type:"Start".concat(r,"Event")}))},L.event(t,e,"End".concat(r,"Event")),t["end".concat(r)]=function(){e.state===$s[r]&&(e.state=It.IS_NONE,e._interactor.cancelAnimation(t),t.invokeEndInteractionEvent({type:"EndInteractionEvent"}),t["invokeEnd".concat(r,"Event")]({type:"End".concat(r,"Event")}),e._interactor.render())}}),t.handleKeyPress=function(r){var n=e._interactor,a=null;switch(r.key){case"r":case"R":r.pokedRenderer.resetCamera(),n.render();break;case"w":case"W":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToWireframe&&s.setRepresentationToWireframe()}),n.render();break;case"s":case"S":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToSurface&&s.setRepresentationToSurface()}),n.render();break;case"v":case"V":a=r.pokedRenderer.getActors(),a.forEach(function(i){var s=i.getProperty();s.setRepresentationToPoints&&s.setRepresentationToPoints()}),n.render();break}}}var kR={state:It.IS_NONE,handleObservers:1,autoAdjustCameraClippingRange:1};function v0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,kR,r),LR.extend(t,e,r),bR(t,e)}var FR=L.newInstance(v0,"vtkInteractorStyle"),BR=_R({newInstance:FR,extend:v0},lf),Kt=lf.States;function NR(t,e){e.classHierarchy.push("vtkInteractorStyleTrackballCamera"),t.handleMouseMove=function(r){var n=r.position,a=r.pokedRenderer;switch(e.state){case Kt.IS_ROTATE:t.handleMouseRotate(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_PAN:t.handleMousePan(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_DOLLY:t.handleMouseDolly(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break;case Kt.IS_SPIN:t.handleMouseSpin(a,n),t.invokeInteractionEvent({type:"InteractionEvent"});break}e.previousPosition=n},t.handleButton3D=function(r){if(r&&r.pressed&&r.device===Lo.RightController&&(r.input===Jn.Trigger||r.input===Jn.TrackPad)){t.startCameraPose();return}r&&!r.pressed&&r.device===Lo.RightController&&(r.input===Jn.Trigger||r.input===Jn.TrackPad)&&e.state===Kt.IS_CAMERA_POSE&&t.endCameraPose()},t.handleMove3D=function(r){switch(e.state){case Kt.IS_CAMERA_POSE:t.updateCameraPose(r);break}},t.updateCameraPose=function(r){var n=r.pokedRenderer.getActiveCamera(),a=n.getPhysicalTranslation(),i=.5,s=i*.05*n.getPhysicalScale(),f=n.physicalOrientationToWorldDirection([r.orientation.x,r.orientation.y,r.orientation.z,r.orientation.w]);n.setPhysicalTranslation(a[0]+f[0]*s,a[1]+f[1]*s,a[2]+f[2]*s)},t.handleLeftButtonPress=function(r){var n=r.position;e.previousPosition=n,r.shiftKey?r.controlKey||r.altKey?t.startDolly():t.startPan():r.controlKey||r.altKey?t.startSpin():t.startRotate()},t.handleLeftButtonRelease=function(){switch(e.state){case Kt.IS_DOLLY:t.endDolly();break;case Kt.IS_PAN:t.endPan();break;case Kt.IS_SPIN:t.endSpin();break;case Kt.IS_ROTATE:t.endRotate();break}},t.handleStartMouseWheel=function(r){t.startDolly(),t.handleMouseWheel(r)},t.handleEndMouseWheel=function(){t.endDolly()},t.handleStartPinch=function(r){e.previousScale=r.scale,t.startDolly()},t.handleEndPinch=function(){t.endDolly()},t.handleStartRotate=function(r){e.previousRotation=r.rotation,t.startRotate()},t.handleEndRotate=function(){t.endRotate()},t.handleStartPan=function(r){e.previousTranslation=r.translation,t.startPan()},t.handleEndPan=function(){t.endPan()},t.handlePinch=function(r){t.dollyByFactor(r.pokedRenderer,r.scale/e.previousScale),e.previousScale=r.scale},t.handlePan=function(r){var n=r.pokedRenderer.getActiveCamera(),a=n.getFocalPoint();a=t.computeWorldToDisplay(r.pokedRenderer,a[0],a[1],a[2]);var i=a[2],s=r.translation,f=e.previousTranslation,o=t.computeDisplayToWorld(r.pokedRenderer,a[0]+s[0]-f[0],a[1]+s[1]-f[1],i),u=t.computeDisplayToWorld(r.pokedRenderer,a[0],a[1],i),g=[];g[0]=u[0]-o[0],g[1]=u[1]-o[1],g[2]=u[2]-o[2],a=n.getFocalPoint();var c=n.getPosition();n.setFocalPoint(g[0]+a[0],g[1]+a[1],g[2]+a[2]),n.setPosition(g[0]+c[0],g[1]+c[1],g[2]+c[2]),e._interactor.getLightFollowCamera()&&r.pokedRenderer.updateLightsGeometryToFollowCamera(),n.orthogonalizeViewUp(),e.previousTranslation=r.translation},t.handleRotate=function(r){var n=r.pokedRenderer.getActiveCamera();n.roll(r.rotation-e.previousRotation),n.orthogonalizeViewUp(),e.previousRotation=r.rotation},t.handleMouseRotate=function(r,n){if(!!e.previousPosition){var a=e._interactor,i=n.x-e.previousPosition.x,s=n.y-e.previousPosition.y,f=a.getView().getViewportSize(r),o=-.1,u=-.1;f[0]&&f[1]&&(o=-20/f[1],u=-20/f[0]);var g=i*u*e.motionFactor,c=s*o*e.motionFactor,l=r.getActiveCamera();!Number.isNaN(g)&&!Number.isNaN(c)&&(l.azimuth(g),l.elevation(c),l.orthogonalizeViewUp()),e.autoAdjustCameraClippingRange&&r.resetCameraClippingRange(),a.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}},t.handleMouseSpin=function(r,n){if(!!e.previousPosition){var a=e._interactor,i=r.getActiveCamera(),s=a.getView().getViewportCenter(r),f=la(Math.atan2(e.previousPosition.y-s[1],e.previousPosition.x-s[0])),o=la(Math.atan2(n.y-s[1],n.x-s[0]))-f;Number.isNaN(o)||(i.roll(o),i.orthogonalizeViewUp())}},t.handleMousePan=function(r,n){if(!!e.previousPosition){var a=r.getActiveCamera(),i=a.getFocalPoint();i=t.computeWorldToDisplay(r,i[0],i[1],i[2]);var s=i[2],f=t.computeDisplayToWorld(r,n.x,n.y,s),o=t.computeDisplayToWorld(r,e.previousPosition.x,e.previousPosition.y,s),u=[];u[0]=o[0]-f[0],u[1]=o[1]-f[1],u[2]=o[2]-f[2],i=a.getFocalPoint();var g=a.getPosition();a.setFocalPoint(u[0]+i[0],u[1]+i[1],u[2]+i[2]),a.setPosition(u[0]+g[0],u[1]+g[1],u[2]+g[2]),e._interactor.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}},t.handleMouseDolly=function(r,n){if(!!e.previousPosition){var a=n.y-e.previousPosition.y,i=e._interactor,s=i.getView().getViewportCenter(r),f=e.motionFactor*a/s[1];t.dollyByFactor(r,Math.pow(1.1,f))}},t.handleMouseWheel=function(r){var n=1-r.spinY/e.zoomFactor;t.dollyByFactor(r.pokedRenderer,n)},t.dollyByFactor=function(r,n){if(!Number.isNaN(n)){var a=r.getActiveCamera();a.getParallelProjection()?a.setParallelScale(a.getParallelScale()/n):(a.dolly(n),e.autoAdjustCameraClippingRange&&r.resetCameraClippingRange()),e._interactor.getLightFollowCamera()&&r.updateLightsGeometryToFollowCamera()}}}var UR={motionFactor:10,zoomFactor:10};function l0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UR,r),BR.extend(t,e,r),L.setGet(t,e,["motionFactor","zoomFactor"]),NR(t,e)}var GR=L.newInstance(l0,"vtkInteractorStyleTrackballCamera"),AR={newInstance:GR,extend:l0};function PR(t,e){var r=t.invokeResize;delete t.invokeResize,e.renderWindow=$D.newInstance(),e.renderer=pR.newInstance(),e.renderWindow.addRenderer(e.renderer),e.openGLRenderWindow=Im.newInstance(),e.renderWindow.addView(e.openGLRenderWindow),e.interactor=u0.newInstance(),e.interactor.setInteractorStyle(AR.newInstance()),e.interactor.setView(e.openGLRenderWindow),e.interactor.initialize(),t.setBackground=e.renderer.setBackground,t.setBackground.apply(t,Ee(e.background)),t.resize=function(){if(e.container){var n=e.container.getBoundingClientRect(),a=window.devicePixelRatio||1;e.openGLRenderWindow.setSize(Math.floor(n.width*a),Math.floor(n.height*a)),r(),e.renderWindow.render()}},t.setContainer=function(n){e.container&&e.interactor.unbindEvents(e.container),e.container=n,e.openGLRenderWindow.setContainer(e.container),e.container&&e.interactor.bindEvents(e.container)},t.delete=L.chain(t.setContainer,e.openGLRenderWindow.delete,t.delete),e.listenWindowResize&&window.addEventListener("resize",t.resize),t.resize()}var WR={background:[.32,.34,.43],listenWindowResize:!0,container:null};function p0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,WR,r),L.obj(t,e),L.get(t,e,["renderWindow","renderer","openGLRenderWindow","interactor","container"]),L.event(t,e,"resize"),PR(t,e)}var zR=L.newInstance(p0),jR={newInstance:zR,extend:p0};function $R(t,e){e.classHierarchy.push("vtkAbstractPicker"),t.initialize=function(){e.renderer=null,e.selectionPoint[0]=0,e.selectionPoint[1]=0,e.selectionPoint[2]=0,e.pickPosition[0]=0,e.pickPosition[1]=0,e.pickPosition[2]=0},t.initializePickList=function(){e.pickList=[]},t.addPickList=function(r){e.pickList.push(r)},t.deletePickList=function(r){var n=e.pickList.indexOf(r);n!==-1&&e.pickList.splice(n,1)}}var HR={renderer:null,selectionPoint:[0,0,0],pickPosition:[0,0,0],pickFromList:0,pickList:[]};function h0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,HR,r),L.obj(t,e),L.get(t,e,["renderer"]),L.getArray(t,e,["selectionPoint","pickPosition"]),L.setGet(t,e,["pickFromList","pickList"]),$R(t,e)}var KR=L.newInstance(h0,"vtkAbstractPicker"),XR={newInstance:KR,extend:h0};function ig(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function YR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ig(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ig(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var IR=L.vtkErrorMacro,sg=L.vtkWarningMacro;function qR(t,e){e.classHierarchy.push("vtkPicker");var r=YR({},t);function n(){r.initialize(),e.actors=[],e.pickedPositions=[],e.mapperPosition[0]=0,e.mapperPosition[1]=0,e.mapperPosition[2]=0,e.mapper=null,e.dataSet=null,e.globalTMin=Number.MAX_VALUE}t.intersectWithLine=function(a,i,s,f){if(!f)return Number.MAX_VALUE;for(var o=f.getCenter(),u=[],g=0;g<3;g++)u[g]=i[g]-a[g];var c=xe(u,u);if(c===0)return 2;var l=(u[0]*(o[0]-a[0])+u[1]*(o[1]-a[1])+u[2]*(o[2]-a[2]))/c;return l},t.pick=function(a,i){a.length!==3&&sg("vtkPicker::pick: selectionPt needs three components");var s=a[0],f=a[1],o=a[2],u=[],g=[],c=[],l=[],h=[],y=[],C=[],T,E,w=[],x=[],S=[],m=[],D,b,N=[],P=[],O=0,A=[],z=!1,j=new Float64Array(4),B=new Float64Array(4),Y=je.newInstance(),I=[],te=[],U=i.getRenderWindow().getViews()[0];if(n(),e.renderer=i,e.selectionPoint[0]=s,e.selectionPoint[1]=f,e.selectionPoint[2]=o,!i){IR("Picker::Pick Must specify renderer");return}var G=i.getActiveCamera();u=G.getPosition(),g=G.getFocalPoint();var K=U.getViewportSize(i),Z=K[0]/K[1];c=i.worldToNormalizedDisplay(g[0],g[1],g[2],Z),c=U.normalizedDisplayToDisplay(c[0],c[1],c[2]),o=c[2];var Q=U.displayToNormalizedDisplay(s,f,o);l=i.normalizedDisplayToWorld(Q[0],Q[1],Q[2],Z);for(var oe=0;oe<3;oe++)e.pickPosition[oe]=l[oe];for(var ce=0;ce<3;ce++)h[ce]=e.pickPosition[ce]-u[ce];for(var fe=0;fe<3;fe++)y[fe]=g[fe]-u[fe];Dn(y);var pe=xe(y,h);if(pe===0){sg("Picker::Pick Cannot process points");return}if(C=G.getClippingRange(),G.getParallelProjection()){T=C[0]-pe,E=C[1]-pe;for(var Re=0;Re<3;Re++)w[Re]=e.pickPosition[Re]+T*y[Re],x[Re]=e.pickPosition[Re]+E*y[Re]}else{T=C[0]/pe,E=C[1]/pe;for(var qe=0;qe<3;qe++)w[qe]=u[qe]+T*h[qe],x[qe]=u[qe]+E*h[qe]}w[3]=1,x[3]=1,S=i.getViewport(),i.getRenderWindow()&&(m=i.getRenderWindow().getViews()[0].getSize()),D=m[0]*S[0],b=m[1]*S[1];var He=U.displayToNormalizedDisplay(D,b,o);N=i.normalizedDisplayToWorld(He[0],He[1],He[2],Z),D=m[0]*S[2],b=m[1]*S[3];var ze=U.displayToNormalizedDisplay(D,b,o);P=i.normalizedDisplayToWorld(ze[0],ze[1],ze[2],Z);for(var tt=0;tt<3;tt++)O+=(P[tt]-N[tt])*(P[tt]-N[tt]);O=Math.sqrt(O)*e.tolerance,e.pickFromList?A=e.pickList:A=i.getActors();var Te=[];A.forEach(function(ne){var ue=ne.getMapper();if(z=ne.getNestedPickable()&&ne.getNestedVisibility(),ne.getProperty().getOpacity()<=0&&(z=!1),z){e.transformMatrix=ne.getMatrix().slice(0),We(e.transformMatrix,e.transformMatrix),wt(e.transformMatrix,e.transformMatrix);var Ce=[e.transformMatrix[0],e.transformMatrix[1],e.transformMatrix[2]],ge=[e.transformMatrix[4],e.transformMatrix[5],e.transformMatrix[6]],ie=[e.transformMatrix[8],e.transformMatrix[9],e.transformMatrix[10]];Te[0]=ra(Ce),Te[1]=ra(ge),Te[2]=ra(ie),dn(j,w,e.transformMatrix),dn(B,x,e.transformMatrix),j[0]/=j[3],j[1]/=j[3],j[2]/=j[3],B[0]/=B[3],B[1]/=B[3],B[2]/=B[3];for(var Se=0;Se<3;Se++)h[Se]=B[Se]-j[Se];if(ue?(Y.setBounds(ue.getBounds()),Y.inflate(O)):Y.reset(),Y.intersectBox(j,h,te,I)&&(I[0]=t.intersectWithLine(j,B,O*.333*(Te[0]+Te[1]+Te[2]),ue),I[0]<Number.MAX_VALUE)){var vt=[];vt[0]=(1-I[0])*w[0]+I[0]*x[0],vt[1]=(1-I[0])*w[1]+I[0]*x[1],vt[2]=(1-I[0])*w[2]+I[0]*x[2];for(var Et=-1,Dt=0;Dt<e.actors.length;Dt++)if(e.actors[Dt]===ne){Et=Dt;break}if(Et===-1)e.actors.push(ne),e.pickedPositions.push(vt);else{var $t=e.pickedPositions[Et],kn=Gt(w,$t),en=Gt(w,vt);en<kn&&(e.pickedPositions[Et]=vt)}}}return t.invokePickChange(e.pickedPositions),1})}}var ZR={tolerance:.025,mapperPosition:[0,0,0],mapper:null,dataSet:null,actors:[],pickedPositions:[],transformMatrix:null,globalTMin:Number.MAX_VALUE};function y0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,ZR,r),XR.extend(t,e,r),L.setGet(t,e,["tolerance"]),L.setGetArray(t,e,["mapperPosition"],3),L.get(t,e,["mapper","dataSet","actors","pickedPositions"]),L.event(t,e,"pickChange"),qR(t,e)}var QR=L.newInstance(y0,"vtkPicker"),JR={newInstance:QR,extend:y0},eL=L.vtkErrorMacro;function tL(t,e){e.classHierarchy.push("vtkPointPicker"),t.intersectWithLine=function(r,n,a,i){var s=Number.MAX_VALUE;if(i.isA("vtkImageMapper")){var f=i.intersectWithLineForPointPicking(r,n);f&&(s=f.t,e.pointIJK=f.ijk)}else i.isA("vtkMapper")&&(s=t.intersectActorWithLine(r,n,a,i));return s},t.intersectActorWithLine=function(r,n,a,i){var s=i.getInputData(),f=0,o=s.getPoints().getNumberOfPoints();if(o<=f)return 2;for(var u=[],g=0;g<3;g++)u[g]=n[g]-r[g];var c=xe(u,u);if(c===0)return eL("Cannot process points"),2;var l,h=-1,y=Number.MAX_VALUE,C=Number.MAX_VALUE,T=[],E=[],w=s.getPoints();if(e.useCells)for(var x=s.getPolys().getData(),S=x[0],m=s.getPolys().getNumberOfCells(),D=0;D<m;D++)for(var b=D*S+1,N=b+S,P=b;P<N;P++){var O=x[P];if(w.getPoint(O,E),l=(u[0]*(E[0]-r[0])+u[1]*(E[1]-r[1])+u[2]*(E[2]-r[2]))/c,l>=0&&l<=1&&l<=y+e.tolerance){for(var A=0,z=0;z<3;z++){T[z]=r[z]+l*u[z];var j=Math.abs(E[z]-T[z]);j>A&&(A=j)}A<=a&&A<C&&(h=f,C=A,y=l)}}else for(f=0;f<o;f++)if(w.getPoint(f,E),l=(u[0]*(E[0]-r[0])+u[1]*(E[1]-r[1])+u[2]*(E[2]-r[2]))/c,l>=0&&l<=1&&l<=y+e.tolerance){for(var B=0,Y=0;Y<3;Y++){T[Y]=r[Y]+l*u[Y];var I=Math.abs(E[Y]-T[Y]);I>B&&(B=I)}B<=a&&B<C&&(h=f,C=B,y=l)}return e.pointId=h,y}}var rL={pointId:-1,pointIJK:[],useCells:!1};function d0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,rL,r),JR.extend(t,e,r),L.getArray(t,e,["pointIJK"]),L.get(t,e,["pointId"]),L.setGet(t,e,["useCells"]),tL(t,e)}var nL=L.newInstance(d0,"vtkPointPicker"),og={newInstance:nL,extend:d0},pf={};function T0(t){return!!pf[t]}function aL(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return pf[t](e)}function C0(t,e){pf[t]=e}var S0={get:aL,has:T0,registerType:C0};function E0(){var t=new ArrayBuffer(4),e=new Uint8Array(t),r=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,r[0]===3569595041?"LittleEndian":r[0]===2712847316?"BigEndian":null}var iL=E0();function sL(t,e){if(!(e<2))for(var r=new Int8Array(t),n=r.length,a=[],i=0;i<n;i+=e){for(var s=0;s<e;s++)a.push(r[i+s]);for(var f=0;f<e;f++)r[i+f]=a.pop()}}var Hs={ENDIANNESS:iL,getEndianness:E0,swapBytes:sL},x0=L.vtkErrorMacro,oL=L.vtkDebugMacro,hf=function(){return x0("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."))},Rn=0;function Ki(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new XMLHttpRequest;return n.open(t,e,!0),r.headers&&Object.entries(r.headers).forEach(function(a){var i=St(a,2),s=i[0],f=i[1];return n.setRequestHeader(s,f)}),r.progressCallback&&n.addEventListener("progress",r.progressCallback),n}function fL(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,n){var a=Ki("GET",t,e);a.onreadystatechange=function(i){a.readyState===4&&(a.status===200||a.status===0?r(a.response):n({xhr:a,e:i}))},a.responseType="arraybuffer",a.send()})}function uL(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return n&&n.compression?hf():r.ref&&!r.ref.pending?new Promise(function(a,i){var s=[e,r.ref.basepath,r.ref.id].join("/"),f=Ki("GET",s,n);f.onreadystatechange=function(o){f.readyState===1&&(r.ref.pending=!0,++Rn===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0)),f.readyState===4&&(r.ref.pending=!1,f.status===200||f.status===0?(r.buffer=f.response,r.ref.encode==="JSON"?r.values=JSON.parse(r.buffer):(Hs.ENDIANNESS!==r.ref.encode&&Hs.ENDIANNESS&&(oL("Swap bytes of ".concat(r.name)),Hs.swapBytes(r.buffer,fl[r.dataType])),r.values=L.newTypedArray(r.dataType,r.buffer)),r.values.length!==r.size&&x0("Error in FetchArray: ".concat(r.name,", does not have the proper array size. Got ").concat(r.values.length,", instead of ").concat(r.size)),delete r.ref,--Rn===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),t!=null&&t.modified&&t.modified(),a(r)):i({xhr:f,e:o}))},f.responseType=r.dataType!=="string"?"arraybuffer":"text",f.send()}):Promise.resolve(r)}function cL(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression?hf():new Promise(function(n,a){var i=Ki("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++Rn===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--Rn===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?n(JSON.parse(i.responseText)):a({xhr:i,e:s}))},i.responseType="text",i.send()})}function gL(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return r&&r.compression?hf():new Promise(function(n,a){var i=Ki("GET",e,r);i.onreadystatechange=function(s){i.readyState===1&&++Rn===1&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!0),i.readyState===4&&(--Rn===0&&t!==null&&t!==void 0&&t.invokeBusy&&t.invokeBusy(!1),i.status===200||i.status===0?n(i.responseText):a({xhr:i,e:s}))},i.responseType="text",i.send()})}function vL(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(function(n,a){var i=new Image;r.crossOrigin&&(i.crossOrigin=r.crossOrigin),i.onload=function(){return n(i)},i.onerror=a,i.src=e})}var lL={fetchArray:uL,fetchJSON:cL,fetchText:gL,fetchBinary:fL,fetchImage:vL};T0("http")||C0("http",function(t){return lL});function fg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function pL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fg(Object(r),!0).forEach(function(n){de(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fg(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var ye={};function Ks(t,e,r,n,a){for(var i=0;i<a;i++)r[n+i]=t[e+i]}function hL(t){ye.splitOn=t,ye.pieces=[],ye.v=[],ye.vt=[],ye.vn=[],ye.f=[[]],ye.size=0}function yL(t){var e=t.split("/").map(function(i){return Number(i)}),r=e[0]-1,n=e[1]?e[1]-1:r,a=e[2]?e[2]-1:r;return[r,n,a]}function dL(t){if(t[0]!=="#"){var e=t.split(/[ \t]+/);if(e[0]===ye.splitOn)e.shift(),ye.pieces.push(e.join(" ").trim()),ye.f.push([]),ye.size++;else if(e[0]==="v")ye.v.push(Number(e[1])),ye.v.push(Number(e[2])),ye.v.push(Number(e[3]));else if(e[0]==="vt")ye.vt.push(Number(e[1])),ye.vt.push(Number(e[2]));else if(e[0]==="vn")ye.vn.push(Number(e[1])),ye.vn.push(Number(e[2])),ye.vn.push(Number(e[3]));else if(e[0]==="f"){ye.size===0&&ye.size++;var r=ye.f[ye.size-1];e.shift();var n=e.filter(function(s){return s.length>0&&s!=="\r"}),a=n.length;r.push(a);for(var i=0;i<a;i++)r.push(yL(n[i]))}}}function TL(t){var e=!!ye.vt.length,r=!!ye.vn.length;if(t.splitMode){t.numberOfOutputs=ye.size;for(var n=0;n<ye.size;n++){var a=ye.f[n],i=a.length,s=ye.v.length/3,f={},o=void 0;if(t.trackDuplicates){for(var u=[],g=0,c=0;c<i;)for(var l=a[c++],h=0;h<l;h++){var y=St(a[c++],3),C=y[0],T=y[1],E=y[2],w="".concat(C,"/").concat(T,"/").concat(E);f[w]===void 0&&(u[C]===void 0?u[C]=[w]:(u[C].push(w),++g),f[w]=C)}o=new Uint16Array(s+g);for(var x=0,S=0;S<u.length;++S){var m=u[S]?u[S].length:0;o[S]=m>1?s+x:S;for(var D=1;D<m;++D){var b=s+x++;o[b]=S,f[u[S][D]]=b}}}for(var N={},P=fr.newInstance({name:ye.pieces[n]}),O=[],A=[],z=[],j=[],B=0;B<i;){var Y=a[B];j.push(Y);for(var I=0;I<Y;I++){var te=St(a[B+I+1],3),U=te[0],G=te[1],K=te[2],Z="".concat(U,"/").concat(G,"/").concat(K);if(N[Z]===void 0){var Q=t.trackDuplicates?f[Z]:O.length/3;N[Z]=Q,Ks(ye.v,U*3,O,Q*3,3),e&&Ks(ye.vt,G*2,A,Q*2,2),r&&Ks(ye.vn,K*3,z,Q*3,3)}j.push(N[Z])}B+=Y+1}if(P.getPoints().setData(Float32Array.from(O),3),t.trackDuplicates){var oe=_e.newInstance({name:"Duplicates",values:o});P.getPointData().addArray(oe)}if(P.getPolys().setData(Uint32Array.from(j)),e){var ce=_e.newInstance({numberOfComponents:2,values:Float32Array.from(A),name:"TextureCoordinates"});P.getPointData().setTCoords(ce)}if(r){var fe=_e.newInstance({numberOfComponents:3,values:Float32Array.from(z),name:"Normals"});P.getPointData().setNormals(fe)}t.output[n]=P}}else{t.numberOfOutputs=1;var pe=fr.newInstance();if(pe.getPoints().setData(Float32Array.from(ye.v),3),e&&ye.v.length/3===ye.vt.length/2){var Re=_e.newInstance({numberOfComponents:2,values:Float32Array.from(ye.vt),name:"TextureCoordinates"});pe.getPointData().setTCoords(Re)}if(r&&ye.v.length===ye.vn.length){var qe=_e.newInstance({numberOfComponents:3,values:Float32Array.from(ye.vn),name:"Normals"});pe.getPointData().setNormals(qe)}for(var He=[],ze=ye.f[0],tt=ze.length,Te=0;Te<tt;){var ne=ze[Te];He.push(ne);for(var ue=0;ue<ne;ue++){var Ce=St(ze[Te+ue+1],1),ge=Ce[0];He.push(ge)}Te+=ne+1}pe.getPolys().setData(Uint32Array.from(He)),t.output[0]=pe}}function CL(t,e){var r=[],n=t.getPointData().getArrayByName("Duplicates");if(n==null)return r;var a=n.getData(),i=Math.min(e,a[e]);r.push(i);var s=a[i];if(s!==i)for(;s<a.length&&a[s]===i;)r.push(s++);return r}var SL={getPointDuplicateIds:CL};function EL(t,e){e.classHierarchy.push("vtkOBJReader"),e.dataAccessHelper||(e.dataAccessHelper=S0.get("http"));function r(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.dataAccessHelper.fetchText(t,n,a)}t.setUrl=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n.indexOf(".obj")===-1&&!a.fullpath)e.baseURL=n,e.url="".concat(n,"/index.obj");else{e.url=n;var i=n.split("/");i.pop(),e.baseURL=i.join("/")}return t.loadData(a)},t.loadData=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r(e.url,n).then(t.parseAsText)},t.parseAsText=function(n){return n&&(n!==e.parseData&&t.modified(),e.parseData=n,e.numberOfOutputs=0,hL(e.splitMode),n.split(`
`).forEach(dL),TL(e)),!0},t.requestData=function(n,a){t.parseAsText(e.parseData)},t.isBusy=function(){return!!e.requestCount},t.getNumberOfOutputPorts=function(){return e.numberOfOutputs}}var xL={numberOfOutputs:1,requestCount:0,splitMode:null,trackDuplicates:!1};function w0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,xL,r),L.obj(t,e),L.get(t,e,["url","baseURL"]),L.setGet(t,e,["dataAccessHelper","splitMode","trackDuplicates"]),L.algo(t,e,0,1),L.event(t,e,"busy"),EL(t,e)}var wL=L.newInstance(w0,"vtkOBJReader"),OL=pL({newInstance:wL,extend:w0},SL);function O0(t){var e=new TextDecoder("latin1");return e.decode(t)}function ML(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=O0(t),a=e.exec(n);if(!a)return{text:n};var i=a.index+a[0].length,s=n.substring(0,i),f=null,o=r?r.exec(n):null;if(o){var u=n.substr(o.index);f={text:s+u,binaryBuffer:t.slice(i,o.index)}}else f={text:s,binaryBuffer:t.slice(i)};return f}var ug={arrayBufferToString:O0,extractBinary:ML},Xs={ASCII:"ascii",BINARY_BIG_ENDIAN:"binary_big_endian",BINARY_LITTLE_ENDIAN:"binary_little_endian"},cg={diffuse_red:"red",diffuse_green:"green",diffuse_blue:"blue"},M0={patternHeader:/ply([\s\S]*)end_header\r?\n/,patternBody:/end_header\s([\s\S]*)$/};function gg(t){var e="",r=0,n=M0.patternHeader.exec(t);n!==null&&(e=n[1],r=n[0].length);for(var a={comments:[],elements:[],headerLength:r},i=e.split(`
`),s,f,o,u=0;u<i.length;u++){var g=i[u];if(g=g.trim(),g!==""){var c=void 0;switch(o=g.split(/\s+/),f=o.shift(),g=o.join(" "),f){case"format":a.format=o[0],a.version=o[1];break;case"comment":a.comments.push(g);break;case"element":s!==void 0&&a.elements.push(s),s={},s.name=o[0],s.count=parseInt(o[1],10),s.properties=[];break;case"property":c={type:o[0]},c.type==="list"?(c.name=o[3],c.countType=o[1],c.itemType=o[2]):c.name=o[1],c.name in cg&&(c.name=cg[c.name]),s.properties.push(c);break;case"obj_info":a.objInfo=g;break;default:console.warn("unhandled",f,o);break}}}return s!==void 0&&a.elements.push(s),a}function vg(t,e){var r=e.find(function(z){return z.name==="vertex"}),n=e.find(function(z){return z.name==="face"}),a=0,i=0;r&&(a=r.count),n&&(i=n.count);for(var s=new Float32Array(a*3),f=new Uint8Array(a*3),o=new Float32Array(a*2),u=new Float32Array(a*3),g=t.colors.length>0,c=t.uvs.length>0,l=t.normals.length>0,h=t.faceVertexUvs.length>0,y=0;y<a;y++){var C=y*3+0,T=y*3+1,E=y*3+2;s[C]=t.vertices[C],s[T]=t.vertices[T],s[E]=t.vertices[E],g&&(f[C]=t.colors[C],f[T]=t.colors[T],f[E]=t.colors[E]),c&&(C=y*2+0,T=y*2+1,o[C]=t.uvs[C],o[T]=t.uvs[T]),l&&(u[C]=t.normals[C],u[T]=t.normals[T],u[E]=t.normals[E])}if(!c&&h)for(var w=0,x=0,S=0;S<i;++S){var m=t.indices[w++],D=t.faceVertexUvs[x++];if(D&&m*2===D.length)for(var b=0;b<m;++b){var N=t.indices[w++];o[N*2+0]=D[b*2+0],o[N*2+1]=D[b*2+1]}else w+=m}var P=fr.newInstance();if(P.getPoints().setData(s,3),g&&P.getPointData().setScalars(_e.newInstance({numberOfComponents:3,values:f,name:"Scalars"})),c||h){var O=_e.newInstance({numberOfComponents:2,values:o,name:"TextureCoordinates"}),A=P.getPointData();A.addArray(O),A.setActiveTCoords(O.getName())}return l&&P.getPointData().setNormals(_e.newInstance({numberOfComponents:3,name:"Normals",values:u})),P.getPolys().setData(Uint32Array.from(t.indices)),P}function Ys(t,e){var r;switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":r=parseInt(t,10);break;case"float":case"double":case"float32":case"float64":r=parseFloat(t);break;default:console.log("Unsupported type");break}return r}function DL(t,e){for(var r=e.split(/\s+/),n={},a=0;a<t.length;a++)if(t[a].type==="list"){for(var i=[],s=Ys(r.shift(),t[a].countType),f=0;f<s;f++)i.push(Ys(r.shift(),t[a].itemType));n[t[a].name]=i}else n[t[a].name]=Ys(r.shift(),t[a].type);return n}function lg(t,e,r){if(e==="vertex")t.vertices.push(r.x,r.y,r.z),"nx"in r&&"ny"in r&&"nz"in r&&t.normals.push(r.nx,r.ny,r.nz),"s"in r&&"t"in r?t.uvs.push(r.s,r.t):"u"in r&&"v"in r?t.uvs.push(r.u,r.v):"texture_u"in r&&"texture_v"in r&&t.uvs.push(r.texture_u,r.texture_v),"red"in r&&"green"in r&&"blue"in r&&t.colors.push(r.red,r.green,r.blue);else if(e==="face"){var n=r.vertex_indices||r.vertex_index,a=r.texcoord;n&&n.length>0&&(t.indices.push(n.length),n.forEach(function(i,s){t.indices.push(i)})),t.faceVertexUvs.push(a)}}function Is(t,e,r,n){var a;switch(r){case"int8":case"char":a=[t.getInt8(e),1];break;case"uint8":case"uchar":a=[t.getUint8(e),1];break;case"int16":case"short":a=[t.getInt16(e,n),2];break;case"uint16":case"ushort":a=[t.getUint16(e,n),2];break;case"int32":case"int":a=[t.getInt32(e,n),4];break;case"uint32":case"uint":a=[t.getUint32(e,n),4];break;case"float32":case"float":a=[t.getFloat32(e,n),4];break;case"float64":case"double":a=[t.getFloat64(e,n),8];break;default:console.log("Unsupported type");break}return a}function mL(t,e,r,n){for(var a={},i,s=0,f=0;f<r.length;f++)if(r[f].type==="list"){var o=[];i=Is(t,e+s,r[f].countType,n);var u=i[0];s+=i[1];for(var g=0;g<u;g++)i=Is(t,e+s,r[f].itemType,n),o.push(i[0]),s+=i[1];a[r[f].name]=o}else i=Is(t,e+s,r[f].type,n),a[r[f].name]=i[0],s+=i[1];return[a,s]}function RL(t,e){e.classHierarchy.push("vtkPLYReader"),e.dataAccessHelper||(e.dataAccessHelper=S0.get("http"));function r(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.compression,s=e.progressCallback;return a.binary?e.dataAccessHelper.fetchBinary(n,{compression:i,progressCallback:s}):e.dataAccessHelper.fetchText(t,n,{compression:i,progressCallback:s})}t.setUrl=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{binary:!0};e.url=n;var i=n.split("/");return i.pop(),e.baseURL=i.join("/"),e.compression=a.compression,t.loadData({progressCallback:a.progressCallback,binary:!!a.binary})},t.loadData=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=r(e.url,n);return a.then(t.parse),a},t.parse=function(n){typeof n=="string"?t.parseAsText(n):t.parseAsArrayBuffer(n)},t.parseAsArrayBuffer=function(n){if(!!n){if(n!==e.parseData)t.modified();else return;var a=ug.arrayBufferToString(n),i=gg(a),s=i.format!==Xs.ASCII;if(!s){t.parseAsText(n);return}e.parseData=n;for(var f={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},o=i.format===Xs.BINARY_LITTLE_ENDIAN,u=n instanceof ArrayBuffer?n:n.buffer,g=new DataView(u,i.headerLength),c,l=0,h=0;h<i.elements.length;h++)for(var y=0;y<i.elements[h].count;y++){c=mL(g,l,i.elements[h].properties,o),l+=c[1];var C=c[0];lg(f,i.elements[h].name,C)}var T=vg(f,i.elements);e.output[0]=T}},t.parseAsText=function(n){if(!!n){if(n!==e.parseData)t.modified();else return;e.parseData=n;var a=ug.arrayBufferToString(n),i=gg(a),s=i.format!==Xs.ASCII;if(s){t.parseAsArrayBuffer(n);return}var f={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},o=M0.patternBody.exec(a),u="";o!==null&&(u=o[1]);for(var g=u.split(`
`),c=0,l=0,h=0;h<g.length;h++){var y=g[h];if(y=y.trim(),y!==""){l>=i.elements[c].count&&(c++,l=0);var C=DL(i.elements[c].properties,y);lg(f,i.elements[c].name,C),l++}}var T=vg(f,i.elements);e.output[0]=T}},t.requestData=function(n,a){t.parse(e.parseData)}}var LL={};function D0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,LL,r),L.obj(t,e),L.get(t,e,["url","baseURL"]),L.setGet(t,e,["dataAccessHelper"]),L.algo(t,e,0,1),RL(t,e),e.compression||(e.compression=null),e.progressCallback||(e.progressCallback=null)}var VL=L.newInstance(D0,"vtkPLYReader"),_L={extend:D0,newInstance:VL};const pg=async t=>{const e=OL.newInstance();if(typeof t=="string")await e.setUrl(t);else{const n=await kL(t);e.parseAsText(n)}return e.update(),e.getOutputData()},bL=async t=>{const e=_L.newInstance();if(typeof t=="string")await e.setUrl(t);else{const n=await FL(t);e.parseAsArrayBuffer(n)}return e.update(),e.getOutputData()},kL=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=a=>{e(n.result)},n.readAsText(t)}),FL=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=a=>{e(n.result)},n.readAsArrayBuffer(t)}),BL=t=>{const e=Rr.newInstance();e.setInputData(t);const r=Dr.newInstance();return r.setMapper(e),r};function NL(t,e){e.classHierarchy.push("vtkSphereMapper")}var UL={scaleArray:null,radius:.05};function m0(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(e,UL,r),Rr.extend(t,e,r),L.setGet(t,e,["radius","scaleArray"]),NL(t,e)}var GL=L.newInstance(m0,"vtkSphereMapper"),AL={newInstance:GL,extend:m0},PL=(()=>{var t=import.meta.url;return function(r){r=r||{};var r=typeof r<"u"?r:{},n,a;r.ready=new Promise(function(v,p){n=v,a=p}),Object.getOwnPropertyDescriptor(r.ready,"_main")||(Object.defineProperty(r.ready,"_main",{configurable:!0,get:function(){be("You are getting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"_main",{configurable:!0,set:function(){be("You are setting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"___getTypeName")||(Object.defineProperty(r.ready,"___getTypeName",{configurable:!0,get:function(){be("You are getting ___getTypeName on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"___getTypeName",{configurable:!0,set:function(){be("You are setting ___getTypeName on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"___embind_register_native_and_builtin_types")||(Object.defineProperty(r.ready,"___embind_register_native_and_builtin_types",{configurable:!0,get:function(){be("You are getting ___embind_register_native_and_builtin_types on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"___embind_register_native_and_builtin_types",{configurable:!0,set:function(){be("You are setting ___embind_register_native_and_builtin_types on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"_fflush")||(Object.defineProperty(r.ready,"_fflush",{configurable:!0,get:function(){be("You are getting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"_fflush",{configurable:!0,set:function(){be("You are setting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})),Object.getOwnPropertyDescriptor(r.ready,"onRuntimeInitialized")||(Object.defineProperty(r.ready,"onRuntimeInitialized",{configurable:!0,get:function(){be("You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}),Object.defineProperty(r.ready,"onRuntimeInitialized",{configurable:!0,set:function(){be("You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}}));var i=Object.assign({},r),s="./this.program",f=typeof window=="object",o=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",g=!f&&!u&&!o;if(r.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");var c="";function l(v){return r.locateFile?r.locateFile(v,c):c+v}var h,y,C,T,E,w;if(u){if(!(typeof process=="object"&&typeof require=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");o?c=require("path").dirname(c)+"/":c=__dirname+"/",w=()=>{E||(T=require("fs"),E=require("path"))},h=function(p,d){return w(),p=E.normalize(p),T.readFileSync(p,d?void 0:"utf8")},C=v=>{var p=h(v,!0);return p.buffer||(p=new Uint8Array(p)),B(p.buffer),p},y=(v,p,d)=>{w(),v=E.normalize(v),T.readFile(v,function(M,V){M?d(M):p(V.buffer)})},process.argv.length>1&&(s=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(v){if(!(v instanceof xy))throw v}),process.on("unhandledRejection",function(v){throw v}),r.inspect=function(){return"[Emscripten Module object]"}}else if(g){if(typeof process=="object"&&typeof require=="function"||typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");typeof read<"u"&&(h=function(p){return read(p)}),C=function(p){let d;return typeof readbuffer=="function"?new Uint8Array(readbuffer(p)):(d=read(p,"binary"),B(typeof d=="object"),d)},y=function(p,d,M){setTimeout(()=>d(C(p)),0)},typeof scriptArgs<"u"&&scriptArgs,typeof print<"u"&&(typeof console>"u"&&(console={}),console.log=print,console.warn=console.error=typeof printErr<"u"?printErr:print)}else if(f||o){if(o?c=self.location.href:typeof document<"u"&&document.currentScript&&(c=document.currentScript.src),t&&(c=t),c.indexOf("blob:")!==0?c=c.substr(0,c.replace(/[?#].*/,"").lastIndexOf("/")+1):c="",!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");h=v=>{var p=new XMLHttpRequest;return p.open("GET",v,!1),p.send(null),p.responseText},o&&(C=v=>{var p=new XMLHttpRequest;return p.open("GET",v,!1),p.responseType="arraybuffer",p.send(null),new Uint8Array(p.response)}),y=(v,p,d)=>{var M=new XMLHttpRequest;M.open("GET",v,!0),M.responseType="arraybuffer",M.onload=()=>{if(M.status==200||M.status==0&&M.response){p(M.response);return}d()},M.onerror=d,M.send(null)}}else throw new Error("environment detection error");var x=r.print||console.log.bind(console),S=r.printErr||console.warn.bind(console);Object.assign(r,i),i=null,yy(),r.arguments&&r.arguments,D("arguments","arguments_"),r.thisProgram&&(s=r.thisProgram),D("thisProgram","thisProgram"),r.quit&&r.quit,D("quit","quit_"),B(typeof r.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),B(typeof r.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),B(typeof r.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),B(typeof r.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),B(typeof r.read>"u","Module.read option was removed (modify read_ in JS)"),B(typeof r.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),B(typeof r.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),B(typeof r.setWindowTitle>"u","Module.setWindowTitle option was removed (modify setWindowTitle in JS)"),B(typeof r.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),D("read","read_"),D("readAsync","readAsync"),D("readBinary","readBinary"),D("setWindowTitle","setWindowTitle"),B(!g,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable.");function m(v){m.shown||(m.shown={}),m.shown[v]||(m.shown[v]=1,S(v))}function D(v,p){Object.getOwnPropertyDescriptor(r,v)||Object.defineProperty(r,v,{configurable:!0,get:function(){be("Module."+v+" has been replaced with plain "+p+" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}})}function b(v){Object.getOwnPropertyDescriptor(r,v)&&be("`Module."+v+"` was supplied but `"+v+"` not included in INCOMING_MODULE_JS_API")}function N(v,p){var d="'"+v+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the FAQ)";return p&&(d+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),d}function P(v,p){Object.getOwnPropertyDescriptor(r,v)||Object.defineProperty(r,v,{configurable:!0,get:function(){be(N(v,p))}})}function O(v,p){Object.getOwnPropertyDescriptor(r,v)||(r[v]=()=>be(N(v,p)))}var A;r.wasmBinary&&(A=r.wasmBinary),D("wasmBinary","wasmBinary"),r.noExitRuntime,D("noExitRuntime","noExitRuntime"),typeof WebAssembly!="object"&&be("no native wasm support detected");var z,j=!1;function B(v,p){v||be("Assertion failed"+(p?": "+p:""))}function Y(v){var p=r["_"+v];return B(p,"Cannot call unknown function "+v+", make sure it is exported"),p}function I(v,p,d,M,V){var _={string:function(ae){var we=0;if(ae!=null&&ae!==0){var Ae=(ae.length<<2)+1;we=Kf(Ae),Z(ae,we,Ae)}return we},array:function(ae){var we=Kf(ae.length);return ze(ae,we),we}};function F(ae){return p==="string"?G(ae):p==="boolean"?Boolean(ae):ae}var k=Y(v),W=[],H=0;if(B(p!=="array",'Return type should not be "array".'),M)for(var ee=0;ee<M.length;ee++){var J=_[d[ee]];J?(H===0&&(H=Cy()),W[ee]=J(M[ee])):W[ee]=M[ee]}var q=k.apply(null,W);function re(ae){return H!==0&&Sy(H),F(ae)}return q=re(q),q}var te=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function U(v,p,d){for(var M=p+d,V=p;v[V]&&!(V>=M);)++V;if(V-p>16&&v.buffer&&te)return te.decode(v.subarray(p,V));for(var _="";p<V;){var F=v[p++];if(!(F&128)){_+=String.fromCharCode(F);continue}var k=v[p++]&63;if((F&224)==192){_+=String.fromCharCode((F&31)<<6|k);continue}var W=v[p++]&63;if((F&240)==224?F=(F&15)<<12|k<<6|W:((F&248)!=240&&m("Invalid UTF-8 leading byte 0x"+F.toString(16)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),F=(F&7)<<18|k<<12|W<<6|v[p++]&63),F<65536)_+=String.fromCharCode(F);else{var H=F-65536;_+=String.fromCharCode(55296|H>>10,56320|H&1023)}}return _}function G(v,p){return v?U(ue,v,p):""}function K(v,p,d,M){if(!(M>0))return 0;for(var V=d,_=d+M-1,F=0;F<v.length;++F){var k=v.charCodeAt(F);if(k>=55296&&k<=57343){var W=v.charCodeAt(++F);k=65536+((k&1023)<<10)|W&1023}if(k<=127){if(d>=_)break;p[d++]=k}else if(k<=2047){if(d+1>=_)break;p[d++]=192|k>>6,p[d++]=128|k&63}else if(k<=65535){if(d+2>=_)break;p[d++]=224|k>>12,p[d++]=128|k>>6&63,p[d++]=128|k&63}else{if(d+3>=_)break;k>1114111&&m("Invalid Unicode code point 0x"+k.toString(16)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),p[d++]=240|k>>18,p[d++]=128|k>>12&63,p[d++]=128|k>>6&63,p[d++]=128|k&63}}return p[d]=0,d-V}function Z(v,p,d){return B(typeof d=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),K(v,ue,p,d)}function Q(v){for(var p=0,d=0;d<v.length;++d){var M=v.charCodeAt(d);M>=55296&&M<=57343&&(M=65536+((M&1023)<<10)|v.charCodeAt(++d)&1023),M<=127?++p:M<=2047?p+=2:M<=65535?p+=3:p+=4}return p}var oe=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ce(v,p){B(v%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var d=v,M=d>>1,V=M+p/2;!(M>=V)&&ge[M];)++M;if(d=M<<1,d-v>32&&oe)return oe.decode(ue.subarray(v,d));for(var _="",F=0;!(F>=p/2);++F){var k=Ce[v+F*2>>1];if(k==0)break;_+=String.fromCharCode(k)}return _}function fe(v,p,d){if(B(p%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),B(typeof d=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),d===void 0&&(d=2147483647),d<2)return 0;d-=2;for(var M=p,V=d<v.length*2?d/2:v.length,_=0;_<V;++_){var F=v.charCodeAt(_);Ce[p>>1]=F,p+=2}return Ce[p>>1]=0,p-M}function pe(v){return v.length*2}function Re(v,p){B(v%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");for(var d=0,M="";!(d>=p/4);){var V=ie[v+d*4>>2];if(V==0)break;if(++d,V>=65536){var _=V-65536;M+=String.fromCharCode(55296|_>>10,56320|_&1023)}else M+=String.fromCharCode(V)}return M}function qe(v,p,d){if(B(p%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!"),B(typeof d=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),d===void 0&&(d=2147483647),d<4)return 0;for(var M=p,V=M+d-4,_=0;_<v.length;++_){var F=v.charCodeAt(_);if(F>=55296&&F<=57343){var k=v.charCodeAt(++_);F=65536+((F&1023)<<10)|k&1023}if(ie[p>>2]=F,p+=4,p+4>V)break}return ie[p>>2]=0,p-M}function He(v){for(var p=0,d=0;d<v.length;++d){var M=v.charCodeAt(d);M>=55296&&M<=57343&&++d,p+=4}return p}function ze(v,p){B(v.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),ne.set(v,p)}function tt(v,p,d){for(var M=0;M<v.length;++M)B(v.charCodeAt(M)===(v.charCodeAt(M)&255)),ne[p++>>0]=v.charCodeAt(M);d||(ne[p>>0]=0)}var Te,ne,ue,Ce,ge,ie,Se,vt,Et;function Dt(v){Te=v,r.HEAP8=ne=new Int8Array(v),r.HEAP16=Ce=new Int16Array(v),r.HEAP32=ie=new Int32Array(v),r.HEAPU8=ue=new Uint8Array(v),r.HEAPU16=ge=new Uint16Array(v),r.HEAPU32=Se=new Uint32Array(v),r.HEAPF32=vt=new Float32Array(v),r.HEAPF64=Et=new Float64Array(v)}var $t=5242880;r.TOTAL_STACK&&B($t===r.TOTAL_STACK,"the stack size can no longer be determined at runtime");var kn=r.INITIAL_MEMORY||16777216;D("INITIAL_MEMORY","INITIAL_MEMORY"),B(kn>=$t,"INITIAL_MEMORY should be larger than TOTAL_STACK, was "+kn+"! (TOTAL_STACK="+$t+")"),B(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support"),B(!r.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),B(kn==16777216,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var en;function yf(){var v=vs();B((v&3)==0),ie[v>>2]=34821223,ie[v+4>>2]=2310721022,Se[0]=1668509029}function Oa(){if(!j){var v=vs(),p=Se[v>>2],d=Se[v+4>>2];(p!=34821223||d!=2310721022)&&be("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x"+d.toString(16)+" 0x"+p.toString(16)),Se[0]!==1668509029&&be("Runtime error: The application has corrupted its heap memory area (address zero)!")}}(function(){var v=new Int16Array(1),p=new Int8Array(v.buffer);if(v[0]=25459,p[0]!==115||p[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})();var df=[],Tf=[],Cf=[],Xi=!1;function R0(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)_0(r.preRun.shift());qi(df)}function L0(){B(!Xi),Xi=!0,Oa(),!r.noFSInit&&!R.init.initialized&&R.init(),R.ignorePermissions=!1,qi(Tf)}function V0(){if(Oa(),r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)k0(r.postRun.shift());qi(Cf)}function _0(v){df.unshift(v)}function b0(v){Tf.unshift(v)}function k0(v){Cf.unshift(v)}B(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),B(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),B(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),B(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var Vr=0,_r=null,Fn=null,tn={};function Sf(v){for(var p=v;;){if(!tn[v])return v;v=p+Math.random()}}function Yi(v){Vr++,r.monitorRunDependencies&&r.monitorRunDependencies(Vr),v?(B(!tn[v]),tn[v]=1,_r===null&&typeof setInterval<"u"&&(_r=setInterval(function(){if(j){clearInterval(_r),_r=null;return}var p=!1;for(var d in tn)p||(p=!0,S("still waiting on run dependencies:")),S("dependency: "+d);p&&S("(end of list)")},1e4))):S("warning: run dependency added without ID")}function Ma(v){if(Vr--,r.monitorRunDependencies&&r.monitorRunDependencies(Vr),v?(B(tn[v]),delete tn[v]):S("warning: run dependency removed without ID"),Vr==0&&(_r!==null&&(clearInterval(_r),_r=null),Fn)){var p=Fn;Fn=null,p()}}function be(v){r.onAbort&&r.onAbort(v),v="Aborted("+v+")",S(v),j=!0;var p=new WebAssembly.RuntimeError(v);throw a(p),p}var F0="data:application/octet-stream;base64,";function Ef(v){return v.startsWith(F0)}function Ii(v){return v.startsWith("file://")}function ft(v,p){return function(){var d=v,M=p;return p||(M=r.asm),B(Xi,"native function `"+d+"` called before runtime initialization"),M[v]||B(M[v],"exported native function `"+d+"` not found"),M[v].apply(null,arguments)}}var it;r.locateFile?(it="simulator.wasm",Ef(it)||(it=l(it))):it=new URL("/embedded-deformation-js/assets/simulator.03b61e17.wasm",self.location).toString();function xf(v){try{if(v==it&&A)return new Uint8Array(A);if(C)return C(v);throw"both async and sync fetching of the wasm failed"}catch(p){be(p)}}function B0(){if(!A&&(f||o)){if(typeof fetch=="function"&&!Ii(it))return fetch(it,{credentials:"same-origin"}).then(function(v){if(!v.ok)throw"failed to load wasm binary file at '"+it+"'";return v.arrayBuffer()}).catch(function(){return xf(it)});if(y)return new Promise(function(v,p){y(it,function(d){v(new Uint8Array(d))},p)})}return Promise.resolve().then(function(){return xf(it)})}function N0(){var v={env:$f,wasi_snapshot_preview1:$f};function p(k,W){var H=k.exports;r.asm=H,z=r.asm.memory,B(z,"memory not found in wasm exports"),Dt(z.buffer),en=r.asm.__indirect_function_table,B(en,"table not found in wasm exports"),b0(r.asm.__wasm_call_ctors),Ma("wasm-instantiate")}Yi("wasm-instantiate");var d=r;function M(k){B(r===d,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),d=null,p(k.instance)}function V(k){return B0().then(function(W){return WebAssembly.instantiate(W,v)}).then(function(W){return W}).then(k,function(W){S("failed to asynchronously prepare wasm: "+W),Ii(it)&&S("warning: Loading from a file URI ("+it+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing"),be(W)})}function _(){return!A&&typeof WebAssembly.instantiateStreaming=="function"&&!Ef(it)&&!Ii(it)&&!u&&typeof fetch=="function"?fetch(it,{credentials:"same-origin"}).then(function(k){var W=WebAssembly.instantiateStreaming(k,v);return W.then(M,function(H){return S("wasm streaming compile failed: "+H),S("falling back to ArrayBuffer instantiation"),V(M)})}):V(M)}if(r.instantiateWasm)try{var F=r.instantiateWasm(v,p);return F}catch(k){return S("Module.instantiateWasm callback failed with error: "+k),!1}return _().catch(a),{}}var rt,Zt;function qi(v){for(;v.length>0;){var p=v.shift();if(typeof p=="function"){p(r);continue}var d=p.func;typeof d=="number"?p.arg===void 0?Bn(d)():Bn(d)(p.arg):d(p.arg===void 0?null:p.arg)}}function U0(v){return m("warning: build with -sDEMANGLE_SUPPORT to link in libcxxabi demangling"),v}function G0(v){var p=/\b_Z[\w\d_]+/g;return v.replace(p,function(d){var M=U0(d);return d===M?d:M+" ["+d+"]"})}var Da=[];function Bn(v){var p=Da[v];return p||(v>=Da.length&&(Da.length=v+1),Da[v]=p=en.get(v)),B(en.get(v)==p,"JavaScript-side Wasm function table mirror is out of date!"),p}function A0(v,p,d,M){be("Assertion failed: "+G(v)+", at: "+[p?G(p):"unknown filename",d,M?G(M):"unknown function"])}function P0(v){return gs(v+24)+24}function W0(v){this.excPtr=v,this.ptr=v-24,this.set_type=function(p){Se[this.ptr+4>>2]=p},this.get_type=function(){return Se[this.ptr+4>>2]},this.set_destructor=function(p){Se[this.ptr+8>>2]=p},this.get_destructor=function(){return Se[this.ptr+8>>2]},this.set_refcount=function(p){ie[this.ptr>>2]=p},this.set_caught=function(p){p=p?1:0,ne[this.ptr+12>>0]=p},this.get_caught=function(){return ne[this.ptr+12>>0]!=0},this.set_rethrown=function(p){p=p?1:0,ne[this.ptr+13>>0]=p},this.get_rethrown=function(){return ne[this.ptr+13>>0]!=0},this.init=function(p,d){this.set_adjusted_ptr(0),this.set_type(p),this.set_destructor(d),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var p=ie[this.ptr>>2];ie[this.ptr>>2]=p+1},this.release_ref=function(){var p=ie[this.ptr>>2];return ie[this.ptr>>2]=p-1,B(p>0),p===1},this.set_adjusted_ptr=function(p){Se[this.ptr+16>>2]=p},this.get_adjusted_ptr=function(){return Se[this.ptr+16>>2]},this.get_exception_ptr=function(){var p=Ey(this.get_type());if(p)return Se[this.excPtr>>2];var d=this.get_adjusted_ptr();return d!==0?d:this.excPtr}}function z0(v,p,d){var M=new W0(v);throw M.init(p,d),v+" - Exception catching is disabled, this exception cannot be caught. Compile with -sNO_DISABLE_EXCEPTION_CATCHING or -sEXCEPTION_CATCHING_ALLOWED=[..] to catch."}function j0(v,p,d,M,V){}function Zi(v){switch(v){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+v)}}function $0(){for(var v=new Array(256),p=0;p<256;++p)v[p]=String.fromCharCode(p);wf=v}var wf=void 0;function xt(v){for(var p="",d=v;ue[d];)p+=wf[ue[d++]];return p}var rn={},br={},ma={},H0=48,K0=57;function Ra(v){if(v===void 0)return"_unknown";v=v.replace(/[^a-zA-Z0-9_]/g,"$");var p=v.charCodeAt(0);return p>=H0&&p<=K0?"_"+v:v}function Qi(v,p){return v=Ra(v),new Function("body","return function "+v+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(p)}function Ji(v,p){var d=Qi(p,function(M){this.name=p,this.message=M;var V=new Error(M).stack;V!==void 0&&(this.stack=this.toString()+`
`+V.replace(/^Error(:[^\n]*)?\n/,""))});return d.prototype=Object.create(v.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},d}var nn=void 0;function Le(v){throw new nn(v)}var Of=void 0;function La(v){throw new Of(v)}function Nn(v,p,d){v.forEach(function(k){ma[k]=p});function M(k){var W=d(k);W.length!==v.length&&La("Mismatched type converter count");for(var H=0;H<v.length;++H)Qt(v[H],W[H])}var V=new Array(p.length),_=[],F=0;p.forEach((k,W)=>{br.hasOwnProperty(k)?V[W]=br[k]:(_.push(k),rn.hasOwnProperty(k)||(rn[k]=[]),rn[k].push(()=>{V[W]=br[k],++F,F===_.length&&M(V)}))}),_.length===0&&M(V)}function Qt(v,p,d={}){if(!("argPackAdvance"in p))throw new TypeError("registerType registeredInstance requires argPackAdvance");var M=p.name;if(v||Le('type "'+M+'" must have a positive integer typeid pointer'),br.hasOwnProperty(v)){if(d.ignoreDuplicateRegistrations)return;Le("Cannot register type '"+M+"' twice")}if(br[v]=p,delete ma[v],rn.hasOwnProperty(v)){var V=rn[v];delete rn[v],V.forEach(_=>_())}}function X0(v,p,d,M,V){var _=Zi(d);p=xt(p),Qt(v,{name:p,fromWireType:function(F){return!!F},toWireType:function(F,k){return k?M:V},argPackAdvance:8,readValueFromPointer:function(F){var k;if(d===1)k=ne;else if(d===2)k=Ce;else if(d===4)k=ie;else throw new TypeError("Unknown boolean type size: "+p);return this.fromWireType(k[F>>_])},destructorFunction:null})}function Y0(v){if(!(this instanceof cr)||!(v instanceof cr))return!1;for(var p=this.$$.ptrType.registeredClass,d=this.$$.ptr,M=v.$$.ptrType.registeredClass,V=v.$$.ptr;p.baseClass;)d=p.upcast(d),p=p.baseClass;for(;M.baseClass;)V=M.upcast(V),M=M.baseClass;return p===M&&d===V}function I0(v){return{count:v.count,deleteScheduled:v.deleteScheduled,preservePointerOnDelete:v.preservePointerOnDelete,ptr:v.ptr,ptrType:v.ptrType,smartPtr:v.smartPtr,smartPtrType:v.smartPtrType}}function es(v){function p(d){return d.$$.ptrType.registeredClass.name}Le(p(v)+" instance already deleted")}var ts=!1;function Mf(v){}function q0(v){v.smartPtr?v.smartPtrType.rawDestructor(v.smartPtr):v.ptrType.registeredClass.rawDestructor(v.ptr)}function Df(v){v.count.value-=1;var p=v.count.value===0;p&&q0(v)}function mf(v,p,d){if(p===d)return v;if(d.baseClass===void 0)return null;var M=mf(v,p,d.baseClass);return M===null?null:d.downcast(M)}var Rf={};function Z0(){return Object.keys(An).length}function Q0(){var v=[];for(var p in An)An.hasOwnProperty(p)&&v.push(An[p]);return v}var Un=[];function rs(){for(;Un.length;){var v=Un.pop();v.$$.deleteScheduled=!1,v.delete()}}var Gn=void 0;function J0(v){Gn=v,Un.length&&Gn&&Gn(rs)}function eh(){r.getInheritedInstanceCount=Z0,r.getLiveInheritedInstances=Q0,r.flushPendingDeletes=rs,r.setDelayFunction=J0}var An={};function th(v,p){for(p===void 0&&Le("ptr should not be undefined");v.baseClass;)p=v.upcast(p),v=v.baseClass;return p}function rh(v,p){return p=th(v,p),An[p]}function Va(v,p){(!p.ptrType||!p.ptr)&&La("makeClassHandle requires ptr and ptrType");var d=!!p.smartPtrType,M=!!p.smartPtr;return d!==M&&La("Both smartPtrType and smartPtr must be specified"),p.count={value:1},Pn(Object.create(v,{$$:{value:p}}))}function Lf(v){var p=this.getPointee(v);if(!p)return this.destructor(v),null;var d=rh(this.registeredClass,p);if(d!==void 0){if(d.$$.count.value===0)return d.$$.ptr=p,d.$$.smartPtr=v,d.clone();var M=d.clone();return this.destructor(v),M}function V(){return this.isSmartPointer?Va(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:p,smartPtrType:this,smartPtr:v}):Va(this.registeredClass.instancePrototype,{ptrType:this,ptr:v})}var _=this.registeredClass.getActualType(p),F=Rf[_];if(!F)return V.call(this);var k;this.isConst?k=F.constPointerType:k=F.pointerType;var W=mf(p,this.registeredClass,k.registeredClass);return W===null?V.call(this):this.isSmartPointer?Va(k.registeredClass.instancePrototype,{ptrType:k,ptr:W,smartPtrType:this,smartPtr:v}):Va(k.registeredClass.instancePrototype,{ptrType:k,ptr:W})}function Pn(v){return typeof FinalizationRegistry>"u"?(Pn=p=>p,v):(ts=new FinalizationRegistry(p=>{console.warn(p.leakWarning.stack.replace(/^Error: /,"")),Df(p.$$)}),Pn=p=>{var d=p.$$,M=!!d.smartPtr;if(M){var V={$$:d},_=d.ptrType.registeredClass;V.leakWarning=new Error("Embind found a leaked C++ instance "+_.name+" <0x"+d.ptr.toString(16)+`>.
We'll free it automatically in this case, but this functionality is not reliable across various environments.
Make sure to invoke .delete() manually once you're done with the instance instead.
Originally allocated`),"captureStackTrace"in Error&&Error.captureStackTrace(V.leakWarning,Lf),ts.register(p,V,p)}return p},Mf=p=>ts.unregister(p),Pn(v))}function nh(){if(this.$$.ptr||es(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var v=Pn(Object.create(Object.getPrototypeOf(this),{$$:{value:I0(this.$$)}}));return v.$$.count.value+=1,v.$$.deleteScheduled=!1,v}function ah(){this.$$.ptr||es(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Le("Object already scheduled for deletion"),Mf(this),Df(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ih(){return!this.$$.ptr}function sh(){return this.$$.ptr||es(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Le("Object already scheduled for deletion"),Un.push(this),Un.length===1&&Gn&&Gn(rs),this.$$.deleteScheduled=!0,this}function oh(){cr.prototype.isAliasOf=Y0,cr.prototype.clone=nh,cr.prototype.delete=ah,cr.prototype.isDeleted=ih,cr.prototype.deleteLater=sh}function cr(){}function Vf(v,p,d){if(v[p].overloadTable===void 0){var M=v[p];v[p]=function(){return v[p].overloadTable.hasOwnProperty(arguments.length)||Le("Function '"+d+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+v[p].overloadTable+")!"),v[p].overloadTable[arguments.length].apply(this,arguments)},v[p].overloadTable=[],v[p].overloadTable[M.argCount]=M}}function fh(v,p,d){r.hasOwnProperty(v)?((d===void 0||r[v].overloadTable!==void 0&&r[v].overloadTable[d]!==void 0)&&Le("Cannot register public name '"+v+"' twice"),Vf(r,v,v),r.hasOwnProperty(d)&&Le("Cannot register multiple overloads of a function with the same number of arguments ("+d+")!"),r[v].overloadTable[d]=p):(r[v]=p,d!==void 0&&(r[v].numArguments=d))}function uh(v,p,d,M,V,_,F,k){this.name=v,this.constructor=p,this.instancePrototype=d,this.rawDestructor=M,this.baseClass=V,this.getActualType=_,this.upcast=F,this.downcast=k,this.pureVirtualFunctions=[]}function ns(v,p,d){for(;p!==d;)p.upcast||Le("Expected null or instance of "+d.name+", got an instance of "+p.name),v=p.upcast(v),p=p.baseClass;return v}function ch(v,p){if(p===null)return this.isReference&&Le("null is not a valid "+this.name),0;p.$$||Le('Cannot pass "'+sn(p)+'" as a '+this.name),p.$$.ptr||Le("Cannot pass deleted object as a pointer of type "+this.name);var d=p.$$.ptrType.registeredClass,M=ns(p.$$.ptr,d,this.registeredClass);return M}function gh(v,p){var d;if(p===null)return this.isReference&&Le("null is not a valid "+this.name),this.isSmartPointer?(d=this.rawConstructor(),v!==null&&v.push(this.rawDestructor,d),d):0;p.$$||Le('Cannot pass "'+sn(p)+'" as a '+this.name),p.$$.ptr||Le("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&p.$$.ptrType.isConst&&Le("Cannot convert argument of type "+(p.$$.smartPtrType?p.$$.smartPtrType.name:p.$$.ptrType.name)+" to parameter type "+this.name);var M=p.$$.ptrType.registeredClass;if(d=ns(p.$$.ptr,M,this.registeredClass),this.isSmartPointer)switch(p.$$.smartPtr===void 0&&Le("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:p.$$.smartPtrType===this?d=p.$$.smartPtr:Le("Cannot convert argument of type "+(p.$$.smartPtrType?p.$$.smartPtrType.name:p.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:d=p.$$.smartPtr;break;case 2:if(p.$$.smartPtrType===this)d=p.$$.smartPtr;else{var V=p.clone();d=this.rawShare(d,mt.toHandle(function(){V.delete()})),v!==null&&v.push(this.rawDestructor,d)}break;default:Le("Unsupporting sharing policy")}return d}function vh(v,p){if(p===null)return this.isReference&&Le("null is not a valid "+this.name),0;p.$$||Le('Cannot pass "'+sn(p)+'" as a '+this.name),p.$$.ptr||Le("Cannot pass deleted object as a pointer of type "+this.name),p.$$.ptrType.isConst&&Le("Cannot convert argument of type "+p.$$.ptrType.name+" to parameter type "+this.name);var d=p.$$.ptrType.registeredClass,M=ns(p.$$.ptr,d,this.registeredClass);return M}function _a(v){return this.fromWireType(Se[v>>2])}function lh(v){return this.rawGetPointee&&(v=this.rawGetPointee(v)),v}function ph(v){this.rawDestructor&&this.rawDestructor(v)}function hh(v){v!==null&&v.delete()}function yh(){Jt.prototype.getPointee=lh,Jt.prototype.destructor=ph,Jt.prototype.argPackAdvance=8,Jt.prototype.readValueFromPointer=_a,Jt.prototype.deleteObject=hh,Jt.prototype.fromWireType=Lf}function Jt(v,p,d,M,V,_,F,k,W,H,ee){this.name=v,this.registeredClass=p,this.isReference=d,this.isConst=M,this.isSmartPointer=V,this.pointeeType=_,this.sharingPolicy=F,this.rawGetPointee=k,this.rawConstructor=W,this.rawShare=H,this.rawDestructor=ee,!V&&p.baseClass===void 0?M?(this.toWireType=ch,this.destructorFunction=null):(this.toWireType=vh,this.destructorFunction=null):this.toWireType=gh}function dh(v,p,d){r.hasOwnProperty(v)||La("Replacing nonexistant public symbol"),r[v].overloadTable!==void 0&&d!==void 0?r[v].overloadTable[d]=p:(r[v]=p,r[v].argCount=d)}function Th(v,p,d){B("dynCall_"+v in r,"bad function pointer type - no table for sig '"+v+"'"),d&&d.length?B(d.length===v.substring(1).replace(/j/g,"--").length):B(v.length==1);var M=r["dynCall_"+v];return d&&d.length?M.apply(null,[p].concat(d)):M.call(null,p)}function Ch(v,p,d){return v.includes("j")?Th(v,p,d):(B(Bn(p),"missing table entry in dynCall: "+p),Bn(p).apply(null,d))}function Sh(v,p){B(v.includes("j"),"getDynCaller should only be called with i64 sigs");var d=[];return function(){return d.length=0,Object.assign(d,arguments),Ch(v,p,d)}}function an(v,p){v=xt(v);function d(){return v.includes("j")?Sh(v,p):Bn(p)}var M=d();return typeof M!="function"&&Le("unknown function pointer with signature "+v+": "+p),M}var _f=void 0;function bf(v){var p=dy(v),d=xt(p);return gr(p),d}function as(v,p){var d=[],M={};function V(_){if(!M[_]&&!br[_]){if(ma[_]){ma[_].forEach(V);return}d.push(_),M[_]=!0}}throw p.forEach(V),new _f(v+": "+d.map(bf).join([", "]))}function Eh(v,p,d,M,V,_,F,k,W,H,ee,J,q){ee=xt(ee),_=an(V,_),k&&(k=an(F,k)),H&&(H=an(W,H)),q=an(J,q);var re=Ra(ee);fh(re,function(){as("Cannot construct "+ee+" due to unbound types",[M])}),Nn([v,p,d],M?[M]:[],function(ae){ae=ae[0];var we,Ae;M?(we=ae.registeredClass,Ae=we.instancePrototype):Ae=cr.prototype;var Xe=Qi(re,function(){if(Object.getPrototypeOf(this)!==X)throw new nn("Use 'new' to construct "+ee);if(se.constructor_body===void 0)throw new nn(ee+" has no accessible constructor");var Ye=se.constructor_body[arguments.length];if(Ye===void 0)throw new nn("Tried to invoke ctor of "+ee+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(se.constructor_body).toString()+") parameters instead!");return Ye.apply(this,arguments)}),X=Object.create(Ae,{constructor:{value:Xe}});Xe.prototype=X;var se=new uh(ee,Xe,X,q,we,_,k,H),Ze=new Jt(ee,se,!0,!1,!1),Be=new Jt(ee+"*",se,!1,!1,!1),dt=new Jt(ee+" const*",se,!1,!0,!1);return Rf[v]={pointerType:Be,constPointerType:dt},dh(re,Xe),[Ze,Be,dt]})}function kf(v,p){for(var d=[],M=0;M<v;M++)d.push(ie[(p>>2)+M]);return d}function Ff(v){for(;v.length;){var p=v.pop(),d=v.pop();d(p)}}function xh(v,p,d,M,V,_){B(p>0);var F=kf(p,d);V=an(M,V),Nn([],[v],function(k){k=k[0];var W="constructor "+k.name;if(k.registeredClass.constructor_body===void 0&&(k.registeredClass.constructor_body=[]),k.registeredClass.constructor_body[p-1]!==void 0)throw new nn("Cannot register multiple constructors with identical number of parameters ("+(p-1)+") for class '"+k.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return k.registeredClass.constructor_body[p-1]=()=>{as("Cannot construct "+k.name+" due to unbound types",F)},Nn([],F,function(H){return H.splice(1,0,null),k.registeredClass.constructor_body[p-1]=Nf(W,H,null,V,_),[]}),[]})}function Bf(v,p){if(!(v instanceof Function))throw new TypeError("new_ called with constructor type "+typeof v+" which is not a function");var d=Qi(v.name||"unknownFunctionName",function(){});d.prototype=v.prototype;var M=new d,V=v.apply(M,p);return V instanceof Object?V:M}function Nf(v,p,d,M,V){var _=p.length;_<2&&Le("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var F=p[1]!==null&&d!==null,k=!1,W=1;W<p.length;++W)if(p[W]!==null&&p[W].destructorFunction===void 0){k=!0;break}for(var H=p[0].name!=="void",ee="",J="",W=0;W<_-2;++W)ee+=(W!==0?", ":"")+"arg"+W,J+=(W!==0?", ":"")+"arg"+W+"Wired";var q="return function "+Ra(v)+"("+ee+`) {
if (arguments.length !== `+(_-2)+`) {
throwBindingError('function `+v+" called with ' + arguments.length + ' arguments, expected "+(_-2)+` args!');
}
`;k&&(q+=`var destructors = [];
`);var re=k?"destructors":"null",ae=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],we=[Le,M,V,Ff,p[0],p[1]];F&&(q+="var thisWired = classParam.toWireType("+re+`, this);
`);for(var W=0;W<_-2;++W)q+="var arg"+W+"Wired = argType"+W+".toWireType("+re+", arg"+W+"); // "+p[W+2].name+`
`,ae.push("argType"+W),we.push(p[W+2]);if(F&&(J="thisWired"+(J.length>0?", ":"")+J),q+=(H?"var rv = ":"")+"invoker(fn"+(J.length>0?", ":"")+J+`);
`,k)q+=`runDestructors(destructors);
`;else for(var W=F?1:2;W<p.length;++W){var Ae=W===1?"thisWired":"arg"+(W-2)+"Wired";p[W].destructorFunction!==null&&(q+=Ae+"_dtor("+Ae+"); // "+p[W].name+`
`,ae.push(Ae+"_dtor"),we.push(p[W].destructorFunction))}H&&(q+=`var ret = retType.fromWireType(rv);
return ret;
`),q+=`}
`,ae.push(q);var Xe=Bf(Function,ae).apply(null,we);return Xe}function wh(v,p,d,M,V,_,F,k){var W=kf(d,M);p=xt(p),_=an(V,_),Nn([],[v],function(H){H=H[0];var ee=H.name+"."+p;p.startsWith("@@")&&(p=Symbol[p.substring(2)]),k&&H.registeredClass.pureVirtualFunctions.push(p);function J(){as("Cannot call "+ee+" due to unbound types",W)}var q=H.registeredClass.instancePrototype,re=q[p];return re===void 0||re.overloadTable===void 0&&re.className!==H.name&&re.argCount===d-2?(J.argCount=d-2,J.className=H.name,q[p]=J):(Vf(q,p,ee),q[p].overloadTable[d-2]=J),Nn([],W,function(ae){var we=Nf(ee,ae,H,_,F);return q[p].overloadTable===void 0?(we.argCount=d-2,q[p]=we):q[p].overloadTable[d-2]=we,[]}),[]})}var is=[],Bt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ss(v){v>4&&--Bt[v].refcount===0&&(Bt[v]=void 0,is.push(v))}function Oh(){for(var v=0,p=5;p<Bt.length;++p)Bt[p]!==void 0&&++v;return v}function Mh(){for(var v=5;v<Bt.length;++v)if(Bt[v]!==void 0)return Bt[v];return null}function Dh(){r.count_emval_handles=Oh,r.get_first_emval=Mh}var mt={toValue:v=>(v||Le("Cannot use deleted val. handle = "+v),Bt[v].value),toHandle:v=>{switch(v){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var p=is.length?is.pop():Bt.length;return Bt[p]={refcount:1,value:v},p}}}};function mh(v,p){p=xt(p),Qt(v,{name:p,fromWireType:function(d){var M=mt.toValue(d);return ss(d),M},toWireType:function(d,M){return mt.toHandle(M)},argPackAdvance:8,readValueFromPointer:_a,destructorFunction:null})}function sn(v){if(v===null)return"null";var p=typeof v;return p==="object"||p==="array"||p==="function"?v.toString():""+v}function Rh(v,p){switch(p){case 2:return function(d){return this.fromWireType(vt[d>>2])};case 3:return function(d){return this.fromWireType(Et[d>>3])};default:throw new TypeError("Unknown float type: "+v)}}function Lh(v,p,d){var M=Zi(d);p=xt(p),Qt(v,{name:p,fromWireType:function(V){return V},toWireType:function(V,_){if(typeof _!="number"&&typeof _!="boolean")throw new TypeError('Cannot convert "'+sn(_)+'" to '+this.name);return _},argPackAdvance:8,readValueFromPointer:Rh(p,M),destructorFunction:null})}function Vh(v,p,d){switch(p){case 0:return d?function(V){return ne[V]}:function(V){return ue[V]};case 1:return d?function(V){return Ce[V>>1]}:function(V){return ge[V>>1]};case 2:return d?function(V){return ie[V>>2]}:function(V){return Se[V>>2]};default:throw new TypeError("Unknown integer type: "+v)}}function _h(v,p,d,M,V){p=xt(p),V===-1&&(V=4294967295);var _=Zi(d),F=J=>J;if(M===0){var k=32-8*d;F=J=>J<<k>>>k}var W=p.includes("unsigned"),H=(J,q)=>{if(typeof J!="number"&&typeof J!="boolean")throw new TypeError('Cannot convert "'+sn(J)+'" to '+q);if(J<M||J>V)throw new TypeError('Passing a number "'+sn(J)+'" from JS side to C/C++ side to an argument of type "'+p+'", which is outside the valid range ['+M+", "+V+"]!")},ee;W?ee=function(J,q){return H(q,this.name),q>>>0}:ee=function(J,q){return H(q,this.name),q},Qt(v,{name:p,fromWireType:F,toWireType:ee,argPackAdvance:8,readValueFromPointer:Vh(p,_,M!==0),destructorFunction:null})}function bh(v,p,d){var M=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],V=M[p];function _(F){F=F>>2;var k=Se,W=k[F],H=k[F+1];return new V(Te,H,W)}d=xt(d),Qt(v,{name:d,fromWireType:_,argPackAdvance:8,readValueFromPointer:_},{ignoreDuplicateRegistrations:!0})}function kh(v,p){p=xt(p);var d=p==="std::string";Qt(v,{name:p,fromWireType:function(M){var V=Se[M>>2],_;if(d)for(var F=M+4,k=0;k<=V;++k){var W=M+4+k;if(k==V||ue[W]==0){var H=W-F,ee=G(F,H);_===void 0?_=ee:(_+=String.fromCharCode(0),_+=ee),F=W+1}}else{for(var J=new Array(V),k=0;k<V;++k)J[k]=String.fromCharCode(ue[M+4+k]);_=J.join("")}return gr(M),_},toWireType:function(M,V){V instanceof ArrayBuffer&&(V=new Uint8Array(V));var _,F=typeof V=="string";F||V instanceof Uint8Array||V instanceof Uint8ClampedArray||V instanceof Int8Array||Le("Cannot pass non-string to std::string"),d&&F?_=()=>Q(V):_=()=>V.length;var k=_(),W=gs(4+k+1);if(Se[W>>2]=k,d&&F)Z(V,W+4,k+1);else if(F)for(var H=0;H<k;++H){var ee=V.charCodeAt(H);ee>255&&(gr(W),Le("String has UTF-16 code units that do not fit in 8 bits")),ue[W+4+H]=ee}else for(var H=0;H<k;++H)ue[W+4+H]=V[H];return M!==null&&M.push(gr,W),W},argPackAdvance:8,readValueFromPointer:_a,destructorFunction:function(M){gr(M)}})}function Fh(v,p,d){d=xt(d);var M,V,_,F,k;p===2?(M=ce,V=fe,F=pe,_=()=>ge,k=1):p===4&&(M=Re,V=qe,F=He,_=()=>Se,k=2),Qt(v,{name:d,fromWireType:function(W){for(var H=Se[W>>2],ee=_(),J,q=W+4,re=0;re<=H;++re){var ae=W+4+re*p;if(re==H||ee[ae>>k]==0){var we=ae-q,Ae=M(q,we);J===void 0?J=Ae:(J+=String.fromCharCode(0),J+=Ae),q=ae+p}}return gr(W),J},toWireType:function(W,H){typeof H!="string"&&Le("Cannot pass non-string to C++ string type "+d);var ee=F(H),J=gs(4+ee+p);return Se[J>>2]=ee>>k,V(H,J+4,ee+p),W!==null&&W.push(gr,J),J},argPackAdvance:8,readValueFromPointer:_a,destructorFunction:function(W){gr(W)}})}function Bh(v,p){p=xt(p),Qt(v,{isVoid:!0,name:p,argPackAdvance:0,fromWireType:function(){},toWireType:function(d,M){}})}function os(v,p){var d=br[v];return d===void 0&&Le(p+" has unknown type "+bf(v)),d}function Nh(v,p,d){v=mt.toValue(v),p=os(p,"emval::as");var M=[],V=mt.toHandle(M);return ie[d>>2]=V,p.toWireType(M,v)}var Uh={};function Uf(v){var p=Uh[v];return p===void 0?xt(v):p}var fs=[];function Gh(v,p,d,M){v=fs[v],p=mt.toValue(p),d=Uf(d),v(p,d,null,M)}function Ah(v){var p=fs.length;return fs.push(v),p}function Ph(v,p){for(var d=new Array(v),M=0;M<v;++M)d[M]=os(ie[(p>>2)+M],"parameter "+M);return d}var Gf=[];function Wh(v,p){var d=Ph(v,p),M=d[0],V=M.name+"_$"+d.slice(1).map(function(ae){return ae.name}).join("_")+"$",_=Gf[V];if(_!==void 0)return _;for(var F=["retType"],k=[M],W="",H=0;H<v-1;++H)W+=(H!==0?", ":"")+"arg"+H,F.push("argType"+H),k.push(d[1+H]);for(var ee=Ra("methodCaller_"+V),J="return function "+ee+`(handle, name, destructors, args) {
`,q=0,H=0;H<v-1;++H)J+="    var arg"+H+" = argType"+H+".readValueFromPointer(args"+(q?"+"+q:"")+`);
`,q+=d[H+1].argPackAdvance;J+="    var rv = handle[name]("+W+`);
`;for(var H=0;H<v-1;++H)d[H+1].deleteObject&&(J+="    argType"+H+".deleteObject(arg"+H+`);
`);M.isVoid||(J+=`    return retType.toWireType(destructors, rv);
`),J+=`};
`,F.push(J);var re=Bf(Function,F).apply(null,k);return _=Ah(re),Gf[V]=_,_}function zh(v,p){return v=mt.toValue(v),p=mt.toValue(p),mt.toHandle(v[p])}function jh(v){v>4&&(Bt[v].refcount+=1)}function $h(v){return mt.toHandle(Uf(v))}function Hh(v){var p=mt.toValue(v);Ff(p),ss(v)}function Kh(v,p){v=os(v,"_emval_take_value");var d=v.readValueFromPointer(p);return mt.toHandle(d)}function Xh(){be("native code called abort()")}function Af(){return 2147483648}function Yh(){return Af()}function Ih(v,p,d){ue.copyWithin(v,p,p+d)}function qh(v){try{return z.grow(v-Te.byteLength+65535>>>16),Dt(z.buffer),1}catch(p){S("emscripten_realloc_buffer: Attempted to grow heap from "+Te.byteLength+" bytes to "+v+" bytes, but got error: "+p)}}function Zh(v){var p=ue.length;v=v>>>0,B(v>p);var d=Af();if(v>d)return S("Cannot enlarge memory, asked to go up to "+v+" bytes, but the limit is "+d+" bytes!"),!1;let M=(W,H)=>W+(H-W%H)%H;for(var V=1;V<=4;V*=2){var _=p*(1+.2/V);_=Math.min(_,v+100663296);var F=Math.min(d,M(Math.max(v,_),65536)),k=qh(F);if(k)return!0}return S("Failed to grow the heap from "+p+" bytes to "+F+" bytes, not enough memory!"),!1}var us={};function Qh(){return s||"./this.program"}function Wn(){if(!Wn.strings){var v=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",p={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:v,_:Qh()};for(var d in us)us[d]===void 0?delete p[d]:p[d]=us[d];var M=[];for(var d in p)M.push(d+"="+p[d]);Wn.strings=M}return Wn.strings}var Ve={isAbs:v=>v.charAt(0)==="/",splitPath:v=>{var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return p.exec(v).slice(1)},normalizeArray:(v,p)=>{for(var d=0,M=v.length-1;M>=0;M--){var V=v[M];V==="."?v.splice(M,1):V===".."?(v.splice(M,1),d++):d&&(v.splice(M,1),d--)}if(p)for(;d;d--)v.unshift("..");return v},normalize:v=>{var p=Ve.isAbs(v),d=v.substr(-1)==="/";return v=Ve.normalizeArray(v.split("/").filter(M=>!!M),!p).join("/"),!v&&!p&&(v="."),v&&d&&(v+="/"),(p?"/":"")+v},dirname:v=>{var p=Ve.splitPath(v),d=p[0],M=p[1];return!d&&!M?".":(M&&(M=M.substr(0,M.length-1)),d+M)},basename:v=>{if(v==="/")return"/";v=Ve.normalize(v),v=v.replace(/\/$/,"");var p=v.lastIndexOf("/");return p===-1?v:v.substr(p+1)},join:function(){var v=Array.prototype.slice.call(arguments,0);return Ve.normalize(v.join("/"))},join2:(v,p)=>Ve.normalize(v+"/"+p)};function Jh(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var v=new Uint8Array(1);return function(){return crypto.getRandomValues(v),v[0]}}else if(u)try{var p=require("crypto");return function(){return p.randomBytes(1)[0]}}catch{}return function(){be("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: function(array) { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")}}var er={resolve:function(){for(var v="",p=!1,d=arguments.length-1;d>=-1&&!p;d--){var M=d>=0?arguments[d]:R.cwd();if(typeof M!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!M)return"";v=M+"/"+v,p=Ve.isAbs(M)}return v=Ve.normalizeArray(v.split("/").filter(V=>!!V),!p).join("/"),(p?"/":"")+v||"."},relative:(v,p)=>{v=er.resolve(v).substr(1),p=er.resolve(p).substr(1);function d(H){for(var ee=0;ee<H.length&&H[ee]==="";ee++);for(var J=H.length-1;J>=0&&H[J]==="";J--);return ee>J?[]:H.slice(ee,J-ee+1)}for(var M=d(v.split("/")),V=d(p.split("/")),_=Math.min(M.length,V.length),F=_,k=0;k<_;k++)if(M[k]!==V[k]){F=k;break}for(var W=[],k=F;k<M.length;k++)W.push("..");return W=W.concat(V.slice(F)),W.join("/")}},kr={ttys:[],init:function(){},shutdown:function(){},register:function(v,p){kr.ttys[v]={input:[],output:[],ops:p},R.registerDevice(v,kr.stream_ops)},stream_ops:{open:function(v){var p=kr.ttys[v.node.rdev];if(!p)throw new R.ErrnoError(43);v.tty=p,v.seekable=!1},close:function(v){v.tty.ops.flush(v.tty)},flush:function(v){v.tty.ops.flush(v.tty)},read:function(v,p,d,M,V){if(!v.tty||!v.tty.ops.get_char)throw new R.ErrnoError(60);for(var _=0,F=0;F<M;F++){var k;try{k=v.tty.ops.get_char(v.tty)}catch{throw new R.ErrnoError(29)}if(k===void 0&&_===0)throw new R.ErrnoError(6);if(k==null)break;_++,p[d+F]=k}return _&&(v.node.timestamp=Date.now()),_},write:function(v,p,d,M,V){if(!v.tty||!v.tty.ops.put_char)throw new R.ErrnoError(60);try{for(var _=0;_<M;_++)v.tty.ops.put_char(v.tty,p[d+_])}catch{throw new R.ErrnoError(29)}return M&&(v.node.timestamp=Date.now()),_}},default_tty_ops:{get_char:function(v){if(!v.input.length){var p=null;if(u){var d=256,M=Buffer.alloc(d),V=0;try{V=T.readSync(process.stdin.fd,M,0,d,-1)}catch(_){if(_.toString().includes("EOF"))V=0;else throw _}V>0?p=M.slice(0,V).toString("utf-8"):p=null}else typeof window<"u"&&typeof window.prompt=="function"?(p=window.prompt("Input: "),p!==null&&(p+=`
`)):typeof readline=="function"&&(p=readline(),p!==null&&(p+=`
`));if(!p)return null;v.input=Ba(p,!0)}return v.input.shift()},put_char:function(v,p){p===null||p===10?(x(U(v.output,0)),v.output=[]):p!=0&&v.output.push(p)},flush:function(v){v.output&&v.output.length>0&&(x(U(v.output,0)),v.output=[])}},default_tty1_ops:{put_char:function(v,p){p===null||p===10?(S(U(v.output,0)),v.output=[]):p!=0&&v.output.push(p)},flush:function(v){v.output&&v.output.length>0&&(S(U(v.output,0)),v.output=[])}}};function Pf(v){be("internal error: mmapAlloc called but `emscripten_builtin_memalign` native symbol not exported")}var he={ops_table:null,mount:function(v){return he.createNode(null,"/",16895,0)},createNode:function(v,p,d,M){if(R.isBlkdev(d)||R.isFIFO(d))throw new R.ErrnoError(63);he.ops_table||(he.ops_table={dir:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr,lookup:he.node_ops.lookup,mknod:he.node_ops.mknod,rename:he.node_ops.rename,unlink:he.node_ops.unlink,rmdir:he.node_ops.rmdir,readdir:he.node_ops.readdir,symlink:he.node_ops.symlink},stream:{llseek:he.stream_ops.llseek}},file:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr},stream:{llseek:he.stream_ops.llseek,read:he.stream_ops.read,write:he.stream_ops.write,allocate:he.stream_ops.allocate,mmap:he.stream_ops.mmap,msync:he.stream_ops.msync}},link:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr,readlink:he.node_ops.readlink},stream:{}},chrdev:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr},stream:R.chrdev_stream_ops}});var V=R.createNode(v,p,d,M);return R.isDir(V.mode)?(V.node_ops=he.ops_table.dir.node,V.stream_ops=he.ops_table.dir.stream,V.contents={}):R.isFile(V.mode)?(V.node_ops=he.ops_table.file.node,V.stream_ops=he.ops_table.file.stream,V.usedBytes=0,V.contents=null):R.isLink(V.mode)?(V.node_ops=he.ops_table.link.node,V.stream_ops=he.ops_table.link.stream):R.isChrdev(V.mode)&&(V.node_ops=he.ops_table.chrdev.node,V.stream_ops=he.ops_table.chrdev.stream),V.timestamp=Date.now(),v&&(v.contents[p]=V,v.timestamp=V.timestamp),V},getFileDataAsTypedArray:function(v){return v.contents?v.contents.subarray?v.contents.subarray(0,v.usedBytes):new Uint8Array(v.contents):new Uint8Array(0)},expandFileStorage:function(v,p){var d=v.contents?v.contents.length:0;if(!(d>=p)){var M=1024*1024;p=Math.max(p,d*(d<M?2:1.125)>>>0),d!=0&&(p=Math.max(p,256));var V=v.contents;v.contents=new Uint8Array(p),v.usedBytes>0&&v.contents.set(V.subarray(0,v.usedBytes),0)}},resizeFileStorage:function(v,p){if(v.usedBytes!=p)if(p==0)v.contents=null,v.usedBytes=0;else{var d=v.contents;v.contents=new Uint8Array(p),d&&v.contents.set(d.subarray(0,Math.min(p,v.usedBytes))),v.usedBytes=p}},node_ops:{getattr:function(v){var p={};return p.dev=R.isChrdev(v.mode)?v.id:1,p.ino=v.id,p.mode=v.mode,p.nlink=1,p.uid=0,p.gid=0,p.rdev=v.rdev,R.isDir(v.mode)?p.size=4096:R.isFile(v.mode)?p.size=v.usedBytes:R.isLink(v.mode)?p.size=v.link.length:p.size=0,p.atime=new Date(v.timestamp),p.mtime=new Date(v.timestamp),p.ctime=new Date(v.timestamp),p.blksize=4096,p.blocks=Math.ceil(p.size/p.blksize),p},setattr:function(v,p){p.mode!==void 0&&(v.mode=p.mode),p.timestamp!==void 0&&(v.timestamp=p.timestamp),p.size!==void 0&&he.resizeFileStorage(v,p.size)},lookup:function(v,p){throw R.genericErrors[44]},mknod:function(v,p,d,M){return he.createNode(v,p,d,M)},rename:function(v,p,d){if(R.isDir(v.mode)){var M;try{M=R.lookupNode(p,d)}catch{}if(M)for(var V in M.contents)throw new R.ErrnoError(55)}delete v.parent.contents[v.name],v.parent.timestamp=Date.now(),v.name=d,p.contents[d]=v,p.timestamp=v.parent.timestamp,v.parent=p},unlink:function(v,p){delete v.contents[p],v.timestamp=Date.now()},rmdir:function(v,p){var d=R.lookupNode(v,p);for(var M in d.contents)throw new R.ErrnoError(55);delete v.contents[p],v.timestamp=Date.now()},readdir:function(v){var p=[".",".."];for(var d in v.contents)!v.contents.hasOwnProperty(d)||p.push(d);return p},symlink:function(v,p,d){var M=he.createNode(v,p,41471,0);return M.link=d,M},readlink:function(v){if(!R.isLink(v.mode))throw new R.ErrnoError(28);return v.link}},stream_ops:{read:function(v,p,d,M,V){var _=v.node.contents;if(V>=v.node.usedBytes)return 0;var F=Math.min(v.node.usedBytes-V,M);if(B(F>=0),F>8&&_.subarray)p.set(_.subarray(V,V+F),d);else for(var k=0;k<F;k++)p[d+k]=_[V+k];return F},write:function(v,p,d,M,V,_){if(B(!(p instanceof ArrayBuffer)),p.buffer===ne.buffer&&(_=!1),!M)return 0;var F=v.node;if(F.timestamp=Date.now(),p.subarray&&(!F.contents||F.contents.subarray)){if(_)return B(V===0,"canOwn must imply no weird position inside the file"),F.contents=p.subarray(d,d+M),F.usedBytes=M,M;if(F.usedBytes===0&&V===0)return F.contents=p.slice(d,d+M),F.usedBytes=M,M;if(V+M<=F.usedBytes)return F.contents.set(p.subarray(d,d+M),V),M}if(he.expandFileStorage(F,V+M),F.contents.subarray&&p.subarray)F.contents.set(p.subarray(d,d+M),V);else for(var k=0;k<M;k++)F.contents[V+k]=p[d+k];return F.usedBytes=Math.max(F.usedBytes,V+M),M},llseek:function(v,p,d){var M=p;if(d===1?M+=v.position:d===2&&R.isFile(v.node.mode)&&(M+=v.node.usedBytes),M<0)throw new R.ErrnoError(28);return M},allocate:function(v,p,d){he.expandFileStorage(v.node,p+d),v.node.usedBytes=Math.max(v.node.usedBytes,p+d)},mmap:function(v,p,d,M,V){if(!R.isFile(v.node.mode))throw new R.ErrnoError(43);var _,F,k=v.node.contents;if(!(V&2)&&k.buffer===Te)F=!1,_=k.byteOffset;else{if((d>0||d+p<k.length)&&(k.subarray?k=k.subarray(d,d+p):k=Array.prototype.slice.call(k,d,d+p)),F=!0,_=Pf(),!_)throw new R.ErrnoError(48);ne.set(k,_)}return{ptr:_,allocated:F}},msync:function(v,p,d,M,V){if(!R.isFile(v.node.mode))throw new R.ErrnoError(43);return V&2||he.stream_ops.write(v,p,0,M,d,!1),0}}};function ey(v,p,d,M){var V=M?"":Sf("al "+v);y(v,function(_){B(_,'Loading data file "'+v+'" failed (no arrayBuffer).'),p(new Uint8Array(_)),V&&Ma(V)},function(_){if(d)d();else throw'Loading data file "'+v+'" failed.'}),V&&Yi(V)}var ty={0:"Success",1:"Arg list too long",2:"Permission denied",3:"Address already in use",4:"Address not available",5:"Address family not supported by protocol family",6:"No more processes",7:"Socket already connected",8:"Bad file number",9:"Trying to read unreadable message",10:"Mount device busy",11:"Operation canceled",12:"No children",13:"Connection aborted",14:"Connection refused",15:"Connection reset by peer",16:"File locking deadlock error",17:"Destination address required",18:"Math arg out of domain of func",19:"Quota exceeded",20:"File exists",21:"Bad address",22:"File too large",23:"Host is unreachable",24:"Identifier removed",25:"Illegal byte sequence",26:"Connection already in progress",27:"Interrupted system call",28:"Invalid argument",29:"I/O error",30:"Socket is already connected",31:"Is a directory",32:"Too many symbolic links",33:"Too many open files",34:"Too many links",35:"Message too long",36:"Multihop attempted",37:"File or path name too long",38:"Network interface is not configured",39:"Connection reset by network",40:"Network is unreachable",41:"Too many open files in system",42:"No buffer space available",43:"No such device",44:"No such file or directory",45:"Exec format error",46:"No record locks available",47:"The link has been severed",48:"Not enough core",49:"No message of desired type",50:"Protocol not available",51:"No space left on device",52:"Function not implemented",53:"Socket is not connected",54:"Not a directory",55:"Directory not empty",56:"State not recoverable",57:"Socket operation on non-socket",59:"Not a typewriter",60:"No such device or address",61:"Value too large for defined data type",62:"Previous owner died",63:"Not super-user",64:"Broken pipe",65:"Protocol error",66:"Unknown protocol",67:"Protocol wrong type for socket",68:"Math result not representable",69:"Read only file system",70:"Illegal seek",71:"No such process",72:"Stale file handle",73:"Connection timed out",74:"Text file busy",75:"Cross-device link",100:"Device not a stream",101:"Bad font file fmt",102:"Invalid slot",103:"Invalid request code",104:"No anode",105:"Block device required",106:"Channel number out of range",107:"Level 3 halted",108:"Level 3 reset",109:"Link number out of range",110:"Protocol driver not attached",111:"No CSI structure available",112:"Level 2 halted",113:"Invalid exchange",114:"Invalid request descriptor",115:"Exchange full",116:"No data (for no delay io)",117:"Timer expired",118:"Out of streams resources",119:"Machine is not on the network",120:"Package not installed",121:"The object is remote",122:"Advertise error",123:"Srmount error",124:"Communication error on send",125:"Cross mount point (not really error)",126:"Given log. name not unique",127:"f.d. invalid for this operation",128:"Remote address changed",129:"Can   access a needed shared lib",130:"Accessing a corrupted shared lib",131:".lib section in a.out corrupted",132:"Attempting to link in too many libs",133:"Attempting to exec a shared library",135:"Streams pipe error",136:"Too many users",137:"Socket type not supported",138:"Not supported",139:"Protocol family not supported",140:"Can't send after socket shutdown",141:"Too many references",142:"Host is down",148:"No medium (in tape drive)",156:"Level 2 not synchronized"},cs={},R={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(v,p={})=>{if(v=er.resolve(R.cwd(),v),!v)return{path:"",node:null};var d={follow_mount:!0,recurse_count:0};if(p=Object.assign(d,p),p.recurse_count>8)throw new R.ErrnoError(32);for(var M=Ve.normalizeArray(v.split("/").filter(J=>!!J),!1),V=R.root,_="/",F=0;F<M.length;F++){var k=F===M.length-1;if(k&&p.parent)break;if(V=R.lookupNode(V,M[F]),_=Ve.join2(_,M[F]),R.isMountpoint(V)&&(!k||k&&p.follow_mount)&&(V=V.mounted.root),!k||p.follow)for(var W=0;R.isLink(V.mode);){var H=R.readlink(_);_=er.resolve(Ve.dirname(_),H);var ee=R.lookupPath(_,{recurse_count:p.recurse_count+1});if(V=ee.node,W++>40)throw new R.ErrnoError(32)}}return{path:_,node:V}},getPath:v=>{for(var p;;){if(R.isRoot(v)){var d=v.mount.mountpoint;return p?d[d.length-1]!=="/"?d+"/"+p:d+p:d}p=p?v.name+"/"+p:v.name,v=v.parent}},hashName:(v,p)=>{for(var d=0,M=0;M<p.length;M++)d=(d<<5)-d+p.charCodeAt(M)|0;return(v+d>>>0)%R.nameTable.length},hashAddNode:v=>{var p=R.hashName(v.parent.id,v.name);v.name_next=R.nameTable[p],R.nameTable[p]=v},hashRemoveNode:v=>{var p=R.hashName(v.parent.id,v.name);if(R.nameTable[p]===v)R.nameTable[p]=v.name_next;else for(var d=R.nameTable[p];d;){if(d.name_next===v){d.name_next=v.name_next;break}d=d.name_next}},lookupNode:(v,p)=>{var d=R.mayLookup(v);if(d)throw new R.ErrnoError(d,v);for(var M=R.hashName(v.id,p),V=R.nameTable[M];V;V=V.name_next){var _=V.name;if(V.parent.id===v.id&&_===p)return V}return R.lookup(v,p)},createNode:(v,p,d,M)=>{B(typeof v=="object");var V=new R.FSNode(v,p,d,M);return R.hashAddNode(V),V},destroyNode:v=>{R.hashRemoveNode(v)},isRoot:v=>v===v.parent,isMountpoint:v=>!!v.mounted,isFile:v=>(v&61440)===32768,isDir:v=>(v&61440)===16384,isLink:v=>(v&61440)===40960,isChrdev:v=>(v&61440)===8192,isBlkdev:v=>(v&61440)===24576,isFIFO:v=>(v&61440)===4096,isSocket:v=>(v&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:v=>{var p=R.flagModes[v];if(typeof p>"u")throw new Error("Unknown file open mode: "+v);return p},flagsToPermissionString:v=>{var p=["r","w","rw"][v&3];return v&512&&(p+="w"),p},nodePermissions:(v,p)=>R.ignorePermissions?0:p.includes("r")&&!(v.mode&292)||p.includes("w")&&!(v.mode&146)||p.includes("x")&&!(v.mode&73)?2:0,mayLookup:v=>{var p=R.nodePermissions(v,"x");return p||(v.node_ops.lookup?0:2)},mayCreate:(v,p)=>{try{var d=R.lookupNode(v,p);return 20}catch{}return R.nodePermissions(v,"wx")},mayDelete:(v,p,d)=>{var M;try{M=R.lookupNode(v,p)}catch(_){return _.errno}var V=R.nodePermissions(v,"wx");if(V)return V;if(d){if(!R.isDir(M.mode))return 54;if(R.isRoot(M)||R.getPath(M)===R.cwd())return 10}else if(R.isDir(M.mode))return 31;return 0},mayOpen:(v,p)=>v?R.isLink(v.mode)?32:R.isDir(v.mode)&&(R.flagsToPermissionString(p)!=="r"||p&512)?31:R.nodePermissions(v,R.flagsToPermissionString(p)):44,MAX_OPEN_FDS:4096,nextfd:(v=0,p=R.MAX_OPEN_FDS)=>{for(var d=v;d<=p;d++)if(!R.streams[d])return d;throw new R.ErrnoError(33)},getStream:v=>R.streams[v],createStream:(v,p,d)=>{R.FSStream||(R.FSStream=function(){this.shared={}},R.FSStream.prototype={object:{get:function(){return this.node},set:function(V){this.node=V}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(V){this.shared.flags=V}},position:{get function(){return this.shared.position},set:function(V){this.shared.position=V}}}),v=Object.assign(new R.FSStream,v);var M=R.nextfd(p,d);return v.fd=M,R.streams[M]=v,v},closeStream:v=>{R.streams[v]=null},chrdev_stream_ops:{open:v=>{var p=R.getDevice(v.node.rdev);v.stream_ops=p.stream_ops,v.stream_ops.open&&v.stream_ops.open(v)},llseek:()=>{throw new R.ErrnoError(70)}},major:v=>v>>8,minor:v=>v&255,makedev:(v,p)=>v<<8|p,registerDevice:(v,p)=>{R.devices[v]={stream_ops:p}},getDevice:v=>R.devices[v],getMounts:v=>{for(var p=[],d=[v];d.length;){var M=d.pop();p.push(M),d.push.apply(d,M.mounts)}return p},syncfs:(v,p)=>{typeof v=="function"&&(p=v,v=!1),R.syncFSRequests++,R.syncFSRequests>1&&S("warning: "+R.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var d=R.getMounts(R.root.mount),M=0;function V(F){return B(R.syncFSRequests>0),R.syncFSRequests--,p(F)}function _(F){if(F)return _.errored?void 0:(_.errored=!0,V(F));++M>=d.length&&V(null)}d.forEach(F=>{if(!F.type.syncfs)return _(null);F.type.syncfs(F,v,_)})},mount:(v,p,d)=>{if(typeof v=="string")throw v;var M=d==="/",V=!d,_;if(M&&R.root)throw new R.ErrnoError(10);if(!M&&!V){var F=R.lookupPath(d,{follow_mount:!1});if(d=F.path,_=F.node,R.isMountpoint(_))throw new R.ErrnoError(10);if(!R.isDir(_.mode))throw new R.ErrnoError(54)}var k={type:v,opts:p,mountpoint:d,mounts:[]},W=v.mount(k);return W.mount=k,k.root=W,M?R.root=W:_&&(_.mounted=k,_.mount&&_.mount.mounts.push(k)),W},unmount:v=>{var p=R.lookupPath(v,{follow_mount:!1});if(!R.isMountpoint(p.node))throw new R.ErrnoError(28);var d=p.node,M=d.mounted,V=R.getMounts(M);Object.keys(R.nameTable).forEach(F=>{for(var k=R.nameTable[F];k;){var W=k.name_next;V.includes(k.mount)&&R.destroyNode(k),k=W}}),d.mounted=null;var _=d.mount.mounts.indexOf(M);B(_!==-1),d.mount.mounts.splice(_,1)},lookup:(v,p)=>v.node_ops.lookup(v,p),mknod:(v,p,d)=>{var M=R.lookupPath(v,{parent:!0}),V=M.node,_=Ve.basename(v);if(!_||_==="."||_==="..")throw new R.ErrnoError(28);var F=R.mayCreate(V,_);if(F)throw new R.ErrnoError(F);if(!V.node_ops.mknod)throw new R.ErrnoError(63);return V.node_ops.mknod(V,_,p,d)},create:(v,p)=>(p=p!==void 0?p:438,p&=4095,p|=32768,R.mknod(v,p,0)),mkdir:(v,p)=>(p=p!==void 0?p:511,p&=1023,p|=16384,R.mknod(v,p,0)),mkdirTree:(v,p)=>{for(var d=v.split("/"),M="",V=0;V<d.length;++V)if(!!d[V]){M+="/"+d[V];try{R.mkdir(M,p)}catch(_){if(_.errno!=20)throw _}}},mkdev:(v,p,d)=>(typeof d>"u"&&(d=p,p=438),p|=8192,R.mknod(v,p,d)),symlink:(v,p)=>{if(!er.resolve(v))throw new R.ErrnoError(44);var d=R.lookupPath(p,{parent:!0}),M=d.node;if(!M)throw new R.ErrnoError(44);var V=Ve.basename(p),_=R.mayCreate(M,V);if(_)throw new R.ErrnoError(_);if(!M.node_ops.symlink)throw new R.ErrnoError(63);return M.node_ops.symlink(M,V,v)},rename:(v,p)=>{var d=Ve.dirname(v),M=Ve.dirname(p),V=Ve.basename(v),_=Ve.basename(p),F,k,W;if(F=R.lookupPath(v,{parent:!0}),k=F.node,F=R.lookupPath(p,{parent:!0}),W=F.node,!k||!W)throw new R.ErrnoError(44);if(k.mount!==W.mount)throw new R.ErrnoError(75);var H=R.lookupNode(k,V),ee=er.relative(v,M);if(ee.charAt(0)!==".")throw new R.ErrnoError(28);if(ee=er.relative(p,d),ee.charAt(0)!==".")throw new R.ErrnoError(55);var J;try{J=R.lookupNode(W,_)}catch{}if(H!==J){var q=R.isDir(H.mode),re=R.mayDelete(k,V,q);if(re)throw new R.ErrnoError(re);if(re=J?R.mayDelete(W,_,q):R.mayCreate(W,_),re)throw new R.ErrnoError(re);if(!k.node_ops.rename)throw new R.ErrnoError(63);if(R.isMountpoint(H)||J&&R.isMountpoint(J))throw new R.ErrnoError(10);if(W!==k&&(re=R.nodePermissions(k,"w"),re))throw new R.ErrnoError(re);R.hashRemoveNode(H);try{k.node_ops.rename(H,W,_)}catch(ae){throw ae}finally{R.hashAddNode(H)}}},rmdir:v=>{var p=R.lookupPath(v,{parent:!0}),d=p.node,M=Ve.basename(v),V=R.lookupNode(d,M),_=R.mayDelete(d,M,!0);if(_)throw new R.ErrnoError(_);if(!d.node_ops.rmdir)throw new R.ErrnoError(63);if(R.isMountpoint(V))throw new R.ErrnoError(10);d.node_ops.rmdir(d,M),R.destroyNode(V)},readdir:v=>{var p=R.lookupPath(v,{follow:!0}),d=p.node;if(!d.node_ops.readdir)throw new R.ErrnoError(54);return d.node_ops.readdir(d)},unlink:v=>{var p=R.lookupPath(v,{parent:!0}),d=p.node;if(!d)throw new R.ErrnoError(44);var M=Ve.basename(v),V=R.lookupNode(d,M),_=R.mayDelete(d,M,!1);if(_)throw new R.ErrnoError(_);if(!d.node_ops.unlink)throw new R.ErrnoError(63);if(R.isMountpoint(V))throw new R.ErrnoError(10);d.node_ops.unlink(d,M),R.destroyNode(V)},readlink:v=>{var p=R.lookupPath(v),d=p.node;if(!d)throw new R.ErrnoError(44);if(!d.node_ops.readlink)throw new R.ErrnoError(28);return er.resolve(R.getPath(d.parent),d.node_ops.readlink(d))},stat:(v,p)=>{var d=R.lookupPath(v,{follow:!p}),M=d.node;if(!M)throw new R.ErrnoError(44);if(!M.node_ops.getattr)throw new R.ErrnoError(63);return M.node_ops.getattr(M)},lstat:v=>R.stat(v,!0),chmod:(v,p,d)=>{var M;if(typeof v=="string"){var V=R.lookupPath(v,{follow:!d});M=V.node}else M=v;if(!M.node_ops.setattr)throw new R.ErrnoError(63);M.node_ops.setattr(M,{mode:p&4095|M.mode&-4096,timestamp:Date.now()})},lchmod:(v,p)=>{R.chmod(v,p,!0)},fchmod:(v,p)=>{var d=R.getStream(v);if(!d)throw new R.ErrnoError(8);R.chmod(d.node,p)},chown:(v,p,d,M)=>{var V;if(typeof v=="string"){var _=R.lookupPath(v,{follow:!M});V=_.node}else V=v;if(!V.node_ops.setattr)throw new R.ErrnoError(63);V.node_ops.setattr(V,{timestamp:Date.now()})},lchown:(v,p,d)=>{R.chown(v,p,d,!0)},fchown:(v,p,d)=>{var M=R.getStream(v);if(!M)throw new R.ErrnoError(8);R.chown(M.node,p,d)},truncate:(v,p)=>{if(p<0)throw new R.ErrnoError(28);var d;if(typeof v=="string"){var M=R.lookupPath(v,{follow:!0});d=M.node}else d=v;if(!d.node_ops.setattr)throw new R.ErrnoError(63);if(R.isDir(d.mode))throw new R.ErrnoError(31);if(!R.isFile(d.mode))throw new R.ErrnoError(28);var V=R.nodePermissions(d,"w");if(V)throw new R.ErrnoError(V);d.node_ops.setattr(d,{size:p,timestamp:Date.now()})},ftruncate:(v,p)=>{var d=R.getStream(v);if(!d)throw new R.ErrnoError(8);if((d.flags&2097155)===0)throw new R.ErrnoError(28);R.truncate(d.node,p)},utime:(v,p,d)=>{var M=R.lookupPath(v,{follow:!0}),V=M.node;V.node_ops.setattr(V,{timestamp:Math.max(p,d)})},open:(v,p,d)=>{if(v==="")throw new R.ErrnoError(44);p=typeof p=="string"?R.modeStringToFlags(p):p,d=typeof d>"u"?438:d,p&64?d=d&4095|32768:d=0;var M;if(typeof v=="object")M=v;else{v=Ve.normalize(v);try{var V=R.lookupPath(v,{follow:!(p&131072)});M=V.node}catch{}}var _=!1;if(p&64)if(M){if(p&128)throw new R.ErrnoError(20)}else M=R.mknod(v,d,0),_=!0;if(!M)throw new R.ErrnoError(44);if(R.isChrdev(M.mode)&&(p&=-513),p&65536&&!R.isDir(M.mode))throw new R.ErrnoError(54);if(!_){var F=R.mayOpen(M,p);if(F)throw new R.ErrnoError(F)}p&512&&!_&&R.truncate(M,0),p&=-131713;var k=R.createStream({node:M,path:R.getPath(M),flags:p,seekable:!0,position:0,stream_ops:M.stream_ops,ungotten:[],error:!1});return k.stream_ops.open&&k.stream_ops.open(k),r.logReadFiles&&!(p&1)&&(R.readFiles||(R.readFiles={}),v in R.readFiles||(R.readFiles[v]=1)),k},close:v=>{if(R.isClosed(v))throw new R.ErrnoError(8);v.getdents&&(v.getdents=null);try{v.stream_ops.close&&v.stream_ops.close(v)}catch(p){throw p}finally{R.closeStream(v.fd)}v.fd=null},isClosed:v=>v.fd===null,llseek:(v,p,d)=>{if(R.isClosed(v))throw new R.ErrnoError(8);if(!v.seekable||!v.stream_ops.llseek)throw new R.ErrnoError(70);if(d!=0&&d!=1&&d!=2)throw new R.ErrnoError(28);return v.position=v.stream_ops.llseek(v,p,d),v.ungotten=[],v.position},read:(v,p,d,M,V)=>{if(M<0||V<0)throw new R.ErrnoError(28);if(R.isClosed(v))throw new R.ErrnoError(8);if((v.flags&2097155)===1)throw new R.ErrnoError(8);if(R.isDir(v.node.mode))throw new R.ErrnoError(31);if(!v.stream_ops.read)throw new R.ErrnoError(28);var _=typeof V<"u";if(!_)V=v.position;else if(!v.seekable)throw new R.ErrnoError(70);var F=v.stream_ops.read(v,p,d,M,V);return _||(v.position+=F),F},write:(v,p,d,M,V,_)=>{if(M<0||V<0)throw new R.ErrnoError(28);if(R.isClosed(v))throw new R.ErrnoError(8);if((v.flags&2097155)===0)throw new R.ErrnoError(8);if(R.isDir(v.node.mode))throw new R.ErrnoError(31);if(!v.stream_ops.write)throw new R.ErrnoError(28);v.seekable&&v.flags&1024&&R.llseek(v,0,2);var F=typeof V<"u";if(!F)V=v.position;else if(!v.seekable)throw new R.ErrnoError(70);var k=v.stream_ops.write(v,p,d,M,V,_);return F||(v.position+=k),k},allocate:(v,p,d)=>{if(R.isClosed(v))throw new R.ErrnoError(8);if(p<0||d<=0)throw new R.ErrnoError(28);if((v.flags&2097155)===0)throw new R.ErrnoError(8);if(!R.isFile(v.node.mode)&&!R.isDir(v.node.mode))throw new R.ErrnoError(43);if(!v.stream_ops.allocate)throw new R.ErrnoError(138);v.stream_ops.allocate(v,p,d)},mmap:(v,p,d,M,V)=>{if((M&2)!==0&&(V&2)===0&&(v.flags&2097155)!==2)throw new R.ErrnoError(2);if((v.flags&2097155)===1)throw new R.ErrnoError(2);if(!v.stream_ops.mmap)throw new R.ErrnoError(43);return v.stream_ops.mmap(v,p,d,M,V)},msync:(v,p,d,M,V)=>!v||!v.stream_ops.msync?0:v.stream_ops.msync(v,p,d,M,V),munmap:v=>0,ioctl:(v,p,d)=>{if(!v.stream_ops.ioctl)throw new R.ErrnoError(59);return v.stream_ops.ioctl(v,p,d)},readFile:(v,p={})=>{if(p.flags=p.flags||0,p.encoding=p.encoding||"binary",p.encoding!=="utf8"&&p.encoding!=="binary")throw new Error('Invalid encoding type "'+p.encoding+'"');var d,M=R.open(v,p.flags),V=R.stat(v),_=V.size,F=new Uint8Array(_);return R.read(M,F,0,_,0),p.encoding==="utf8"?d=U(F,0):p.encoding==="binary"&&(d=F),R.close(M),d},writeFile:(v,p,d={})=>{d.flags=d.flags||577;var M=R.open(v,d.flags,d.mode);if(typeof p=="string"){var V=new Uint8Array(Q(p)+1),_=K(p,V,0,V.length);R.write(M,V,0,_,void 0,d.canOwn)}else if(ArrayBuffer.isView(p))R.write(M,p,0,p.byteLength,void 0,d.canOwn);else throw new Error("Unsupported data type");R.close(M)},cwd:()=>R.currentPath,chdir:v=>{var p=R.lookupPath(v,{follow:!0});if(p.node===null)throw new R.ErrnoError(44);if(!R.isDir(p.node.mode))throw new R.ErrnoError(54);var d=R.nodePermissions(p.node,"x");if(d)throw new R.ErrnoError(d);R.currentPath=p.path},createDefaultDirectories:()=>{R.mkdir("/tmp"),R.mkdir("/home"),R.mkdir("/home/web_user")},createDefaultDevices:()=>{R.mkdir("/dev"),R.registerDevice(R.makedev(1,3),{read:()=>0,write:(p,d,M,V,_)=>V}),R.mkdev("/dev/null",R.makedev(1,3)),kr.register(R.makedev(5,0),kr.default_tty_ops),kr.register(R.makedev(6,0),kr.default_tty1_ops),R.mkdev("/dev/tty",R.makedev(5,0)),R.mkdev("/dev/tty1",R.makedev(6,0));var v=Jh();R.createDevice("/dev","random",v),R.createDevice("/dev","urandom",v),R.mkdir("/dev/shm"),R.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{R.mkdir("/proc");var v=R.mkdir("/proc/self");R.mkdir("/proc/self/fd"),R.mount({mount:()=>{var p=R.createNode(v,"fd",16895,73);return p.node_ops={lookup:(d,M)=>{var V=+M,_=R.getStream(V);if(!_)throw new R.ErrnoError(8);var F={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>_.path}};return F.parent=F,F}},p}},{},"/proc/self/fd")},createStandardStreams:()=>{r.stdin?R.createDevice("/dev","stdin",r.stdin):R.symlink("/dev/tty","/dev/stdin"),r.stdout?R.createDevice("/dev","stdout",null,r.stdout):R.symlink("/dev/tty","/dev/stdout"),r.stderr?R.createDevice("/dev","stderr",null,r.stderr):R.symlink("/dev/tty1","/dev/stderr");var v=R.open("/dev/stdin",0),p=R.open("/dev/stdout",1),d=R.open("/dev/stderr",1);B(v.fd===0,"invalid handle for stdin ("+v.fd+")"),B(p.fd===1,"invalid handle for stdout ("+p.fd+")"),B(d.fd===2,"invalid handle for stderr ("+d.fd+")")},ensureErrnoError:()=>{R.ErrnoError||(R.ErrnoError=function(p,d){this.node=d,this.setErrno=function(M){this.errno=M;for(var V in cs)if(cs[V]===M){this.code=V;break}},this.setErrno(p),this.message=ty[p],this.stack&&(Object.defineProperty(this,"stack",{value:new Error().stack,writable:!0}),this.stack=G0(this.stack))},R.ErrnoError.prototype=new Error,R.ErrnoError.prototype.constructor=R.ErrnoError,[44].forEach(v=>{R.genericErrors[v]=new R.ErrnoError(v),R.genericErrors[v].stack="<generic error, no stack>"}))},staticInit:()=>{R.ensureErrnoError(),R.nameTable=new Array(4096),R.mount(he,{},"/"),R.createDefaultDirectories(),R.createDefaultDevices(),R.createSpecialDirectories(),R.filesystems={MEMFS:he}},init:(v,p,d)=>{B(!R.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),R.init.initialized=!0,R.ensureErrnoError(),r.stdin=v||r.stdin,r.stdout=p||r.stdout,r.stderr=d||r.stderr,R.createStandardStreams()},quit:()=>{R.init.initialized=!1,Ty(0);for(var v=0;v<R.streams.length;v++){var p=R.streams[v];!p||R.close(p)}},getMode:(v,p)=>{var d=0;return v&&(d|=365),p&&(d|=146),d},findObject:(v,p)=>{var d=R.analyzePath(v,p);return d.exists?d.object:null},analyzePath:(v,p)=>{try{var d=R.lookupPath(v,{follow:!p});v=d.path}catch{}var M={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var d=R.lookupPath(v,{parent:!0});M.parentExists=!0,M.parentPath=d.path,M.parentObject=d.node,M.name=Ve.basename(v),d=R.lookupPath(v,{follow:!p}),M.exists=!0,M.path=d.path,M.object=d.node,M.name=d.node.name,M.isRoot=d.path==="/"}catch(V){M.error=V.errno}return M},createPath:(v,p,d,M)=>{v=typeof v=="string"?v:R.getPath(v);for(var V=p.split("/").reverse();V.length;){var _=V.pop();if(!!_){var F=Ve.join2(v,_);try{R.mkdir(F)}catch{}v=F}}return F},createFile:(v,p,d,M,V)=>{var _=Ve.join2(typeof v=="string"?v:R.getPath(v),p),F=R.getMode(M,V);return R.create(_,F)},createDataFile:(v,p,d,M,V,_)=>{var F=p;v&&(v=typeof v=="string"?v:R.getPath(v),F=p?Ve.join2(v,p):v);var k=R.getMode(M,V),W=R.create(F,k);if(d){if(typeof d=="string"){for(var H=new Array(d.length),ee=0,J=d.length;ee<J;++ee)H[ee]=d.charCodeAt(ee);d=H}R.chmod(W,k|146);var q=R.open(W,577);R.write(q,d,0,d.length,0,_),R.close(q),R.chmod(W,k)}return W},createDevice:(v,p,d,M)=>{var V=Ve.join2(typeof v=="string"?v:R.getPath(v),p),_=R.getMode(!!d,!!M);R.createDevice.major||(R.createDevice.major=64);var F=R.makedev(R.createDevice.major++,0);return R.registerDevice(F,{open:k=>{k.seekable=!1},close:k=>{M&&M.buffer&&M.buffer.length&&M(10)},read:(k,W,H,ee,J)=>{for(var q=0,re=0;re<ee;re++){var ae;try{ae=d()}catch{throw new R.ErrnoError(29)}if(ae===void 0&&q===0)throw new R.ErrnoError(6);if(ae==null)break;q++,W[H+re]=ae}return q&&(k.node.timestamp=Date.now()),q},write:(k,W,H,ee,J)=>{for(var q=0;q<ee;q++)try{M(W[H+q])}catch{throw new R.ErrnoError(29)}return ee&&(k.node.timestamp=Date.now()),q}}),R.mkdev(V,_,F)},forceLoadFile:v=>{if(v.isDevice||v.isFolder||v.link||v.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(h)try{v.contents=Ba(h(v.url),!0),v.usedBytes=v.contents.length}catch{throw new R.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(v,p,d,M,V)=>{function _(){this.lengthKnown=!1,this.chunks=[]}if(_.prototype.get=function(re){if(!(re>this.length-1||re<0)){var ae=re%this.chunkSize,we=re/this.chunkSize|0;return this.getter(we)[ae]}},_.prototype.setDataGetter=function(re){this.getter=re},_.prototype.cacheLength=function(){var re=new XMLHttpRequest;if(re.open("HEAD",d,!1),re.send(null),!(re.status>=200&&re.status<300||re.status===304))throw new Error("Couldn't load "+d+". Status: "+re.status);var ae=Number(re.getResponseHeader("Content-length")),we,Ae=(we=re.getResponseHeader("Accept-Ranges"))&&we==="bytes",Xe=(we=re.getResponseHeader("Content-Encoding"))&&we==="gzip",X=1024*1024;Ae||(X=ae);var se=(Be,dt)=>{if(Be>dt)throw new Error("invalid range ("+Be+", "+dt+") or no bytes requested!");if(dt>ae-1)throw new Error("only "+ae+" bytes available! programmer error!");var Ye=new XMLHttpRequest;if(Ye.open("GET",d,!1),ae!==X&&Ye.setRequestHeader("Range","bytes="+Be+"-"+dt),Ye.responseType="arraybuffer",Ye.overrideMimeType&&Ye.overrideMimeType("text/plain; charset=x-user-defined"),Ye.send(null),!(Ye.status>=200&&Ye.status<300||Ye.status===304))throw new Error("Couldn't load "+d+". Status: "+Ye.status);return Ye.response!==void 0?new Uint8Array(Ye.response||[]):Ba(Ye.responseText||"",!0)},Ze=this;Ze.setDataGetter(Be=>{var dt=Be*X,Ye=(Be+1)*X-1;if(Ye=Math.min(Ye,ae-1),typeof Ze.chunks[Be]>"u"&&(Ze.chunks[Be]=se(dt,Ye)),typeof Ze.chunks[Be]>"u")throw new Error("doXHR failed!");return Ze.chunks[Be]}),(Xe||!ae)&&(X=ae=1,ae=this.getter(0).length,X=ae,x("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=ae,this._chunkSize=X,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!o)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var F=new _;Object.defineProperties(F,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var k={isDevice:!1,contents:F}}else var k={isDevice:!1,url:d};var W=R.createFile(v,p,k,M,V);k.contents?W.contents=k.contents:k.url&&(W.contents=null,W.url=k.url),Object.defineProperties(W,{usedBytes:{get:function(){return this.contents.length}}});var H={},ee=Object.keys(W.stream_ops);ee.forEach(q=>{var re=W.stream_ops[q];H[q]=function(){return R.forceLoadFile(W),re.apply(null,arguments)}});function J(q,re,ae,we,Ae){var Xe=q.node.contents;if(Ae>=Xe.length)return 0;var X=Math.min(Xe.length-Ae,we);if(B(X>=0),Xe.slice)for(var se=0;se<X;se++)re[ae+se]=Xe[Ae+se];else for(var se=0;se<X;se++)re[ae+se]=Xe.get(Ae+se);return X}return H.read=(q,re,ae,we,Ae)=>(R.forceLoadFile(W),J(q,re,ae,we,Ae)),H.mmap=(q,re,ae,we,Ae)=>{R.forceLoadFile(W);var Xe=Pf();if(!Xe)throw new R.ErrnoError(48);return J(q,ne,Xe,re,ae),{ptr:Xe,allocated:!0}},W.stream_ops=H,W},createPreloadedFile:(v,p,d,M,V,_,F,k,W,H)=>{var ee=p?er.resolve(Ve.join2(v,p)):v,J=Sf("cp "+ee);function q(re){function ae(we){H&&H(),k||R.createDataFile(v,p,we,M,V,W),_&&_(),Ma(J)}Browser.handledByPreloadPlugin(re,ee,ae,()=>{F&&F(),Ma(J)})||ae(re)}Yi(J),typeof d=="string"?ey(d,re=>q(re),F):q(d)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(v,p,d)=>{p=p||(()=>{}),d=d||(()=>{});var M=R.indexedDB();try{var V=M.open(R.DB_NAME(),R.DB_VERSION)}catch(_){return d(_)}V.onupgradeneeded=()=>{x("creating db");var _=V.result;_.createObjectStore(R.DB_STORE_NAME)},V.onsuccess=()=>{var _=V.result,F=_.transaction([R.DB_STORE_NAME],"readwrite"),k=F.objectStore(R.DB_STORE_NAME),W=0,H=0,ee=v.length;function J(){H==0?p():d()}v.forEach(q=>{var re=k.put(R.analyzePath(q).object.contents,q);re.onsuccess=()=>{W++,W+H==ee&&J()},re.onerror=()=>{H++,W+H==ee&&J()}}),F.onerror=d},V.onerror=d},loadFilesFromDB:(v,p,d)=>{p=p||(()=>{}),d=d||(()=>{});var M=R.indexedDB();try{var V=M.open(R.DB_NAME(),R.DB_VERSION)}catch(_){return d(_)}V.onupgradeneeded=d,V.onsuccess=()=>{var _=V.result;try{var F=_.transaction([R.DB_STORE_NAME],"readonly")}catch(q){d(q);return}var k=F.objectStore(R.DB_STORE_NAME),W=0,H=0,ee=v.length;function J(){H==0?p():d()}v.forEach(q=>{var re=k.get(q);re.onsuccess=()=>{R.analyzePath(q).exists&&R.unlink(q),R.createDataFile(Ve.dirname(q),Ve.basename(q),re.result,!0,!0,!0),W++,W+H==ee&&J()},re.onerror=()=>{H++,W+H==ee&&J()}}),F.onerror=d},V.onerror=d},absolutePath:()=>{be("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder:()=>{be("FS.createFolder has been removed; use FS.mkdir instead")},createLink:()=>{be("FS.createLink has been removed; use FS.symlink instead")},joinPath:()=>{be("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc:()=>{be("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath:()=>{be("FS.standardizePath has been removed; use PATH.normalize instead")}},Fr={DEFAULT_POLLMASK:5,calculateAt:function(v,p,d){if(Ve.isAbs(p))return p;var M;if(v===-100)M=R.cwd();else{var V=R.getStream(v);if(!V)throw new R.ErrnoError(8);M=V.path}if(p.length==0){if(!d)throw new R.ErrnoError(44);return M}return Ve.join2(M,p)},doStat:function(v,p,d){try{var M=v(p)}catch(V){if(V&&V.node&&Ve.normalize(p)!==Ve.normalize(R.getPath(V.node)))return-54;throw V}return ie[d>>2]=M.dev,ie[d+4>>2]=0,ie[d+8>>2]=M.ino,ie[d+12>>2]=M.mode,ie[d+16>>2]=M.nlink,ie[d+20>>2]=M.uid,ie[d+24>>2]=M.gid,ie[d+28>>2]=M.rdev,ie[d+32>>2]=0,Zt=[M.size>>>0,(rt=M.size,+Math.abs(rt)>=1?rt>0?(Math.min(+Math.floor(rt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((rt-+(~~rt>>>0))/4294967296)>>>0:0)],ie[d+40>>2]=Zt[0],ie[d+44>>2]=Zt[1],ie[d+48>>2]=4096,ie[d+52>>2]=M.blocks,ie[d+56>>2]=M.atime.getTime()/1e3|0,ie[d+60>>2]=0,ie[d+64>>2]=M.mtime.getTime()/1e3|0,ie[d+68>>2]=0,ie[d+72>>2]=M.ctime.getTime()/1e3|0,ie[d+76>>2]=0,Zt=[M.ino>>>0,(rt=M.ino,+Math.abs(rt)>=1?rt>0?(Math.min(+Math.floor(rt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((rt-+(~~rt>>>0))/4294967296)>>>0:0)],ie[d+80>>2]=Zt[0],ie[d+84>>2]=Zt[1],0},doMsync:function(v,p,d,M,V){var _=ue.slice(v,v+d);R.msync(p,_,V,d,M)},varargs:void 0,get:function(){B(Fr.varargs!=null),Fr.varargs+=4;var v=ie[Fr.varargs-4>>2];return v},getStr:function(v){var p=G(v);return p},getStreamFromFD:function(v){var p=R.getStream(v);if(!p)throw new R.ErrnoError(8);return p}};function ry(v,p){var d=0;return Wn().forEach(function(M,V){var _=p+d;Se[v+V*4>>2]=_,tt(M,_),d+=M.length+1}),0}function ny(v,p){var d=Wn();Se[v>>2]=d.length;var M=0;return d.forEach(function(V){M+=V.length+1}),Se[p>>2]=M,0}function ay(v){try{var p=Fr.getStreamFromFD(v);return R.close(p),0}catch(d){if(typeof R>"u"||!(d instanceof R.ErrnoError))throw d;return d.errno}}function iy(v,p,d,M){for(var V=0,_=0;_<d;_++){var F=Se[p>>2],k=Se[p+4>>2];p+=8;var W=R.read(v,ne,F,k,M);if(W<0)return-1;if(V+=W,W<k)break}return V}function sy(v,p,d,M){try{var V=Fr.getStreamFromFD(v),_=iy(V,p,d);return ie[M>>2]=_,0}catch(F){if(typeof R>"u"||!(F instanceof R.ErrnoError))throw F;return F.errno}}function oy(v,p){return B(v==v>>>0||v==(v|0)),B(p===(p|0)),p+2097152>>>0<4194305-!!v?(v>>>0)+p*4294967296:NaN}function fy(v,p,d,M,V){try{var _=oy(p,d);if(isNaN(_))return 61;var F=Fr.getStreamFromFD(v);return R.llseek(F,_,M),Zt=[F.position>>>0,(rt=F.position,+Math.abs(rt)>=1?rt>0?(Math.min(+Math.floor(rt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((rt-+(~~rt>>>0))/4294967296)>>>0:0)],ie[V>>2]=Zt[0],ie[V+4>>2]=Zt[1],F.getdents&&_===0&&M===0&&(F.getdents=null),0}catch(k){if(typeof R>"u"||!(k instanceof R.ErrnoError))throw k;return k.errno}}function uy(v,p,d,M){for(var V=0,_=0;_<d;_++){var F=Se[p>>2],k=Se[p+4>>2];p+=8;var W=R.write(v,ne,F,k,M);if(W<0)return-1;V+=W}return V}function cy(v,p,d,M){try{var V=Fr.getStreamFromFD(v),_=uy(V,p,d);return Se[M>>2]=_,0}catch(F){if(typeof R>"u"||!(F instanceof R.ErrnoError))throw F;return F.errno}}function gy(v){}function ba(v){return v%4===0&&(v%100!==0||v%400===0)}function vy(v,p){for(var d=0,M=0;M<=p;d+=v[M++]);return d}var Wf=[31,29,31,30,31,30,31,31,30,31,30,31],zf=[31,28,31,30,31,30,31,31,30,31,30,31];function ly(v,p){for(var d=new Date(v.getTime());p>0;){var M=ba(d.getFullYear()),V=d.getMonth(),_=(M?Wf:zf)[V];if(p>_-d.getDate())p-=_-d.getDate()+1,d.setDate(1),V<11?d.setMonth(V+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else return d.setDate(d.getDate()+p),d}return d}function py(v,p,d,M){var V=ie[M+40>>2],_={tm_sec:ie[M>>2],tm_min:ie[M+4>>2],tm_hour:ie[M+8>>2],tm_mday:ie[M+12>>2],tm_mon:ie[M+16>>2],tm_year:ie[M+20>>2],tm_wday:ie[M+24>>2],tm_yday:ie[M+28>>2],tm_isdst:ie[M+32>>2],tm_gmtoff:ie[M+36>>2],tm_zone:V?G(V):""},F=G(d),k={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var W in k)F=F.replace(new RegExp(W,"g"),k[W]);var H=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ee=["January","February","March","April","May","June","July","August","September","October","November","December"];function J(X,se,Ze){for(var Be=typeof X=="number"?X.toString():X||"";Be.length<se;)Be=Ze[0]+Be;return Be}function q(X,se){return J(X,se,"0")}function re(X,se){function Ze(dt){return dt<0?-1:dt>0?1:0}var Be;return(Be=Ze(X.getFullYear()-se.getFullYear()))===0&&(Be=Ze(X.getMonth()-se.getMonth()))===0&&(Be=Ze(X.getDate()-se.getDate())),Be}function ae(X){switch(X.getDay()){case 0:return new Date(X.getFullYear()-1,11,29);case 1:return X;case 2:return new Date(X.getFullYear(),0,3);case 3:return new Date(X.getFullYear(),0,2);case 4:return new Date(X.getFullYear(),0,1);case 5:return new Date(X.getFullYear()-1,11,31);case 6:return new Date(X.getFullYear()-1,11,30)}}function we(X){var se=ly(new Date(X.tm_year+1900,0,1),X.tm_yday),Ze=new Date(se.getFullYear(),0,4),Be=new Date(se.getFullYear()+1,0,4),dt=ae(Ze),Ye=ae(Be);return re(dt,se)<=0?re(Ye,se)<=0?se.getFullYear()+1:se.getFullYear():se.getFullYear()-1}var Ae={"%a":function(X){return H[X.tm_wday].substring(0,3)},"%A":function(X){return H[X.tm_wday]},"%b":function(X){return ee[X.tm_mon].substring(0,3)},"%B":function(X){return ee[X.tm_mon]},"%C":function(X){var se=X.tm_year+1900;return q(se/100|0,2)},"%d":function(X){return q(X.tm_mday,2)},"%e":function(X){return J(X.tm_mday,2," ")},"%g":function(X){return we(X).toString().substring(2)},"%G":function(X){return we(X)},"%H":function(X){return q(X.tm_hour,2)},"%I":function(X){var se=X.tm_hour;return se==0?se=12:se>12&&(se-=12),q(se,2)},"%j":function(X){return q(X.tm_mday+vy(ba(X.tm_year+1900)?Wf:zf,X.tm_mon-1),3)},"%m":function(X){return q(X.tm_mon+1,2)},"%M":function(X){return q(X.tm_min,2)},"%n":function(){return`
`},"%p":function(X){return X.tm_hour>=0&&X.tm_hour<12?"AM":"PM"},"%S":function(X){return q(X.tm_sec,2)},"%t":function(){return"	"},"%u":function(X){return X.tm_wday||7},"%U":function(X){var se=X.tm_yday+7-X.tm_wday;return q(Math.floor(se/7),2)},"%V":function(X){var se=Math.floor((X.tm_yday+7-(X.tm_wday+6)%7)/7);if((X.tm_wday+371-X.tm_yday-2)%7<=2&&se++,se){if(se==53){var Be=(X.tm_wday+371-X.tm_yday)%7;Be!=4&&(Be!=3||!ba(X.tm_year))&&(se=1)}}else{se=52;var Ze=(X.tm_wday+7-X.tm_yday-1)%7;(Ze==4||Ze==5&&ba(X.tm_year%400-1))&&se++}return q(se,2)},"%w":function(X){return X.tm_wday},"%W":function(X){var se=X.tm_yday+7-(X.tm_wday+6)%7;return q(Math.floor(se/7),2)},"%y":function(X){return(X.tm_year+1900).toString().substring(2)},"%Y":function(X){return X.tm_year+1900},"%z":function(X){var se=X.tm_gmtoff,Ze=se>=0;return se=Math.abs(se)/60,se=se/60*100+se%60,(Ze?"+":"-")+String("0000"+se).slice(-4)},"%Z":function(X){return X.tm_zone},"%%":function(){return"%"}};F=F.replace(/%%/g,"\0\0");for(var W in Ae)F.includes(W)&&(F=F.replace(new RegExp(W,"g"),Ae[W](_)));F=F.replace(/\0\0/g,"%");var Xe=Ba(F,!1);return Xe.length>p?0:(ze(Xe,v),Xe.length-1)}function hy(v,p,d,M){return py(v,p,d,M)}$0(),nn=r.BindingError=Ji(Error,"BindingError"),Of=r.InternalError=Ji(Error,"InternalError"),oh(),eh(),yh(),_f=r.UnboundTypeError=Ji(Error,"UnboundTypeError"),Dh();var jf=function(v,p,d,M){v||(v=this),this.parent=v,this.mount=v.mount,this.mounted=null,this.id=R.nextInode++,this.name=p,this.mode=d,this.node_ops={},this.stream_ops={},this.rdev=M},ka=365,Fa=146;Object.defineProperties(jf.prototype,{read:{get:function(){return(this.mode&ka)===ka},set:function(v){v?this.mode|=ka:this.mode&=~ka}},write:{get:function(){return(this.mode&Fa)===Fa},set:function(v){v?this.mode|=Fa:this.mode&=~Fa}},isFolder:{get:function(){return R.isDir(this.mode)}},isDevice:{get:function(){return R.isChrdev(this.mode)}}}),R.FSNode=jf,R.staticInit(),cs={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};function Ba(v,p,d){var M=d>0?d:Q(v)+1,V=new Array(M),_=K(v,V,0,V.length);return p&&(V.length=_),V}function yy(){b("fetchSettings")}var $f={__assert_fail:A0,__cxa_allocate_exception:P0,__cxa_throw:z0,_embind_register_bigint:j0,_embind_register_bool:X0,_embind_register_class:Eh,_embind_register_class_constructor:xh,_embind_register_class_function:wh,_embind_register_emval:mh,_embind_register_float:Lh,_embind_register_integer:_h,_embind_register_memory_view:bh,_embind_register_std_string:kh,_embind_register_std_wstring:Fh,_embind_register_void:Bh,_emval_as:Nh,_emval_call_void_method:Gh,_emval_decref:ss,_emval_get_method_caller:Wh,_emval_get_property:zh,_emval_incref:jh,_emval_new_cstring:$h,_emval_run_destructors:Hh,_emval_take_value:Kh,abort:Xh,emscripten_get_heap_max:Yh,emscripten_memcpy_big:Ih,emscripten_resize_heap:Zh,environ_get:ry,environ_sizes_get:ny,fd_close:ay,fd_read:sy,fd_seek:fy,fd_write:cy,setTempRet0:gy,strftime_l:hy};N0(),r.___wasm_call_ctors=ft("__wasm_call_ctors");var gr=r._free=ft("free"),gs=r._malloc=ft("malloc"),dy=r.___getTypeName=ft("__getTypeName");r.___embind_register_native_and_builtin_types=ft("__embind_register_native_and_builtin_types"),r.___errno_location=ft("__errno_location");var Ty=r._fflush=ft("fflush"),Hf=r._emscripten_stack_init=function(){return(Hf=r._emscripten_stack_init=r.asm.emscripten_stack_init).apply(null,arguments)};r._emscripten_stack_get_free=function(){return(r._emscripten_stack_get_free=r.asm.emscripten_stack_get_free).apply(null,arguments)},r._emscripten_stack_get_base=function(){return(r._emscripten_stack_get_base=r.asm.emscripten_stack_get_base).apply(null,arguments)};var vs=r._emscripten_stack_get_end=function(){return(vs=r._emscripten_stack_get_end=r.asm.emscripten_stack_get_end).apply(null,arguments)},Cy=r.stackSave=ft("stackSave"),Sy=r.stackRestore=ft("stackRestore"),Kf=r.stackAlloc=ft("stackAlloc"),Ey=r.___cxa_is_pointer_type=ft("__cxa_is_pointer_type");r.dynCall_jiji=ft("dynCall_jiji"),r.dynCall_viijii=ft("dynCall_viijii"),r.dynCall_iiiiij=ft("dynCall_iiiiij"),r.dynCall_iiiiijj=ft("dynCall_iiiiijj"),r.dynCall_iiiiiijj=ft("dynCall_iiiiiijj"),r.ccall=I,O("cwrap",!1),O("allocate",!1),O("UTF8ArrayToString",!1),O("UTF8ToString",!1),O("stringToUTF8Array",!1),O("stringToUTF8",!1),O("lengthBytesUTF8",!1),O("addOnPreRun",!1),O("addOnInit",!1),O("addOnPreMain",!1),O("addOnExit",!1),O("addOnPostRun",!1),O("addRunDependency",!0),O("removeRunDependency",!0),O("FS_createFolder",!1),O("FS_createPath",!0),O("FS_createDataFile",!0),O("FS_createPreloadedFile",!0),O("FS_createLazyFile",!0),O("FS_createLink",!1),O("FS_createDevice",!0),O("FS_unlink",!0),O("getLEB",!1),O("getFunctionTables",!1),O("alignFunctionTables",!1),O("registerFunctions",!1),O("addFunction",!1),O("removeFunction",!1),O("prettyPrint",!1),O("getCompilerSetting",!1),O("print",!1),O("printErr",!1),O("getTempRet0",!1),O("setTempRet0",!1),O("callMain",!1),O("abort",!1),O("keepRuntimeAlive",!1),O("wasmMemory",!1),O("warnOnce",!1),O("stackSave",!1),O("stackRestore",!1),O("stackAlloc",!1),O("AsciiToString",!1),O("stringToAscii",!1),O("UTF16ToString",!1),O("stringToUTF16",!1),O("lengthBytesUTF16",!1),O("UTF32ToString",!1),O("stringToUTF32",!1),O("lengthBytesUTF32",!1),O("allocateUTF8",!1),O("allocateUTF8OnStack",!1),O("ExitStatus",!1),O("intArrayFromString",!1),O("intArrayToString",!1),O("writeStringToMemory",!1),O("writeArrayToMemory",!1),O("writeAsciiToMemory",!1),r.writeStackCookie=yf,r.checkStackCookie=Oa,O("ptrToString",!1),O("zeroMemory",!1),O("stringToNewUTF8",!1),O("getHeapMax",!1),O("emscripten_realloc_buffer",!1),O("ENV",!1),O("ERRNO_CODES",!1),O("ERRNO_MESSAGES",!1),O("setErrNo",!1),O("inetPton4",!1),O("inetNtop4",!1),O("inetPton6",!1),O("inetNtop6",!1),O("readSockaddr",!1),O("writeSockaddr",!1),O("DNS",!1),O("getHostByName",!1),O("Protocols",!1),O("Sockets",!1),O("getRandomDevice",!1),O("traverseStack",!1),O("UNWIND_CACHE",!1),O("convertPCtoSourceLocation",!1),O("readAsmConstArgsArray",!1),O("readAsmConstArgs",!1),O("mainThreadEM_ASM",!1),O("jstoi_q",!1),O("jstoi_s",!1),O("getExecutableName",!1),O("listenOnce",!1),O("autoResumeAudioContext",!1),O("dynCallLegacy",!1),O("getDynCaller",!1),O("dynCall",!1),O("handleException",!1),O("runtimeKeepalivePush",!1),O("runtimeKeepalivePop",!1),O("callUserCallback",!1),O("maybeExit",!1),O("safeSetTimeout",!1),O("asmjsMangle",!1),O("asyncLoad",!1),O("alignMemory",!1),O("mmapAlloc",!1),O("writeI53ToI64",!1),O("writeI53ToI64Clamped",!1),O("writeI53ToI64Signaling",!1),O("writeI53ToU64Clamped",!1),O("writeI53ToU64Signaling",!1),O("readI53FromI64",!1),O("readI53FromU64",!1),O("convertI32PairToI53",!1),O("convertI32PairToI53Checked",!1),O("convertU32PairToI53",!1),O("reallyNegative",!1),O("unSign",!1),O("strLen",!1),O("reSign",!1),O("formatString",!1),O("setValue",!1),O("getValue",!1),O("PATH",!1),O("PATH_FS",!1),O("SYSCALLS",!1),O("getSocketFromFD",!1),O("getSocketAddress",!1),O("JSEvents",!1),O("registerKeyEventCallback",!1),O("specialHTMLTargets",!1),O("maybeCStringToJsString",!1),O("findEventTarget",!1),O("findCanvasEventTarget",!1),O("getBoundingClientRect",!1),O("fillMouseEventData",!1),O("registerMouseEventCallback",!1),O("registerWheelEventCallback",!1),O("registerUiEventCallback",!1),O("registerFocusEventCallback",!1),O("fillDeviceOrientationEventData",!1),O("registerDeviceOrientationEventCallback",!1),O("fillDeviceMotionEventData",!1),O("registerDeviceMotionEventCallback",!1),O("screenOrientation",!1),O("fillOrientationChangeEventData",!1),O("registerOrientationChangeEventCallback",!1),O("fillFullscreenChangeEventData",!1),O("registerFullscreenChangeEventCallback",!1),O("JSEvents_requestFullscreen",!1),O("JSEvents_resizeCanvasForFullscreen",!1),O("registerRestoreOldStyle",!1),O("hideEverythingExceptGivenElement",!1),O("restoreHiddenElements",!1),O("setLetterbox",!1),O("currentFullscreenStrategy",!1),O("restoreOldWindowedStyle",!1),O("softFullscreenResizeWebGLRenderTarget",!1),O("doRequestFullscreen",!1),O("fillPointerlockChangeEventData",!1),O("registerPointerlockChangeEventCallback",!1),O("registerPointerlockErrorEventCallback",!1),O("requestPointerLock",!1),O("fillVisibilityChangeEventData",!1),O("registerVisibilityChangeEventCallback",!1),O("registerTouchEventCallback",!1),O("fillGamepadEventData",!1),O("registerGamepadEventCallback",!1),O("registerBeforeUnloadEventCallback",!1),O("fillBatteryEventData",!1),O("battery",!1),O("registerBatteryEventCallback",!1),O("setCanvasElementSize",!1),O("getCanvasElementSize",!1),O("demangle",!1),O("demangleAll",!1),O("jsStackTrace",!1),O("stackTrace",!1),O("getEnvStrings",!1),O("checkWasiClock",!1),O("doReadv",!1),O("doWritev",!1),O("dlopenMissingError",!1),O("setImmediateWrapped",!1),O("clearImmediateWrapped",!1),O("polyfillSetImmediate",!1),O("uncaughtExceptionCount",!1),O("exceptionLast",!1),O("exceptionCaught",!1),O("ExceptionInfo",!1),O("exception_addRef",!1),O("exception_decRef",!1),O("Browser",!1),O("setMainLoop",!1),O("wget",!1),O("FS",!1),O("MEMFS",!1),O("TTY",!1),O("PIPEFS",!1),O("SOCKFS",!1),O("_setNetworkCallback",!1),O("tempFixedLengthArray",!1),O("miniTempWebGLFloatBuffers",!1),O("heapObjectForWebGLType",!1),O("heapAccessShiftForWebGLHeap",!1),O("GL",!1),O("emscriptenWebGLGet",!1),O("computeUnpackAlignedImageSize",!1),O("emscriptenWebGLGetTexPixelData",!1),O("emscriptenWebGLGetUniform",!1),O("webglGetUniformLocation",!1),O("webglPrepareUniformLocationsBeforeFirstUse",!1),O("webglGetLeftBracePos",!1),O("emscriptenWebGLGetVertexAttrib",!1),O("writeGLArray",!1),O("AL",!1),O("SDL_unicode",!1),O("SDL_ttfContext",!1),O("SDL_audio",!1),O("SDL",!1),O("SDL_gfx",!1),O("GLUT",!1),O("EGL",!1),O("GLFW_Window",!1),O("GLFW",!1),O("GLEW",!1),O("IDBStore",!1),O("runAndAbortIfError",!1),O("InternalError",!1),O("BindingError",!1),O("UnboundTypeError",!1),O("PureVirtualError",!1),O("init_embind",!1),O("throwInternalError",!1),O("throwBindingError",!1),O("throwUnboundTypeError",!1),O("ensureOverloadTable",!1),O("exposePublicSymbol",!1),O("replacePublicSymbol",!1),O("extendError",!1),O("createNamedFunction",!1),O("registeredInstances",!1),O("getBasestPointer",!1),O("registerInheritedInstance",!1),O("unregisterInheritedInstance",!1),O("getInheritedInstance",!1),O("getInheritedInstanceCount",!1),O("getLiveInheritedInstances",!1),O("registeredTypes",!1),O("awaitingDependencies",!1),O("typeDependencies",!1),O("registeredPointers",!1),O("registerType",!1),O("whenDependentTypesAreResolved",!1),O("embind_charCodes",!1),O("embind_init_charCodes",!1),O("readLatin1String",!1),O("getTypeName",!1),O("heap32VectorToArray",!1),O("requireRegisteredType",!1),O("getShiftFromSize",!1),O("integerReadValueFromPointer",!1),O("enumReadValueFromPointer",!1),O("floatReadValueFromPointer",!1),O("simpleReadValueFromPointer",!1),O("runDestructors",!1),O("new_",!1),O("craftInvokerFunction",!1),O("embind__requireFunction",!1),O("tupleRegistrations",!1),O("structRegistrations",!1),O("genericPointerToWireType",!1),O("constNoSmartPtrRawPointerToWireType",!1),O("nonConstNoSmartPtrRawPointerToWireType",!1),O("init_RegisteredPointer",!1),O("RegisteredPointer",!1),O("RegisteredPointer_getPointee",!1),O("RegisteredPointer_destructor",!1),O("RegisteredPointer_deleteObject",!1),O("RegisteredPointer_fromWireType",!1),O("runDestructor",!1),O("releaseClassHandle",!1),O("finalizationRegistry",!1),O("detachFinalizer_deps",!1),O("detachFinalizer",!1),O("attachFinalizer",!1),O("makeClassHandle",!1),O("init_ClassHandle",!1),O("ClassHandle",!1),O("ClassHandle_isAliasOf",!1),O("throwInstanceAlreadyDeleted",!1),O("ClassHandle_clone",!1),O("ClassHandle_delete",!1),O("deletionQueue",!1),O("ClassHandle_isDeleted",!1),O("ClassHandle_deleteLater",!1),O("flushPendingDeletes",!1),O("delayFunction",!1),O("setDelayFunction",!1),O("RegisteredClass",!1),O("shallowCopyInternalPointer",!1),O("downcastPointer",!1),O("upcastPointer",!1),O("validateThis",!1),O("char_0",!1),O("char_9",!1),O("makeLegalFunctionName",!1),O("emval_handle_array",!1),O("emval_free_list",!1),O("emval_symbols",!1),O("init_emval",!1),O("count_emval_handles",!1),O("get_first_emval",!1),O("getStringOrSymbol",!1),O("Emval",!1),O("emval_newers",!1),O("craftEmvalAllocator",!1),O("emval_get_global",!1),O("emval_methodCallers",!1),O("emval_registeredMethods",!1),P("ALLOC_NORMAL",!1),P("ALLOC_STACK",!1);var Na;function xy(v){this.name="ExitStatus",this.message="Program terminated with exit("+v+")",this.status=v}Fn=function v(){Na||ls(),Na||(Fn=v)};function wy(){Hf(),yf()}function ls(v){if(Vr>0||(wy(),R0(),Vr>0))return;function p(){Na||(Na=!0,r.calledRun=!0,!j&&(L0(),n(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),B(!r._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),V0()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),p()},1)):p(),Oa()}if(r.run=ls,r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return ls(),r.ready}})();let WL=async()=>new Promise((t,e)=>{PL().then(r=>{t(r)})});function hg(t){let e,r,n;return{c(){e=Zn("div"),e.innerHTML="<h1>Drop draped mesh .obj file</h1>",zr(e,"class","drop-handler svelte-1apv8mb")},m(a,i){bp(a,e,i),r||(n=Mo(e,"dragleave",t[8]),r=!0)},p:ha,d(a){a&&sf(e),r=!1,n()}}}function zL(t){let e,r,n,a,i,s=t[2]?"drag control point ":"add control point",f,o,u,g,c,l=t[3]&&hg(t);return{c(){e=Zn("main"),r=Zn("div"),n=Zn("div"),n.textContent="Press 'space' to change mode",a=Kc(),i=Zn("div"),f=kp(s),o=Kc(),l&&l.c(),zr(n,"class","svelte-1apv8mb"),zr(i,"class","svelte-1apv8mb"),zr(r,"class","message svelte-1apv8mb"),zr(e,"style",u="--theme-background1: rgb("+t[1][0]+", "+t[1][1]+", "+t[1][2]+" ); --theme-background2 : rgb("+t[4][0]+", "+t[4][1]+", "+t[4][2]+");"),zr(e,"class","svelte-1apv8mb")},m(h,y){bp(h,e,y),vn(e,r),vn(r,n),vn(r,a),vn(r,i),vn(i,f),vn(e,o),l&&l.m(e,null),t[9](e),g||(c=[Mo(e,"dragover",t[10]),Mo(e,"drop",t[11])],g=!0)},p(h,[y]){y&4&&s!==(s=h[2]?"drag control point ":"add control point")&&DD(f,s),h[3]?l?l.p(h,y):(l=hg(h),l.c(),l.m(e,null)):l&&(l.d(1),l=null),y&2&&u!==(u="--theme-background1: rgb("+h[1][0]+", "+h[1][1]+", "+h[1][2]+" ); --theme-background2 : rgb("+h[4][0]+", "+h[4][1]+", "+h[4][2]+");")&&zr(e,"style",u)},i:ha,o:ha,d(h){h&&sf(e),l&&l.d(),t[9](null),g=!1,wa(c)}}}function jL(t,e,r){let n,a=jR.newInstance({background:[1,0,0,0]}),i=[100,100,100],s=[200,200,200],f,o,u,g,c,l=1e3/60,h,y,C=!1,T=.5,E,w=!1;RD(async()=>{a.setContainer(n),a.getRenderWindow().render(),a.resize(),await x("resources/decimated-knight.obj");let U=await WL();E=new U.Simulator,a.getInteractor().onLeftButtonPress(G=>{S(G)}),a.getInteractor().onMouseMove(G=>{m(G)}),a.getInteractor().onLeftButtonRelease(G=>{D()}),a.getInteractor().onKeyDown(G=>{b(G)})});const x=async U=>{let G=a.getRenderWindow(),K=a.getRenderer();f=await pg(U),o=BL(f),o.getProperty().setColor(1,1,0),K.addActor(o),u=fr.newInstance(),u.getPointData().addArray(_e.newInstance({values:new Int32Array,name:"Reference"}));const Z=AL.newInstance();Z.setInputData(u),g=Dr.newInstance(),g.setMapper(Z),g.getProperty().setColor(1,0,0),K.addActor(g),K.resetCamera(),G.render(),N()},S=U=>{const G=a.getRenderWindow(),K=a.getRenderer(),Z=a.getInteractor().getInteractorStyle();c.pick([U.position.x,U.position.y,U.position.z],K);const Q=c.getPointId();if(c.getActors().length!==0){if(Z.endRotate(),Z.endPan(),!C){const oe=f.getPoints().getPoint(Q);T=K.worldToNormalizedDisplay(...oe)[2];let fe=u.getPoints().getData();fe=new Float32Array([...fe,...oe]),u.getPoints().setData(fe,3),u.getPointData().getArray("Reference").insertNextTuple([Q]),u.modified()}G.render()}},m=U=>{if(!C||c.getActors().length===0)return;const G=a.getRenderer(),K=c.getPointId(),Z=[U.position.x,U.position.y,U.position.z],Q=a.getInteractor().getView(),oe=Q.displayToNormalizedDisplay(...Z),ce=Q.getViewportSize(G),fe=G.normalizedDisplayToWorld(oe[0],oe[1],T,ce[0]/ce[1]);u.getPoints().setTuple(K,fe),u.getPoints().setData(u.getPoints().getData(),3),u.modified(),G.resetCameraClippingRange()},D=U=>{!C||c.getActors().length!==0&&(c=og.newInstance(),c.setPickFromList(!0),c.initializePickList(),c.addPickList(g))},b=U=>{U.key===" "&&r(2,C=!C),N()},N=()=>{c=og.newInstance(),c.setPickFromList(!0),c.initializePickList();const U=o.getBounds(),G=U[1]-U[0],K=U[2]-U[3],Z=U[4]-U[5],Q=Math.sqrt(G*G+K*K+Z*Z);if(g.getMapper().setRadius(Q/50),C){const oe=f.getPoints().getData(),ce=f.getPolys().getData(),fe=u.getPointData().getArray("Reference").getData();E.Initialize(oe,ce,fe),h=Date.now(),y=requestAnimationFrame(O),c.addPickList(g),r(1,i=[100,100,255])}else cancelAnimationFrame(y),c.addPickList(o),r(1,i=[100,100,100]);a.resize()},P=()=>{const U=u.getPoints().getData(),G=f.getPoints().getData();let K=E.SingleIteration(U,G);f.getPoints().setData(K),f.modified()},O=()=>{y=requestAnimationFrame(O);let U=Date.now(),G=U-h;G>l&&(h=U-G%l,P(),a.getRenderWindow().render())},A=U=>{U.preventDefault(),r(3,w=!0)},z=async U=>{U.preventDefault();const G=U.dataTransfer.files[0];if(!G)return;const K=a.getRenderer(),Z=a.getRenderWindow(),Q=G.name.split(".").pop();Q==="ply"?f=await bL(G):Q==="obj"&&(f=await pg(G)),f.getPointData().removeArray("Normals"),o.getMapper().setInputData(f),u.getPoints().setData(new Float32Array,3),u.getPointData().getArray("Reference").setData(new Int16Array),r(2,C=!1),N(),r(3,w=!1),K.resetCamera(),Z.render()},j=U=>{U.preventDefault(),r(3,w=!1)},B=U=>{j(U)};function Y(U){Do[U?"unshift":"push"](()=>{n=U,r(0,n)})}return[n,i,C,w,s,A,z,j,B,Y,U=>{A(U)},U=>{z(U)}]}class $L extends GD{constructor(e){super(),UD(this,e,jL,zL,wD,{})}}new $L({target:document.getElementById("app")});
